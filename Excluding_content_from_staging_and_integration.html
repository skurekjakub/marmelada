<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Excluding content from staging and integration - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico_11_Documentation_Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882269"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico_11_Documentation_Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom_development.html">Custom development</a></li>
                                                                                     <li><a href="Handling_global_events.html">Handling global events</a></li>
                                                            </ul>
</div>            <h1 id="src-68882269"> <span>Excluding content from staging and integration</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
        $page.content
<p   
><a   href="Handling_global_events.html">Event handlers</a> allow you to disable <a   href="Content_staging.html">content staging</a> and <a   href="Using_the_integration_bus.html">integration bus synchronization</a> for certain pages or objects. The system provides two types of events that you can use:</p>
<ul class=" "><li class=" "><p   
><a   href="#src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingpageorobjectchanges">Handling the changes of pages or objects</a></p>
</li><li class=" "><p   
><a   href="#src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingsynchronizationtasks">Handling the creation of staging or integration tasks</a></p>
</li></ul>    <h3 id="src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingpageorobjectchanges" class="heading "><span>Excluding content by handling page or object changes</span></h3>
<p   
>When changes are made to pages and objects (such as creating, editing or deleting), the system logs the change data. <a   href="Content_staging.html">Content staging</a> and the <a   href="Using_the_integration_bus.html">integration bus</a> use the data to create synchronization tasks, which then transfer the changes to the target server or application.</p>
<p   
>To completely prevent the system from starting the staging or integration process, handle the following events:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">DocumentEvents.LogChange.Before</strong></p>
</li><li class=" "><p   
><strong class=" ">ObjectEvents.LogChange.Before </strong>(or <strong class=" ">&lt;name&gt;Info.TYPEINFO.Events</strong> for specific object types)</p>
</li></ul><p   
>You can use two different approaches to disable staging or integration inside the event handlers:</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Set the properties of the event handler&#39;s <strong class=" ">LogDocumentChangeArgs/LogObjectChangeArgs</strong> parameter:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">e.Settings.LogStaging = </code><code class="keyword">false</code><code class="plain">;</code></div>
<div class="line"><code class="plain">e.Settings.LogIntegration = </code><code class="keyword">false</code><code class="plain">;</code></div>
</div>
    </div>
<p   
>Directly switches off logging of staging or integration tasks. The properties can be changed later during the execution of the <i class=" ">LogChange</i> event.</p>
        </div>
    </div>
<p   
><strong class=" ">OR</strong></p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Call the <strong class=" ">Using</strong> method of the event handler&#39;s <strong class=" ">LogDocumentChangeArgs/LogObjectChangeArgs</strong> parameter with a new <strong class=" ">CMSActionContext</strong> object as the parameter. Set the <strong class=" ">LogSynchronization</strong> or <strong class=" ">LogIntegration</strong> properties in the <i class=" ">CMSActionContext</i> constructor.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">e.Using(</code><code class="keyword">new</code><code class="plain"> CMSActionContext() {LogSynchronization = </code><code class="keyword">false</code><code class="plain">, LogIntegration = </code><code class="keyword">false</code><code class="plain">} );</code></div>
</div>
    </div>
<p   
>Disables logging of staging or integration tasks within the entire context of the <i class=" ">LogChange</i> event.</p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingpageorobjectchanges">Excluding content by handling page or object changes</a></p>
</li><li class=" "><p   
><a   href="#src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingsynchronizationtasks">Excluding content by handling synchronization tasks</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="Content_staging.html">Content staging</a></p>
</li><li class=" "><p   
><a   href="Using_the_integration_bus.html">Using the integration bus</a></p>
</li><li class=" "><p   
><a   href="Handling_global_events.html">Handling global events</a></p>
</li><li class=" "><p   
><a   href="Reference_-_Global_system_events.html">Reference - Global system events</a></p>
</li></ul>        </div>
    </div>
    <h4 id="src-68882269_Excludingcontentfromstagingandintegration-Example" class="heading "><span>Example</span></h4>
<p   
>The following example demonstrates how to use <strong class=" ">LogChange</strong> handlers to disable content staging and integration for the <i class=" ">/Archive</i> section of a website.</p>
<ol class=" "><li class=" "><p   
>Open your Kentico project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p   
>Create a <a   href="Initializing_modules_to_run_custom_code.html">custom module class</a>.</p>
<ul class=" "><li class=" "><p   
>Either add the class into a custom project within the Kentico solution (recommended) or directly into the Kentico web project (into a custom folder under the <strong class=" ">CMSApp</strong> project for <i class=" ">web application</i> installations, into the <strong class=" ">App_Code</strong> folder for <i class=" ">web site</i> installations).</p>
</li></ul></li><li class=" "><p  class="confluence-link" 
>Override the module&#39;s <strong class=" ">OnInit</strong> method and assign handlers to the <strong class=" ">DocumentEvents.LogChange.Before</strong> and <strong class=" ">PageTemplateInfo.TYPEINFO.Events.LogChange.Before</strong> events.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Base;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DocumentEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.PortalEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Registers the custom module into the system</code></div>
<div class="line"><code class="plain">[assembly: RegisterModule(</code><code class="keyword">typeof</code><code class="plain">(LogChangeHandlerModule))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> LogChangeHandlerModule : Module</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Module class constructor, the system registers the module under the name "LogChangeHandlers"</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">public</code><code class="plain"> LogChangeHandlerModule()</code></div>
<div class="line"><code class="plain">		: </code><code class="keyword">base</code><code class="plain">(</code><code class="string">"LogChangeHandlers"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Contains initialization code that is executed when the application starts</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit()</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">base</code><code class="plain">.OnInit();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Assigns a handler to the DocumentEvents.LogChange.Before event</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// This event occurs when pages are modified, before the system starts logging the changes</code></div>
<div class="line"><code class="plain">		DocumentEvents.LogChange.Before += LogDocumentChange_Before;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Assigns a handler to the LogChange.Before event for PageTemplateInfo objects</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// This event occurs when page templates are modified, before the system starts logging the changes</code></div>
<div class="line"><code class="plain">		PageTemplateInfo.TYPEINFO.Events.LogChange.Before += LogPageTemplateObjectChange_Before;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Define the handler methods (inside the custom module class):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Disables logging of staging and outgoing integration tasks for the content of pages in the /Archive section of the website</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> LogDocumentChange_Before(</code><code class="keyword">object</code><code class="plain"> sender, LogDocumentChangeEventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Gets the synchronized page</code></div>
<div class="line"><code class="plain">	TreeNode page = e.Settings.Node;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Excludes pages under the "/Archive" path from content staging and integration bus synchronization</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (page.NodeAliasPath.StartsWith(</code><code class="string">"/Archive"</code><code class="plain">))</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		e.Using(</code><code class="keyword">new</code><code class="plain"> CMSActionContext()</code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			LogSynchronization = </code><code class="keyword">false</code><code class="plain">,</code></div>
<div class="line"><code class="plain">			LogIntegration = </code><code class="keyword">false</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">		);</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Disables 'Create' and 'Update' staging/integration tasks for ad-hoc page templates of pages in the excluded /Archive section</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> LogPageTemplateObjectChange_Before(</code><code class="keyword">object</code><code class="plain"> sender, LogObjectChangeEventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Gets the synchronized object</code></div>
<div class="line"><code class="plain">	GeneralizedInfo obj = e.Settings.InfoObj;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (obj != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Continues only for ad-hoc templates</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">if</code><code class="plain"> (!ValidationHelper.GetBoolean(obj.GetValue(</code><code class="string">"PageTemplateIsReusable"</code><code class="plain">), </code><code class="keyword">false</code><code class="plain">))                </code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			</code><code class="comments">// Checks if the template is used by a page in the /Archive section</code></div>
<div class="line"><code class="plain">			</code><code class="keyword">var</code><code class="plain"> nodeQuery = DocumentHelper.GetDocuments()</code></div>
<div class="line"><code class="plain">											.Path(</code><code class="string">"/Archive"</code><code class="plain">, PathTypeEnum.Section)</code></div>
<div class="line"><code class="plain">											.WhereEquals(</code><code class="string">"NodeTemplateID"</code><code class="plain">, obj.GetValue(</code><code class="string">"PageTemplateID"</code><code class="plain">));</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">			</code><code class="keyword">if</code><code class="plain"> (nodeQuery.Count &gt; 0)</code></div>
<div class="line"><code class="plain">			{</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Disables logging of staging and integration tasks</code></div>
<div class="line"><code class="plain">				e.Settings.LogStaging = </code><code class="keyword">false</code><code class="plain">;</code></div>
<div class="line"><code class="plain">				e.Settings.LogIntegration = </code><code class="keyword">false</code><code class="plain">;</code></div>
<div class="line"><code class="plain">			}</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Save the class.</p>
</li></ol><p   
>The custom handlers ensure that the system does not create synchronization tasks for:</p>
<ul class=" "><li class=" "><p   
>The content and metadata of pages in the website&#39;s <i class=" ">/Archive</i> section</p>
</li><li class=" "><p   
><a   href="Creating_portal_engine_page_templates.html">Ad-hoc page templates</a> of the pages in the <i class=" ">/Archive</i> section (only <i class=" ">Create</i> and <i class=" ">Update</i> synchronization tasks, does not disable <i class=" ">Delete</i> tasks)</p>
</li></ul>    <h3 id="src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingsynchronizationtasks" class="heading "><span>Excluding content by handling synchronization tasks</span></h3>
<p   
><a   href="Content_staging.html">Content staging</a> and the <a   href="Using_the_integration_bus.html">integration bus</a> use synchronization tasks to transfer changes to the target server or application. You can cancel the creation of synchronization tasks during the following system events:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">StagingEvents.LogTask.Before</strong></p>
</li><li class=" "><p   
><strong class=" ">IntegrationEvents.LogInternalTask.Before</strong></p>
</li></ul><p   
>Excluding content via the <i class=" ">LogTask</i> events provides the following advantages and disadvantages:</p>
<ul class=" "><li class=" "><p   
><img  class="emoticon emoticon-plus"  src="images/s/-yaks3q/8804/1w4vbtj/_/images/icons/emoticons/add.svg" alt="images/s/-yaks3q/8804/1w4vbtj/_/images/icons/emoticons/add.svg"   />
 Allows you to access the data of the synchronization task inside the event handler. For example, you can disable only specific types of synchronization tasks.</p>
</li><li class=" "><p   
><img  class="emoticon emoticon-minus"  src="images/s/-yaks3q/8804/1w4vbtj/_/images/icons/emoticons/forbidden.svg" alt="images/s/-yaks3q/8804/1w4vbtj/_/images/icons/emoticons/forbidden.svg"   />
 The system needs to prepare the synchronization data for every object/page change, which requires more overhead than when excluding content through <a   href="#src-68882269_Excludingcontentfromstagingandintegration-Excludingcontentbyhandlingdocumentorobjectchanges">LogChange handlers</a>.</p>
</li></ul>    <h4 id="src-68882269_Excludingcontentfromstagingandintegration-Example.1" class="heading "><span>Example</span></h4>
<p   
>The following example demonstrates how to use the <strong class=" ">LogTask</strong> handler to disable content staging for the deletion of <a   href="Role_management.html">role objects</a> and for content synchronization of certain pages.</p>
<ol class=" "><li class=" "><p   
>Open your Kentico project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p   
>Create a <a   href="Initializing_modules_to_run_custom_code.html">custom module class</a>.</p>
<ul class=" "><li class=" "><p   
>Either add the class into a custom project within the Kentico solution (recommended) or directly into the Kentico web project (into a custom folder under the <strong class=" ">CMSApp</strong> project for <i class=" ">web application</i> installations, into the <strong class=" ">App_Code</strong> folder for <i class=" ">web site</i> installations).</p>
</li></ul></li><li class=" "><p  class="confluence-link" 
>Override the module&#39;s <strong class=" ">OnInit</strong> method and assign a handler to the <strong class=" ">StagingEvents.LogTask.Before</strong> event.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Synchronization;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DocumentEngine;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Registers the custom module into the system</code></div>
<div class="line"><code class="plain">[assembly: RegisterModule(</code><code class="keyword">typeof</code><code class="plain">(LogTaskHandlerModule))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> LogTaskHandlerModule : Module</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Module class constructor, the system registers the module under the name "LogTaskHandlers"</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">public</code><code class="plain"> LogTaskHandlerModule()</code></div>
<div class="line"><code class="plain">		: </code><code class="keyword">base</code><code class="plain">(</code><code class="string">"LogTaskHandlers"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Contains initialization code that is executed when the application starts</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit()</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">base</code><code class="plain">.OnInit();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Assigns a handler to the StagingEvents.LogTask.Before event</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// This event occurs before the system creates content staging synchronization tasks</code></div>
<div class="line"><code class="plain">		StagingEvents.LogTask.Before += LogTask_Before;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Define the handler method (inside the custom module class):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> LogTask_Before(</code><code class="keyword">object</code><code class="plain"> sender, StagingLogTaskEventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Handles content staging exclusion of documents</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (e.Object </code><code class="keyword">is</code><code class="plain"> TreeNode)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the synchronized document</code></div>
<div class="line"><code class="plain">		TreeNode document = (TreeNode)e.Object;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Cancels the creation of content staging tasks for documents under the "/Archive" path</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">if</code><code class="plain"> (document.NodeAliasPath.StartsWith(</code><code class="string">"/Archive"</code><code class="plain">))</code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			e.Cancel();</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Handles content staging exclusion of objects</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">else</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the synchronized object</code></div>
<div class="line"><code class="plain">		BaseInfo synchronizedObject = e.Object;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the synchronization task</code></div>
<div class="line"><code class="plain">		StagingTaskInfo stagingTask = e.Task;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Cancels the creation of content staging tasks for the deletion of role objects</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">if</code><code class="plain"> ((synchronizedObject.TypeInfo.ObjectType == CMS.Membership.RoleInfo.OBJECT_TYPE)</code></div>
<div class="line"><code class="plain">			 &amp;&amp; (stagingTask.TaskType == TaskTypeEnum.DeleteObject))</code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			e.Cancel();</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Save the class.</p>
</li></ol><p   
>The handler ensures that the system does not create staging tasks:</p>
<ul class=" "><li class=" "><p   
>For changes made to pages in the website&#39;s <i class=" ">/Archive</i> section</p>
</li><li class=" "><p   
>When a role is deleted from the system</p>
</li></ul>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
