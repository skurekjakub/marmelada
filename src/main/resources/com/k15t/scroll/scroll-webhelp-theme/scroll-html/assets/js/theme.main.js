!function(e){window.SCROLL_WEBHELP=window.SCROLL_WEBHELP||{},window.SCROLL_WEBHELP.escapeHtml=function(t){return e("<div />").text(t).html()};var t="desktop";navigator.userAgent.indexOf("MSIE")>0||navigator.userAgent.indexOf("Trident"),Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");function n(){e("body").bind("click",(function(t){!e(t.target).parents("#ht-search").length&&e("#ht-search").hasClass("open")&&(e("body").unbind("click"),a())})),e("#ht-search").addClass("open"),setTimeout((function(){e(".ht-search-clear").addClass("show")}),250),d=!0,e(".search-input")[0].focus()}function a(){input=e("#ht-search"),input.find(".ht-search-dropdown").removeClass("open"),e(".ht-search-dropdown a.hover").removeClass("hover"),e(document).unbind("keydown")}function i(t){var n=e(".ht-search-input .ht-search-dropdown"),a=n.find("ul");t=encodeURIComponent(t),a.empty();window.SCROLL_WEBHELP&&window.SCROLL_WEBHELP.search&&window.SCROLL_WEBHELP.search.performSearch(t,(function(t,i){e.each(t,(function(e,t){a.append('<li n="'+e+'" class="search-result"><a href="'+t.link+'">'+SCROLL_WEBHELP.escapeHtml(t.title)+"</a></li>")}));var r=e('<li class="search-key" n="'+t.length+'"></li>'),c=e('<a class="search-key-button" href="#">Search:&nbsp;</a>'),d=e("<b></b>").text(decodeURIComponent(i)),h=r.append(c.append(d));h.bind("click",(function(e){s(),e.preventDefault()})),a.append(h),a.children("li").each((function(t,n){var i=e(n);i.bind("mouseover",(function(){a.find("li a").removeClass("hover"),i.find("a").addClass("hover")}))})),n.addClass("open"),e("#search input.search-input").on("keydown",(function(e){switch(e.which){case 38:o(-1,n);break;case 40:o(1,n);break;default:return}e.preventDefault()}))}))}function o(t,n){var a=n.find("a").length,i=parseInt(n.find("a.hover").parent().attr("n"));isNaN(i)&&(i=-1);var o=i+t,s=n.height()-2,r=parseInt(n.find("a.hover").outerHeight());o<0||o>=a||e.each(n.find("a"),(function(t,a){t==i&&e(this).removeClass("hover"),t==o&&(e(this).addClass("hover"),r*(t+1)-n.scrollTop()>s?n.scrollTop(r*(t+1)-s):r*(t+1)-n.scrollTop()<r&&n.scrollTop()>0&&n.scrollTop(r*t))}))}function s(){var t=e(".ht-search-dropdown a.hover");0!=t.length?t.is(".search-key-button")?kenticoThemeOpenSearchResultsPage():window.location.href=t.attr("href"):kenticoThemeOpenSearchResultsPage()}function r(){e("article.ht-content").outerHeight()<e(window).innerHeight()?e("#ht-jump-top").fadeOut():e("#ht-jump-top").fadeIn()}function c(n){switch(parseInt(e("#ht-mq-detect").css("width").replace("px",""))){case 1:t="mobile";break;case 2:t="potrait";break;case 3:t="landscape";break;case 4:case 5:t="desktop"}var a=e("meta[name='confluence-base-url']").attr("content"),i=e("meta[name='confluence-space-key']").attr("content").toLowerCase(),o=a;i!==CONFIG.DOC_ROOT_URL_SPACE_KEY&&(o=o+"/"+i);var s=e(location).attr("href");s==o||s==o+"/"||s.indexOf(o+"/search")>=0||("desktop"==t?n||e("html").addClass("show-sidebar"):e("html").removeClass("show-sidebar"),"desktop"==t||"landscape"==t?e(".search-input").addClass("show"):e(".search-input").removeClass("show")),setTimeout((function(){e("#ht-sidebar").addClass("animate")}),500),setTimeout((function(){e(".search-input").addClass("animate")}),500)}e(document).ready((function(){c(!1),function(){window.SCROLL&&window.SCROLL.initPageTree&&window.SCROLL.initPageTree();e("#ht-menu-toggle").bind("click",(function(e){e.preventDefault(),setTimeout(toggleSidebar(),.05)}))}(),w(),function(){var t=function(e,t){var n,a;return function(){var i=arguments,o=this,s=function(){a=e.apply(o,i)};return clearTimeout(n),n=setTimeout(s,t),a}},n=t(i,200),a=e("#search input.search-input");a.on("focus",(function(e){d=!0,a.on("blur",(function(e){d=!1}))})),a.on("input",(function(t){var i=a.val();i.length>=3&&n(i),0==i.length&&e(".ht-search-dropdown").removeClass("open")})),a.on("keydown",(function(e){13===e.which&&s()})),e("form#search").on("submit",(function(){return!1}))}(),e("#ht-search-button").bind("click",(function(e){e.preventDefault(),n()})),e("#searchButton").bind("click",(function(t){t.preventDefault(),e(".search-input").hasClass("show")||e(".search-input").is(":visible")?s():e(".search-input").addClass("show")})),e(".ht-search-clear").bind("click",(function(e){e.preventDefault(),a()})),r(),e("#ht-jump-top").bind("click",(function(t){t.preventDefault(),e("body,html").animate({scrollTop:0},100)})),d=!1,e("body").bind("keyup",(function(e){if(!d||27==e.which){switch(e.which){case 219:"desktop"!==t&&toggleSidebar();break;case 191:sidebarExpanded||n();break;case 71:71==h&&(sidebarExpanded||n());break;case 27:a()}h=e.which}})),e(".sp-picker").change((function(){e(this).closest("form").trigger("submit")})),function(){var t=500,n=10;window.location.hash&&setTimeout((function(){e(window).scrollTo(document.getElementById(window.location.hash.substr(1)),{offset:-(e("#ht-headerbar").height()+n),duration:t,interrupt:!0,axis:"y"})}),0);e(".ht-content").on("click",'a[href^="'+location.pathname+'\\#"], a[href^=\\#]',(function(a){a.preventDefault();var i=document.getElementById(this.hash.substr(1));return i||(i=document.getElementById(decodeURI(this.hash.substr(1)))),e(window).stop(!0).scrollTo(i,{offset:-(e("#ht-headerbar").height()+n),duration:t,interrupt:!0,axis:"y"}),history&&"file"!=location.protocol.substr(0,4)&&history.pushState({},"",e(a.target).attr("href")),!1}))}(),e("#ht-loader").hide()})),function(){var t=e(".js-header-search-open"),n=e(".js-header-search-close"),a=e(".js-header-search-box"),i=250;t.click((function(e){a.css("display","flex").hide().fadeIn(i)})),n.click((function(e){a.fadeOut(i)}));var o=e(".js-menu-toggle"),s=e("#ht-sidebar");function r(){o.removeClass("is-active"),s.fadeOut(i)}o.click((function(e){o.hasClass("is-active")?r():(o.addClass("is-active"),s.fadeIn(i))})),window.addEventListener("click",(function(e){o[0].contains(e.target)||s[0].contains(e.target)||r()}))}();var d,h,l,u=new Date(1,1,2e3,12,0,0),p=!1;function f(){new Date-u<200?setTimeout(f,200):(p=!1,r(),c(!0),w())}function w(){e("#ht-wrap-container").width()>640?(e("#ht-wrap-container").addClass("sp-grid-float"),e("#ht-wrap-container").removeClass("sp-grid-fluid"),e(".sp-grid-cell.sp-grid-60").first().after(e(".sp-grid-cell.sp-grid-40"))):(e("#ht-wrap-container").addClass("sp-grid-fluid"),e("#ht-wrap-container").removeClass("sp-grid-float"),e(".sp-grid-cell.sp-grid-60").first().before(e(".sp-grid-cell.sp-grid-40")))}e(window).resize((function(){u=new Date,!1===p&&(p=!0,setTimeout(f,200))})),new ClipboardJS(".js-codeClipboard",{target:function(t){return e(t).closest(".js-codePanel").find(".js-code")[0]}}).on("success",(function(t){var n=e(t.trigger);n.addClass("is-copied"),l&&window.clearTimeout(l),l=window.setTimeout((function(){n.removeClass("is-copied")}),2e3),t.clearSelection()}))}($);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRoZW1lLm1haW4uanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsIlNDUk9MTF9XRUJIRUxQIiwidGV4dCIsImh0bWwiLCJ2aWV3cG9ydCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImluZGV4T2YiLCJPYmplY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJIVE1MRWxlbWVudCIsInJlc3VsdHNMaXN0IiwiYmluZCIsImUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJsZW5ndGgiLCJoYXNDbGFzcyIsImVtcHR5IiwidW5iaW5kIiwiaGFuZGxlU2VhcmNoUmVzdWx0cyIsImVhY2giLCJzZWFyY2hSZXN1bHRzIiwiYWRkQ2xhc3MiLCJzZWFyY2hGaWVsZEFjdGl2ZSIsImZvY3VzIiwia2V5YnV0dG9uIiwiY2hpbGRyZW4iLCJyZW1vdmVDbGFzcyIsImRvY3VtZW50IiwiZG9TZWFyY2giLCJxdWVyeSIsImRyb3Bkb3duIiwicHJldmVudERlZmF1bHQiLCJmaW5kIiwic2VhcmNoIiwicGVyZm9ybVNlYXJjaCIsImN1cnJlbnRpdGVtIiwiaW5kZXgiLCJzZWFyY2hSZXN1bHQiLCJsaW5rIiwiZXNjYXBlSHRtbCIsInRpdGxlIiwibmV4dGl0ZW0iLCJrZXlidXR0b25fbGluayIsImtleWJ1dHRvbl9zZWFyY2hlZFRlcm0iLCJkZWNvZGVVUklDb21wb25lbnQiLCJrZXlidXR0b25fbGkiLCJhcHBlbmQiLCJzY3JvbGxUb3AiLCJpdGVtaGVpZ2h0IiwiaXRlbSIsImxpIiwic2VsZWN0ZWQiLCJsb2NhdGlvbiIsImF0dHIiLCJ3aGljaCIsImRyb3Bkb3duS2V5ZG93biIsImtlbnRpY29UaGVtZU9wZW5TZWFyY2hSZXN1bHRzUGFnZSIsImNsb3NlU2VhcmNoIiwiZGlyZWN0aW9uIiwiaXRlbWNvdW50IiwicGFyc2VJbnQiLCJwYXJlbnQiLCJpc05hTiIsImRyb3Bkb3duSGVpZ2h0IiwiaGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCIkY2xvc2VTZWFyY2giLCJ0cmFuc2l0aW9uTXMiLCJ2YWwiLCJjbGljayIsInRoaXMiLCJjc3MiLCIkc2lkZWJhciIsIiRtZW51VG9nZ2xlIiwiaXMiLCJocmVmIiwiY2hlY2tGb290ZXIiLCJpbm5lckhlaWdodCIsImZpcmVFdmVudCIsIndvcmtlZCIsImZhZGVJbiIsImNoZWNrRGV2aWNlIiwicmVzaXplIiwiaW5pdEtleWJvYXJkIiwicmVwbGFjZSIsInNpZGViYXJFeHBhbmRlZCIsImJhc2VVcmwiLCJzcGFjZUtleSIsInRvTG93ZXJDYXNlIiwiaG9tZVBhdGgiLCJDT05GSUciLCJET0NfUk9PVF9VUkxfU1BBQ0VfS0VZIiwiY3VyclBhdGgiLCJzZXRDb29raWUiLCJzZXRJdGVtIiwibG9jYWxTdG9yYWdlIiwiY3ZhbHVlIiwiY29va2llIiwiZXhwaXJlcyIsInNldFRpbWVvdXQiLCJyZWFkeSIsImR1cmF0aW9uIiwiU0NST0xMIiwiaW5pdFBhZ2VUcmVlIiwiaW50ZXJydXB0IiwidG9nZ2xlU2lkZWJhciIsImluaXRTaWRlYmFyIiwiaW5pdFNlYXJjaCIsImlucHV0IiwiZnVuYyIsIndhaXQiLCJyZXN1bHQiLCJhcmdzIiwiYXJndW1lbnRzIiwiY29udGV4dCIsImRlYm91bmNlZCIsImFwcGx5IiwiY2xlYXJUaW1lb3V0IiwidGltZW91dCIsIm9wZW5TZWFyY2giLCJkZWJvdW5jZWRTZWFyY2giLCJkZWJvdW5jZSIsIm9uIiwic3RyIiwic3ZnIiwidG9nZ2xlIiwiY29udGFpbmVyIiwibGFiZWwiLCJhbGxBY2Nlc3NpYmxlIiwiYWxsRW50cmllc0FjY2Vzc2libGUiLCJzZWxlY3QiLCJzZWxlY3RvciIsImVsZW1lbnQiLCJhbmltYXRlIiwiY3JlYXRlRXZlbnQiLCJjbGlwYm9hcmQiLCIkdHJpZ2dlciIsImNsaXBib2FyZFRpbWVvdXQiLCJsYXN0S2V5Iiwic2Nyb2xsVG9Qb3NpdGlvbiIsImNoYW5nZSIsImNsb3Nlc3QiLCJ0cmlnZ2VyIiwiYWRkaXRpb25hbE9mZnNldCIsImhhc2giLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdWJzdHIiLCJvZmZzZXQiLCJheGlzIiwicGF0aG5hbWUiLCJkZWNvZGVVUkkiLCJwcm90b2NvbCIsInRhcmdldCIsImhpZGUiLCIkb3BlblNlYXJjaCIsIiRzZWFyY2giLCJ0b29nbGVEcm9wZG93biIsImZhZGVPdXQiLCJoaWRlTWVudSIsImNyZWF0ZU9wdGlvblRleHQiLCJvcHRpb24iLCJvcHRpb25UZXh0IiwidmVyc2lvbkFjY2Vzc2libGUiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJvcGVuIiwicnRpbWUiLCJ2YWx1ZSIsInJlc2l6ZWVuZCIsIkRhdGUiLCJzdWJzdHJpbmciLCJjaGVja0dyaWQiLCJ3aWR0aCIsImZpcnN0IiwiYWZ0ZXIiLCJiZWZvcmUiLCJjb25zb2xlIiwibmFtZSIsIkNsaXBib2FyZEpTIiwiY2xlYXJTZWxlY3Rpb24iXSwibWFwcGluZ3MiOiJDQUFBLFNBQUNBLEdBUUdDLE9BQU9DLGVBQWlCRCxPQUFPQyxnQkFBb0IsQ0FBQSxFQUcvQ0QsT0FBT0QsZUFBYUcsV0FBZSxTQUFFQSxHQUN4QyxPQUFBSCxFQUFBLFdBQUFHLEtBQUFBLEdBQUFDLE1BRUQsRUFFQSxJQUNBQyxFQUFBLFVBSVlDLFVBQVVDLFVBQVVDLFFBQVEsUUFBVSxHQUFPRixVQUFVQyxVQUFVQyxRQUFRLFdBR3BFQyxPQUFDQyxVQUFXQyxTQUFBQyxLQUFBWCxPQUFBWSxhQUFBTCxRQUFBLGVBNFB6QixTQUFJTSxJQUNMZCxFQUFBLFFBQUFlLEtBQUEsU0FBQSxTQUFBQyxJQUNHQyxFQUFBQSxFQUFBQSxRQUFBQSxRQUF5QixjQUFBQyxRQUFBbEIsRUFBQSxjQUFBbUIsU0FBQSxVQUVmQyxFQUFBQSxRQUFPQyxPQUFBLFNBRWZDLElBMUNKLElBNkNNQyxFQUFBQSxjQUFLQyxTQUFlLFFBQ2xCVixZQUFXLFdBQ2JkLEVBQUEsb0JBQUF5QixTQUFBLE9BM0NOLEdBQUcsS0E2Q0NDLEdBQUEsRUFDQTFCLEVBQUEsaUJBQUEsR0FBQTJCLE9BM0NSLENBR0Es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QUMsS0FBU0MsRUFWUCxJQVdOekUsV0FBQXVFLEVBWE0sTUFhZHBELEdBQUEsRUFFTzFDLElBQ1hLLEdBQUEsR0E3R1E0RixJQWlIWixDQUVJLFNBQVNBLElBQ0RqTCxFQUFFLHNCQUFzQmtMLFFBQVUsS0FDbENsTCxFQUFFLHNCQUFzQnlCLFNBQVMsaUJBQ2pDekIsRUFBRSxzQkFBc0I4QixZQUFZLGlCQUVwQzlCLEVBQUUsNEJBQTRCbUwsUUFBUUMsTUFBTXBMLEVBQUUsK0JBRTlDQSxFQUFFLHNCQUFzQnlCLFNBQVMsaUJBQ2pDekIsRUFBRSxzQkFBc0I4QixZQUFZLGlCQUVwQzlCLEVBQUUsNEJBQTRCbUwsUUFBUUUsT0FBT3JMLEVBQUUsNkJBRXZELENBOUlBQSxFQUFFQyxRQTZHVXFMLFFBQVksV0FDaEJWLEVBQUEsSUFBQUcsTUFDRyxJQUFBckQsSUFDQzZELEdBQVksRUFDVmhGLFdBQVd1RSxFQUxQLEtBdEdsQixJQWdKb0IsSUFBSVUsWUFBWSxvQkFBcUIsQ0FDakQxQixPQUFRLFNBQVNaLEdBSWIsT0FIYWxKLEVBQUVrSixHQUFTRCxRQUFRLGlCQUNiN0csS0FBSyxZQUVYLEVBQ2pCLElBR00wRixHQUFHLFdBQVcsU0FBVTlHLEdBQzlCLElBQUk0SCxFQUFXNUksRUFBRWdCLEVBQUVrSSxTQUNuQk4sRUFBU25ILFNBQVMsYUFFZG9ILEdBQ0E1SSxPQUFPd0gsYUFBYW9CLEdBR3hCQSxFQUFtQjVJLE9BQU9zRyxZQUFXLFdBQ2pDcUMsRUFBUzlHLFlBQVksWUFDekIsR0FBRyxLQUVIZCxFQUFFeUssZ0JBQ04sR0FFUCxDQW4xQkQsQ0FtMUJHekwiLCJmaWxlIjoidGhlbWUubWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigkKSB7XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBLMTV0IEhlbHAgVGhlbWVcbiAgICAgKiBNb2RpZmllZCBNYWluIEphdmFzY3JpcHRcbiAgICAgKlxuICAgICAqKi9cblxuICAgIHdpbmRvdy5TQ1JPTExfV0VCSEVMUCA9IHdpbmRvdy5TQ1JPTExfV0VCSEVMUCB8fCB7fTtcblxuICAgIHdpbmRvdy5TQ1JPTExfV0VCSEVMUC5lc2NhcGVIdG1sID0gZnVuY3Rpb24odGV4dCkge1xuICAgICAgICByZXR1cm4gJCgnPGRpdiAvPicpLnRleHQodGV4dCkuaHRtbCgpO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHNlYXJjaFVSTCA9ICdzZWFyY2guanNvbic7XG4gICAgdmFyIHZpZXdwb3J0ID0gJ2Rlc2t0b3AnO1xuICAgIHZhciBzdmRyb3Bkb3duID0gZmFsc2U7XG4gICAgLy8gdmFyIHBhZ2VJZDtcblxuICAgIC8vIGZpcmVmb3ggZGV0ZWN0aW9uXG4gICAgdmFyIGlzRmlyZWZveCA9IHR5cGVvZiBJbnN0YWxsVHJpZ2dlciAhPT0gJ3VuZGVmaW5lZCc7IC8vIEZpcmVmb3ggMS4wK1xuICAgIHZhciBpc0lFID0gKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUVcIikgPiAwKSB8fCAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiVHJpZGVudFwiKSA+IDApO1xuICAgIHZhciBpc1NhZmFyaSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh3aW5kb3cuSFRNTEVsZW1lbnQpLmluZGV4T2YoJ0NvbnN0cnVjdG9yJykgPiAwOyAvLyBBdCBsZWFzdCBTYWZhcmkgMys6IFwiW29iamVjdCBIVE1MRWxlbWVudENvbnN0cnVjdG9yXVwiXG5cbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblxuICAgICAgICAvLyBwYWdlSWQgPSAkKCdib2R5JykuYXR0cigncGFnZWlkJyk7XG4gICAgICAgIC8qIFNldCBUeXBlIG9mIERldmljZSAqL1xuICAgICAgICBjaGVja0RldmljZShmYWxzZSk7IC8vIENVU1RPTSAtIGZhbHNlIHBhcmFtZXRlciB0byBpbmRpY2F0ZSB0aGF0IHRoZSBjYWxsIGlzIG9uIHRoZSBpbml0aWFsIHBhZ2UgbG9hZFxuXG4gICAgICAgIC8qIGluaXQgU2lkZWJhciBGdW5jdGlvbnMgKi9cbiAgICAgICAgLy8gaW5pdERyYWdiYXIoKTtcbiAgICAgICAgaW5pdFNpZGViYXIoKTtcbiAgICAgICAgY2hlY2tHcmlkKCk7XG5cbiAgICAgICAgLyogaW5pdCBTZWFyY2ggRnVuY3Rpb25zICovXG4gICAgICAgIGluaXRTZWFyY2goKTtcbiAgICAgICAgaW5pdEJ1dHRvbnMoKTtcblxuICAgICAgICBpbml0Rm9vdGVyKCk7XG4gICAgICAgIC8vIHNldENvbnRlbnRXaWR0aCgpOyAvLyBDVVNUT00gY29udGVudCB3aWR0aCBhZGp1c3RtZW50c1xuXG4gICAgICAgIC8qIGluaXQgS2V5Ym9hcmQgKi9cbiAgICAgICAgaW5pdEtleWJvYXJkKCk7XG5cbiAgICAgICAgJCgnLnNwLXBpY2tlcicpLmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJ2Zvcm0nKS50cmlnZ2VyKCdzdWJtaXQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLyogaGFuZGxlIGxpbmtzIHRvIGFuY2hvcnMgY29ycmVjdGx5IHdpdGggdGhlIGhlYWRlcmJhciAqL1xuICAgICAgICBzY3JvbGxUb1Bvc2l0aW9uKCk7XG5cbiAgICAgICAgLy9zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyQoJyNodC1sb2FkZXInKS5oaWRlKCk7fSwgNTAwKTtcbiAgICAgICAgJCgnI2h0LWxvYWRlcicpLmhpZGUoKTtcbiAgICB9KTtcblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgIFJlc2l6ZSBTaWRlYmFyICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICBmdW5jdGlvbiBpbml0RHJhZ2JhcigpIHtcbiAgICAgICAgc2V0RHJhZ2JhcihwYXJzZUludChnZXRDb29raWUoJ3NpZGViYXItd2lkdGgnKSkpO1xuXG4gICAgICAgICQoJyNodC1zaWRlYmFyLWRyYWdiYXInKS5tb3VzZWRvd24oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm1vdXNlbW92ZShmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHZhciBtb3VzZXggPSBlLnBhZ2VYICsgMjtcblxuICAgICAgICAgICAgICAgIGlmIChtb3VzZXggPCAxOTAgfHwgbW91c2V4ID4gJCh3aW5kb3cpLmlubmVyV2lkdGgoKSAtIDQ1NSlyZXR1cm47XG5cbiAgICAgICAgICAgICAgICBpZiAobW91c2V4IDwgMjIwKSQoJyNodC1zaWRlYmFyJykuYWRkQ2xhc3MoJ3NtYWxsJyk7XG4gICAgICAgICAgICAgICAgZWxzZSAkKCcjaHQtc2lkZWJhcicpLnJlbW92ZUNsYXNzKCdzbWFsbCcpO1xuXG5cbiAgICAgICAgICAgICAgICBzZXREcmFnYmFyKG1vdXNleCk7XG4gICAgICAgICAgICAgICAgc2V0Q29va2llKCdzaWRlYmFyLXdpZHRoJywgbW91c2V4KTtcblxuICAgICAgICAgICAgICAgIGNoZWNrR3JpZCgpO1xuXG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoJ21vdXNlbW92ZScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNldFNjcm9sbFZlcnNpb25TZWxlY3QoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXREcmFnYmFyKHZhbCkge1xuICAgICAgICBpZiAodmlld3BvcnQgIT0gJ2Rlc2t0b3AnKXJldHVybjtcblxuICAgICAgICBpZiAodmFsID09IGlzTmFOKCkpdmFsID0gMjk1O1xuXG4gICAgICAgICQoJyNodC1zaWRlYmFyJykud2lkdGgodmFsKTtcbiAgICAgICAgaWYgKHZhbCA8IDIyMCkkKCcjaHQtc2lkZWJhcicpLmFkZENsYXNzKCdzbWFsbCcpO1xuXG4gICAgICAgICQoJyNodC13cmFwLWNvbnRhaW5lcicpLmNzcyhcImxlZnRcIiwgdmFsICsgMTApO1xuICAgICAgICAkKCcjaHQtaGVhZGVyYmFyJykuY3NzKCdsZWZ0JywgdmFsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlbmREcmFnYmFyKCkge1xuICAgICAgICBpZiAoJCgnI2h0LXNpZGViYXInKS5hdHRyKCdzdHlsZScpID09ICcnKXJldHVybjtcbiAgICAgICAgJCgnI2h0LXNpZGViYXInKS5hdHRyKCdzdHlsZScsICcnKTtcbiAgICAgICAgJCgnI2h0LXdyYXAtY29udGFpbmVyJykuYXR0cignc3R5bGUnLCAnJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0U2Nyb2xsVmVyc2lvblNlbGVjdCh2aXNpYmxlKSB7XG4gICAgICAgICQuZWFjaCgkKCcuaHQtc2Nyb2xsLXZlcnNpb25zLXNlbGVjdCBzZWxlY3QnKSwgZnVuY3Rpb24gKGluZGV4LCB2YWwpIHtcbiAgICAgICAgICAgIHNldERyb3Bkb3duKCQodGhpcykpO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgIFRvZ2dsZSBTaWRlYmFybmF2ICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICBmdW5jdGlvbiBpbml0U2lkZWJhcigpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5TQ1JPTEwgJiYgd2luZG93LlNDUk9MTC5pbml0UGFnZVRyZWUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5TQ1JPTEwuaW5pdFBhZ2VUcmVlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAkKCcjaHQtbWVudS10b2dnbGUnKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHRvZ2dsZVNpZGViYXIoKSwgMC4wNSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICBcbiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICAgICBIZWFkZXJiYXIgICAgICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICBmdW5jdGlvbiBzY3JvbGxUb1Bvc2l0aW9uKCkge1xuICAgICAgICB2YXIgZHVyYXRpb24gPSA1MDA7XG4gICAgICAgIHZhciBhZGRpdGlvbmFsT2Zmc2V0ID0gMTA7XG5cbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5oYXNoKSB7XG4gICAgICAgICAgICAvLyBOZXQgdG8gcHV0IGl0IGF0IHRoZSBlbmQgb2YgdGhlIGV2ZW50IGxvb3AgZm9yIG1ha2luZyBpdCB3b3JrIGluIElFIDotKFxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkKHdpbmRvdykuc2Nyb2xsVG8oXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cigxKSksXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogLSgkKCcjaHQtaGVhZGVyYmFyJykuaGVpZ2h0KCkgKyBhZGRpdGlvbmFsT2Zmc2V0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVycnVwdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF4aXM6ICd5J1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgJCgnLmh0LWNvbnRlbnQnKS5vbignY2xpY2snLCAnYVtocmVmXj1cIicrbG9jYXRpb24ucGF0aG5hbWUrJ1xcXFwjXCJdLCBhW2hyZWZePVxcXFwjXScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5oYXNoLnN1YnN0cigxKSk7XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBsb29rIGZvciBlbGVtZW50IHdpdGggZW5jb2RlZCBJRCAtIGhhc2ggaXMgcHJvdmlkZWQgZGlmZmVyZW50IGluIEZpcmVmb3hcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVjb2RlVVJJKHRoaXMuaGFzaC5zdWJzdHIoMSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQod2luZG93KS5zdG9wKHRydWUpLnNjcm9sbFRvKFxuICAgICAgICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IC0oJCgnI2h0LWhlYWRlcmJhcicpLmhlaWdodCgpICsgYWRkaXRpb25hbE9mZnNldCksXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJydXB0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBheGlzOiAneSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBQdXNoU3RhdGUgaXMgbm90IHN1cHBvcnRlZCBmb3IgbG9jYWwgZmlsZXMgKGZpbGU6Ly8vLi4uKVxuICAgICAgICAgICAgLy8gU2VlIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTMwMTIxMFxuICAgICAgICAgICAgaWYgKGhpc3RvcnkgJiYgbG9jYXRpb24ucHJvdG9jb2wuc3Vic3RyKDAsNCkgIT0gJ2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoe30sICcnLCAkKGUudGFyZ2V0KS5hdHRyKCdocmVmJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgICAgIFNlYXJjaCAgICAgICAgICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICBmdW5jdGlvbiBpbml0U2VhcmNoKCkge1xuICAgICAgICB2YXIgZGVib3VuY2UgPSBmdW5jdGlvbihmdW5jLCB3YWl0KSB7XG4gICAgICAgICAgICB2YXIgdGltZW91dDtcbiAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBkZWJvdW5jZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChkZWJvdW5jZWQsIHdhaXQpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBkZWJvdW5jZWRTZWFyY2ggPSBkZWJvdW5jZShkb1NlYXJjaCwgMjAwKTtcblxuICAgICAgICB2YXIgaW5wdXQgPSAkKCcjc2VhcmNoIGlucHV0LnNlYXJjaC1pbnB1dCcpO1xuICAgICAgICBpbnB1dC5vbignZm9jdXMnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgc2VhcmNoRmllbGRBY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICBpbnB1dC5vbignYmx1cicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgc2VhcmNoRmllbGRBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgIGlucHV0Lm9uKCdpbnB1dCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBzdHIgPSBpbnB1dC52YWwoKTtcbiAgICAgICAgICAgIGlmIChzdHIubGVuZ3RoID49IDMpIHtcbiAgICAgICAgICAgICAgICBkZWJvdW5jZWRTZWFyY2goc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHN0ci5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICQoJy5odC1zZWFyY2gtZHJvcGRvd24nKS5yZW1vdmVDbGFzcygnb3BlbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlucHV0Lm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLndoaWNoID09PSAxMykge1xuICAgICAgICAgICAgICAgIHBlcmZvcm1TZWFyY2goKTsgLy8gQ1VTVE9NXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJ2Zvcm0jc2VhcmNoJykub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uKCkgeyAvLyBDVVNUT01cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3BlblNlYXJjaCgpIHtcbiAgICAgICAgJCgnYm9keScpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmICghJChlLnRhcmdldCkucGFyZW50cygnI2h0LXNlYXJjaCcpLmxlbmd0aCAmJiAkKCcjaHQtc2VhcmNoJykuaGFzQ2xhc3MoJ29wZW4nKSkge1xuICAgICAgICAgICAgICAgICQoJ2JvZHknKS51bmJpbmQoJ2NsaWNrJyk7XG4gICAgICAgICAgICAgICAgY2xvc2VTZWFyY2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICQoJyNodC1zZWFyY2gnKS5hZGRDbGFzcygnb3BlbicpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJy5odC1zZWFyY2gtY2xlYXInKS5hZGRDbGFzcygnc2hvdycpO1xuICAgICAgICB9LCAyNTApO1xuICAgICAgICBzZWFyY2hGaWVsZEFjdGl2ZSA9IHRydWU7XG4gICAgICAgICQoJy5zZWFyY2gtaW5wdXQnKVswXS5mb2N1cygpO1xuICAgIH1cblxuICAgIC8vIENVU1RPTTogV2Ugb25seSBoaWRlIHNlYXJjaCBzdWdnZXN0aW9ucyBvbiBlc2NcbiAgICBmdW5jdGlvbiBjbG9zZVNlYXJjaCgpIHtcbiAgICAgICAgaW5wdXQgPSAkKCcjaHQtc2VhcmNoJyk7XG4gICAgICAgIC8vaW5wdXQuZmluZCgnaW5wdXQnKS52YWwoJycpO1xuICAgICAgICAvL2lucHV0LmZpbmQoJ2lucHV0JykuYmx1cigpO1xuICAgICAgICAvL2lucHV0LnJlbW92ZUNsYXNzKCdvcGVuJyk7XG4gICAgICAgIC8vJCgnLmh0LXNlYXJjaC1jbGVhcicpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgIGlucHV0LmZpbmQoJy5odC1zZWFyY2gtZHJvcGRvd24nKS5yZW1vdmVDbGFzcygnb3BlbicpO1xuICAgICAgXG4gICAgICAgIC8vIENVU1RPTSAtIFJlbW92ZXMgdGhlIGhvdmVyIGNsYXNzIGZyb20gaXRlbXMgc2VsZWN0ZWQgaW4gdGhlIHNlYXJjaCBkcm9wLWRvd25cblx0XHR2YXIgc2VsZWN0ZWRTZWFyY2hMaW5rRWxlbWVudCA9ICQoXCIuaHQtc2VhcmNoLWRyb3Bkb3duIGEuaG92ZXJcIik7XG4gICAgICAgIHNlbGVjdGVkU2VhcmNoTGlua0VsZW1lbnQucmVtb3ZlQ2xhc3MoXCJob3ZlclwiKTtcbiAgICAgIFxuICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoJ2tleWRvd24nKTtcbiAgICB9XG5cbiAgICAvLyBDVVNUT00gLSBjb21tZW50ZWQgb3V0LCBub3QgdXNlZCBpbiBvdXIgaW1wbGVtZW50YXRpb25cbiAgICAvKmZ1bmN0aW9uIG5hdmlnYXRlVG9TZWFyY2hSZXN1bHRzUGFnZShxdWVyeSkge1xuICAgICAgICBpZiAod2luZG93LlNDUk9MTF9XRUJIRUxQICYmIHdpbmRvdy5TQ1JPTExfV0VCSEVMUC5zZWFyY2gpIHtcbiAgICAgICAgICAgIHdpbmRvdy5TQ1JPTExfV0VCSEVMUC5zZWFyY2gubmF2aWdhdGVUb1NlYXJjaFBhZ2UocXVlcnkpO1xuICAgICAgICAgICAgY2xvc2VTZWFyY2goKTtcbiAgICAgICAgfVxuICAgIH0qL1xuXG5cbiAgICBmdW5jdGlvbiBkb1NlYXJjaChxdWVyeSkge1xuICAgICAgICB2YXIgZHJvcGRvd24gPSAkKCcuaHQtc2VhcmNoLWlucHV0IC5odC1zZWFyY2gtZHJvcGRvd24nKTtcbiAgICAgICAgdmFyIHJlc3VsdHNMaXN0ID0gZHJvcGRvd24uZmluZCgndWwnKTtcbiAgICAgIFx0Ly8gQ1VTVE9NIC0gRXNjYXBlcyBmb3JiaWRkZW4gY2hhcmFjdGVyc1xuXHRcdHF1ZXJ5ID0gZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KTtcbiAgICAgIFxuICAgICAgICByZXN1bHRzTGlzdC5lbXB0eSgpO1xuXG4gICAgICAgIHZhciBoYW5kbGVTZWFyY2hSZXN1bHRzID0gZnVuY3Rpb24oc2VhcmNoUmVzdWx0cywgcXVlcnkpIHtcbiAgICAgICAgICAgIC8vICQoZG9jdW1lbnQpLnVuYmluZCgna2V5ZG93bicpO1xuXG4gICAgICAgICAgICAkLmVhY2goc2VhcmNoUmVzdWx0cywgZnVuY3Rpb24gKGluZGV4LCBzZWFyY2hSZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRzTGlzdC5hcHBlbmQoJzxsaSBuPVwiJyArIGluZGV4ICsgJ1wiIGNsYXNzPVwic2VhcmNoLXJlc3VsdFwiPjxhIGhyZWY9XCInICsgc2VhcmNoUmVzdWx0LmxpbmsgKyAnXCI+JyArIFNDUk9MTF9XRUJIRUxQLmVzY2FwZUh0bWwoc2VhcmNoUmVzdWx0LnRpdGxlKSArICc8L2E+PC9saT4nKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDVVNUT00gLSBCcm9rZW4gZG93biBpbnRvIGluZGl2aWR1YWwgY29tcG9uZW50IGVsZW1lbnRzLCBuZWVkZWQgdG8gc2VjdXJlbHkgZGlzcGxheSB0aGUgcXVlcnkgdmFsdWVcbiAgICAgICAgICAgIC8vIENVU1RPTSAtIEFkZGVkIHRoZSAnZGVjb2RlVVJJQ29tcG9uZW50KCknIGNhbGwgdG8gdGhlIGRpc3BsYXllZCBzZWFyY2ggcXVlcnkgKHN0b3BzIGRpc3BsYXlpbmcgb2YgZW5jb2RlZCBcIlNlYXJjaDpcIiB2YWx1ZXMgaW4gdGhlIHNlYXJjaCBzdWdnZXN0ZXIgZHJvcC1kb3duKVxuICAgICAgICAgICAgdmFyIGtleWJ1dHRvbl9saSA9ICQoJzxsaSBjbGFzcz1cInNlYXJjaC1rZXlcIiBuPVwiJyArIHNlYXJjaFJlc3VsdHMubGVuZ3RoICsgJ1wiPjwvbGk+Jyk7XG4gICAgICAgICAgICB2YXIga2V5YnV0dG9uX2xpbmsgPSAkKCc8YSBjbGFzcz1cInNlYXJjaC1rZXktYnV0dG9uXCIgaHJlZj1cIiNcIj5TZWFyY2g6Jm5ic3A7PC9hPicpO1xuICAgICAgICAgICAgdmFyIGtleWJ1dHRvbl9zZWFyY2hlZFRlcm0gPSAkKCc8Yj48L2I+JykudGV4dChkZWNvZGVVUklDb21wb25lbnQocXVlcnkpKTtcbiAgICAgICAgICAgIHZhciBrZXlidXR0b24gPSBrZXlidXR0b25fbGkuYXBwZW5kKGtleWJ1dHRvbl9saW5rLmFwcGVuZChrZXlidXR0b25fc2VhcmNoZWRUZXJtKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGtleWJ1dHRvbi5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBwZXJmb3JtU2VhcmNoKCk7IC8vIENVU1RPTVxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVzdWx0c0xpc3QuYXBwZW5kKGtleWJ1dHRvbik7XG5cbiAgICAgICAgICAgIHJlc3VsdHNMaXN0LmNoaWxkcmVuKCdsaScpLmVhY2goZnVuY3Rpb24oaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgbGkgPSAkKGl0ZW0pO1xuICAgICAgICAgICAgICAgIGxpLmJpbmQoJ21vdXNlb3ZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0c0xpc3QuZmluZCgnbGkgYScpLnJlbW92ZUNsYXNzKCdob3ZlcicpO1xuICAgICAgICAgICAgICAgICAgICBsaS5maW5kKCdhJykuYWRkQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZHJvcGRvd24uYWRkQ2xhc3MoJ29wZW4nKTtcblxuICAgICAgICAgICAgdmFyIGlucHV0ID0gJCgnI3NlYXJjaCBpbnB1dC5zZWFyY2gtaW5wdXQnKTtcblxuICAgICAgICAgICAgaW5wdXQub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZS53aGljaCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd25LZXlkb3duKC0xLCBkcm9wZG93bik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duS2V5ZG93bigxLCBkcm9wZG93bik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHdpbmRvdy5TQ1JPTExfV0VCSEVMUCAmJiB3aW5kb3cuU0NST0xMX1dFQkhFTFAuc2VhcmNoKSB7XG4gICAgICAgICAgICB3aW5kb3cuU0NST0xMX1dFQkhFTFAuc2VhcmNoLnBlcmZvcm1TZWFyY2gocXVlcnksIGhhbmRsZVNlYXJjaFJlc3VsdHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHJvcGRvd25LZXlkb3duKGRpcmVjdGlvbiwgZHJvcGRvd24pIHtcbiAgICAgICAgdmFyIGl0ZW1jb3VudCA9IGRyb3Bkb3duLmZpbmQoJ2EnKS5sZW5ndGg7XG4gICAgICAgIHZhciBjdXJyZW50aXRlbSA9IHBhcnNlSW50KGRyb3Bkb3duLmZpbmQoJ2EuaG92ZXInKS5wYXJlbnQoKS5hdHRyKCduJykpO1xuICAgICAgICBpZiAoaXNOYU4oY3VycmVudGl0ZW0pKWN1cnJlbnRpdGVtID0gLTE7XG5cbiAgICAgICAgdmFyIG5leHRpdGVtID0gY3VycmVudGl0ZW0gKyBkaXJlY3Rpb247XG4gICAgICAgIHZhciBkcm9wZG93bkhlaWdodCA9IGRyb3Bkb3duLmhlaWdodCgpIC0gMjtcblxuICAgICAgICB2YXIgaXRlbWhlaWdodCA9IHBhcnNlSW50KGRyb3Bkb3duLmZpbmQoJ2EuaG92ZXInKS5vdXRlckhlaWdodCgpKTtcblxuICAgICAgICBpZiAobmV4dGl0ZW0gPCAwIHx8IG5leHRpdGVtID49IGl0ZW1jb3VudClyZXR1cm47XG5cbiAgICAgICAgJC5lYWNoKGRyb3Bkb3duLmZpbmQoJ2EnKSwgZnVuY3Rpb24gKGluZGV4LCB2YWwpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PSBjdXJyZW50aXRlbSkkKHRoaXMpLnJlbW92ZUNsYXNzKCdob3ZlcicpO1xuICAgICAgICAgICAgaWYgKGluZGV4ID09IG5leHRpdGVtKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaG92ZXInKTtcblxuICAgICAgICAgICAgICAgIGlmICgoaXRlbWhlaWdodCAqIChpbmRleCArIDEpKSAtIGRyb3Bkb3duLnNjcm9sbFRvcCgpID4gZHJvcGRvd25IZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2Nyb2xsVG9wKChpdGVtaGVpZ2h0ICogKGluZGV4ICsgMSkpIC0gZHJvcGRvd25IZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGl0ZW1oZWlnaHQgKiAoaW5kZXggKyAxKSkgLSBkcm9wZG93bi5zY3JvbGxUb3AoKSA8IGl0ZW1oZWlnaHQgJiYgZHJvcGRvd24uc2Nyb2xsVG9wKCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNjcm9sbFRvcChpdGVtaGVpZ2h0ICogaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSAgXG5cbiAgXG4gICAgLy8gQ1VTVE9NOiBQZXJmb3JtcyBhIHNlYXJjaFxuICAgIGZ1bmN0aW9uIHBlcmZvcm1TZWFyY2goKSB7XG5cdFx0Ly8gQXR0ZW1wdHMgdG8gZ2V0IGEgc2VsZWN0ZWQgc2VhcmNoIGRyb3AtZG93biBsaW5rIGVsZW1lbnRcbiAgICAgICAgdmFyIHNlbGVjdGVkID0gJCgnLmh0LXNlYXJjaC1kcm9wZG93biBhLmhvdmVyJyk7ICAgICAgICBcblxuXHRcdGlmIChzZWxlY3RlZC5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkLmlzKCcuc2VhcmNoLWtleS1idXR0b24nKSkge1xuXHRcdCAgICAgICAgLy8gSWYgdGhlIHNlbGVjdGVkIGl0ZW0gaXMgdGhlIGZpbmFsIFwiU2VhcmNoOiA8cXVlcnk+XCIgZWxlbWVudCwgb3BlbnMgdGhlIHNlYXJjaCByZXN1bHQgcGFnZSBcbiAgICAgICAgICAgICAgICBrZW50aWNvVGhlbWVPcGVuU2VhcmNoUmVzdWx0c1BhZ2UoKTsgLy8gRnVuY3Rpb24gZGVmaW5lZCBpbiB0aGVtZS5jdXN0b20uanNcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0XHRcdC8vIElmIHRoZSBzZWxlY3RlZCBpdGVtIGlzIGEgcGFnZSByZXN1bHQsIHJlZGlyZWN0cyBkaXJlY3RseSB0byBnaXZlbiBkb2N1bWVudGF0aW9uIHBhZ2VcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHNlbGVjdGVkLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcblx0XHRcdC8vIE9wZW5zIHRoZSBzZWFyY2ggcmVzdWx0IHBhZ2UgKGRlZmF1bHQgY2FzZSlcbiAgICAgICAgICAgIGtlbnRpY29UaGVtZU9wZW5TZWFyY2hSZXN1bHRzUGFnZSgpOyAvLyBGdW5jdGlvbiBkZWZpbmVkIGluIHRoZW1lLmN1c3RvbS5qc1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBpbml0QnV0dG9ucygpIHtcblxuICAgICAgICAkKCcjaHQtc2VhcmNoLWJ1dHRvbicpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIG9wZW5TZWFyY2goKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnI3NlYXJjaEJ1dHRvbicpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBcdGlmICgkKFwiLnNlYXJjaC1pbnB1dFwiKS5oYXNDbGFzcyhcInNob3dcIikgfHwgJChcIi5zZWFyY2gtaW5wdXRcIikuaXMoXCI6dmlzaWJsZVwiKSkge1xuICAgICAgICAgICAgXHRwZXJmb3JtU2VhcmNoKCk7XG4gICAgICAgIFx0fSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKFwiLnNlYXJjaC1pbnB1dFwiKS5hZGRDbGFzcyhcInNob3dcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJy5odC1zZWFyY2gtY2xlYXInKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjbG9zZVNlYXJjaCgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgSGVhZGVyIHJlc3BvbnNpdml0eSAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkb3BlblNlYXJjaCA9ICQoJy5qcy1oZWFkZXItc2VhcmNoLW9wZW4nKTtcbiAgICAgICAgdmFyICRjbG9zZVNlYXJjaCA9ICQoJy5qcy1oZWFkZXItc2VhcmNoLWNsb3NlJyk7XG4gICAgICAgIHZhciAkc2VhcmNoID0gJCgnLmpzLWhlYWRlci1zZWFyY2gtYm94Jyk7XG4gICAgICAgIHZhciB0cmFuc2l0aW9uTXMgPSAyNTA7XG5cbiAgICAgICAgJG9wZW5TZWFyY2guY2xpY2soZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgJHNlYXJjaFxuICAgICAgICAgICAgICAgIC5jc3MoXCJkaXNwbGF5XCIsIFwiZmxleFwiKVxuICAgICAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgICAgICAuZmFkZUluKHRyYW5zaXRpb25Ncyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRjbG9zZVNlYXJjaC5jbGljayhmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAkc2VhcmNoLmZhZGVPdXQodHJhbnNpdGlvbk1zKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyICRtZW51VG9nZ2xlID0gJCgnLmpzLW1lbnUtdG9nZ2xlJyk7XG4gICAgICAgIHZhciAkc2lkZWJhciA9ICQoJyNodC1zaWRlYmFyJyk7XG5cbiAgICAgICAgZnVuY3Rpb24gc2hvd01lbnUoKSB7XG4gICAgICAgICAgICAkbWVudVRvZ2dsZS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgICAgICAgICAkc2lkZWJhci5mYWRlSW4odHJhbnNpdGlvbk1zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhpZGVNZW51KCkge1xuICAgICAgICAgICAgJG1lbnVUb2dnbGUucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgICAgJHNpZGViYXIuZmFkZU91dCh0cmFuc2l0aW9uTXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgJG1lbnVUb2dnbGUuY2xpY2soZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKCRtZW51VG9nZ2xlLmhhc0NsYXNzKCdpcy1hY3RpdmUnKSkge1xuICAgICAgICAgICAgICAgIGhpZGVNZW51KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNob3dNZW51KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKCEkbWVudVRvZ2dsZVswXS5jb250YWlucyhlLnRhcmdldCkgJiYgISRzaWRlYmFyWzBdLmNvbnRhaW5zKGUudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIGhpZGVNZW51KCk7XG4gICAgICAgICAgICB9IFxuICAgICAgICB9KTtcbiAgICB9KSgpO1xuXG5cbiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICBEcm9wZG93biAgICAgICAgICAgID1cbiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuXG4gICAgZnVuY3Rpb24gc2V0RHJvcGRvd24oc2VsZWN0KSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSBzZWxlY3QucGFyZW50KCk7XG4gICAgICAgIHZhciBzdmcgPSAnPHN2ZyB3aWR0aD1cIjEwcHhcIiBoZWlnaHQ9XCIxMHB4XCIgdmlld0JveD1cIjAgMCAxMCAxMFwiIHZlcnNpb249XCIxLjFcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCI+PGcgY2xhc3M9XCJodC1zZWxlY3QtYnV0dG9uLWljb25cIj48cGF0aCBkPVwiTTIsMyBMOCwzIEw1LDcgTDIsMyBaXCI+PC9wYXRoPjwvZz48L3N2Zz4nO1xuICAgICAgICB2YXIgdG9nZ2xlID0gJCgnPGEgY2xhc3M9XCJodC1zZWxlY3QtYnV0dG9uXCI+PHNwYW4+JyArIGNyZWF0ZU9wdGlvblRleHQoc2VsZWN0LmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpKSArICc8L3NwYW4+JyArIHN2ZyArICc8L2E+Jyk7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQodG9nZ2xlKTtcblxuICAgICAgICB2YXIgbGFiZWwgPSBjb250YWluZXIucGFyZW50KCkuZmluZCgnbGFiZWwnKS5yZW1vdmUoKTtcbiAgICAgICAgdG9nZ2xlLnByZXBlbmQobGFiZWwpO1xuXG4gICAgICAgIHZhciBkcm9wZG93biA9ICQoJzxkaXYgY2xhc3M9XCJodC1kcm9wZG93biBodC1kcm9wZG93bi1zZWxlY3RcIj48dWw+PC91bD48L2Rpdj4nKTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZChkcm9wZG93bik7XG5cbiAgICAgICAgdmFyIGFsbEFjY2Vzc2libGUgPSBhbGxFbnRyaWVzQWNjZXNzaWJsZShzZWxlY3QpO1xuICAgICAgICAkLmVhY2goc2VsZWN0LmZpbmQoJ29wdGlvbicpLCBmdW5jdGlvbiAoaW5kZXgsIHZhbCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSAkKCc8bGkgbj1cIicgKyBpbmRleCArICdcIj48YSBkYXRhLXNjcm9sbC1pbnRlZ3JhdGlvbi1uYW1lPVwiJyArIHNlbGVjdC5hdHRyKCduYW1lJykgKyAnXCIgZGF0YS1zY3JvbGwtaW50ZWdyYXRpb24tdGl0bGU9XCInICsgJCh0aGlzKS50ZXh0KCkgKyAnXCIgZGF0YS1zY3JvbGwtaW50ZWdyYXRpb24tdmFsdWU9XCInICsgJCh0aGlzKS5hdHRyKCd2YWx1ZScpICsgJ1wiPicgKyBjcmVhdGVPcHRpb25UZXh0KCQodGhpcyksICFhbGxBY2Nlc3NpYmxlKSArICc8L2E+PC9saT4nKTtcbiAgICAgICAgICAgIGRyb3Bkb3duLmZpbmQoJ3VsJykuYXBwZW5kKGl0ZW0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZWxlY3Qub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBzZWxlY3QudmFsKCk7XG4gICAgICAgICAgICB0b2dnbGUuZmluZCgnc3BhbicpLnRleHQoc2VsZWN0LmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnRleHQoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRvZ2dsZS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICBpZiAodmlld3BvcnQgPT0gJ21vYmlsZScgJiYgIShpc0ZpcmVmb3ggfHwgaXNJRSkpIHtcbiAgICAgICAgICAgICAgICBvcGVuU2VsZWN0KHNlbGVjdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICAgICAgICAgIHRvb2dsZURyb3Bkb3duKGNvbnRhaW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkLmVhY2goJCgnLicgKyBjb250YWluZXIuYXR0cignY2xhc3MnKSksIGZ1bmN0aW9uIChpbmRleCwgdmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5odC1zZWxlY3QtYnV0dG9uJykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29nbGVEcm9wZG93bigkKHRoaXMpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRvb2dsZURyb3Bkb3duKGNvbnRhaW5lciwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqIENoZWNrIGlmIGFsbCBvZiB0aGUgZW50cmllcyBpbiB0aGUgZ2l2ZW4gc2VsZWN0IGFyZSBydW50aW1lIGFjY2Vzc2libGUgKGN1cnJlbnRseSBvbmx5IHJlbGV2YW50IGZvciB2ZXJzaW9ucykuICovXG4gICAgZnVuY3Rpb24gYWxsRW50cmllc0FjY2Vzc2libGUoc2VsZWN0KSB7XG4gICAgICAgIHZhciBhbGxBY2Nlc3NpYmxlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHNlbGVjdC5hdHRyKCduYW1lJykgPT09ICdzY3JvbGwtdmVyc2lvbnM6dmVyc2lvbi1uYW1lJykge1xuICAgICAgICAgICAgJC5lYWNoKHNlbGVjdC5maW5kKCdvcHRpb24nKSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFsbEFjY2Vzc2libGUgJj0gKCQodGhpcykuYXR0cignZGF0YS12ZXJzaW9uLWFjY2Vzc2libGUnKSA9PT0gJ3RydWUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGxBY2Nlc3NpYmxlO1xuICAgIH1cblxuICAgIC8qKiBDcmVhdGUgdGhlIHRleHQgZm9yIHRoZSBkcm9wLWRvd24gZW50cmllcyAodmVyc2lvbiBlbnRyaWVzIG1heSBjb250YWluIHNvbWUgZXh0cmEgaW5mbyBvdGhlciB0aGFuIHRoZSBwcm9wZXJ0eSBuYW1lKS4gKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVPcHRpb25UZXh0KG9wdGlvbiwgc2hvd1ZlcnNpb25BY2Nlc3NpYmlsaXR5KSB7XG4gICAgICAgIHZhciBvcHRpb25UZXh0ID0gb3B0aW9uLnRleHQoKTtcbiAgICAgICAgaWYgKHNob3dWZXJzaW9uQWNjZXNzaWJpbGl0eSkge1xuICAgICAgICAgICAgdmFyIHZlcnNpb25BY2Nlc3NpYmxlID0gb3B0aW9uLmF0dHIoJ2RhdGEtdmVyc2lvbi1hY2Nlc3NpYmxlJyk7XG4gICAgICAgICAgICBpZiAodmVyc2lvbkFjY2Vzc2libGUpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25UZXh0ICs9ICcgPHNwYW4gc3R5bGU9XCJmbG9hdDogcmlnaHQ7IG1hcmdpbi1sZWZ0OiAwLjhlbTsgY29sb3I6ICNkZGRkZGQ7JztcbiAgICAgICAgICAgICAgICBpZiAodmVyc2lvbkFjY2Vzc2libGUgPT09ICd0cnVlJykge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25UZXh0ICs9ICd2aXNpYmlsaXR5OiBoaWRkZW47JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3B0aW9uVGV4dCArPSAnXCIgY2xhc3M9XCJrMTV0LWljb24tdmlld3BvcnRcIj48L3NwYW4+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3B0aW9uVGV4dDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b29nbGVEcm9wZG93bihjb250YWluZXIsIG9wZW4pIHtcbiAgICAgICAgaWYgKG9wZW4pIHtcbiAgICAgICAgICAgICQoJ2JvZHknKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5pcyhjb250YWluZXIuZmluZCgnKicpKSlyZXR1cm47XG4gICAgICAgICAgICAgICAgdG9vZ2xlRHJvcGRvd24oY29udGFpbmVyLCAhb3Blbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnYm9keScpLnVuYmluZCgnY2xpY2snKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB0b2dnbGUgPSBjb250YWluZXIuZmluZCgnLmh0LXNlbGVjdC1idXR0b24nKTtcbiAgICAgICAgdmFyIGRyb3Bkb3duID0gY29udGFpbmVyLmZpbmQoJy5odC1kcm9wZG93bicpO1xuXG4gICAgICAgIGlmIChvcGVuKSB7XG4gICAgICAgICAgICB0b2dnbGUuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZHJvcGRvd24uYWRkQ2xhc3MoJ29wZW4nKTtcblxuICAgICAgICAgICAgJC5lYWNoKGRyb3Bkb3duLmZpbmQoJ2xpJyksIGZ1bmN0aW9uIChpbmRleCwgdmFsKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5iaW5kKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmZpbmQoJ2xpIGEnKS5yZW1vdmVDbGFzcygnaG92ZXInKTtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCdhJykuYWRkQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ2EnKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKS5hdHRyKCdkYXRhLXNjcm9sbC1pbnRlZ3JhdGlvbi1uYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKS5hdHRyKCdkYXRhLXNjcm9sbC1pbnRlZ3JhdGlvbi12YWx1ZScpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCdhJykuYXR0cignZGF0YS1zY3JvbGwtaW50ZWdyYXRpb24tdGl0bGUnKTtcblxuICAgICAgICAgICAgICAgICAgICB0b2dnbGUuZmluZCgnc3BhbicpLnRleHQodGl0bGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgKyAnPycgKyBuYW1lICsgJz0nICsgdmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0b2dnbGUuY2xvc2VzdCgnZm9ybScpLmZpbmQoJ2lucHV0W25hbWU9Y29udGV4dF0nKS52YWwoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldCArPSAnJmNvbnRleHQ9JyArIGNvbnRleHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9nZ2xlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIGRyb3Bkb3duLnJlbW92ZUNsYXNzKCdvcGVuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICBJbml0IEZvb3RlciAgICAgICAgICAgID1cbiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuICAgIGZ1bmN0aW9uIGluaXRGb290ZXIoKSB7XG4gICAgICAgIGNoZWNrRm9vdGVyKCk7XG5cbiAgICAgICAgJCgnI2h0LWp1bXAtdG9wJykuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgJCgnYm9keSxodG1sJykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogMH0sXG4gICAgICAgICAgICAgICAgMTAwKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tGb290ZXIoKSB7XG4gICAgICAgIGlmICgkKCdhcnRpY2xlLmh0LWNvbnRlbnQnKS5vdXRlckhlaWdodCgpIDwgJCh3aW5kb3cpLmlubmVySGVpZ2h0KCkpIHtcbiAgICAgICAgICAgICQoJyNodC1qdW1wLXRvcCcpLmZhZGVPdXQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJyNodC1qdW1wLXRvcCcpLmZhZGVJbigpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgTWVkaWEgUXVlcnkgRGV0ZWN0aW9uICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuICAgIGZ1bmN0aW9uIGNoZWNrRGV2aWNlKHJlc2l6ZSkgeyAvLyBDVVNUT00gLSByZXNpemUgcGFyYW1ldGVyIGFkZGVkIHRvIGRpZmZlcmVudGlhdGUgYmV0d2VlbiBwYWdlIGxvYWQgYW5kIHJlc2l6ZSBjYWxsc1xuICAgICAgICB2YXIgaSA9IHBhcnNlSW50KCQoJyNodC1tcS1kZXRlY3QnKS5jc3MoJ3dpZHRoJykucmVwbGFjZSgncHgnLCAnJykpO1xuXG4gICAgICAgIHN3aXRjaCAoaSkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHZpZXdwb3J0ID0gJ21vYmlsZSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB2aWV3cG9ydCA9ICdwb3RyYWl0JztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHZpZXdwb3J0ID0gJ2xhbmRzY2FwZSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICB2aWV3cG9ydCA9ICdkZXNrdG9wJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIHZpZXdwb3J0ID0gJ2Rlc2t0b3AnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGJhc2VVcmwgPSAkKFwibWV0YVtuYW1lPSdjb25mbHVlbmNlLWJhc2UtdXJsJ11cIikuYXR0cihcImNvbnRlbnRcIik7XG4gICAgICAgIHZhciBzcGFjZUtleSA9ICQoXCJtZXRhW25hbWU9J2NvbmZsdWVuY2Utc3BhY2Uta2V5J11cIikuYXR0cihcImNvbnRlbnRcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgdmFyIGhvbWVQYXRoID0gYmFzZVVybDtcblx0XHQvLyBIYW5kbGluZyBmb3IgY2FzZXMgd2hlcmUgdGhlIHZlcnNpb24gaXMgZGlzcGxheWVkIHdpdGhvdXQgYSBzcGFjZSBrZXkgaW4gdGhlIFVSTFxuXHRcdGlmIChzcGFjZUtleSAhPT0gQ09ORklHLkRPQ19ST09UX1VSTF9TUEFDRV9LRVkpIHtcblx0XHRcdGhvbWVQYXRoID0gaG9tZVBhdGggKyAnLycgKyBzcGFjZUtleTtcblx0XHR9XG4gICAgICAgIHZhciBjdXJyUGF0aCA9ICQobG9jYXRpb24pLmF0dHIoJ2hyZWYnKTtcblxuICAgICAgICAvLyBObyBzaWRlYmFyIGZvciBob21lcGFnZXMgYW5kIHNlYXJjaCByZXN1bHRzICsgQ29sbGFwc2VkIHNtYWxsIHNlYXJjaCBib3ggZm9yIHNtYWxsZXIgc2NyZWVuc1xuICAgICAgICBpZiAoICEoY3VyclBhdGggPT0gaG9tZVBhdGggfHwgY3VyclBhdGggPT0gKGhvbWVQYXRoICsgJy8nKSB8fCBjdXJyUGF0aC5pbmRleE9mKGhvbWVQYXRoICsgJy9zZWFyY2gnKSA+PSAwKSApe1xuICAgICAgICAgICAgaWYgKHZpZXdwb3J0ID09ICdkZXNrdG9wJykge1xuICAgICAgICAgICAgICAgIGlmICghcmVzaXplKSB7IC8vIERvZXMgbm90IGF1dG8tb3BlbiB0aGUgc2lkZWJhciB3aGVuIHJlc2l6aW5nXG4gICAgICAgICAgICAgICAgICAgICQoJ2h0bWwnKS5hZGRDbGFzcygnc2hvdy1zaWRlYmFyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKCdodG1sJykucmVtb3ZlQ2xhc3MoJ3Nob3ctc2lkZWJhcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIFx0aWYgKHZpZXdwb3J0ID09ICdkZXNrdG9wJyB8fCB2aWV3cG9ydCA9PSAnbGFuZHNjYXBlJykge1xuICAgICAgICAgICAgICBcdCQoJy5zZWFyY2gtaW5wdXQnKS5hZGRDbGFzcygnc2hvdycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgXHQkKCcuc2VhcmNoLWlucHV0JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE9uY2UgcmVuZGVyZWQsIGFkZCBDU1MgYW5pbWF0aW9uIGNsYXNzIHRvIHNpZGViYXIgZWxlbWVudFxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JCgnI2h0LXNpZGViYXInKS5hZGRDbGFzcygnYW5pbWF0ZScpO30sNTAwKTtcbiAgICAgIFx0c2V0VGltZW91dChmdW5jdGlvbigpeyQoJy5zZWFyY2gtaW5wdXQnKS5hZGRDbGFzcygnYW5pbWF0ZScpO30sNTAwKTtcbiAgICB9XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgV2luZG93IFJlc2l6ZSAgICAgICAgICAgID1cbiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG4gICAgdmFyIHJ0aW1lID0gbmV3IERhdGUoMSwgMSwgMjAwMCwgMTIsIDAsIDApO1xuICAgIHZhciB0aW1lb3V0ID0gZmFsc2U7XG4gICAgdmFyIGRlbHRhID0gMjAwO1xuICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xuICAgICAgICBydGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGlmICh0aW1lb3V0ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGltZW91dCA9IHRydWU7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJlc2l6ZWVuZCwgZGVsdGEpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiByZXNpemVlbmQoKSB7XG4gICAgICAgIGlmIChuZXcgRGF0ZSgpIC0gcnRpbWUgPCBkZWx0YSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChyZXNpemVlbmQsIGRlbHRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRpbWVvdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNoZWNrRm9vdGVyKCk7XG4gICAgICAgICAgICBjaGVja0RldmljZSh0cnVlKTsgLy8gQ1VTVE9NIC0gdHJ1ZSBwYXJhbWV0ZXIgdG8gaW5kaWNhdGUgdGhhdCB0aGUgY2FsbCBpcyBvbiByZXNpemVcbiAgICAgICAgICAgIGNoZWNrR3JpZCgpO1xuICAgICAgICAgICAgLy8gc2V0Q29udGVudFdpZHRoKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcGVuU2VsZWN0KHNlbGVjdG9yKSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gJChzZWxlY3RvcilbMF0sIHdvcmtlZCA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudCkgeyAvLyBhbGwgYnJvd3NlcnNcbiAgICAgICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50c1wiKTtcbiAgICAgICAgICAgIGUuaW5pdE1vdXNlRXZlbnQoXCJtb3VzZWRvd25cIiwgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAwLCAwLCAwLCAwLCAwLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbCk7XG4gICAgICAgICAgICB3b3JrZWQgPSBlbGVtZW50LmRpc3BhdGNoRXZlbnQoZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LmZpcmVFdmVudCkgeyAvLyBpZVxuICAgICAgICAgICAgd29ya2VkID0gZWxlbWVudC5maXJlRXZlbnQoXCJvbm1vdXNlZG93blwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXdvcmtlZCkgeyAvLyB1bmtub3duIGJyb3dzZXIgLyBlcnJvclxuXG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgIEtleWJvYXJkICAgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuICAgIHZhciBzZWFyY2hGaWVsZEFjdGl2ZTtcbiAgICB2YXIgbGFzdEtleTtcblxuICAgIGZ1bmN0aW9uIGluaXRLZXlib2FyZCgpIHtcbiAgICAgICAgc2VhcmNoRmllbGRBY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICAkKCdib2R5JykuYmluZCgna2V5dXAnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKHNlYXJjaEZpZWxkQWN0aXZlICYmIGUud2hpY2ggIT0gMjcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN3aXRjaCAoZS53aGljaCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMjE5OiAvLyBbXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3cG9ydCAhPT0gJ2Rlc2t0b3AnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVTaWRlYmFyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE5MTogLy8gL1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNpZGViYXJFeHBhbmRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3BlblNlYXJjaCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSA3MTogLy8gZ1xuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdEtleSA9PSA3MSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzaWRlYmFyRXhwYW5kZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuU2VhcmNoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDI3OiAvLyBlc2NcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VTZWFyY2goKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxhc3RLZXkgPSBlLndoaWNoO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgICBDb29raWVzICAgICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgIGZ1bmN0aW9uIHNldENvb2tpZShjbmFtZSwgY3ZhbHVlKSB7XG4gICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ub3JpZ2luID09ICdmaWxlOi8vJykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjbmFtZSwgY3ZhbHVlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2F2aW5nIHRoZSBzdGF0ZSBvZiB0aGUgZHJhZy1iYXIgaXMgbm90IHN1cHBvcnRlZCBiZWNhdXNlIGxvY2FsU3RvcmFnZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyAoMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuICAgICAgICAgICAgdmFyIGV4cGlyZXMgPSBcImV4cGlyZXM9XCIgKyBkLnRvVVRDU3RyaW5nKCk7XG4gICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSBjbmFtZSArIFwiPVwiICsgY3ZhbHVlICsgXCI7IFwiICsgZXhwaXJlcyArIFwiOyBwYXRoPS9cIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldENvb2tpZShjbmFtZSkge1xuICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLm9yaWdpbiA9PSAnZmlsZTovLycpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oY25hbWUpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2F2aW5nIHRoZSBzdGF0ZSBvZiB0aGUgZHJhZy1iYXIgaXMgbm90IHN1cHBvcnRlZCBiZWNhdXNlIGxvY2FsU3RvcmFnZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGNuYW1lICsgXCI9XCI7XG4gICAgICAgICAgICB2YXIgY2EgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2EubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGNhW2ldO1xuICAgICAgICAgICAgICAgIHdoaWxlIChjLmNoYXJBdCgwKSA9PSAnICcpIGMgPSBjLnN1YnN0cmluZygxKTtcbiAgICAgICAgICAgICAgICBpZiAoYy5pbmRleE9mKG5hbWUpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGMuc3Vic3RyaW5nKG5hbWUubGVuZ3RoLCBjLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICAgICBHUklEICAgICAgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuXG4gICAgZnVuY3Rpb24gY2hlY2tHcmlkKCkge1xuICAgICAgICBpZiAoJCgnI2h0LXdyYXAtY29udGFpbmVyJykud2lkdGgoKSA+IDY0MCkge1xuICAgICAgICAgICAgJCgnI2h0LXdyYXAtY29udGFpbmVyJykuYWRkQ2xhc3MoJ3NwLWdyaWQtZmxvYXQnKTtcbiAgICAgICAgICAgICQoJyNodC13cmFwLWNvbnRhaW5lcicpLnJlbW92ZUNsYXNzKCdzcC1ncmlkLWZsdWlkJyk7XG4gICAgICAgICAgICAvLyBQdXRzIHNpZGUgY2VsbCBhZnRlciBtYWluIGNlbGxcbiAgICAgICAgICAgICQoJy5zcC1ncmlkLWNlbGwuc3AtZ3JpZC02MCcpLmZpcnN0KCkuYWZ0ZXIoJCgnLnNwLWdyaWQtY2VsbC5zcC1ncmlkLTQwJykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnI2h0LXdyYXAtY29udGFpbmVyJykuYWRkQ2xhc3MoJ3NwLWdyaWQtZmx1aWQnKTtcbiAgICAgICAgICAgICQoJyNodC13cmFwLWNvbnRhaW5lcicpLnJlbW92ZUNsYXNzKCdzcC1ncmlkLWZsb2F0Jyk7XG4gICAgICAgICAgICAvLyBQdXRzIG1haW4gY2VsbCBiZWZvcmUgc2lkZSBjZWxsXG4gICAgICAgICAgICAkKCcuc3AtZ3JpZC1jZWxsLnNwLWdyaWQtNjAnKS5maXJzdCgpLmJlZm9yZSgkKCcuc3AtZ3JpZC1jZWxsLnNwLWdyaWQtNDAnKSk7XG4gICAgICAgIH0gICAgICAgIFxuICAgIH1cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgIENsaXBib2FyZCAgICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cbiAgICAoZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGNsaXBib2FyZFRpbWVvdXQ7XG5cbiAgICAgICAgdmFyIGNsaXBib2FyZCA9IG5ldyBDbGlwYm9hcmRKUygnLmpzLWNvZGVDbGlwYm9hcmQnLCB7XG4gICAgICAgICAgICB0YXJnZXQ6IGZ1bmN0aW9uKHRyaWdnZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgJHBhbmVsID0gJCh0cmlnZ2VyKS5jbG9zZXN0KCcuanMtY29kZVBhbmVsJyk7XG4gICAgICAgICAgICAgICAgdmFyICRjb2RlID0gJHBhbmVsLmZpbmQoJy5qcy1jb2RlJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gJGNvZGVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNsaXBib2FyZC5vbignc3VjY2VzcycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgJHRyaWdnZXIgPSAkKGUudHJpZ2dlcik7XG4gICAgICAgICAgICAkdHJpZ2dlci5hZGRDbGFzcygnaXMtY29waWVkJyk7XG5cbiAgICAgICAgICAgIGlmIChjbGlwYm9hcmRUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChjbGlwYm9hcmRUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2xpcGJvYXJkVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICR0cmlnZ2VyLnJlbW92ZUNsYXNzKCdpcy1jb3BpZWQnKTtcbiAgICAgICAgICAgIH0sIDIwMDApO1xuXG4gICAgICAgICAgICBlLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIH0pO1xuICAgIH0oKSlcbn0pKCQpO1xuIl19
