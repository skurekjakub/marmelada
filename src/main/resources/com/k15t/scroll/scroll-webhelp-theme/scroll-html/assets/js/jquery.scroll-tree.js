!function(e){"use strict";e.fn.scrollTree=function(s){var a,n={contextPath:"/",css:{ancestor:"active",current:"active",leaf:"leaf",loading:"sp-loading",collapsed:"sp-collapsed",expanded:"sp-expanded",error:"sp-error"},renderChildrenUl:function(){return'<ul class="nav"></ul>'},renderChildLi:function(e,s){return'<li class="'+s.css[e.type]+'"><span class="sp-toggle"></span><a href="'+e.link+'">'+SCROLL_WEBHELP.escapeHtml(e.title)+"</a></li>"}},t=e(this).data("viewportId"),l=e(this).data("root"),r=e(this).data("current"),d=e(this).data("confluenceid"),c=e(this).data("currenttitle"),i=isDevModelSwitcherSupported();if(i){var o=getCurrentDevModel();0===o.indexOf("all|")&&(o=o.split("|")[1]),a="mvc"===o?"pe":"mvc"}var p=e.extend(!0,n,s);return this.each((function(){var s=e(this);return f(s,l,c,r),function(s){s.on("click",".sp-toggle",(function(){var s=e(this).parent("li");s.is("."+p.css.collapsed)?function(s){if(s.has("ul").length)s.removeClass(p.css.collapsed).addClass(p.css.expanded);else{var n=e(p.renderChildrenUl()).appendTo(s);i?function(s,n,t){var l=s.closest("li");l&&l.removeClass(p.css.collapsed).addClass(p.css.loading);e.get(p.contextPath+"/rest/treefilter/1.0/getchildren",{spaceId:d,parent:n||l.find("> a").text(),parentLink:l.find("> a").attr("href"),label:a}).done((function(e){C(s,e),l.removeClass(p.css.loading).addClass(p.css.expanded)})).fail((function(e,s,a){l.removeClass(p.css.loading).addClass(p.css.error)}))}(n):f(n)}}(s):s.is("."+p.css.expanded)&&function(e){e.removeClass(p.css.expanded).addClass(p.css.collapsed)}(s)}))}(s),this}));function f(s,n,r,c){var o=s.closest("li");o&&o.removeClass(p.css.collapsed).addClass(p.css.loading),i?e.get(p.contextPath+"/rest/treefilter/1.0/getchildrenrecursive",{spaceId:d,parent:n||o.find("> a").text(),current:r||"",label:a,isLatest:CONFIG.CONFLUENCE_SPACE_KEY===CONFIG.DOC_ROOT_URL_SPACE_KEY}).done((function(e){C(s,e),o.removeClass(p.css.loading).addClass(p.css.expanded)})).fail((function(e,s,a){o.removeClass(p.css.loading).addClass(p.css.error)})):e.get(p.contextPath+"/rest/scroll-viewport/1.0/tree/children",{viewportId:t,root:l,parent:n||o.find("> a").attr("href"),current:c||""}).done((function(e){C(s,e),o.removeClass(p.css.loading).addClass(p.css.expanded)})).fail((function(e,s,a){o.removeClass(p.css.loading).addClass(p.css.error)}))}function C(s,a){s.html(""),e.each(a,(function(a,n){var t=e(p.renderChildLi(n,p)).appendTo(s);n.children?n.children.length?(t.addClass(p.css.expanded),C(e(p.renderChildrenUl()).appendTo(t),n.children)):t.addClass(p.css.collapsed):t.addClass(p.css.leaf)}))}}}($);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5zY3JvbGwtdHJlZS5qcyJdLCJuYW1lcyI6WyIkIiwiZm4iLCJERUZBVUxUX09QVElPTlMiLCJvcHRpb25zIiwibGFiZWwiLCJjb250ZXh0UGF0aCIsImNzcyIsImFuY2VzdG9yIiwiY3VycmVudCIsImxlYWYiLCJsb2FkaW5nIiwiY29sbGFwc2VkIiwiZXhwYW5kZWQiLCJlcnJvciIsInJlbmRlckNoaWxkcmVuVWwiLCJyZW5kZXJDaGlsZExpIiwiY2hpbGQiLCJvcHRzIiwidHlwZSIsImxpbmsiLCJTQ1JPTExfV0VCSEVMUCIsImVzY2FwZUh0bWwiLCJ0aXRsZSIsInZpZXdwb3J0SWQiLCJ0aGlzIiwiZGF0YSIsInJvb3RMaW5rIiwiY3VycmVudExpbmsiLCJjb25mbHVlbmNlU3BhY2VSb290SWQiLCJkZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkIiwiaXNEZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkIiwiY3VycmVudE1vZGVsIiwiZ2V0Q3VycmVudERldk1vZGVsIiwiaW5kZXhPZiIsInNwbGl0IiwiZXh0ZW5kIiwibG9hZENoaWxkcmVuIiwiJHJvb3RVbCIsInNldHVwRXZlbnRIYW5kbGluZyIsImN1cnJlbnRUaXRsZSIsIm9uIiwiJGxpIiwicGFyZW50IiwiaXMiLCJoYXMiLCJsZW5ndGgiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiJGNoaWxkcmVuRWwiLCJhcHBlbmRUbyIsIiR1bCIsInBhcmVudFRpdGxlIiwiaW5zZXJ0Q2hpbGRyZW4iLCJjbG9zZXN0IiwiY2hpbGRyZW4iLCIkcGFyZW50TGkiLCJzcGFjZUlkIiwiJGNoaWxkTGkiLCJmaW5kIiwidGV4dCIsInBhcmVudExpbmsiLCJhdHRyIiwiZG9uZSIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImNsb3NlTm9kZSIsImxvYWRDaGlsZHJlbk91dHNpZGVPcmlnaW5hbFBhdGgiLCJvcGVuTm9kZSIsImdldCIsImlzTGF0ZXN0IiwiQ09ORkxVRU5DRV9TUEFDRV9LRVkiLCJDT05GSUciLCJET0NfUk9PVF9VUkxfU1BBQ0VfS0VZIiwiZmFpbCIsInJvb3QiLCJqcVhIUiIsInN1Y2Nlc3MiLCJodG1sIiwiaWR4Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFDQSxHQUVHLGFBTUlBLEVBQUFDLEdBQUlDLFdBQUFBLFNBQWtCQyxHQUVsQixJQXlCQUMsRUF6QktGLEVBQUUsQ0FDSEcsWUFBWSxJQUNaQyxJQUFXLENBQ0hDLFNBQU0sU0FDZEMsUUFBVyxTQUNYQyxLQUFhLE9BQ2JDLFFBQVksYUFDTEMsVUFBRSxlQUNaQyxTQUFBLGNBQ0RDLE1BQWtCLFlBRWpCQyxpQkFBQSxXQUNELE1BQWlCLHVCQUNiLEVBQ0pDLGNBQUEsU0FBQUMsRUFBQUMsR0FDSCxNQUFBLGNBQUFBLEVBQUFYLElBQUFVLEVBQUFFLE1BQUEsNkNBQUFGLEVBQUFHLEtBQUEsS0FBQUMsZUFBQUMsV0FBQUwsRUFBQU0sT0FBQSxXQUVHQyxHQUFBQSxFQUFhdkIsRUFBRXdCLE1BQU1DLEtBQUssY0FJOUJDLEVBQUExQixFQUFBd0IsTUFBQUMsS0FBQSxRQUNBRSxFQUFBM0IsRUFBQXdCLE1BQUFDLEtBQUEsV0FJTkcsRUFBQTVCLEVBQUF3QixNQUFBQyxLQUFBLGdCQUNJSSxFQUFBQSxFQUFBQSxNQUF5QkosS0FBR0ssZ0JBRzFCRCxFQUFBQyw4QkFJSSxHQUFJQyxFQUE0QixDQUV0QyxJQUFBQSxFQUFBQyxxQkFGMkMsSUFBakNELEVBQWFFLFFBQVEsVUFJekJGLEVBQUFBLEVBQUFHLE1BQUEsS0FBQSxJQUlKOUIsRUFBQSxRQUFBMkIsRUFBQSxLQUFBLEtBQ1IsQ0FHUSxJQUFJZCxFQUFPakIsRUFBRW1DLFFBQU8sRUFBTWpDLEVBQWlCQyxHQU12Q2lDLE9BQUFBLEtBQWFDLE1BQUFBLFdBQ2JDLElBQUFBLEVBQW1CRCxFQUFBQSxNQU82QyxPQVJoRUQsRUFBYUMsRUFBU1gsRUFBVWEsRUFBY1osR0FxSnJELFNBQUFVLEdBeENPQSxFQUFRRyxHQUFHLFFBQVMsY0FBYyxXQUM5QixJQUFJQyxFQUFNekMsRUFBRXdC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LEVBQUE5RCxHQUNYNEIsSUFBSWEsRUFBWXpELEVBQUVpQixFQUFBRixjQUFBQyxFQUFBQyxJQUFBZ0MsU0FBQUMsR0FFbEJKLEVBQVk3QixTQUViRCxFQUFBc0MsU0FBQVQsUUFDSFksRUFBQVYsU0FBQTlCLEVBQUFYLElBQUFNLFVBRVBpQixFQURnQ2YsRUFBQUEsRUFBZ0JBLG9CQUFpQm1DLFNBQUFRLEdBQ3RDekMsRUFBQXNDLFdBSS9CWSxFQUFBQSxTQUFnQ2xCLEVBQUFBLElBQUFBLFdBRzdCUyxFQUFBVixTQUFBOUIsRUFBQVgsSUFBQUcsS0FHQSxHQUNJZ0MsQ0FJUixDQUVILENBbk5ELENBbU5HekMiLCJmaWxlIjoianF1ZXJ5LnNjcm9sbC10cmVlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCQpIHtcbiBcbiAgICAndXNlIHN0cmljdCc7XG4gXG4gICAgLy8gaHR0cDovL2xlYXJuLmpxdWVyeS5jb20vcGx1Z2lucy9iYXNpYy1wbHVnaW4tY3JlYXRpb24vXG4gICAgLy8gaHR0cDovL2xlYXJuLmpxdWVyeS5jb20vcGx1Z2lucy9hZHZhbmNlZC1wbHVnaW4tY29uY2VwdHMvXG4gICAgJC5mbi5zY3JvbGxUcmVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiBcbiAgICAgICAgdmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgICAgICAgICAgICdjb250ZXh0UGF0aCc6ICcvJyxcbiAgICAgICAgICAgICdjc3MnOiB7XG4gICAgICAgICAgICAgICAgJ2FuY2VzdG9yJzogJ2FjdGl2ZScsXG4gICAgICAgICAgICAgICAgJ2N1cnJlbnQnOiAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICAnbGVhZic6ICdsZWFmJyxcbiAgICAgICAgICAgICAgICAnbG9hZGluZyc6ICdzcC1sb2FkaW5nJyxcbiAgICAgICAgICAgICAgICAnY29sbGFwc2VkJzogJ3NwLWNvbGxhcHNlZCcsXG4gICAgICAgICAgICAgICAgJ2V4cGFuZGVkJzogJ3NwLWV4cGFuZGVkJyxcbiAgICAgICAgICAgICAgICAnZXJyb3InOiAnc3AtZXJyb3InXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3JlbmRlckNoaWxkcmVuVWwnOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICc8dWwgY2xhc3M9XCJuYXZcIj48L3VsPic7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3JlbmRlckNoaWxkTGknOiBmdW5jdGlvbiAoY2hpbGQsIG9wdHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzxsaSBjbGFzcz1cIicgKyBvcHRzLmNzc1tjaGlsZC50eXBlXSArICdcIj48c3BhbiBjbGFzcz1cInNwLXRvZ2dsZVwiPjwvc3Bhbj48YSBocmVmPVwiJyArIGNoaWxkLmxpbmsgKyAnXCI+JyArIFNDUk9MTF9XRUJIRUxQLmVzY2FwZUh0bWwoY2hpbGQudGl0bGUpICsgJzwvYT48L2xpPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gXG4gICAgICAgIHZhciB2aWV3cG9ydElkID0gJCh0aGlzKS5kYXRhKCd2aWV3cG9ydElkJyk7XG4gICAgICAgIHZhciByb290TGluayA9ICQodGhpcykuZGF0YSgncm9vdCcpO1xuICAgICAgICB2YXIgY3VycmVudExpbmsgPSAkKHRoaXMpLmRhdGEoJ2N1cnJlbnQnKTtcbiBcbiAgICAgICAgLy8gQ1VTVE9NXG4gICAgICAgIC8vIFBhZ2VUcmVlRmlsdGVyLXNwZWNpZmljIHZhcmlhYmxlc1xuICAgICAgICB2YXIgY29uZmx1ZW5jZVNwYWNlUm9vdElkID0gJCh0aGlzKS5kYXRhKCdjb25mbHVlbmNlaWQnKTtcbiAgICAgICAgdmFyIGN1cnJlbnRUaXRsZSA9ICQodGhpcykuZGF0YSgnY3VycmVudHRpdGxlJyk7XG4gICAgICAgIHZhciBsYWJlbDsgICAgIFxuXHRcdC8vIENhbGxzIGZ1bmN0aW9ucyBkZWZpbmVkIGluIHRoZW1lLmN1c3RvbS5qc1xuXHRcdHZhciBkZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkID0gaXNEZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkKCk7XG5cdFx0XG4gICAgICAgIC8vIFNldHMgdGhlIGxhYmVsIHVzZWQgZm9yIGZpbHRlcmluZyBpbiB0aGUgZG9jdW1lbnRhdGlvbiB0cmVlICAgICAgICBcbiAgICAgICAgLy8gQ2FsbHMgZnVuY3Rpb25zIGRlZmluZWQgaW4gdGhlbWUuY3VzdG9tLmpzXG4gICAgICBcdGlmIChkZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICAvLyBHZXRzIHRoZSBjdXJyZW50bHkgYWN0aXZlIGRldiBtb2RlbCwgd2l0aG91dCB0aGUgcG9zc2libGUgJ2FsbHwnIHByZWZpeFxuICAgICAgICAgICAgdmFyIGN1cnJlbnRNb2RlbCA9IGdldEN1cnJlbnREZXZNb2RlbCgpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRNb2RlbC5pbmRleE9mKFwiYWxsfFwiKSA9PT0gMCkge1xuICAgICAgICBcdFx0Y3VycmVudE1vZGVsID0gY3VycmVudE1vZGVsLnNwbGl0KFwifFwiKVsxXTtcbiAgICBcdFx0fVxuICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSW52ZXJ0cyB0aGUgY3VycmVudGx5IGFjdGl2ZSBkZXYgbW9kZWwsIGJlY2F1c2Ugd2UgdXNlIG5lZ2F0aXZlIGZpbHRlcmluZ1xuICAgICAgICAgICAgbGFiZWwgPSAoY3VycmVudE1vZGVsID09PSAnbXZjJykgPyAncGUnIDogJ212Yyc7ICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIC8vIE5vIGxvbmdlciBuZWVkZWQsIHNwYWNlcyB3aXRob3V0IHRoZSBkZXYgbW9kZWwgc3dpdGNoZXIgbm93IHVzZSB0aGUgZGVmYXVsdCBwYWdlIHRyZWVcbiAgICAgICAgLyplbHNlIHtcbiAgICAgICAgICAgIGxhYmVsID0gJ25vRmlsdGVyaW5nJztcbiAgICAgICAgfSovXG4gICAgICAgICAgICBcbiAgICAgICAgdmFyIG9wdHMgPSAkLmV4dGVuZCh0cnVlLCBERUZBVUxUX09QVElPTlMsIG9wdGlvbnMpO1xuIFxuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciAkcm9vdFVsID0gJCh0aGlzKTtcbiBcbiAgICAgICAgICAgIC8vbG9hZENoaWxkcmVuKCRyb290VWwsIHJvb3RMaW5rLCBjdXJyZW50TGluayk7IC8vIE9SSUdJTkFMXG4gICAgICAgICAgICBsb2FkQ2hpbGRyZW4oJHJvb3RVbCwgcm9vdExpbmssIGN1cnJlbnRUaXRsZSwgY3VycmVudExpbmspOyAvLyBDVVNUT01cbiAgICAgICAgICAgIHNldHVwRXZlbnRIYW5kbGluZygkcm9vdFVsKTtcbiBcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9KTtcbiBcbiBcbiAgICAgICAgLy9mdW5jdGlvbiBsb2FkQ2hpbGRyZW4oJHVsLCBwYXJlbnRMaW5rLCBjdXJyZW50TGluaykgeyAvLyBPUklHSU5BTFxuICAgICAgICBmdW5jdGlvbiBsb2FkQ2hpbGRyZW4oJHVsLCBwYXJlbnRMaW5rLCBjdXJyZW50VGl0bGUsIGN1cnJlbnRMaW5rKSB7IC8vIENVU1RPTVxuICAgICAgICAgICAgdmFyICRwYXJlbnRMaSA9ICR1bC5jbG9zZXN0KCdsaScpO1xuICAgICAgICAgICAgaWYgKCRwYXJlbnRMaSkge1xuICAgICAgICAgICAgICAgICRwYXJlbnRMaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5jb2xsYXBzZWQpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcHRzLmNzcy5sb2FkaW5nKTtcbiAgICAgICAgICAgIH1cblx0XHRcdGlmICghZGV2TW9kZWxTd2l0Y2hlclN1cHBvcnRlZCkge1xuXHRcdFx0XHQvLyBPUklHSU5BTCBWSUVXUE9SVCBFTkRQT0lOVFxuXHRcdFx0XHQkLmdldChvcHRzLmNvbnRleHRQYXRoICsgJy9yZXN0L3Njcm9sbC12aWV3cG9ydC8xLjAvdHJlZS9jaGlsZHJlbicsIHtcbiAgICAgICAgICAgICAgICAndmlld3BvcnRJZCc6IHZpZXdwb3J0SWQsXG4gICAgICAgICAgICAgICAgJ3Jvb3QnOiByb290TGluayxcbiAgICAgICAgICAgICAgICAncGFyZW50JzogcGFyZW50TGluayB8fCAkcGFyZW50TGkuZmluZCgnPiBhJykuYXR0cignaHJlZicpLFxuICAgICAgICAgICAgICAgICdjdXJyZW50JzogY3VycmVudExpbmsgfHwgJydcblx0XHRcdFx0fSlcblx0XHRcdFx0XHQuZG9uZShmdW5jdGlvbiBzdWNjZXNzKGNoaWxkcmVuKSB7XG5cdFx0XHRcdFx0XHRpbnNlcnRDaGlsZHJlbigkdWwsIGNoaWxkcmVuKTtcbiBcbiAgICAgICAgICAgICAgICAgICAgJHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmxvYWRpbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3Mob3B0cy5jc3MuZXhwYW5kZWQpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0LmZhaWwoZnVuY3Rpb24gZXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XG5cdFx0XHRcdFx0XHQkcGFyZW50TGkucmVtb3ZlQ2xhc3Mob3B0cy5jc3MubG9hZGluZylcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKG9wdHMuY3NzLmVycm9yKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQ7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcdFx0XHRcdFx0XHQgICAgICAgICAgIFxuXHRcdFx0XHQvLyBDVVNUT00gRU5EUE9JTlQgMVxuXHRcdFx0XHQvLyBDYWxsZWQgb24gcGFnZSBsb2FkXG5cdFx0XHRcdCQuZ2V0KG9wdHMuY29udGV4dFBhdGggKyAnL3Jlc3QvdHJlZWZpbHRlci8xLjAvZ2V0Y2hpbGRyZW5yZWN1cnNpdmUnLCB7XG5cdFx0XHRcdFx0J3NwYWNlSWQnOiBjb25mbHVlbmNlU3BhY2VSb290SWQsXG5cdFx0XHRcdFx0J3BhcmVudCc6IHBhcmVudExpbmsgfHwgJHBhcmVudExpLmZpbmQoJz4gYScpLnRleHQoKSxcblx0XHRcdFx0XHQnY3VycmVudCc6IGN1cnJlbnRUaXRsZSB8fCAnJyxcblx0XHRcdFx0XHQnbGFiZWwnOiBsYWJlbCxcblx0XHRcdFx0XHQnaXNMYXRlc3QnOlx0KENPTkZJRy5DT05GTFVFTkNFX1NQQUNFX0tFWSA9PT0gQ09ORklHLkRPQ19ST09UX1VSTF9TUEFDRV9LRVkpXG5cdFx0XHRcdH0pXG5cdFx0XHRcdFx0LmRvbmUoZnVuY3Rpb24gc3VjY2VzcyhjaGlsZHJlbikge1xuXHRcdFx0XHRcdFx0aW5zZXJ0Q2hpbGRyZW4oJHVsLCBjaGlsZHJlbik7XG5cdCBcblx0XHRcdFx0XHRcdCRwYXJlbnRMaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5sb2FkaW5nKVxuXHRcdFx0XHRcdFx0XHQuYWRkQ2xhc3Mob3B0cy5jc3MuZXhwYW5kZWQpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0LmZhaWwoZnVuY3Rpb24gZXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XG5cdFx0XHRcdFx0XHQkcGFyZW50TGkucmVtb3ZlQ2xhc3Mob3B0cy5jc3MubG9hZGluZylcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKG9wdHMuY3NzLmVycm9yKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQ7XG5cdFx0XHR9XG4gICAgICAgIH1cbiBcbiAgICAgICAgLy8gQ1VTVE9NXG4gICAgICAgIGZ1bmN0aW9uIGxvYWRDaGlsZHJlbk91dHNpZGVPcmlnaW5hbFBhdGgoJHVsLCBwYXJlbnRUaXRsZSwgY3VycmVudFRpdGxlKSB7XG4gICAgICAgICAgICB2YXIgJHBhcmVudExpID0gJHVsLmNsb3Nlc3QoJ2xpJyk7XG4gICAgICAgICAgICBpZiAoJHBhcmVudExpKSB7XG4gICAgICAgICAgICAgICAgJHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmNvbGxhcHNlZClcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKG9wdHMuY3NzLmxvYWRpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIFx0Ly8gQ1VTVE9NIEVORFBPSU5UIDIgLSBjYWxsZWQgd2hlbiBvcGVuaW5nIHN1YnRyZWVzIG91dHNpZGUgdGhlIG9yaWdpbmFsIHBhZ2UgbG9hZCByZXF1ZXN0XG4gICAgICAgICAgICAvLyB1c2VzIERPTSB0byBwZXJzaXN0IGFscmVhZHkgbG9hZGVkIHBhZ2UgbGlua3MgdG8gYXZvaWQgcmVwZWF0ZWQgdXNlIG9mIHJlY3Vyc2lvblxuICAgICAgICAgICAgJC5nZXQob3B0cy5jb250ZXh0UGF0aCArICcvcmVzdC90cmVlZmlsdGVyLzEuMC9nZXRjaGlsZHJlbicsIHtcbiAgICAgICAgICAgICAgICAnc3BhY2VJZCc6IGNvbmZsdWVuY2VTcGFjZVJvb3RJZCxcbiAgICAgICAgICAgICAgICAncGFyZW50JzogcGFyZW50VGl0bGUgfHwgJHBhcmVudExpLmZpbmQoJz4gYScpLnRleHQoKSxcbiAgICAgICAgICAgICAgXHQncGFyZW50TGluayc6ICAkcGFyZW50TGkuZmluZCgnPiBhJykuYXR0cignaHJlZicpLFxuICAgICAgICAgICAgICAgICdsYWJlbCc6IGxhYmVsXHRcdFx0XHRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24gc3VjY2VzcyhjaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRDaGlsZHJlbigkdWwsIGNoaWxkcmVuKTtcblxuICAgICAgICAgICAgICAgICAgICAkcGFyZW50TGkucmVtb3ZlQ2xhc3Mob3B0cy5jc3MubG9hZGluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcHRzLmNzcy5leHBhbmRlZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbiBlcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHtcbiAgICAgICAgICAgICAgICAgICAgJHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmxvYWRpbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3Mob3B0cy5jc3MuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICA7XG4gICAgICAgIH1cbiAgICAgIFxuICAgICAgICBmdW5jdGlvbiBpbnNlcnRDaGlsZHJlbigkdWwsIGNoaWxkcmVuKSB7XG4gICAgICAgICAgICAkdWwuaHRtbCgnJyk7XG4gICAgICAgICAgICAkLmVhY2goY2hpbGRyZW4sIGZ1bmN0aW9uIChpZHgsIGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgdmFyICRjaGlsZExpID0gJChvcHRzLnJlbmRlckNoaWxkTGkoY2hpbGQsIG9wdHMpKS5hcHBlbmRUbygkdWwpO1xuIFxuICAgICAgICAgICAgICAgIGlmIChjaGlsZC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkY2hpbGRMaS5hZGRDbGFzcyhvcHRzLmNzcy5leHBhbmRlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGNoaWxkcmVuRWwgPSAkKG9wdHMucmVuZGVyQ2hpbGRyZW5VbCgpKS5hcHBlbmRUbygkY2hpbGRMaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRDaGlsZHJlbigkY2hpbGRyZW5FbCwgY2hpbGQuY2hpbGRyZW4pO1xuIFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGNoaWxkTGkuYWRkQ2xhc3Mob3B0cy5jc3MuY29sbGFwc2VkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRjaGlsZExpLmFkZENsYXNzKG9wdHMuY3NzLmxlYWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gXG4gXG4gICAgICAgIGZ1bmN0aW9uIHNldHVwRXZlbnRIYW5kbGluZygkcm9vdFVsKSB7XG4gICAgICAgICAgICAkcm9vdFVsLm9uKCdjbGljaycsICcuc3AtdG9nZ2xlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciAkbGkgPSAkKHRoaXMpLnBhcmVudCgnbGknKTtcbiAgICAgICAgICAgICAgICBpZiAoJGxpLmlzKCcuJyArIG9wdHMuY3NzLmNvbGxhcHNlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3Blbk5vZGUoJGxpKTtcbiBcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRsaS5pcygnLicgKyBvcHRzLmNzcy5leHBhbmRlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VOb2RlKCRsaSk7XG4gXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgZG9uJ3QgaGF2ZSBjaGlsZHJlbiAtPiBuby1vcFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gXG4gXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5Ob2RlKCRsaSkge1xuICAgICAgICAgICAgaWYgKCRsaS5oYXMoJ3VsJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gY2hpbGRyZW4gaGF2ZSBiZWVuIGxvYWRlZCwganVzdCB0b2dnbGUgY2xhc3Nlc1xuICAgICAgICAgICAgICAgICRsaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5jb2xsYXBzZWQpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcHRzLmNzcy5leHBhbmRlZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGNoaWxkcmVuIGhhdmUgdG8gYmUgbG9hZGVkXG4gICAgICAgICAgICAgICAgdmFyICRjaGlsZHJlbkVsID0gJChvcHRzLnJlbmRlckNoaWxkcmVuVWwoKSkuYXBwZW5kVG8oJGxpKTtcblx0XHRcdFx0aWYgKCFkZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0bG9hZENoaWxkcmVuKCRjaGlsZHJlbkVsKTsgLy8gT1JJR0lOQUxcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRsb2FkQ2hpbGRyZW5PdXRzaWRlT3JpZ2luYWxQYXRoKCRjaGlsZHJlbkVsKTsgLy8gQ1VTVE9NXG5cdFx0XHRcdH1cblx0XHRcdH1cbiAgICAgICAgfVxuIFxuIFxuICAgICAgICBmdW5jdGlvbiBjbG9zZU5vZGUoJGxpKSB7XG4gICAgICAgICAgICAkbGlcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3Mob3B0cy5jc3MuZXhwYW5kZWQpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKG9wdHMuY3NzLmNvbGxhcHNlZCk7XG4gICAgICAgIH1cbiAgICB9O1xuIFxufSkoJCk7Il19
