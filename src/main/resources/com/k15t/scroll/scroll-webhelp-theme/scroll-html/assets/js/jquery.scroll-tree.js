!function(e){"use strict";e.fn.scrollTree=function(s){var a,n={contextPath:"/",css:{ancestor:"active",current:"active",leaf:"leaf",loading:"sp-loading",collapsed:"sp-collapsed",expanded:"sp-expanded",error:"sp-error"},renderChildrenUl:function(){return'<ul class="nav"></ul>'},renderChildLi:function(e,s){return'<li class="'+s.css[e.type]+'"><span class="sp-toggle"></span><a href="'+e.link+'">'+SCROLL_WEBHELP.escapeHtml(e.title)+"</a></li>"}},t=e(this).data("viewportId"),l=e(this).data("root"),r=e(this).data("current"),d=e(this).data("confluenceid"),c=e(this).data("currenttitle"),i=isDevModelSwitcherSupported();if(i){var o=getCurrentDevModel();0===o.indexOf("all|")&&(o=o.split("|")[1]),a="mvc"===o?"pe":"mvc"}var p=e.extend(!0,n,s);return this.each((function(){var s=e(this);return f(s,l,c,r),function(s){s.on("click",".sp-toggle",(function(){var s=e(this).parent("li");s.is("."+p.css.collapsed)?function(s){if(s.has("ul").length)s.removeClass(p.css.collapsed).addClass(p.css.expanded);else{var n=e(p.renderChildrenUl()).appendTo(s);i?function(s,n,t){var l=s.closest("li");l&&l.removeClass(p.css.collapsed).addClass(p.css.loading);e.get(p.contextPath+"/rest/treefilter/1.0/getchildren",{spaceId:d,parent:n||l.find("> a").text(),parentLink:l.find("> a").attr("href"),label:a}).done((function(e){C(s,e),l.removeClass(p.css.loading).addClass(p.css.expanded)})).fail((function(e,s,a){l.removeClass(p.css.loading).addClass(p.css.error)}))}(n):f(n)}}(s):s.is("."+p.css.expanded)&&function(e){e.removeClass(p.css.expanded).addClass(p.css.collapsed)}(s)}))}(s),this}));function f(s,n,r,c){var o=s.closest("li");o&&o.removeClass(p.css.collapsed).addClass(p.css.loading),i?e.get(p.contextPath+"/rest/treefilter/1.0/getchildrenrecursive",{spaceId:d,parent:n||o.find("> a").text(),current:r||"",label:a,isLatest:CONFIG.CONFLUENCE_SPACE_KEY===CONFIG.DOC_ROOT_URL_SPACE_KEY}).done((function(e){C(s,e),o.removeClass(p.css.loading).addClass(p.css.expanded)})).fail((function(e,s,a){o.removeClass(p.css.loading).addClass(p.css.error)})):e.get(p.contextPath+"/rest/scroll-viewport/1.0/tree/children",{viewportId:t,root:l,parent:n||o.find("> a").attr("href"),current:c||""}).done((function(e){C(s,e),o.removeClass(p.css.loading).addClass(p.css.expanded)})).fail((function(e,s,a){o.removeClass(p.css.loading).addClass(p.css.error)}))}function C(s,a){s.html(""),e.each(a,(function(a,n){var t=e(p.renderChildLi(n,p)).appendTo(s);n.children?n.children.length?(t.addClass(p.css.expanded),C(e(p.renderChildrenUl()).appendTo(t),n.children)):t.addClass(p.css.collapsed):t.addClass(p.css.leaf)}))}}}($);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5zY3JvbGwtdHJlZS5qcyJdLCJuYW1lcyI6WyIkIiwiZm4iLCJERUZBVUxUX09QVElPTlMiLCJvcHRpb25zIiwibGFiZWwiLCJjb250ZXh0UGF0aCIsImNzcyIsImFuY2VzdG9yIiwiY3VycmVudCIsImxlYWYiLCJsb2FkaW5nIiwiY29sbGFwc2VkIiwiZXhwYW5kZWQiLCJlcnJvciIsInJlbmRlckNoaWxkcmVuVWwiLCJyZW5kZXJDaGlsZExpIiwiY2hpbGQiLCJvcHRzIiwidHlwZSIsImxpbmsiLCJTQ1JPTExfV0VCSEVMUCIsImVzY2FwZUh0bWwiLCJ0aXRsZSIsInZpZXdwb3J0SWQiLCJ0aGlzIiwiZGF0YSIsInJvb3RMaW5rIiwiY3VycmVudExpbmsiLCJjb25mbHVlbmNlU3BhY2VSb290SWQiLCJkZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkIiwiaXNEZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkIiwiY3VycmVudE1vZGVsIiwiZ2V0Q3VycmVudERldk1vZGVsIiwiaW5kZXhPZiIsInNwbGl0IiwiZXh0ZW5kIiwibG9hZENoaWxkcmVuIiwiJHJvb3RVbCIsInNldHVwRXZlbnRIYW5kbGluZyIsImN1cnJlbnRUaXRsZSIsIm9uIiwiJGxpIiwicGFyZW50IiwiaXMiLCJoYXMiLCJsZW5ndGgiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiJGNoaWxkcmVuRWwiLCJhcHBlbmRUbyIsIiR1bCIsInBhcmVudFRpdGxlIiwiaW5zZXJ0Q2hpbGRyZW4iLCJjbG9zZXN0IiwiY2hpbGRyZW4iLCIkcGFyZW50TGkiLCJzcGFjZUlkIiwiJGNoaWxkTGkiLCJmaW5kIiwidGV4dCIsInBhcmVudExpbmsiLCJhdHRyIiwiZG9uZSIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImNsb3NlTm9kZSIsImxvYWRDaGlsZHJlbk91dHNpZGVPcmlnaW5hbFBhdGgiLCJvcGVuTm9kZSIsImdldCIsImlzTGF0ZXN0IiwiQ09ORkxVRU5DRV9TUEFDRV9LRVkiLCJDT05GSUciLCJET0NfUk9PVF9VUkxfU1BBQ0VfS0VZIiwiZmFpbCIsInJvb3QiLCJqcVhIUiIsInN1Y2Nlc3MiLCJodG1sIiwiaWR4Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFDQSxHQUVHLGFBTUlBLEVBQUFDLEdBQUlDLFdBQUFBLFNBQWtCQyxHQUVsQixJQXlCQUMsRUF6QktGLEVBQUUsQ0FDSEcsWUFBWSxJQUNaQyxJQUFXLENBQ0hDLFNBQU0sU0FDZEMsUUFBVyxTQUNYQyxLQUFhLE9BQ2JDLFFBQVksYUFDTEMsVUFBRSxlQUNaQyxTQUFBLGNBQ0RDLE1BQWtCLFlBRWpCQyxpQkFBQSxXQUNELE1BQWlCLHVCQUNiLEVBQ0pDLGNBQUEsU0FBQUMsRUFBQUMsR0FDSCxNQUFBLGNBQUFBLEVBQUFYLElBQUFVLEVBQUFFLE1BQUEsNkNBQUFGLEVBQUFHLEtBQUEsS0FBQUMsZUFBQUMsV0FBQUwsRUFBQU0sT0FBQSxXQUVHQyxHQUFBQSxFQUFhdkIsRUFBRXdCLE1BQU1DLEtBQUssY0FJOUJDLEVBQUExQixFQUFBd0IsTUFBQUMsS0FBQSxRQUNBRSxFQUFBM0IsRUFBQXdCLE1BQUFDLEtBQUEsV0FJTkcsRUFBQTVCLEVBQUF3QixNQUFBQyxLQUFBLGdCQUNJSSxFQUFBQSxFQUFBQSxNQUF5QkosS0FBR0ssZ0JBRzFCRCxFQUFBQyw4QkFJSSxHQUFJQyxFQUE0QixDQUV0QyxJQUFBQSxFQUFBQyxxQkFGMkMsSUFBakNELEVBQWFFLFFBQVEsVUFJekJGLEVBQUFBLEVBQUFHLE1BQUEsS0FBQSxJQUlKOUIsRUFBQSxRQUFBMkIsRUFBQSxLQUFBLEtBQ1IsQ0FHUSxJQUFJZCxFQUFPakIsRUFBRW1DLFFBQU8sRUFBTWpDLEVBQWlCQyxHQU12Q2lDLE9BQUFBLEtBQWFDLE1BQUFBLFdBQ2JDLElBQUFBLEVBQW1CRCxFQUFBQSxNQU82QyxPQVJoRUQsRUFBYUMsRUFBU1gsRUFBVWEsRUFBY1osR0FxSnJELFNBQUFVLEdBeENPQSxFQUFRRyxHQUFHLFFBQVMsY0FBYyxXQUM5QixJQUFJQyxFQUFNekMsRUFBRXdC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LEVBQUE5RCxHQUNYNEIsSUFBSWEsRUFBWXpELEVBQUVpQixFQUFBRixjQUFBQyxFQUFBQyxJQUFBZ0MsU0FBQUMsR0FFbEJKLEVBQVk3QixTQUViRCxFQUFBc0MsU0FBQVQsUUFDSFksRUFBQVYsU0FBQTlCLEVBQUFYLElBQUFNLFVBRVBpQixFQURnQ2YsRUFBQUEsRUFBZ0JBLG9CQUFpQm1DLFNBQUFRLEdBQ3RDekMsRUFBQXNDLFdBSS9CWSxFQUFBQSxTQUFnQ2xCLEVBQUFBLElBQUFBLFdBRzdCUyxFQUFBVixTQUFBOUIsRUFBQVgsSUFBQUcsS0FHQSxHQUNJZ0MsQ0FJUixDQUVILENBbk5ELENBbU5HekMiLCJmaWxlIjoianF1ZXJ5LnNjcm9sbC10cmVlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCQpIHtcclxuIFxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gXHJcbiAgICAvLyBodHRwOi8vbGVhcm4uanF1ZXJ5LmNvbS9wbHVnaW5zL2Jhc2ljLXBsdWdpbi1jcmVhdGlvbi9cclxuICAgIC8vIGh0dHA6Ly9sZWFybi5qcXVlcnkuY29tL3BsdWdpbnMvYWR2YW5jZWQtcGx1Z2luLWNvbmNlcHRzL1xyXG4gICAgJC5mbi5zY3JvbGxUcmVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuIFxyXG4gICAgICAgIHZhciBERUZBVUxUX09QVElPTlMgPSB7XHJcbiAgICAgICAgICAgICdjb250ZXh0UGF0aCc6ICcvJyxcclxuICAgICAgICAgICAgJ2Nzcyc6IHtcclxuICAgICAgICAgICAgICAgICdhbmNlc3Rvcic6ICdhY3RpdmUnLFxyXG4gICAgICAgICAgICAgICAgJ2N1cnJlbnQnOiAnYWN0aXZlJyxcclxuICAgICAgICAgICAgICAgICdsZWFmJzogJ2xlYWYnLFxyXG4gICAgICAgICAgICAgICAgJ2xvYWRpbmcnOiAnc3AtbG9hZGluZycsXHJcbiAgICAgICAgICAgICAgICAnY29sbGFwc2VkJzogJ3NwLWNvbGxhcHNlZCcsXHJcbiAgICAgICAgICAgICAgICAnZXhwYW5kZWQnOiAnc3AtZXhwYW5kZWQnLFxyXG4gICAgICAgICAgICAgICAgJ2Vycm9yJzogJ3NwLWVycm9yJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAncmVuZGVyQ2hpbGRyZW5VbCc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnPHVsIGNsYXNzPVwibmF2XCI+PC91bD4nO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAncmVuZGVyQ2hpbGRMaSc6IGZ1bmN0aW9uIChjaGlsZCwgb3B0cykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc8bGkgY2xhc3M9XCInICsgb3B0cy5jc3NbY2hpbGQudHlwZV0gKyAnXCI+PHNwYW4gY2xhc3M9XCJzcC10b2dnbGVcIj48L3NwYW4+PGEgaHJlZj1cIicgKyBjaGlsZC5saW5rICsgJ1wiPicgKyBTQ1JPTExfV0VCSEVMUC5lc2NhcGVIdG1sKGNoaWxkLnRpdGxlKSArICc8L2E+PC9saT4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuIFxyXG4gICAgICAgIHZhciB2aWV3cG9ydElkID0gJCh0aGlzKS5kYXRhKCd2aWV3cG9ydElkJyk7XHJcbiAgICAgICAgdmFyIHJvb3RMaW5rID0gJCh0aGlzKS5kYXRhKCdyb290Jyk7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRMaW5rID0gJCh0aGlzKS5kYXRhKCdjdXJyZW50Jyk7XHJcbiBcclxuICAgICAgICAvLyBDVVNUT01cclxuICAgICAgICAvLyBQYWdlVHJlZUZpbHRlci1zcGVjaWZpYyB2YXJpYWJsZXNcclxuICAgICAgICB2YXIgY29uZmx1ZW5jZVNwYWNlUm9vdElkID0gJCh0aGlzKS5kYXRhKCdjb25mbHVlbmNlaWQnKTtcclxuICAgICAgICB2YXIgY3VycmVudFRpdGxlID0gJCh0aGlzKS5kYXRhKCdjdXJyZW50dGl0bGUnKTtcclxuICAgICAgICB2YXIgbGFiZWw7ICAgICBcclxuXHRcdC8vIENhbGxzIGZ1bmN0aW9ucyBkZWZpbmVkIGluIHRoZW1lLmN1c3RvbS5qc1xyXG5cdFx0dmFyIGRldk1vZGVsU3dpdGNoZXJTdXBwb3J0ZWQgPSBpc0Rldk1vZGVsU3dpdGNoZXJTdXBwb3J0ZWQoKTtcclxuXHRcdFxyXG4gICAgICAgIC8vIFNldHMgdGhlIGxhYmVsIHVzZWQgZm9yIGZpbHRlcmluZyBpbiB0aGUgZG9jdW1lbnRhdGlvbiB0cmVlICAgICAgICBcclxuICAgICAgICAvLyBDYWxscyBmdW5jdGlvbnMgZGVmaW5lZCBpbiB0aGVtZS5jdXN0b20uanNcclxuICAgICAgXHRpZiAoZGV2TW9kZWxTd2l0Y2hlclN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICAvLyBHZXRzIHRoZSBjdXJyZW50bHkgYWN0aXZlIGRldiBtb2RlbCwgd2l0aG91dCB0aGUgcG9zc2libGUgJ2FsbHwnIHByZWZpeFxyXG4gICAgICAgICAgICB2YXIgY3VycmVudE1vZGVsID0gZ2V0Q3VycmVudERldk1vZGVsKCk7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50TW9kZWwuaW5kZXhPZihcImFsbHxcIikgPT09IDApIHtcclxuICAgICAgICBcdFx0Y3VycmVudE1vZGVsID0gY3VycmVudE1vZGVsLnNwbGl0KFwifFwiKVsxXTtcclxuICAgIFx0XHR9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gSW52ZXJ0cyB0aGUgY3VycmVudGx5IGFjdGl2ZSBkZXYgbW9kZWwsIGJlY2F1c2Ugd2UgdXNlIG5lZ2F0aXZlIGZpbHRlcmluZ1xyXG4gICAgICAgICAgICBsYWJlbCA9IChjdXJyZW50TW9kZWwgPT09ICdtdmMnKSA/ICdwZScgOiAnbXZjJzsgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIC8vIE5vIGxvbmdlciBuZWVkZWQsIHNwYWNlcyB3aXRob3V0IHRoZSBkZXYgbW9kZWwgc3dpdGNoZXIgbm93IHVzZSB0aGUgZGVmYXVsdCBwYWdlIHRyZWVcclxuICAgICAgICAvKmVsc2Uge1xyXG4gICAgICAgICAgICBsYWJlbCA9ICdub0ZpbHRlcmluZyc7XHJcbiAgICAgICAgfSovXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIHZhciBvcHRzID0gJC5leHRlbmQodHJ1ZSwgREVGQVVMVF9PUFRJT05TLCBvcHRpb25zKTtcclxuIFxyXG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgJHJvb3RVbCA9ICQodGhpcyk7XHJcbiBcclxuICAgICAgICAgICAgLy9sb2FkQ2hpbGRyZW4oJHJvb3RVbCwgcm9vdExpbmssIGN1cnJlbnRMaW5rKTsgLy8gT1JJR0lOQUxcclxuICAgICAgICAgICAgbG9hZENoaWxkcmVuKCRyb290VWwsIHJvb3RMaW5rLCBjdXJyZW50VGl0bGUsIGN1cnJlbnRMaW5rKTsgLy8gQ1VTVE9NXHJcbiAgICAgICAgICAgIHNldHVwRXZlbnRIYW5kbGluZygkcm9vdFVsKTtcclxuIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9KTtcclxuIFxyXG4gXHJcbiAgICAgICAgLy9mdW5jdGlvbiBsb2FkQ2hpbGRyZW4oJHVsLCBwYXJlbnRMaW5rLCBjdXJyZW50TGluaykgeyAvLyBPUklHSU5BTFxyXG4gICAgICAgIGZ1bmN0aW9uIGxvYWRDaGlsZHJlbigkdWwsIHBhcmVudExpbmssIGN1cnJlbnRUaXRsZSwgY3VycmVudExpbmspIHsgLy8gQ1VTVE9NXHJcbiAgICAgICAgICAgIHZhciAkcGFyZW50TGkgPSAkdWwuY2xvc2VzdCgnbGknKTtcclxuICAgICAgICAgICAgaWYgKCRwYXJlbnRMaSkge1xyXG4gICAgICAgICAgICAgICAgJHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmNvbGxhcHNlZClcclxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3Mob3B0cy5jc3MubG9hZGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuXHRcdFx0aWYgKCFkZXZNb2RlbFN3aXRjaGVyU3VwcG9ydGVkKSB7XHJcblx0XHRcdFx0Ly8gT1JJR0lOQUwgVklFV1BPUlQgRU5EUE9JTlRcclxuXHRcdFx0XHQkLmdldChvcHRzLmNvbnRleHRQYXRoICsgJy9yZXN0L3Njcm9sbC12aWV3cG9ydC8xLjAvdHJlZS9jaGlsZHJlbicsIHtcclxuICAgICAgICAgICAgICAgICd2aWV3cG9ydElkJzogdmlld3BvcnRJZCxcclxuICAgICAgICAgICAgICAgICdyb290Jzogcm9vdExpbmssXHJcbiAgICAgICAgICAgICAgICAncGFyZW50JzogcGFyZW50TGluayB8fCAkcGFyZW50TGkuZmluZCgnPiBhJykuYXR0cignaHJlZicpLFxyXG4gICAgICAgICAgICAgICAgJ2N1cnJlbnQnOiBjdXJyZW50TGluayB8fCAnJ1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQuZG9uZShmdW5jdGlvbiBzdWNjZXNzKGNoaWxkcmVuKSB7XHJcblx0XHRcdFx0XHRcdGluc2VydENoaWxkcmVuKCR1bCwgY2hpbGRyZW4pO1xyXG4gXHJcbiAgICAgICAgICAgICAgICAgICAgJHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmxvYWRpbmcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcHRzLmNzcy5leHBhbmRlZCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0LmZhaWwoZnVuY3Rpb24gZXJyb3IoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XHJcblx0XHRcdFx0XHRcdCRwYXJlbnRMaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5sb2FkaW5nKVxyXG5cdFx0XHRcdFx0XHRcdC5hZGRDbGFzcyhvcHRzLmNzcy5lcnJvcik7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdDtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcdFx0XHRcdFx0XHQgICAgICAgICAgIFxyXG5cdFx0XHRcdC8vIENVU1RPTSBFTkRQT0lOVCAxXHJcblx0XHRcdFx0Ly8gQ2FsbGVkIG9uIHBhZ2UgbG9hZFxyXG5cdFx0XHRcdCQuZ2V0KG9wdHMuY29udGV4dFBhdGggKyAnL3Jlc3QvdHJlZWZpbHRlci8xLjAvZ2V0Y2hpbGRyZW5yZWN1cnNpdmUnLCB7XHJcblx0XHRcdFx0XHQnc3BhY2VJZCc6IGNvbmZsdWVuY2VTcGFjZVJvb3RJZCxcclxuXHRcdFx0XHRcdCdwYXJlbnQnOiBwYXJlbnRMaW5rIHx8ICRwYXJlbnRMaS5maW5kKCc+IGEnKS50ZXh0KCksXHJcblx0XHRcdFx0XHQnY3VycmVudCc6IGN1cnJlbnRUaXRsZSB8fCAnJyxcclxuXHRcdFx0XHRcdCdsYWJlbCc6IGxhYmVsLFxyXG5cdFx0XHRcdFx0J2lzTGF0ZXN0JzpcdChDT05GSUcuQ09ORkxVRU5DRV9TUEFDRV9LRVkgPT09IENPTkZJRy5ET0NfUk9PVF9VUkxfU1BBQ0VfS0VZKVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQuZG9uZShmdW5jdGlvbiBzdWNjZXNzKGNoaWxkcmVuKSB7XHJcblx0XHRcdFx0XHRcdGluc2VydENoaWxkcmVuKCR1bCwgY2hpbGRyZW4pO1xyXG5cdCBcclxuXHRcdFx0XHRcdFx0JHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmxvYWRpbmcpXHJcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKG9wdHMuY3NzLmV4cGFuZGVkKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQuZmFpbChmdW5jdGlvbiBlcnJvcihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHtcclxuXHRcdFx0XHRcdFx0JHBhcmVudExpLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmxvYWRpbmcpXHJcblx0XHRcdFx0XHRcdFx0LmFkZENsYXNzKG9wdHMuY3NzLmVycm9yKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0O1xyXG5cdFx0XHR9XHJcbiAgICAgICAgfVxyXG4gXHJcbiAgICAgICAgLy8gQ1VTVE9NXHJcbiAgICAgICAgZnVuY3Rpb24gbG9hZENoaWxkcmVuT3V0c2lkZU9yaWdpbmFsUGF0aCgkdWwsIHBhcmVudFRpdGxlLCBjdXJyZW50VGl0bGUpIHtcclxuICAgICAgICAgICAgdmFyICRwYXJlbnRMaSA9ICR1bC5jbG9zZXN0KCdsaScpO1xyXG4gICAgICAgICAgICBpZiAoJHBhcmVudExpKSB7XHJcbiAgICAgICAgICAgICAgICAkcGFyZW50TGkucmVtb3ZlQ2xhc3Mob3B0cy5jc3MuY29sbGFwc2VkKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhvcHRzLmNzcy5sb2FkaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBcdC8vIENVU1RPTSBFTkRQT0lOVCAyIC0gY2FsbGVkIHdoZW4gb3BlbmluZyBzdWJ0cmVlcyBvdXRzaWRlIHRoZSBvcmlnaW5hbCBwYWdlIGxvYWQgcmVxdWVzdFxyXG4gICAgICAgICAgICAvLyB1c2VzIERPTSB0byBwZXJzaXN0IGFscmVhZHkgbG9hZGVkIHBhZ2UgbGlua3MgdG8gYXZvaWQgcmVwZWF0ZWQgdXNlIG9mIHJlY3Vyc2lvblxyXG4gICAgICAgICAgICAkLmdldChvcHRzLmNvbnRleHRQYXRoICsgJy9yZXN0L3RyZWVmaWx0ZXIvMS4wL2dldGNoaWxkcmVuJywge1xyXG4gICAgICAgICAgICAgICAgJ3NwYWNlSWQnOiBjb25mbHVlbmNlU3BhY2VSb290SWQsXHJcbiAgICAgICAgICAgICAgICAncGFyZW50JzogcGFyZW50VGl0bGUgfHwgJHBhcmVudExpLmZpbmQoJz4gYScpLnRleHQoKSxcclxuICAgICAgICAgICAgICBcdCdwYXJlbnRMaW5rJzogICRwYXJlbnRMaS5maW5kKCc+IGEnKS5hdHRyKCdocmVmJyksXHJcbiAgICAgICAgICAgICAgICAnbGFiZWwnOiBsYWJlbFx0XHRcdFx0XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbiBzdWNjZXNzKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0Q2hpbGRyZW4oJHVsLCBjaGlsZHJlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRwYXJlbnRMaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5sb2FkaW5nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3Mob3B0cy5jc3MuZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uIGVycm9yKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAgICAgICAgICRwYXJlbnRMaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5sb2FkaW5nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3Mob3B0cy5jc3MuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgO1xyXG4gICAgICAgIH1cclxuICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gaW5zZXJ0Q2hpbGRyZW4oJHVsLCBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICAkdWwuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgICQuZWFjaChjaGlsZHJlbiwgZnVuY3Rpb24gKGlkeCwgY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciAkY2hpbGRMaSA9ICQob3B0cy5yZW5kZXJDaGlsZExpKGNoaWxkLCBvcHRzKSkuYXBwZW5kVG8oJHVsKTtcclxuIFxyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY2hpbGRMaS5hZGRDbGFzcyhvcHRzLmNzcy5leHBhbmRlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkY2hpbGRyZW5FbCA9ICQob3B0cy5yZW5kZXJDaGlsZHJlblVsKCkpLmFwcGVuZFRvKCRjaGlsZExpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0Q2hpbGRyZW4oJGNoaWxkcmVuRWwsIGNoaWxkLmNoaWxkcmVuKTtcclxuIFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjaGlsZExpLmFkZENsYXNzKG9wdHMuY3NzLmNvbGxhcHNlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkY2hpbGRMaS5hZGRDbGFzcyhvcHRzLmNzcy5sZWFmKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gXHJcbiBcclxuICAgICAgICBmdW5jdGlvbiBzZXR1cEV2ZW50SGFuZGxpbmcoJHJvb3RVbCkge1xyXG4gICAgICAgICAgICAkcm9vdFVsLm9uKCdjbGljaycsICcuc3AtdG9nZ2xlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyICRsaSA9ICQodGhpcykucGFyZW50KCdsaScpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRsaS5pcygnLicgKyBvcHRzLmNzcy5jb2xsYXBzZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3Blbk5vZGUoJGxpKTtcclxuIFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkbGkuaXMoJy4nICsgb3B0cy5jc3MuZXhwYW5kZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VOb2RlKCRsaSk7XHJcbiBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgZG9uJ3QgaGF2ZSBjaGlsZHJlbiAtPiBuby1vcFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiBcclxuIFxyXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5Ob2RlKCRsaSkge1xyXG4gICAgICAgICAgICBpZiAoJGxpLmhhcygndWwnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNoaWxkcmVuIGhhdmUgYmVlbiBsb2FkZWQsIGp1c3QgdG9nZ2xlIGNsYXNzZXNcclxuICAgICAgICAgICAgICAgICRsaS5yZW1vdmVDbGFzcyhvcHRzLmNzcy5jb2xsYXBzZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKG9wdHMuY3NzLmV4cGFuZGVkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGNoaWxkcmVuIGhhdmUgdG8gYmUgbG9hZGVkXHJcbiAgICAgICAgICAgICAgICB2YXIgJGNoaWxkcmVuRWwgPSAkKG9wdHMucmVuZGVyQ2hpbGRyZW5VbCgpKS5hcHBlbmRUbygkbGkpO1xyXG5cdFx0XHRcdGlmICghZGV2TW9kZWxTd2l0Y2hlclN1cHBvcnRlZCkge1xyXG5cdFx0XHRcdFx0bG9hZENoaWxkcmVuKCRjaGlsZHJlbkVsKTsgLy8gT1JJR0lOQUxcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRsb2FkQ2hpbGRyZW5PdXRzaWRlT3JpZ2luYWxQYXRoKCRjaGlsZHJlbkVsKTsgLy8gQ1VTVE9NXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcbiAgICAgICAgfVxyXG4gXHJcbiBcclxuICAgICAgICBmdW5jdGlvbiBjbG9zZU5vZGUoJGxpKSB7XHJcbiAgICAgICAgICAgICRsaVxyXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKG9wdHMuY3NzLmV4cGFuZGVkKVxyXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKG9wdHMuY3NzLmNvbGxhcHNlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuIFxyXG59KSgkKTsiXX0=
