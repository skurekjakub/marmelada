function _typeof2(t){return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof2(t)}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)},_typeof(t)}$(document).ready((function(){$(".ht-content img").each((function(){var t=$(this),i=$(this).attr("alt");t.title||("undefined"==_typeof(i)||0==i?t.attr("title",""):t.attr("title",t.attr("alt"))),$(t).wrap('<a data-lightbox="imageset" data-title="'+$(t).attr("title")+'" href="'+$(t).attr("src")+'"></a>')}))})),
/*!
 * Lightbox v2.8.2
 * by Lokesh Dhakar
 *
 * More info:
 * http://lokeshdhakar.com/projects/lightbox2/
 *
 * Copyright 2007, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://github.com/lokesh/lightbox2/blob/master/LICENSE
 */
function(t,i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=i(require("jquery")):t.lightbox=i(t.jQuery)}(this,(function(t){function i(i){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=t.extend({},this.constructor.defaults),this.option(i)}return i.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:250,fitImagesInViewport:!0,positionFromTop:50,resizeDuration:250,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1},i.prototype.option=function(i){t.extend(this.options,i)},i.prototype.imageCountLabel=function(t,i){return this.options.albumLabel.replace(/%1/g,t).replace(/%2/g,i)},i.prototype.init=function(){this.enable(),this.build()},i.prototype.enable=function(){var i=this;t("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",(function(e){return i.start(t(e.currentTarget)),!1}))},i.prototype.build=function(){var i=this;t('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(t("body")),this.$lightbox=t("#lightbox"),this.$overlay=t("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",(function(){return i.end(),!1})),this.$lightbox.hide().on("click",(function(e){return"lightbox"===t(e.target).attr("id")&&i.end(),!1})),this.$outerContainer.on("click",(function(e){return"lightbox"===t(e.target).attr("id")&&i.end(),!1})),this.$lightbox.find(".lb-prev").on("click",(function(){return 0===i.currentImageIndex?i.changeImage(i.album.length-1):i.changeImage(i.currentImageIndex-1),!1})),this.$lightbox.find(".lb-next").on("click",(function(){return i.currentImageIndex===i.album.length-1?i.changeImage(0):i.changeImage(i.currentImageIndex+1),!1})),this.$lightbox.find(".lb-loader, .lb-close").on("click",(function(){return i.end(),!1}))},i.prototype.start=function(i){var e=this,n=t(window);n.on("resize",t.proxy(this.sizeOverlay,this)),t("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var o=0;function a(t){e.album.push({link:t.attr("href"),title:t.attr("data-title")||t.attr("title")})}"undefined"!=i.attr("data-title")&&"undefined"!=i.attr("title")||i.attr("data-title"," ");var r,s=i.attr("data-lightbox");if(s){r=t(i.prop("tagName")+'[data-lightbox="'+s+'"]');for(var h=0;h<r.length;h=++h)a(t(r[h])),r[h]===i[0]&&(o=h)}else if("lightbox"===i.attr("rel"))a(i);else{r=t(i.prop("tagName")+'[rel="'+i.attr("rel")+'"]');for(var l=0;l<r.length;l=++l)a(t(r[l])),r[l]===i[0]&&(o=l)}var d=n.scrollTop()+this.options.positionFromTop,c=n.scrollLeft();this.$lightbox.css({top:d+"px",left:c+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&t("body").addClass("lb-disable-scrolling"),this.changeImage(o)},i.prototype.changeImage=function(i){var e=this;this.disableKeyboardNav();var n=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),t(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var o=new Image;o.onload=function(){var a,r,s,h,l,d;n.attr("src",e.album[i].link),t(o),n.width(o.width),n.height(o.height),e.options.fitImagesInViewport&&(d=t(window).width(),l=t(window).height(),h=d-e.containerLeftPadding-e.containerRightPadding-20,s=l-e.containerTopPadding-e.containerBottomPadding-120,e.options.maxWidth&&e.options.maxWidth<h&&(h=e.options.maxWidth),e.options.maxHeight&&e.options.maxHeight<h&&(s=e.options.maxHeight),(o.width>h||o.height>s)&&(o.width/h>o.height/s?(r=h,a=parseInt(o.height/(o.width/r),10),n.width(r),n.height(a)):(a=s,r=parseInt(o.width/(o.height/a),10),n.width(r),n.height(a)))),e.sizeContainer(n.width(),n.height())},o.src=this.album[i].link,this.currentImageIndex=i},i.prototype.sizeOverlay=function(){this.$overlay.width(t(document).width()).height(t(document).height())},i.prototype.sizeContainer=function(t,i){var e=this,n=this.$outerContainer.outerWidth(),o=this.$outerContainer.outerHeight(),a=t+this.containerLeftPadding+this.containerRightPadding,r=i+this.containerTopPadding+this.containerBottomPadding;function s(){e.$lightbox.find(".lb-dataContainer").width(a),e.$lightbox.find(".lb-prevLink").height(r),e.$lightbox.find(".lb-nextLink").height(r),e.showImage()}n!==a||o!==r?this.$outerContainer.animate({width:a,height:r},this.options.resizeDuration,"swing",(function(){s()})):s()},i.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},i.prototype.updateNav=function(){var t=!1;try{document.createEvent("TouchEvent"),t=!!this.options.alwaysShowNavOnTouchDevices}catch(t){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(t&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),t&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),t&&this.$lightbox.find(".lb-next").css("opacity","1"))))},i.prototype.updateDetails=function(){var i=this;if(void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast").find("a").on("click",(function(i){void 0!==t(this).attr("target")?window.open(t(this).attr("href"),t(this).attr("target")):location.href=t(this).attr("href")})),this.album.length>1&&this.options.showImageNumberLabel){var e=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(e).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,(function(){return i.sizeOverlay()}))},i.prototype.preloadNeighboringImages=function(){this.album.length>this.currentImageIndex+1&&((new Image).src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&((new Image).src=this.album[this.currentImageIndex-1].link)},i.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},i.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},i.prototype.keyboardAction=function(t){var i=t.keyCode,e=String.fromCharCode(i).toLowerCase();27===i||e.match(/x|o|c/)?this.end():"p"===e||37===i?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==e&&39!==i||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},i.prototype.end=function(){this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&t("body").removeClass("lb-disable-scrolling")},new i}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRoZW1lLmxpZ2h0Ym94LmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiZWFjaCIsInQiLCJ0aGlzIiwiaSIsImF0dHIiLCJfdHlwZW9mIiwid3JhcCIsInByb3RvdHlwZSIsIm9wdGlvbnMiLCJkZWZpbmUiLCJhbGJ1bUxhYmVsIiwibW9kdWxlIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJsaWdodGJveCIsImpRdWVyeSIsImFsYnVtIiwiY3VycmVudEltYWdlSW5kZXgiLCJpbml0IiwiZXh0ZW5kIiwiY29uc3RydWN0b3IiLCJkZWZhdWx0cyIsIm9wdGlvbiIsImFsd2F5c1Nob3dOYXZPblRvdWNoRGV2aWNlcyIsImZhZGVEdXJhdGlvbiIsImZpdEltYWdlc0luVmlld3BvcnQiLCJwb3NpdGlvbkZyb21Ub3AiLCJyZXNpemVEdXJhdGlvbiIsInNob3dJbWFnZU51bWJlckxhYmVsIiwid3JhcEFyb3VuZCIsImRpc2FibGVTY3JvbGxpbmciLCJpbWFnZUNvdW50TGFiZWwiLCJwcm9wIiwicmVwbGFjZSIsImVuYWJsZSIsImJ1aWxkIiwib24iLCJlIiwiJG92ZXJsYXkiLCJ3aWR0aCIsIiRsaWdodGJveCIsImFwcGVuZFRvIiwiaGVpZ2h0IiwiJG91dGVyQ29udGFpbmVyIiwiZmluZCIsImNvbnRhaW5lclRvcFBhZGRpbmciLCJwYXJzZUludCIsIiRjb250YWluZXIiLCJjc3MiLCJjb250YWluZXJSaWdodFBhZGRpbmciLCJjb250YWluZXJCb3R0b21QYWRkaW5nIiwiY29udGFpbmVyTGVmdFBhZGRpbmciLCJoaWRlIiwiZW5kIiwidGFyZ2V0IiwiZGlzYWJsZUtleWJvYXJkTmF2IiwidmlzaWJpbGl0eSIsImNoYW5nZUltYWdlIiwibGVuZ3RoIiwic3RhcnQiLCJuIiwid2luZG93IiwicHJveHkiLCJzaXplT3ZlcmxheSIsImEiLCJvIiwicHVzaCIsImxpbmsiLCJ0aXRsZSIsInMiLCJyIiwiaCIsImwiLCJkIiwic2Nyb2xsVG9wIiwiYyIsInNjcm9sbExlZnQiLCJ0b3AiLCJsZWZ0IiwiZmFkZUluIiwiYWRkQ2xhc3MiLCJJbWFnZSIsIm9ubG9hZCIsIm1heFdpZHRoIiwibWF4SGVpZ2h0Iiwic2l6ZUNvbnRhaW5lciIsInNyYyIsIm91dGVyV2lkdGgiLCJvdXRlckhlaWdodCIsInNob3dJbWFnZSIsImFuaW1hdGUiLCJzdG9wIiwidXBkYXRlTmF2IiwidXBkYXRlRGV0YWlscyIsInByZWxvYWROZWlnaGJvcmluZ0ltYWdlcyIsImVuYWJsZUtleWJvYXJkTmF2IiwiY3JlYXRlRXZlbnQiLCJzaG93IiwiaHRtbCIsIm9wZW4iLCJsb2NhdGlvbiIsImhyZWYiLCJ0ZXh0IiwicmVtb3ZlQ2xhc3MiLCJrZXlib2FyZEFjdGlvbiIsIm9mZiIsImtleUNvZGUiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJ0b0xvd2VyQ2FzZSIsIm1hdGNoIiwiZmFkZU91dCJdLCJtYXBwaW5ncyI6IjRmQUNBQSxFQUFBQyxVQUFBQyxPQUFBLFdBQ0VGLEVBQUEsbUJBQWdCRyxNQUFBLFdBQ2IsSUFBQUMsRUFBQUosRUFBQUssTUFDT0MsRUFBS04sRUFBS0ssTUFBRUUsS0FBQSxPQUh4Qk4sRUFBQUEsUUEyQkEsYUFBQU8sUUFBQUYsSUFBQSxHQUFBQSxFQVpXRixFQUNJRyxLQUFBLFlBSVBILEVBQUFHLEtBQUEsUUFBQUgsRUFBQUcsS0FBQSxTQUlOUCxFQUFBSSxHQUFBSyxLQUFBLDJDQUFBVCxFQUFBSSxHQUFBRyxLQUFBLG9CQUFBUCxFQUFBSSxHQUFBRyxLQUFBLGdCQURBLEdBOEJEOzs7Ozs7Ozs7Ozs7QUFiQSxTQXFERUcsRUFBQUosR0FOYUssbUJBQUxDLFFBQWFDLE9BQUFBLElBV3BCRCxPQUFBLFdBQUFOLEdBRE9JLGdDQUFBQSxRQUFBQSxZQUFBQSxRQUFBQSxVQU1USSxPQUFBQyxRQUFBVCxFQUFBVSxRQUFBLFdBaERBWixFQStFSWEsU0FEQVgsRUFHRkYsRUFBQWMsT0FuRkgsQ0FiQSxDQWFDYixNQTBGRSxTQUFBRCxHQXhGRixTQStFSUUsRUFE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QixXQUN0Q3RELEVBQUVILFVBQVUyRyxJQUFJLFlBQ2xCLEVBRUF0RyxFQUFTSSxVQUFVaUcsZUFBaUIsU0FBU3ZHLEdBQzNDLElBSUlFLEVBQVVGLEVBQU15RyxRQUNoQnJFLEVBQVVzRSxPQUFPQyxhQUFhekcsR0FBUzBHLGNBTGxCLEtBTXJCMUcsR0FBMkJrQyxFQUFJeUUsTUFBTSxTQUN2QzVHLEtBQUttRCxNQUNZLE1BQVJoQixHQVBjLEtBT0NsQyxFQUNPLElBQTNCRCxLQUFLZSxrQkFDUGYsS0FBS3VELFlBQVl2RCxLQUFLZSxrQkFBb0IsR0FDakNmLEtBQUtNLFFBQVFxQixZQUFjM0IsS0FBS2MsTUFBTTBDLE9BQVMsR0FDeER4RCxLQUFLdUQsWUFBWXZELEtBQUtjLE1BQU0wQyxPQUFTLEdBRXRCLE1BQVJyQixHQVpjLEtBWUNsQyxJQUNwQkQsS0FBS2Usb0JBQXNCZixLQUFLYyxNQUFNMEMsT0FBUyxFQUNqRHhELEtBQUt1RCxZQUFZdkQsS0FBS2Usa0JBQW9CLEdBQ2pDZixLQUFLTSxRQUFRcUIsWUFBYzNCLEtBQUtjLE1BQU0wQyxPQUFTLEdBQ3hEeEQsS0FBS3VELFlBQVksR0FHdkIsRUFHQXRELEVBQVNJLFVBQVU4QyxJQUFNLFdBQ3ZCbkQsS0FBS3FELHFCQUNMdEQsRUFBRTRELFFBQVE0QyxJQUFJLFNBQVV2RyxLQUFLNkQsYUFDN0I3RCxLQUFLc0MsVUFBVXVFLFFBQVE3RyxLQUFLTSxRQUFRZ0IsY0FDcEN0QixLQUFLb0MsU0FBU3lFLFFBQVE3RyxLQUFLTSxRQUFRZ0IsY0FDbkN2QixFQUFFLHlCQUF5QitDLElBQUksQ0FDN0JRLFdBQVksWUFFVnRELEtBQUtNLFFBQVFzQixrQkFDZjdCLEVBQUUsUUFBUXNHLFlBQVksdUJBRTFCLEVBRU8sSUFBSXBHLENBQ2IiLCJmaWxlIjoidGhlbWUubGlnaHRib3guanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IENVU1RPTSBJTUFHRSBXUkFQUEVSID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFdyYXBzIGltZyBlbGVtZW50cyBpbiBhbiA8YT4gd2l0aCBkYXRhLWxpZ2h0Ym94IGFuZCBkYXRhLXRpdGxlIHByb3BlcnRpZXMgbmVjZXNzYXJ5IHRvIGVuYWJsZSBMaWdodGJveCBhbmQgZ3JvdXAgdGhlIGltYWdlcyB0byBhIGdhbGxlcnlcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICBcdCQoJy5odC1jb250ZW50IGltZycpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgXHR2YXIgaW1nID0gJCh0aGlzKTsgLy8gY2FjaGUgcXVlcnlcbiAgICAgICAgdmFyIGF0dHIgPSAkKHRoaXMpLmF0dHIoJ2FsdCcpO1xuICAgIFxuICAgIFx0Ly8gQ3JlYXRlcyB0aGUgdGl0bGUgYXR0cmlidXRlIGZvciBhbiBpbWFnZSBvbiB0aGUgcGFnZVxuICAgIFx0Ly8gSWYgdGhlIHRpdGxlIGF0dHJpYnV0ZSBleGlzdHMsIGRvIG5vdGhpbmdcbiAgICAgICAgaWYgKGltZy50aXRsZSkgeyAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsgICAgICAgICAgXG4gICAgICAgICAgLy8gQ2hlY2tzIHdoZXRoZXIgdGhlIGFsdCBhdHRyaWJ1dGUgZXhpc3RzLCBhY3RzIGFjY29yZGluZ2x5IGJ5IGdpdmluZyB0aGUgdGl0bGUgYXR0cmlidXRlIHJlbGV2YW50IHZhbHVlc1xuICAgICAgICAgIGlmICh0eXBlb2YgYXR0ciA9PSB0eXBlb2YgdW5kZWZpbmVkIHx8IGF0dHIgPT0gZmFsc2UpIHtcbiAgICAgICAgICBcdC8vIE5vIGFsdCBmb3VuZCwgc2V0IHRpdGxlIGF0dHJpYnV0ZSBibGFua1xuICAgICAgICAgICAgaW1nLmF0dHIoJ3RpdGxlJywgXCJcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gQWx0IGF0dHJpYnV0ZSBleGlzdHMsIHVzZSBpdCBhcyB0aGUgdGl0bGUgYXR0cmlidXRlXG4gICAgICAgICAgICBpbWcuYXR0cigndGl0bGUnLCBpbWcuYXR0cignYWx0JykpOyBcbiAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgLy8gV3JhcHMgdGhlIGlhbWdlIGluIGEgaHlwZXJsaW5rIHdpdGggYXR0cmlidXRlcyBuZWNlc3NhcnkgZm9yIGxpZ2h0Ym94MiB0byBmdW5jdGlvblxuICAkKCBpbWcgKS53cmFwKCAnPGEgZGF0YS1saWdodGJveD1cImltYWdlc2V0XCIgZGF0YS10aXRsZT1cIicgKyAkKCBpbWcgKS5hdHRyKCAndGl0bGUnICkgKyAnXCIgaHJlZj1cIicgKyQoIGltZyApLmF0dHIoICdzcmMnICkrICdcIj48L2E+JyApO1xuICB9KTtcbn0pO1xuXG5cbi8qIVxuICogTGlnaHRib3ggdjIuOC4yXG4gKiBieSBMb2tlc2ggRGhha2FyXG4gKlxuICogTW9yZSBpbmZvOlxuICogaHR0cDovL2xva2VzaGRoYWthci5jb20vcHJvamVjdHMvbGlnaHRib3gyL1xuICpcbiAqIENvcHlyaWdodCAyMDA3LCAyMDE1IExva2VzaCBEaGFrYXJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogaHR0cHM6Ly9naXRodWIuY29tL2xva2VzaC9saWdodGJveDIvYmxvYi9tYXN0ZXIvTElDRU5TRVxuICovXG5cbi8vIFVzZXMgTm9kZSwgQU1EIG9yIGJyb3dzZXIgZ2xvYmFscyB0byBjcmVhdGUgYSBtb2R1bGUuXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICAgICAgZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgICAgICAvLyBvbmx5IENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cyxcbiAgICAgICAgLy8gbGlrZSBOb2RlLlxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnanF1ZXJ5JykpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXG4gICAgICAgIHJvb3QubGlnaHRib3ggPSBmYWN0b3J5KHJvb3QualF1ZXJ5KTtcbiAgICB9XG59KHRoaXMsIGZ1bmN0aW9uICgkKSB7XG5cbiAgZnVuY3Rpb24gTGlnaHRib3gob3B0aW9ucykge1xuICAgIHRoaXMuYWxidW0gPSBbXTtcbiAgICB0aGlzLmN1cnJlbnRJbWFnZUluZGV4ID0gdm9pZCAwO1xuICAgIHRoaXMuaW5pdCgpO1xuXG4gICAgLy8gb3B0aW9uc1xuICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRzKTtcbiAgICB0aGlzLm9wdGlvbihvcHRpb25zKTtcbiAgfVxuXG4gIC8vIERlc2NyaXB0aW9ucyBvZiBhbGwgb3B0aW9ucyBhdmFpbGFibGUgb24gdGhlIGRlbW8gc2l0ZTpcbiAgLy8gaHR0cDovL2xva2VzaGRoYWthci5jb20vcHJvamVjdHMvbGlnaHRib3gyL2luZGV4Lmh0bWwjb3B0aW9uc1xuICBMaWdodGJveC5kZWZhdWx0cyA9IHtcbiAgICBhbGJ1bUxhYmVsOiAnSW1hZ2UgJTEgb2YgJTInLFxuICAgIGFsd2F5c1Nob3dOYXZPblRvdWNoRGV2aWNlczogZmFsc2UsXG4gICAgZmFkZUR1cmF0aW9uOiAyNTAsXG4gICAgZml0SW1hZ2VzSW5WaWV3cG9ydDogdHJ1ZSxcbiAgICAvLyBtYXhXaWR0aDogODAwLFxuICAgIC8vIG1heEhlaWdodDogNjAwLFxuICAgIHBvc2l0aW9uRnJvbVRvcDogNTAsXG4gICAgLy8gcmVzaXplRHVyYXRpb246IDcwMCxcbiAgICByZXNpemVEdXJhdGlvbjogMjUwLFxuICAgIHNob3dJbWFnZU51bWJlckxhYmVsOiB0cnVlLFxuICAgIHdyYXBBcm91bmQ6IGZhbHNlLFxuICAgIGRpc2FibGVTY3JvbGxpbmc6IGZhbHNlXG4gIH07XG5cbiAgTGlnaHRib3gucHJvdG90eXBlLm9wdGlvbiA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAkLmV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuICB9O1xuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5pbWFnZUNvdW50TGFiZWwgPSBmdW5jdGlvbihjdXJyZW50SW1hZ2VOdW0sIHRvdGFsSW1hZ2VzKSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5hbGJ1bUxhYmVsLnJlcGxhY2UoLyUxL2csIGN1cnJlbnRJbWFnZU51bSkucmVwbGFjZSgvJTIvZywgdG90YWxJbWFnZXMpO1xuICB9O1xuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5lbmFibGUoKTtcbiAgICB0aGlzLmJ1aWxkKCk7XG4gIH07XG5cbiAgLy8gTG9vcCB0aHJvdWdoIGFuY2hvcnMgYW5kIGFyZWFtYXBzIGxvb2tpbmcgZm9yIGVpdGhlciBkYXRhLWxpZ2h0Ym94IGF0dHJpYnV0ZXMgb3IgcmVsIGF0dHJpYnV0ZXNcbiAgLy8gdGhhdCBjb250YWluICdsaWdodGJveCcuIFdoZW4gdGhlc2UgYXJlIGNsaWNrZWQsIHN0YXJ0IGxpZ2h0Ym94LlxuICBMaWdodGJveC5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnYVtyZWxePWxpZ2h0Ym94XSwgYXJlYVtyZWxePWxpZ2h0Ym94XSwgYVtkYXRhLWxpZ2h0Ym94XSwgYXJlYVtkYXRhLWxpZ2h0Ym94XScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBzZWxmLnN0YXJ0KCQoZXZlbnQuY3VycmVudFRhcmdldCkpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIEJ1aWxkIGh0bWwgZm9yIHRoZSBsaWdodGJveCBhbmQgdGhlIG92ZXJsYXkuXG4gIC8vIEF0dGFjaCBldmVudCBoYW5kbGVycyB0byB0aGUgbmV3IERPTSBlbGVtZW50cy4gY2xpY2sgY2xpY2sgY2xpY2tcbiAgTGlnaHRib3gucHJvdG90eXBlLmJ1aWxkID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICQoJzxkaXYgaWQ9XCJsaWdodGJveE92ZXJsYXlcIiBjbGFzcz1cImxpZ2h0Ym94T3ZlcmxheVwiPjwvZGl2PjxkaXYgaWQ9XCJsaWdodGJveFwiIGNsYXNzPVwibGlnaHRib3hcIj48ZGl2IGNsYXNzPVwibGItb3V0ZXJDb250YWluZXJcIj48ZGl2IGNsYXNzPVwibGItY29udGFpbmVyXCI+PGltZyBjbGFzcz1cImxiLWltYWdlXCIgc3JjPVwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFJQUFBUC8vL3dBQUFDSDVCQUVBQUFBQUxBQUFBQUFCQUFFQUFBSUNSQUVBT3c9PVwiIC8+PGRpdiBjbGFzcz1cImxiLW5hdlwiPjxhIGNsYXNzPVwibGItcHJldlwiIGhyZWY9XCJcIiA+PC9hPjxhIGNsYXNzPVwibGItbmV4dFwiIGhyZWY9XCJcIiA+PC9hPjwvZGl2PjxkaXYgY2xhc3M9XCJsYi1sb2FkZXJcIj48YSBjbGFzcz1cImxiLWNhbmNlbFwiPjwvYT48L2Rpdj48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwibGItZGF0YUNvbnRhaW5lclwiPjxkaXYgY2xhc3M9XCJsYi1kYXRhXCI+PGRpdiBjbGFzcz1cImxiLWRldGFpbHNcIj48c3BhbiBjbGFzcz1cImxiLWNhcHRpb25cIj48L3NwYW4+PHNwYW4gY2xhc3M9XCJsYi1udW1iZXJcIj48L3NwYW4+PC9kaXY+PGRpdiBjbGFzcz1cImxiLWNsb3NlQ29udGFpbmVyXCI+PGEgY2xhc3M9XCJsYi1jbG9zZVwiPjwvYT48L2Rpdj48L2Rpdj48L2Rpdj48L2Rpdj4nKS5hcHBlbmRUbygkKCdib2R5JykpO1xuXG4gICAgLy8gQ2FjaGUgalF1ZXJ5IG9iamVjdHNcbiAgICB0aGlzLiRsaWdodGJveCAgICAgICA9ICQoJyNsaWdodGJveCcpO1xuICAgIHRoaXMuJG92ZXJsYXkgICAgICAgID0gJCgnI2xpZ2h0Ym94T3ZlcmxheScpO1xuICAgIHRoaXMuJG91dGVyQ29udGFpbmVyID0gdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLW91dGVyQ29udGFpbmVyJyk7XG4gICAgdGhpcy4kY29udGFpbmVyICAgICAgPSB0aGlzLiRsaWdodGJveC5maW5kKCcubGItY29udGFpbmVyJyk7XG5cbiAgICAvLyBTdG9yZSBjc3MgdmFsdWVzIGZvciBmdXR1cmUgbG9va3VwXG4gICAgdGhpcy5jb250YWluZXJUb3BQYWRkaW5nID0gcGFyc2VJbnQodGhpcy4kY29udGFpbmVyLmNzcygncGFkZGluZy10b3AnKSwgMTApO1xuICAgIHRoaXMuY29udGFpbmVyUmlnaHRQYWRkaW5nID0gcGFyc2VJbnQodGhpcy4kY29udGFpbmVyLmNzcygncGFkZGluZy1yaWdodCcpLCAxMCk7XG4gICAgdGhpcy5jb250YWluZXJCb3R0b21QYWRkaW5nID0gcGFyc2VJbnQodGhpcy4kY29udGFpbmVyLmNzcygncGFkZGluZy1ib3R0b20nKSwgMTApO1xuICAgIHRoaXMuY29udGFpbmVyTGVmdFBhZGRpbmcgPSBwYXJzZUludCh0aGlzLiRjb250YWluZXIuY3NzKCdwYWRkaW5nLWxlZnQnKSwgMTApO1xuXG4gICAgLy8gQXR0YWNoIGV2ZW50IGhhbmRsZXJzIHRvIHRoZSBuZXdseSBtaW50ZWQgRE9NIGVsZW1lbnRzXG4gICAgdGhpcy4kb3ZlcmxheS5oaWRlKCkub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICBzZWxmLmVuZCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgdGhpcy4kbGlnaHRib3guaGlkZSgpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoJChldmVudC50YXJnZXQpLmF0dHIoJ2lkJykgPT09ICdsaWdodGJveCcpIHtcbiAgICAgICAgc2VsZi5lbmQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIHRoaXMuJG91dGVyQ29udGFpbmVyLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoJChldmVudC50YXJnZXQpLmF0dHIoJ2lkJykgPT09ICdsaWdodGJveCcpIHtcbiAgICAgICAgc2VsZi5lbmQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1wcmV2Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoc2VsZi5jdXJyZW50SW1hZ2VJbmRleCA9PT0gMCkge1xuICAgICAgICBzZWxmLmNoYW5nZUltYWdlKHNlbGYuYWxidW0ubGVuZ3RoIC0gMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLmNoYW5nZUltYWdlKHNlbGYuY3VycmVudEltYWdlSW5kZXggLSAxKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1uZXh0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoc2VsZi5jdXJyZW50SW1hZ2VJbmRleCA9PT0gc2VsZi5hbGJ1bS5sZW5ndGggLSAxKSB7XG4gICAgICAgIHNlbGYuY2hhbmdlSW1hZ2UoMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLmNoYW5nZUltYWdlKHNlbGYuY3VycmVudEltYWdlSW5kZXggKyAxKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1sb2FkZXIsIC5sYi1jbG9zZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5lbmQoKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBTaG93IG92ZXJsYXkgYW5kIGxpZ2h0Ym94LiBJZiB0aGUgaW1hZ2UgaXMgcGFydCBvZiBhIHNldCwgYWRkIHNpYmxpbmdzIHRvIGFsYnVtIGFycmF5LlxuICBMaWdodGJveC5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigkbGluaykge1xuICAgIHZhciBzZWxmICAgID0gdGhpcztcbiAgICB2YXIgJHdpbmRvdyA9ICQod2luZG93KTtcblxuICAgICR3aW5kb3cub24oJ3Jlc2l6ZScsICQucHJveHkodGhpcy5zaXplT3ZlcmxheSwgdGhpcykpO1xuXG4gICAgJCgnc2VsZWN0LCBvYmplY3QsIGVtYmVkJykuY3NzKHtcbiAgICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nXG4gICAgfSk7XG5cbiAgICB0aGlzLnNpemVPdmVybGF5KCk7XG5cbiAgICB0aGlzLmFsYnVtID0gW107XG4gICAgdmFyIGltYWdlTnVtYmVyID0gMDtcbiAgICBcbiAgICAvL0NVU1RPTSAtIElmIHRoZSBpbWFnZSBpcyBtaXNzaW5nIHRoZSB0aXRsZSBhdHRyaWJ1dGUsIHRoZSBkYXRhLXRpdGxlIGF0dHJpYnV0ZSBpcyBcbiAgICAvL25vIGxvbmdlciBhcHBlbmRlZCB0byB0aGUgbGlnaHRib3ggZWxlbWVudC4gVGhpcyBwcmV2ZW50cyB0aGUgXCJ1bmRlZmluZWRcIiBpbWFnZSBkZXNjcmlwdGlvbiBmcm9tIGJlaW5nIGRpc3BsYXllZC5cbiAgICBpZigoJGxpbmsuYXR0cignZGF0YS10aXRsZScpID09IFwidW5kZWZpbmVkXCIgKSB8fCAoJGxpbmsuYXR0cigndGl0bGUnKT09IFwidW5kZWZpbmVkXCIgKSkge1x0XHRcdFx0XHRcblx0ICAgICAgICAkbGluay5hdHRyKCdkYXRhLXRpdGxlJywgXCIgXCIpO1xuXHR9XG4gICAgLy9FTkRPRkNVU1RPTVxuXG4gICAgZnVuY3Rpb24gYWRkVG9BbGJ1bSgkbGluaykge1xuICAgICAgc2VsZi5hbGJ1bS5wdXNoKHtcbiAgICAgICAgbGluazogJGxpbmsuYXR0cignaHJlZicpLFxuICAgICAgICB0aXRsZTogJGxpbmsuYXR0cignZGF0YS10aXRsZScpIHx8ICRsaW5rLmF0dHIoJ3RpdGxlJylcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFN1cHBvcnQgYm90aCBkYXRhLWxpZ2h0Ym94IGF0dHJpYnV0ZSBhbmQgcmVsIGF0dHJpYnV0ZSBpbXBsZW1lbnRhdGlvbnNcbiAgICB2YXIgZGF0YUxpZ2h0Ym94VmFsdWUgPSAkbGluay5hdHRyKCdkYXRhLWxpZ2h0Ym94Jyk7XG4gICAgdmFyICRsaW5rcztcblxuICAgIGlmIChkYXRhTGlnaHRib3hWYWx1ZSkge1xuICAgICAgJGxpbmtzID0gJCgkbGluay5wcm9wKCd0YWdOYW1lJykgKyAnW2RhdGEtbGlnaHRib3g9XCInICsgZGF0YUxpZ2h0Ym94VmFsdWUgKyAnXCJdJyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRsaW5rcy5sZW5ndGg7IGkgPSArK2kpIHtcbiAgICAgICAgYWRkVG9BbGJ1bSgkKCRsaW5rc1tpXSkpO1xuICAgICAgICBpZiAoJGxpbmtzW2ldID09PSAkbGlua1swXSkge1xuICAgICAgICAgIGltYWdlTnVtYmVyID0gaTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoJGxpbmsuYXR0cigncmVsJykgPT09ICdsaWdodGJveCcpIHtcbiAgICAgICAgLy8gSWYgaW1hZ2UgaXMgbm90IHBhcnQgb2YgYSBzZXRcbiAgICAgICAgYWRkVG9BbGJ1bSgkbGluayk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJZiBpbWFnZSBpcyBwYXJ0IG9mIGEgc2V0XG4gICAgICAgICRsaW5rcyA9ICQoJGxpbmsucHJvcCgndGFnTmFtZScpICsgJ1tyZWw9XCInICsgJGxpbmsuYXR0cigncmVsJykgKyAnXCJdJyk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgJGxpbmtzLmxlbmd0aDsgaiA9ICsraikge1xuICAgICAgICAgIGFkZFRvQWxidW0oJCgkbGlua3Nbal0pKTtcbiAgICAgICAgICBpZiAoJGxpbmtzW2pdID09PSAkbGlua1swXSkge1xuICAgICAgICAgICAgaW1hZ2VOdW1iZXIgPSBqO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFBvc2l0aW9uIExpZ2h0Ym94XG4gICAgdmFyIHRvcCAgPSAkd2luZG93LnNjcm9sbFRvcCgpICsgdGhpcy5vcHRpb25zLnBvc2l0aW9uRnJvbVRvcDtcbiAgICB2YXIgbGVmdCA9ICR3aW5kb3cuc2Nyb2xsTGVmdCgpO1xuICAgIHRoaXMuJGxpZ2h0Ym94LmNzcyh7XG4gICAgICB0b3A6IHRvcCArICdweCcsXG4gICAgICBsZWZ0OiBsZWZ0ICsgJ3B4J1xuICAgIH0pLmZhZGVJbih0aGlzLm9wdGlvbnMuZmFkZUR1cmF0aW9uKTtcblxuICAgIC8vIERpc2FibGUgc2Nyb2xsaW5nIG9mIHRoZSBwYWdlIHdoaWxlIG9wZW5cbiAgICBpZiAodGhpcy5vcHRpb25zLmRpc2FibGVTY3JvbGxpbmcpIHtcbiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnbGItZGlzYWJsZS1zY3JvbGxpbmcnKTtcbiAgICB9XG5cbiAgICB0aGlzLmNoYW5nZUltYWdlKGltYWdlTnVtYmVyKTtcbiAgfTtcblxuICAvLyBIaWRlIG1vc3QgVUkgZWxlbWVudHMgaW4gcHJlcGFyYXRpb24gZm9yIHRoZSBhbmltYXRlZCByZXNpemluZyBvZiB0aGUgbGlnaHRib3guXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5jaGFuZ2VJbWFnZSA9IGZ1bmN0aW9uKGltYWdlTnVtYmVyKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5kaXNhYmxlS2V5Ym9hcmROYXYoKTtcbiAgICB2YXIgJGltYWdlID0gdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLWltYWdlJyk7XG5cbiAgICB0aGlzLiRvdmVybGF5LmZhZGVJbih0aGlzLm9wdGlvbnMuZmFkZUR1cmF0aW9uKTtcblxuICAgICQoJy5sYi1sb2FkZXInKS5mYWRlSW4oJ3Nsb3cnKTtcbiAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItaW1hZ2UsIC5sYi1uYXYsIC5sYi1wcmV2LCAubGItbmV4dCwgLmxiLWRhdGFDb250YWluZXIsIC5sYi1udW1iZXJzLCAubGItY2FwdGlvbicpLmhpZGUoKTtcblxuICAgIHRoaXMuJG91dGVyQ29udGFpbmVyLmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIC8vIFdoZW4gaW1hZ2UgdG8gc2hvdyBpcyBwcmVsb2FkZWQsIHdlIHNlbmQgdGhlIHdpZHRoIGFuZCBoZWlnaHQgdG8gc2l6ZUNvbnRhaW5lcigpXG4gICAgdmFyIHByZWxvYWRlciA9IG5ldyBJbWFnZSgpO1xuICAgIHByZWxvYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciAkcHJlbG9hZGVyO1xuICAgICAgdmFyIGltYWdlSGVpZ2h0O1xuICAgICAgdmFyIGltYWdlV2lkdGg7XG4gICAgICB2YXIgbWF4SW1hZ2VIZWlnaHQ7XG4gICAgICB2YXIgbWF4SW1hZ2VXaWR0aDtcbiAgICAgIHZhciB3aW5kb3dIZWlnaHQ7XG4gICAgICB2YXIgd2luZG93V2lkdGg7XG5cbiAgICAgICRpbWFnZS5hdHRyKCdzcmMnLCBzZWxmLmFsYnVtW2ltYWdlTnVtYmVyXS5saW5rKTtcblxuICAgICAgJHByZWxvYWRlciA9ICQocHJlbG9hZGVyKTtcblxuICAgICAgJGltYWdlLndpZHRoKHByZWxvYWRlci53aWR0aCk7XG4gICAgICAkaW1hZ2UuaGVpZ2h0KHByZWxvYWRlci5oZWlnaHQpO1xuXG4gICAgICBpZiAoc2VsZi5vcHRpb25zLmZpdEltYWdlc0luVmlld3BvcnQpIHtcbiAgICAgICAgLy8gRml0IGltYWdlIGluc2lkZSB0aGUgdmlld3BvcnQuXG4gICAgICAgIC8vIFRha2UgaW50byBhY2NvdW50IHRoZSBib3JkZXIgYXJvdW5kIHRoZSBpbWFnZSBhbmQgYW4gYWRkaXRpb25hbCAxMHB4IGd1dHRlciBvbiBlYWNoIHNpZGUuXG5cbiAgICAgICAgd2luZG93V2lkdGggICAgPSAkKHdpbmRvdykud2lkdGgoKTtcbiAgICAgICAgd2luZG93SGVpZ2h0ICAgPSAkKHdpbmRvdykuaGVpZ2h0KCk7XG4gICAgICAgIG1heEltYWdlV2lkdGggID0gd2luZG93V2lkdGggLSBzZWxmLmNvbnRhaW5lckxlZnRQYWRkaW5nIC0gc2VsZi5jb250YWluZXJSaWdodFBhZGRpbmcgLSAyMDtcbiAgICAgICAgbWF4SW1hZ2VIZWlnaHQgPSB3aW5kb3dIZWlnaHQgLSBzZWxmLmNvbnRhaW5lclRvcFBhZGRpbmcgLSBzZWxmLmNvbnRhaW5lckJvdHRvbVBhZGRpbmcgLSAxMjA7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgaW1hZ2Ugc2l6ZSBpcyBsYXJnZXIgdGhlbiBtYXhXaWR0aHxtYXhIZWlnaHQgaW4gc2V0dGluZ3NcbiAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5tYXhXaWR0aCAmJiBzZWxmLm9wdGlvbnMubWF4V2lkdGggPCBtYXhJbWFnZVdpZHRoKSB7XG4gICAgICAgICAgbWF4SW1hZ2VXaWR0aCA9IHNlbGYub3B0aW9ucy5tYXhXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5vcHRpb25zLm1heEhlaWdodCAmJiBzZWxmLm9wdGlvbnMubWF4SGVpZ2h0IDwgbWF4SW1hZ2VXaWR0aCkge1xuICAgICAgICAgIG1heEltYWdlSGVpZ2h0ID0gc2VsZi5vcHRpb25zLm1heEhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElzIHRoZXJlIGEgZml0dGluZyBpc3N1ZT9cbiAgICAgICAgaWYgKChwcmVsb2FkZXIud2lkdGggPiBtYXhJbWFnZVdpZHRoKSB8fCAocHJlbG9hZGVyLmhlaWdodCA+IG1heEltYWdlSGVpZ2h0KSkge1xuICAgICAgICAgIGlmICgocHJlbG9hZGVyLndpZHRoIC8gbWF4SW1hZ2VXaWR0aCkgPiAocHJlbG9hZGVyLmhlaWdodCAvIG1heEltYWdlSGVpZ2h0KSkge1xuICAgICAgICAgICAgaW1hZ2VXaWR0aCAgPSBtYXhJbWFnZVdpZHRoO1xuICAgICAgICAgICAgaW1hZ2VIZWlnaHQgPSBwYXJzZUludChwcmVsb2FkZXIuaGVpZ2h0IC8gKHByZWxvYWRlci53aWR0aCAvIGltYWdlV2lkdGgpLCAxMCk7XG4gICAgICAgICAgICAkaW1hZ2Uud2lkdGgoaW1hZ2VXaWR0aCk7XG4gICAgICAgICAgICAkaW1hZ2UuaGVpZ2h0KGltYWdlSGVpZ2h0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW1hZ2VIZWlnaHQgPSBtYXhJbWFnZUhlaWdodDtcbiAgICAgICAgICAgIGltYWdlV2lkdGggPSBwYXJzZUludChwcmVsb2FkZXIud2lkdGggLyAocHJlbG9hZGVyLmhlaWdodCAvIGltYWdlSGVpZ2h0KSwgMTApO1xuICAgICAgICAgICAgJGltYWdlLndpZHRoKGltYWdlV2lkdGgpO1xuICAgICAgICAgICAgJGltYWdlLmhlaWdodChpbWFnZUhlaWdodCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzZWxmLnNpemVDb250YWluZXIoJGltYWdlLndpZHRoKCksICRpbWFnZS5oZWlnaHQoKSk7XG4gICAgfTtcblxuICAgIHByZWxvYWRlci5zcmMgICAgICAgICAgPSB0aGlzLmFsYnVtW2ltYWdlTnVtYmVyXS5saW5rO1xuICAgIHRoaXMuY3VycmVudEltYWdlSW5kZXggPSBpbWFnZU51bWJlcjtcbiAgfTtcblxuICAvLyBTdHJldGNoIG92ZXJsYXkgdG8gZml0IHRoZSB2aWV3cG9ydFxuICBMaWdodGJveC5wcm90b3R5cGUuc2l6ZU92ZXJsYXkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLiRvdmVybGF5XG4gICAgICAud2lkdGgoJChkb2N1bWVudCkud2lkdGgoKSlcbiAgICAgIC5oZWlnaHQoJChkb2N1bWVudCkuaGVpZ2h0KCkpO1xuICB9O1xuXG4gIC8vIEFuaW1hdGUgdGhlIHNpemUgb2YgdGhlIGxpZ2h0Ym94IHRvIGZpdCB0aGUgaW1hZ2Ugd2UgYXJlIHNob3dpbmdcbiAgTGlnaHRib3gucHJvdG90eXBlLnNpemVDb250YWluZXIgPSBmdW5jdGlvbihpbWFnZVdpZHRoLCBpbWFnZUhlaWdodCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHZhciBvbGRXaWR0aCAgPSB0aGlzLiRvdXRlckNvbnRhaW5lci5vdXRlcldpZHRoKCk7XG4gICAgdmFyIG9sZEhlaWdodCA9IHRoaXMuJG91dGVyQ29udGFpbmVyLm91dGVySGVpZ2h0KCk7XG4gICAgdmFyIG5ld1dpZHRoICA9IGltYWdlV2lkdGggKyB0aGlzLmNvbnRhaW5lckxlZnRQYWRkaW5nICsgdGhpcy5jb250YWluZXJSaWdodFBhZGRpbmc7XG4gICAgdmFyIG5ld0hlaWdodCA9IGltYWdlSGVpZ2h0ICsgdGhpcy5jb250YWluZXJUb3BQYWRkaW5nICsgdGhpcy5jb250YWluZXJCb3R0b21QYWRkaW5nO1xuXG4gICAgZnVuY3Rpb24gcG9zdFJlc2l6ZSgpIHtcbiAgICAgIHNlbGYuJGxpZ2h0Ym94LmZpbmQoJy5sYi1kYXRhQ29udGFpbmVyJykud2lkdGgobmV3V2lkdGgpO1xuICAgICAgc2VsZi4kbGlnaHRib3guZmluZCgnLmxiLXByZXZMaW5rJykuaGVpZ2h0KG5ld0hlaWdodCk7XG4gICAgICBzZWxmLiRsaWdodGJveC5maW5kKCcubGItbmV4dExpbmsnKS5oZWlnaHQobmV3SGVpZ2h0KTtcbiAgICAgIHNlbGYuc2hvd0ltYWdlKCk7XG4gICAgfVxuXG4gICAgaWYgKG9sZFdpZHRoICE9PSBuZXdXaWR0aCB8fCBvbGRIZWlnaHQgIT09IG5ld0hlaWdodCkge1xuICAgICAgdGhpcy4kb3V0ZXJDb250YWluZXIuYW5pbWF0ZSh7XG4gICAgICAgIHdpZHRoOiBuZXdXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiBuZXdIZWlnaHRcbiAgICAgIH0sIHRoaXMub3B0aW9ucy5yZXNpemVEdXJhdGlvbiwgJ3N3aW5nJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHBvc3RSZXNpemUoKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBwb3N0UmVzaXplKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIERpc3BsYXkgdGhlIGltYWdlIGFuZCBpdHMgZGV0YWlscyBhbmQgYmVnaW4gcHJlbG9hZCBuZWlnaGJvcmluZyBpbWFnZXMuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5zaG93SW1hZ2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItbG9hZGVyJykuc3RvcCh0cnVlKS5oaWRlKCk7XG4gICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLWltYWdlJykuZmFkZUluKCdzbG93Jyk7XG5cbiAgICB0aGlzLnVwZGF0ZU5hdigpO1xuICAgIHRoaXMudXBkYXRlRGV0YWlscygpO1xuICAgIHRoaXMucHJlbG9hZE5laWdoYm9yaW5nSW1hZ2VzKCk7XG4gICAgdGhpcy5lbmFibGVLZXlib2FyZE5hdigpO1xuICB9O1xuXG4gIC8vIERpc3BsYXkgcHJldmlvdXMgYW5kIG5leHQgbmF2aWdhdGlvbiBpZiBhcHByb3ByaWF0ZS5cbiAgTGlnaHRib3gucHJvdG90eXBlLnVwZGF0ZU5hdiA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyB0b3VjaCBldmVudHMuIElmIHNvLCB3ZSB0YWtlIHRoZSBjb25zZXJ2YXRpdmUgYXBwcm9hY2hcbiAgICAvLyBhbmQgYXNzdW1lIHRoYXQgbW91c2UgaG92ZXIgZXZlbnRzIGFyZSBub3Qgc3VwcG9ydGVkIGFuZCBhbHdheXMgc2hvdyBwcmV2L25leHQgbmF2aWdhdGlvblxuICAgIC8vIGFycm93cyBpbiBpbWFnZSBzZXRzLlxuICAgIHZhciBhbHdheXNTaG93TmF2ID0gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgIGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdUb3VjaEV2ZW50Jyk7XG4gICAgICBhbHdheXNTaG93TmF2ID0gKHRoaXMub3B0aW9ucy5hbHdheXNTaG93TmF2T25Ub3VjaERldmljZXMpID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItbmF2Jykuc2hvdygpO1xuXG4gICAgaWYgKHRoaXMuYWxidW0ubGVuZ3RoID4gMSkge1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy53cmFwQXJvdW5kKSB7XG4gICAgICAgIGlmIChhbHdheXNTaG93TmF2KSB7XG4gICAgICAgICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLXByZXYsIC5sYi1uZXh0JykuY3NzKCdvcGFjaXR5JywgJzEnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItcHJldiwgLmxiLW5leHQnKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50SW1hZ2VJbmRleCA+IDApIHtcbiAgICAgICAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItcHJldicpLnNob3coKTtcbiAgICAgICAgICBpZiAoYWx3YXlzU2hvd05hdikge1xuICAgICAgICAgICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLXByZXYnKS5jc3MoJ29wYWNpdHknLCAnMScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXJyZW50SW1hZ2VJbmRleCA8IHRoaXMuYWxidW0ubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1uZXh0Jykuc2hvdygpO1xuICAgICAgICAgIGlmIChhbHdheXNTaG93TmF2KSB7XG4gICAgICAgICAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItbmV4dCcpLmNzcygnb3BhY2l0eScsICcxJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIERpc3BsYXkgY2FwdGlvbiwgaW1hZ2UgbnVtYmVyLCBhbmQgY2xvc2luZyBidXR0b24uXG4gIExpZ2h0Ym94LnByb3RvdHlwZS51cGRhdGVEZXRhaWxzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gRW5hYmxlIGFuY2hvciBjbGlja3MgaW4gdGhlIGluamVjdGVkIGNhcHRpb24gaHRtbC5cbiAgICAvLyBUaGFua3MgTmF0ZSBXcmlnaHQgZm9yIHRoZSBmaXguIEBodHRwczovL2dpdGh1Yi5jb20vTmF0ZVdyXG4gICAgaWYgKHR5cGVvZiB0aGlzLmFsYnVtW3RoaXMuY3VycmVudEltYWdlSW5kZXhdLnRpdGxlICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgdGhpcy5hbGJ1bVt0aGlzLmN1cnJlbnRJbWFnZUluZGV4XS50aXRsZSAhPT0gJycpIHtcbiAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1jYXB0aW9uJylcbiAgICAgICAgLmh0bWwodGhpcy5hbGJ1bVt0aGlzLmN1cnJlbnRJbWFnZUluZGV4XS50aXRsZSlcbiAgICAgICAgLmZhZGVJbignZmFzdCcpXG4gICAgICAgIC5maW5kKCdhJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCd0YXJnZXQnKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB3aW5kb3cub3BlbigkKHRoaXMpLmF0dHIoJ2hyZWYnKSwgJCh0aGlzKS5hdHRyKCd0YXJnZXQnKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFsYnVtLmxlbmd0aCA+IDEgJiYgdGhpcy5vcHRpb25zLnNob3dJbWFnZU51bWJlckxhYmVsKSB7XG4gICAgICB2YXIgbGFiZWxUZXh0ID0gdGhpcy5pbWFnZUNvdW50TGFiZWwodGhpcy5jdXJyZW50SW1hZ2VJbmRleCArIDEsIHRoaXMuYWxidW0ubGVuZ3RoKTtcbiAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1udW1iZXInKS50ZXh0KGxhYmVsVGV4dCkuZmFkZUluKCdmYXN0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1udW1iZXInKS5oaWRlKCk7XG4gICAgfVxuXG4gICAgdGhpcy4kb3V0ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2FuaW1hdGluZycpO1xuXG4gICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLWRhdGFDb250YWluZXInKS5mYWRlSW4odGhpcy5vcHRpb25zLnJlc2l6ZUR1cmF0aW9uLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzZWxmLnNpemVPdmVybGF5KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gUHJlbG9hZCBwcmV2aW91cyBhbmQgbmV4dCBpbWFnZXMgaW4gc2V0LlxuICBMaWdodGJveC5wcm90b3R5cGUucHJlbG9hZE5laWdoYm9yaW5nSW1hZ2VzID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuYWxidW0ubGVuZ3RoID4gdGhpcy5jdXJyZW50SW1hZ2VJbmRleCArIDEpIHtcbiAgICAgIHZhciBwcmVsb2FkTmV4dCA9IG5ldyBJbWFnZSgpO1xuICAgICAgcHJlbG9hZE5leHQuc3JjID0gdGhpcy5hbGJ1bVt0aGlzLmN1cnJlbnRJbWFnZUluZGV4ICsgMV0ubGluaztcbiAgICB9XG4gICAgaWYgKHRoaXMuY3VycmVudEltYWdlSW5kZXggPiAwKSB7XG4gICAgICB2YXIgcHJlbG9hZFByZXYgPSBuZXcgSW1hZ2UoKTtcbiAgICAgIHByZWxvYWRQcmV2LnNyYyA9IHRoaXMuYWxidW1bdGhpcy5jdXJyZW50SW1hZ2VJbmRleCAtIDFdLmxpbms7XG4gICAgfVxuICB9O1xuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5lbmFibGVLZXlib2FyZE5hdiA9IGZ1bmN0aW9uKCkge1xuICAgICQoZG9jdW1lbnQpLm9uKCdrZXl1cC5rZXlib2FyZCcsICQucHJveHkodGhpcy5rZXlib2FyZEFjdGlvbiwgdGhpcykpO1xuICB9O1xuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5kaXNhYmxlS2V5Ym9hcmROYXYgPSBmdW5jdGlvbigpIHtcbiAgICAkKGRvY3VtZW50KS5vZmYoJy5rZXlib2FyZCcpO1xuICB9O1xuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5rZXlib2FyZEFjdGlvbiA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIEtFWUNPREVfRVNDICAgICAgICA9IDI3O1xuICAgIHZhciBLRVlDT0RFX0xFRlRBUlJPVyAgPSAzNztcbiAgICB2YXIgS0VZQ09ERV9SSUdIVEFSUk9XID0gMzk7XG5cbiAgICB2YXIga2V5Y29kZSA9IGV2ZW50LmtleUNvZGU7XG4gICAgdmFyIGtleSAgICAgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGtleWNvZGUpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGtleWNvZGUgPT09IEtFWUNPREVfRVNDIHx8IGtleS5tYXRjaCgveHxvfGMvKSkge1xuICAgICAgdGhpcy5lbmQoKTtcbiAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ3AnIHx8IGtleWNvZGUgPT09IEtFWUNPREVfTEVGVEFSUk9XKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50SW1hZ2VJbmRleCAhPT0gMCkge1xuICAgICAgICB0aGlzLmNoYW5nZUltYWdlKHRoaXMuY3VycmVudEltYWdlSW5kZXggLSAxKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgdGhpcy5hbGJ1bS5sZW5ndGggPiAxKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlSW1hZ2UodGhpcy5hbGJ1bS5sZW5ndGggLSAxKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ24nIHx8IGtleWNvZGUgPT09IEtFWUNPREVfUklHSFRBUlJPVykge1xuICAgICAgaWYgKHRoaXMuY3VycmVudEltYWdlSW5kZXggIT09IHRoaXMuYWxidW0ubGVuZ3RoIC0gMSkge1xuICAgICAgICB0aGlzLmNoYW5nZUltYWdlKHRoaXMuY3VycmVudEltYWdlSW5kZXggKyAxKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLndyYXBBcm91bmQgJiYgdGhpcy5hbGJ1bS5sZW5ndGggPiAxKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlSW1hZ2UoMCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIENsb3NpbmcgdGltZS4gOi0oXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRpc2FibGVLZXlib2FyZE5hdigpO1xuICAgICQod2luZG93KS5vZmYoJ3Jlc2l6ZScsIHRoaXMuc2l6ZU92ZXJsYXkpO1xuICAgIHRoaXMuJGxpZ2h0Ym94LmZhZGVPdXQodGhpcy5vcHRpb25zLmZhZGVEdXJhdGlvbik7XG4gICAgdGhpcy4kb3ZlcmxheS5mYWRlT3V0KHRoaXMub3B0aW9ucy5mYWRlRHVyYXRpb24pO1xuICAgICQoJ3NlbGVjdCwgb2JqZWN0LCBlbWJlZCcpLmNzcyh7XG4gICAgICB2aXNpYmlsaXR5OiAndmlzaWJsZSdcbiAgICB9KTtcbiAgICBpZiAodGhpcy5vcHRpb25zLmRpc2FibGVTY3JvbGxpbmcpIHtcbiAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbGItZGlzYWJsZS1zY3JvbGxpbmcnKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIG5ldyBMaWdodGJveCgpO1xufSkpO1xuIl19
