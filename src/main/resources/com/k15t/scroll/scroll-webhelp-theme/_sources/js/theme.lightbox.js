function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}$(document).ready((function(){$(".ht-content img").each((function(){var t=$(this),i=$(this).attr("alt");t.title||("undefined"==_typeof(i)||0==i?t.attr("title",""):t.attr("title",t.attr("alt"))),$(t).wrap('<a data-lightbox="imageset" data-title="'+$(t).attr("title")+'" href="'+$(t).attr("src")+'"></a>')}))})),
/*!
 * Lightbox v2.8.2
 * by Lokesh Dhakar
 *
 * More info:
 * http://lokeshdhakar.com/projects/lightbox2/
 *
 * Copyright 2007, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://github.com/lokesh/lightbox2/blob/master/LICENSE
 */
function(t,i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=i(require("jquery")):t.lightbox=i(t.jQuery)}(this,(function(t){function i(i){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=t.extend({},this.constructor.defaults),this.option(i)}return i.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:250,fitImagesInViewport:!0,positionFromTop:50,resizeDuration:250,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1},i.prototype.option=function(i){t.extend(this.options,i)},i.prototype.imageCountLabel=function(t,i){return this.options.albumLabel.replace(/%1/g,t).replace(/%2/g,i)},i.prototype.init=function(){this.enable(),this.build()},i.prototype.enable=function(){var i=this;t("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",(function(e){return i.start(t(e.currentTarget)),!1}))},i.prototype.build=function(){var i=this;t('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(t("body")),this.$lightbox=t("#lightbox"),this.$overlay=t("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",(function(){return i.end(),!1})),this.$lightbox.hide().on("click",(function(e){return"lightbox"===t(e.target).attr("id")&&i.end(),!1})),this.$outerContainer.on("click",(function(e){return"lightbox"===t(e.target).attr("id")&&i.end(),!1})),this.$lightbox.find(".lb-prev").on("click",(function(){return 0===i.currentImageIndex?i.changeImage(i.album.length-1):i.changeImage(i.currentImageIndex-1),!1})),this.$lightbox.find(".lb-next").on("click",(function(){return i.currentImageIndex===i.album.length-1?i.changeImage(0):i.changeImage(i.currentImageIndex+1),!1})),this.$lightbox.find(".lb-loader, .lb-close").on("click",(function(){return i.end(),!1}))},i.prototype.start=function(i){var e=this,n=t(window);n.on("resize",t.proxy(this.sizeOverlay,this)),t("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var a=0;function o(t){e.album.push({link:t.attr("href"),title:t.attr("data-title")||t.attr("title")})}"undefined"!=i.attr("data-title")&&"undefined"!=i.attr("title")||i.attr("data-title"," ");var s,r=i.attr("data-lightbox");if(r){s=t(i.prop("tagName")+'[data-lightbox="'+r+'"]');for(var h=0;h<s.length;h=++h)o(t(s[h])),s[h]===i[0]&&(a=h)}else if("lightbox"===i.attr("rel"))o(i);else{s=t(i.prop("tagName")+'[rel="'+i.attr("rel")+'"]');for(var l=0;l<s.length;l=++l)o(t(s[l])),s[l]===i[0]&&(a=l)}var d=n.scrollTop()+this.options.positionFromTop,c=n.scrollLeft();this.$lightbox.css({top:d+"px",left:c+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&t("body").addClass("lb-disable-scrolling"),this.changeImage(a)},i.prototype.changeImage=function(i){var e=this;this.disableKeyboardNav();var n=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),t(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var a=new Image;a.onload=function(){var o,s,r,h,l,d;n.attr("src",e.album[i].link),t(a),n.width(a.width),n.height(a.height),e.options.fitImagesInViewport&&(d=t(window).width(),l=t(window).height(),h=d-e.containerLeftPadding-e.containerRightPadding-20,r=l-e.containerTopPadding-e.containerBottomPadding-120,e.options.maxWidth&&e.options.maxWidth<h&&(h=e.options.maxWidth),e.options.maxHeight&&e.options.maxHeight<h&&(r=e.options.maxHeight),(a.width>h||a.height>r)&&(a.width/h>a.height/r?(s=h,o=parseInt(a.height/(a.width/s),10),n.width(s),n.height(o)):(o=r,s=parseInt(a.width/(a.height/o),10),n.width(s),n.height(o)))),e.sizeContainer(n.width(),n.height())},a.src=this.album[i].link,this.currentImageIndex=i},i.prototype.sizeOverlay=function(){this.$overlay.width(t(document).width()).height(t(document).height())},i.prototype.sizeContainer=function(t,i){var e=this,n=this.$outerContainer.outerWidth(),a=this.$outerContainer.outerHeight(),o=t+this.containerLeftPadding+this.containerRightPadding,s=i+this.containerTopPadding+this.containerBottomPadding;function r(){e.$lightbox.find(".lb-dataContainer").width(o),e.$lightbox.find(".lb-prevLink").height(s),e.$lightbox.find(".lb-nextLink").height(s),e.showImage()}n!==o||a!==s?this.$outerContainer.animate({width:o,height:s},this.options.resizeDuration,"swing",(function(){r()})):r()},i.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},i.prototype.updateNav=function(){var t=!1;try{document.createEvent("TouchEvent"),t=!!this.options.alwaysShowNavOnTouchDevices}catch(t){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(t&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),t&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),t&&this.$lightbox.find(".lb-next").css("opacity","1"))))},i.prototype.updateDetails=function(){var i=this;if(void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast").find("a").on("click",(function(i){void 0!==t(this).attr("target")?window.open(t(this).attr("href"),t(this).attr("target")):location.href=t(this).attr("href")})),this.album.length>1&&this.options.showImageNumberLabel){var e=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(e).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,(function(){return i.sizeOverlay()}))},i.prototype.preloadNeighboringImages=function(){this.album.length>this.currentImageIndex+1&&((new Image).src=this.album[this.currentImageIndex+1].link);this.currentImageIndex>0&&((new Image).src=this.album[this.currentImageIndex-1].link)},i.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},i.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},i.prototype.keyboardAction=function(t){var i=t.keyCode,e=String.fromCharCode(i).toLowerCase();27===i||e.match(/x|o|c/)?this.end():"p"===e||37===i?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==e&&39!==i||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},i.prototype.end=function(){this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&t("body").removeClass("lb-disable-scrolling")},new i}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRoZW1lLmxpZ2h0Ym94LmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiZWFjaCIsImltZyIsInRoaXMiLCJhdHRyIiwidGl0bGUiLCJfdHlwZW9mIiwid3JhcCIsInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsImRlZmluZSIsImFtZCIsIm1vZHVsZSIsImxpZ2h0Ym94IiwialF1ZXJ5IiwiTGlnaHRib3giLCJvcHRpb25zIiwiY3VycmVudEltYWdlSW5kZXgiLCJhbGJ1bSIsIm9wdGlvbiIsImV4dGVuZCIsImNvbnN0cnVjdG9yIiwiZGVmYXVsdHMiLCJmaXRJbWFnZXNJblZpZXdwb3J0IiwiYWxidW1MYWJlbCIsImFsd2F5c1Nob3dOYXZPblRvdWNoRGV2aWNlcyIsInBvc2l0aW9uRnJvbVRvcCIsIndyYXBBcm91bmQiLCJyZXNpemVEdXJhdGlvbiIsImRpc2FibGVTY3JvbGxpbmciLCJwcm90b3R5cGUiLCJpbWFnZUNvdW50TGFiZWwiLCJjdXJyZW50SW1hZ2VOdW0iLCJ0b3RhbEltYWdlcyIsInJlcGxhY2UiLCJlbmFibGUiLCJzZWxmIiwiYnVpbGQiLCJvbiIsImV2ZW50IiwiJG91dGVyQ29udGFpbmVyIiwiJGNvbnRhaW5lciIsImFwcGVuZFRvIiwiY29udGFpbmVyUmlnaHRQYWRkaW5nIiwiY29udGFpbmVyQm90dG9tUGFkZGluZyIsImNvbnRhaW5lckxlZnRQYWRkaW5nIiwicGFyc2VJbnQiLCJmaW5kIiwiJGxpZ2h0Ym94IiwiY3NzIiwiJG92ZXJsYXkiLCJoaWRlIiwiZW5kIiwidGFyZ2V0IiwiY2hhbmdlSW1hZ2UiLCJsZW5ndGgiLCJzdGFydCIsIiR3aW5kb3ciLCJ2aXNpYmlsaXR5Iiwic2l6ZU92ZXJsYXkiLCIkbGluayIsIndpbmRvdyIsInByb3h5IiwicHVzaCIsImltYWdlTnVtYmVyIiwiYWRkVG9BbGJ1bSIsImxpbmsiLCIkbGlua3MiLCJkYXRhTGlnaHRib3hWYWx1ZSIsImkiLCJwcm9wIiwic2Nyb2xsTGVmdCIsImxlZnQiLCJ0b3AiLCJqIiwiYWRkQ2xhc3MiLCJkaXNhYmxlS2V5Ym9hcmROYXYiLCIkaW1hZ2UiLCJmYWRlSW4iLCJwcmVsb2FkZXIiLCJvbmxvYWQiLCJ3aW5kb3dXaWR0aCIsImhlaWdodCIsImZhZGVEdXJhdGlvbiIsIm1heEltYWdlV2lkdGgiLCJJbWFnZSIsImltYWdlSGVpZ2h0IiwiaW1hZ2VXaWR0aCIsIm1heEltYWdlSGVpZ2h0Iiwid2luZG93SGVpZ2h0Iiwid2lkdGgiLCJjb250YWluZXJUb3BQYWRkaW5nIiwibWF4V2lkdGgiLCJtYXhIZWlnaHQiLCJzaXplQ29udGFpbmVyIiwib2xkV2lkdGgiLCJvbGRIZWlnaHQiLCJvdXRlckhlaWdodCIsIm5ld1dpZHRoIiwibmV3SGVpZ2h0Iiwic2hvd0ltYWdlIiwicG9zdFJlc2l6ZSIsInVwZGF0ZURldGFpbHMiLCJwcmVsb2FkTmVpZ2hib3JpbmdJbWFnZXMiLCJvdXRlcldpZHRoIiwiYWx3YXlzU2hvd05hdiIsImFuaW1hdGUiLCJzdG9wIiwic2hvdyIsInVwZGF0ZU5hdiIsImVuYWJsZUtleWJvYXJkTmF2IiwiY3JlYXRlRXZlbnQiLCJlIiwic2hvd0ltYWdlTnVtYmVyTGFiZWwiLCJsYWJlbFRleHQiLCJvZmYiLCJrZXlib2FyZEFjdGlvbiIsIktFWUNPREVfRVNDIiwiS0VZQ09ERV9MRUZUQVJST1ciLCJ1bmRlZmluZWQiLCJLRVlDT0RFX1JJR0hUQVJST1ciLCJrZXljb2RlIiwia2V5Q29kZSIsImtleSIsIm1hdGNoIiwidGV4dCIsInJlbW92ZUNsYXNzIiwiZmFkZU91dCIsInNyYyIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsInRvTG93ZXJDYXNlIl0sIm1hcHBpbmdzIjoid1BBQ0FBLEVBQUFDLFVBQUFDLE9BQUEsV0FDRUQsRUFBQUEsbUJBQWdCRSxNQUFBLFdBQ2IsSUFBQUMsRUFBQUosRUFBQUssTUFDT0MsRUFBS04sRUFBS0ssTUFBRUMsS0FBQSxPQUluQkYsRUFBQUcsUUFNTSxhQUFBQyxRQUFBRixJQUFBLEdBQUFB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QUFLYyxRQUFRVyxZQUFjekIsS0FBS2dCLE1BQU1xQyxPQUFTLEdBQ3hEckQsS0FBS29ELFlBQVksR0FHdkIsRUFHQXZDLEVBQVNlLFVBQVVzQixJQUFNLFdBQ3ZCbEQsS0FBSzBFLHFCQUNML0UsRUFBRWdFLFFBQVFzRCxJQUFJLFNBQVVqSCxLQUFLeUQsYUFDN0J6RCxLQUFLOEMsVUFBVStFLFFBQVE3SCxLQUFLYyxRQUFRbUUsY0FDcENqRixLQUFLZ0QsU0FBUzZFLFFBQVE3SCxLQUFLYyxRQUFRbUUsY0FDbkN0RixFQUFFLHlCQUF5Qm9ELElBQUksQ0FDN0JTLFdBQVksWUFFVnhELEtBQUtjLFFBQVFhLGtCQUNmaEMsRUFBRSxRQUFRaUksWUFBWSx1QkFFMUIsRUFFTyxJQUFJL0csQ0FDYiIsImZpbGUiOiJ0aGVtZS5saWdodGJveC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT0gQ1VTVE9NIElNQUdFIFdSQVBQRVIgPT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gV3JhcHMgaW1nIGVsZW1lbnRzIGluIGFuIDxhPiB3aXRoIGRhdGEtbGlnaHRib3ggYW5kIGRhdGEtdGl0bGUgcHJvcGVydGllcyBuZWNlc3NhcnkgdG8gZW5hYmxlIExpZ2h0Ym94IGFuZCBncm91cCB0aGUgaW1hZ2VzIHRvIGEgZ2FsbGVyeVxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gIFx0JCgnLmh0LWNvbnRlbnQgaW1nJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICBcdHZhciBpbWcgPSAkKHRoaXMpOyAvLyBjYWNoZSBxdWVyeVxuICAgICAgICB2YXIgYXR0ciA9ICQodGhpcykuYXR0cignYWx0Jyk7XG4gICAgXG4gICAgXHQvLyBDcmVhdGVzIHRoZSB0aXRsZSBhdHRyaWJ1dGUgZm9yIGFuIGltYWdlIG9uIHRoZSBwYWdlXG4gICAgXHQvLyBJZiB0aGUgdGl0bGUgYXR0cmlidXRlIGV4aXN0cywgZG8gbm90aGluZ1xuICAgICAgICBpZiAoaW1nLnRpdGxlKSB7ICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgeyAgICAgICAgICBcbiAgICAgICAgICAvLyBDaGVja3Mgd2hldGhlciB0aGUgYWx0IGF0dHJpYnV0ZSBleGlzdHMsIGFjdHMgYWNjb3JkaW5nbHkgYnkgZ2l2aW5nIHRoZSB0aXRsZSBhdHRyaWJ1dGUgcmVsZXZhbnQgdmFsdWVzXG4gICAgICAgICAgaWYgKHR5cGVvZiBhdHRyID09IHR5cGVvZiB1bmRlZmluZWQgfHwgYXR0ciA9PSBmYWxzZSkge1xuICAgICAgICAgIFx0Ly8gTm8gYWx0IGZvdW5kLCBzZXQgdGl0bGUgYXR0cmlidXRlIGJsYW5rXG4gICAgICAgICAgICBpbWcuYXR0cigndGl0bGUnLCBcIlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBBbHQgYXR0cmlidXRlIGV4aXN0cywgdXNlIGl0IGFzIHRoZSB0aXRsZSBhdHRyaWJ1dGVcbiAgICAgICAgICAgIGltZy5hdHRyKCd0aXRsZScsIGltZy5hdHRyKCdhbHQnKSk7IFxuICAgICAgICAgIH0gICAgICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAvLyBXcmFwcyB0aGUgaWFtZ2UgaW4gYSBoeXBlcmxpbmsgd2l0aCBhdHRyaWJ1dGVzIG5lY2Vzc2FyeSBmb3IgbGlnaHRib3gyIHRvIGZ1bmN0aW9uXG4gICQoIGltZyApLndyYXAoICc8YSBkYXRhLWxpZ2h0Ym94PVwiaW1hZ2VzZXRcIiBkYXRhLXRpdGxlPVwiJyArICQoIGltZyApLmF0dHIoICd0aXRsZScgKSArICdcIiBocmVmPVwiJyArJCggaW1nICkuYXR0ciggJ3NyYycgKSsgJ1wiPjwvYT4nICk7XG4gIH0pO1xufSk7XG5cblxuLyohXG4gKiBMaWdodGJveCB2Mi44LjJcbiAqIGJ5IExva2VzaCBEaGFrYXJcbiAqXG4gKiBNb3JlIGluZm86XG4gKiBodHRwOi8vbG9rZXNoZGhha2FyLmNvbS9wcm9qZWN0cy9saWdodGJveDIvXG4gKlxuICogQ29weXJpZ2h0IDIwMDcsIDIwMTUgTG9rZXNoIERoYWthclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbG9rZXNoL2xpZ2h0Ym94Mi9ibG9iL21hc3Rlci9MSUNFTlNFXG4gKi9cblxuLy8gVXNlcyBOb2RlLCBBTUQgb3IgYnJvd3NlciBnbG9iYWxzIHRvIGNyZWF0ZSBhIG1vZHVsZS5cbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuICAgICAgICBkZWZpbmUoWydqcXVlcnknXSwgZmFjdG9yeSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gTm9kZS4gRG9lcyBub3Qgd29yayB3aXRoIHN0cmljdCBDb21tb25KUywgYnV0XG4gICAgICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLFxuICAgICAgICAvLyBsaWtlIE5vZGUuXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKCdqcXVlcnknKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcbiAgICAgICAgcm9vdC5saWdodGJveCA9IGZhY3Rvcnkocm9vdC5qUXVlcnkpO1xuICAgIH1cbn0odGhpcywgZnVuY3Rpb24gKCQpIHtcblxuICBmdW5jdGlvbiBMaWdodGJveChvcHRpb25zKSB7XG4gICAgdGhpcy5hbGJ1bSA9IFtdO1xuICAgIHRoaXMuY3VycmVudEltYWdlSW5kZXggPSB2b2lkIDA7XG4gICAgdGhpcy5pbml0KCk7XG5cbiAgICAvLyBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIHRoaXMuY29uc3RydWN0b3IuZGVmYXVsdHMpO1xuICAgIHRoaXMub3B0aW9uKG9wdGlvbnMpO1xuICB9XG5cbiAgLy8gRGVzY3JpcHRpb25zIG9mIGFsbCBvcHRpb25zIGF2YWlsYWJsZSBvbiB0aGUgZGVtbyBzaXRlOlxuICAvLyBodHRwOi8vbG9rZXNoZGhha2FyLmNvbS9wcm9qZWN0cy9saWdodGJveDIvaW5kZXguaHRtbCNvcHRpb25zXG4gIExpZ2h0Ym94LmRlZmF1bHRzID0ge1xuICAgIGFsYnVtTGFiZWw6ICdJbWFnZSAlMSBvZiAlMicsXG4gICAgYWx3YXlzU2hvd05hdk9uVG91Y2hEZXZpY2VzOiBmYWxzZSxcbiAgICBmYWRlRHVyYXRpb246IDI1MCxcbiAgICBmaXRJbWFnZXNJblZpZXdwb3J0OiB0cnVlLFxuICAgIC8vIG1heFdpZHRoOiA4MDAsXG4gICAgLy8gbWF4SGVpZ2h0OiA2MDAsXG4gICAgcG9zaXRpb25Gcm9tVG9wOiA1MCxcbiAgICAvLyByZXNpemVEdXJhdGlvbjogNzAwLFxuICAgIHJlc2l6ZUR1cmF0aW9uOiAyNTAsXG4gICAgc2hvd0ltYWdlTnVtYmVyTGFiZWw6IHRydWUsXG4gICAgd3JhcEFyb3VuZDogZmFsc2UsXG4gICAgZGlzYWJsZVNjcm9sbGluZzogZmFsc2VcbiAgfTtcblxuICBMaWdodGJveC5wcm90b3R5cGUub3B0aW9uID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICQuZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XG4gIH07XG5cbiAgTGlnaHRib3gucHJvdG90eXBlLmltYWdlQ291bnRMYWJlbCA9IGZ1bmN0aW9uKGN1cnJlbnRJbWFnZU51bSwgdG90YWxJbWFnZXMpIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFsYnVtTGFiZWwucmVwbGFjZSgvJTEvZywgY3VycmVudEltYWdlTnVtKS5yZXBsYWNlKC8lMi9nLCB0b3RhbEltYWdlcyk7XG4gIH07XG5cbiAgTGlnaHRib3gucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmVuYWJsZSgpO1xuICAgIHRoaXMuYnVpbGQoKTtcbiAgfTtcblxuICAvLyBMb29wIHRocm91Z2ggYW5jaG9ycyBhbmQgYXJlYW1hcHMgbG9va2luZyBmb3IgZWl0aGVyIGRhdGEtbGlnaHRib3ggYXR0cmlidXRlcyBvciByZWwgYXR0cmlidXRlc1xuICAvLyB0aGF0IGNvbnRhaW4gJ2xpZ2h0Ym94Jy4gV2hlbiB0aGVzZSBhcmUgY2xpY2tlZCwgc3RhcnQgbGlnaHRib3guXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgJCgnYm9keScpLm9uKCdjbGljaycsICdhW3JlbF49bGlnaHRib3hdLCBhcmVhW3JlbF49bGlnaHRib3hdLCBhW2RhdGEtbGlnaHRib3hdLCBhcmVhW2RhdGEtbGlnaHRib3hdJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHNlbGYuc3RhcnQoJChldmVudC5jdXJyZW50VGFyZ2V0KSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQnVpbGQgaHRtbCBmb3IgdGhlIGxpZ2h0Ym94IGFuZCB0aGUgb3ZlcmxheS5cbiAgLy8gQXR0YWNoIGV2ZW50IGhhbmRsZXJzIHRvIHRoZSBuZXcgRE9NIGVsZW1lbnRzLiBjbGljayBjbGljayBjbGlja1xuICBMaWdodGJveC5wcm90b3R5cGUuYnVpbGQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgJCgnPGRpdiBpZD1cImxpZ2h0Ym94T3ZlcmxheVwiIGNsYXNzPVwibGlnaHRib3hPdmVybGF5XCI+PC9kaXY+PGRpdiBpZD1cImxpZ2h0Ym94XCIgY2xhc3M9XCJsaWdodGJveFwiPjxkaXYgY2xhc3M9XCJsYi1vdXRlckNvbnRhaW5lclwiPjxkaXYgY2xhc3M9XCJsYi1jb250YWluZXJcIj48aW1nIGNsYXNzPVwibGItaW1hZ2VcIiBzcmM9XCJkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUlBQUFQLy8vd0FBQUNINUJBRUFBQUFBTEFBQUFBQUJBQUVBQUFJQ1JBRUFPdz09XCIgLz48ZGl2IGNsYXNzPVwibGItbmF2XCI+PGEgY2xhc3M9XCJsYi1wcmV2XCIgaHJlZj1cIlwiID48L2E+PGEgY2xhc3M9XCJsYi1uZXh0XCIgaHJlZj1cIlwiID48L2E+PC9kaXY+PGRpdiBjbGFzcz1cImxiLWxvYWRlclwiPjxhIGNsYXNzPVwibGItY2FuY2VsXCI+PC9hPjwvZGl2PjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJsYi1kYXRhQ29udGFpbmVyXCI+PGRpdiBjbGFzcz1cImxiLWRhdGFcIj48ZGl2IGNsYXNzPVwibGItZGV0YWlsc1wiPjxzcGFuIGNsYXNzPVwibGItY2FwdGlvblwiPjwvc3Bhbj48c3BhbiBjbGFzcz1cImxiLW51bWJlclwiPjwvc3Bhbj48L2Rpdj48ZGl2IGNsYXNzPVwibGItY2xvc2VDb250YWluZXJcIj48YSBjbGFzcz1cImxiLWNsb3NlXCI+PC9hPjwvZGl2PjwvZGl2PjwvZGl2PjwvZGl2PicpLmFwcGVuZFRvKCQoJ2JvZHknKSk7XG5cbiAgICAvLyBDYWNoZSBqUXVlcnkgb2JqZWN0c1xuICAgIHRoaXMuJGxpZ2h0Ym94ICAgICAgID0gJCgnI2xpZ2h0Ym94Jyk7XG4gICAgdGhpcy4kb3ZlcmxheSAgICAgICAgPSAkKCcjbGlnaHRib3hPdmVybGF5Jyk7XG4gICAgdGhpcy4kb3V0ZXJDb250YWluZXIgPSB0aGlzLiRsaWdodGJveC5maW5kKCcubGItb3V0ZXJDb250YWluZXInKTtcbiAgICB0aGlzLiRjb250YWluZXIgICAgICA9IHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1jb250YWluZXInKTtcblxuICAgIC8vIFN0b3JlIGNzcyB2YWx1ZXMgZm9yIGZ1dHVyZSBsb29rdXBcbiAgICB0aGlzLmNvbnRhaW5lclRvcFBhZGRpbmcgPSBwYXJzZUludCh0aGlzLiRjb250YWluZXIuY3NzKCdwYWRkaW5nLXRvcCcpLCAxMCk7XG4gICAgdGhpcy5jb250YWluZXJSaWdodFBhZGRpbmcgPSBwYXJzZUludCh0aGlzLiRjb250YWluZXIuY3NzKCdwYWRkaW5nLXJpZ2h0JyksIDEwKTtcbiAgICB0aGlzLmNvbnRhaW5lckJvdHRvbVBhZGRpbmcgPSBwYXJzZUludCh0aGlzLiRjb250YWluZXIuY3NzKCdwYWRkaW5nLWJvdHRvbScpLCAxMCk7XG4gICAgdGhpcy5jb250YWluZXJMZWZ0UGFkZGluZyA9IHBhcnNlSW50KHRoaXMuJGNvbnRhaW5lci5jc3MoJ3BhZGRpbmctbGVmdCcpLCAxMCk7XG5cbiAgICAvLyBBdHRhY2ggZXZlbnQgaGFuZGxlcnMgdG8gdGhlIG5ld2x5IG1pbnRlZCBET00gZWxlbWVudHNcbiAgICB0aGlzLiRvdmVybGF5LmhpZGUoKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuZW5kKCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG5cbiAgICB0aGlzLiRsaWdodGJveC5oaWRlKCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICgkKGV2ZW50LnRhcmdldCkuYXR0cignaWQnKSA9PT0gJ2xpZ2h0Ym94Jykge1xuICAgICAgICBzZWxmLmVuZCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgdGhpcy4kb3V0ZXJDb250YWluZXIub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICgkKGV2ZW50LnRhcmdldCkuYXR0cignaWQnKSA9PT0gJ2xpZ2h0Ym94Jykge1xuICAgICAgICBzZWxmLmVuZCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLXByZXYnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChzZWxmLmN1cnJlbnRJbWFnZUluZGV4ID09PSAwKSB7XG4gICAgICAgIHNlbGYuY2hhbmdlSW1hZ2Uoc2VsZi5hbGJ1bS5sZW5ndGggLSAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGYuY2hhbmdlSW1hZ2Uoc2VsZi5jdXJyZW50SW1hZ2VJbmRleCAtIDEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLW5leHQnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChzZWxmLmN1cnJlbnRJbWFnZUluZGV4ID09PSBzZWxmLmFsYnVtLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgc2VsZi5jaGFuZ2VJbWFnZSgwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGYuY2hhbmdlSW1hZ2Uoc2VsZi5jdXJyZW50SW1hZ2VJbmRleCArIDEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLWxvYWRlciwgLmxiLWNsb3NlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICBzZWxmLmVuZCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIFNob3cgb3ZlcmxheSBhbmQgbGlnaHRib3guIElmIHRoZSBpbWFnZSBpcyBwYXJ0IG9mIGEgc2V0LCBhZGQgc2libGluZ3MgdG8gYWxidW0gYXJyYXkuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCRsaW5rKSB7XG4gICAgdmFyIHNlbGYgICAgPSB0aGlzO1xuICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpO1xuXG4gICAgJHdpbmRvdy5vbigncmVzaXplJywgJC5wcm94eSh0aGlzLnNpemVPdmVybGF5LCB0aGlzKSk7XG5cbiAgICAkKCdzZWxlY3QsIG9iamVjdCwgZW1iZWQnKS5jc3Moe1xuICAgICAgdmlzaWJpbGl0eTogJ2hpZGRlbidcbiAgICB9KTtcblxuICAgIHRoaXMuc2l6ZU92ZXJsYXkoKTtcblxuICAgIHRoaXMuYWxidW0gPSBbXTtcbiAgICB2YXIgaW1hZ2VOdW1iZXIgPSAwO1xuICAgIFxuICAgIC8vQ1VTVE9NIC0gSWYgdGhlIGltYWdlIGlzIG1pc3NpbmcgdGhlIHRpdGxlIGF0dHJpYnV0ZSwgdGhlIGRhdGEtdGl0bGUgYXR0cmlidXRlIGlzIFxuICAgIC8vbm8gbG9uZ2VyIGFwcGVuZGVkIHRvIHRoZSBsaWdodGJveCBlbGVtZW50LiBUaGlzIHByZXZlbnRzIHRoZSBcInVuZGVmaW5lZFwiIGltYWdlIGRlc2NyaXB0aW9uIGZyb20gYmVpbmcgZGlzcGxheWVkLlxuICAgIGlmKCgkbGluay5hdHRyKCdkYXRhLXRpdGxlJykgPT0gXCJ1bmRlZmluZWRcIiApIHx8ICgkbGluay5hdHRyKCd0aXRsZScpPT0gXCJ1bmRlZmluZWRcIiApKSB7XHRcdFx0XHRcdFxuXHQgICAgICAgICRsaW5rLmF0dHIoJ2RhdGEtdGl0bGUnLCBcIiBcIik7XG5cdH1cbiAgICAvL0VORE9GQ1VTVE9NXG5cbiAgICBmdW5jdGlvbiBhZGRUb0FsYnVtKCRsaW5rKSB7XG4gICAgICBzZWxmLmFsYnVtLnB1c2goe1xuICAgICAgICBsaW5rOiAkbGluay5hdHRyKCdocmVmJyksXG4gICAgICAgIHRpdGxlOiAkbGluay5hdHRyKCdkYXRhLXRpdGxlJykgfHwgJGxpbmsuYXR0cigndGl0bGUnKVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU3VwcG9ydCBib3RoIGRhdGEtbGlnaHRib3ggYXR0cmlidXRlIGFuZCByZWwgYXR0cmlidXRlIGltcGxlbWVudGF0aW9uc1xuICAgIHZhciBkYXRhTGlnaHRib3hWYWx1ZSA9ICRsaW5rLmF0dHIoJ2RhdGEtbGlnaHRib3gnKTtcbiAgICB2YXIgJGxpbmtzO1xuXG4gICAgaWYgKGRhdGFMaWdodGJveFZhbHVlKSB7XG4gICAgICAkbGlua3MgPSAkKCRsaW5rLnByb3AoJ3RhZ05hbWUnKSArICdbZGF0YS1saWdodGJveD1cIicgKyBkYXRhTGlnaHRib3hWYWx1ZSArICdcIl0nKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJGxpbmtzLmxlbmd0aDsgaSA9ICsraSkge1xuICAgICAgICBhZGRUb0FsYnVtKCQoJGxpbmtzW2ldKSk7XG4gICAgICAgIGlmICgkbGlua3NbaV0gPT09ICRsaW5rWzBdKSB7XG4gICAgICAgICAgaW1hZ2VOdW1iZXIgPSBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICgkbGluay5hdHRyKCdyZWwnKSA9PT0gJ2xpZ2h0Ym94Jykge1xuICAgICAgICAvLyBJZiBpbWFnZSBpcyBub3QgcGFydCBvZiBhIHNldFxuICAgICAgICBhZGRUb0FsYnVtKCRsaW5rKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIElmIGltYWdlIGlzIHBhcnQgb2YgYSBzZXRcbiAgICAgICAgJGxpbmtzID0gJCgkbGluay5wcm9wKCd0YWdOYW1lJykgKyAnW3JlbD1cIicgKyAkbGluay5hdHRyKCdyZWwnKSArICdcIl0nKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAkbGlua3MubGVuZ3RoOyBqID0gKytqKSB7XG4gICAgICAgICAgYWRkVG9BbGJ1bSgkKCRsaW5rc1tqXSkpO1xuICAgICAgICAgIGlmICgkbGlua3Nbal0gPT09ICRsaW5rWzBdKSB7XG4gICAgICAgICAgICBpbWFnZU51bWJlciA9IGo7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUG9zaXRpb24gTGlnaHRib3hcbiAgICB2YXIgdG9wICA9ICR3aW5kb3cuc2Nyb2xsVG9wKCkgKyB0aGlzLm9wdGlvbnMucG9zaXRpb25Gcm9tVG9wO1xuICAgIHZhciBsZWZ0ID0gJHdpbmRvdy5zY3JvbGxMZWZ0KCk7XG4gICAgdGhpcy4kbGlnaHRib3guY3NzKHtcbiAgICAgIHRvcDogdG9wICsgJ3B4JyxcbiAgICAgIGxlZnQ6IGxlZnQgKyAncHgnXG4gICAgfSkuZmFkZUluKHRoaXMub3B0aW9ucy5mYWRlRHVyYXRpb24pO1xuXG4gICAgLy8gRGlzYWJsZSBzY3JvbGxpbmcgb2YgdGhlIHBhZ2Ugd2hpbGUgb3BlblxuICAgIGlmICh0aGlzLm9wdGlvbnMuZGlzYWJsZVNjcm9sbGluZykge1xuICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdsYi1kaXNhYmxlLXNjcm9sbGluZycpO1xuICAgIH1cblxuICAgIHRoaXMuY2hhbmdlSW1hZ2UoaW1hZ2VOdW1iZXIpO1xuICB9O1xuXG4gIC8vIEhpZGUgbW9zdCBVSSBlbGVtZW50cyBpbiBwcmVwYXJhdGlvbiBmb3IgdGhlIGFuaW1hdGVkIHJlc2l6aW5nIG9mIHRoZSBsaWdodGJveC5cbiAgTGlnaHRib3gucHJvdG90eXBlLmNoYW5nZUltYWdlID0gZnVuY3Rpb24oaW1hZ2VOdW1iZXIpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB0aGlzLmRpc2FibGVLZXlib2FyZE5hdigpO1xuICAgIHZhciAkaW1hZ2UgPSB0aGlzLiRsaWdodGJveC5maW5kKCcubGItaW1hZ2UnKTtcblxuICAgIHRoaXMuJG92ZXJsYXkuZmFkZUluKHRoaXMub3B0aW9ucy5mYWRlRHVyYXRpb24pO1xuXG4gICAgJCgnLmxiLWxvYWRlcicpLmZhZGVJbignc2xvdycpO1xuICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1pbWFnZSwgLmxiLW5hdiwgLmxiLXByZXYsIC5sYi1uZXh0LCAubGItZGF0YUNvbnRhaW5lciwgLmxiLW51bWJlcnMsIC5sYi1jYXB0aW9uJykuaGlkZSgpO1xuXG4gICAgdGhpcy4kb3V0ZXJDb250YWluZXIuYWRkQ2xhc3MoJ2FuaW1hdGluZycpO1xuXG4gICAgLy8gV2hlbiBpbWFnZSB0byBzaG93IGlzIHByZWxvYWRlZCwgd2Ugc2VuZCB0aGUgd2lkdGggYW5kIGhlaWdodCB0byBzaXplQ29udGFpbmVyKClcbiAgICB2YXIgcHJlbG9hZGVyID0gbmV3IEltYWdlKCk7XG4gICAgcHJlbG9hZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyICRwcmVsb2FkZXI7XG4gICAgICB2YXIgaW1hZ2VIZWlnaHQ7XG4gICAgICB2YXIgaW1hZ2VXaWR0aDtcbiAgICAgIHZhciBtYXhJbWFnZUhlaWdodDtcbiAgICAgIHZhciBtYXhJbWFnZVdpZHRoO1xuICAgICAgdmFyIHdpbmRvd0hlaWdodDtcbiAgICAgIHZhciB3aW5kb3dXaWR0aDtcblxuICAgICAgJGltYWdlLmF0dHIoJ3NyYycsIHNlbGYuYWxidW1baW1hZ2VOdW1iZXJdLmxpbmspO1xuXG4gICAgICAkcHJlbG9hZGVyID0gJChwcmVsb2FkZXIpO1xuXG4gICAgICAkaW1hZ2Uud2lkdGgocHJlbG9hZGVyLndpZHRoKTtcbiAgICAgICRpbWFnZS5oZWlnaHQocHJlbG9hZGVyLmhlaWdodCk7XG5cbiAgICAgIGlmIChzZWxmLm9wdGlvbnMuZml0SW1hZ2VzSW5WaWV3cG9ydCkge1xuICAgICAgICAvLyBGaXQgaW1hZ2UgaW5zaWRlIHRoZSB2aWV3cG9ydC5cbiAgICAgICAgLy8gVGFrZSBpbnRvIGFjY291bnQgdGhlIGJvcmRlciBhcm91bmQgdGhlIGltYWdlIGFuZCBhbiBhZGRpdGlvbmFsIDEwcHggZ3V0dGVyIG9uIGVhY2ggc2lkZS5cblxuICAgICAgICB3aW5kb3dXaWR0aCAgICA9ICQod2luZG93KS53aWR0aCgpO1xuICAgICAgICB3aW5kb3dIZWlnaHQgICA9ICQod2luZG93KS5oZWlnaHQoKTtcbiAgICAgICAgbWF4SW1hZ2VXaWR0aCAgPSB3aW5kb3dXaWR0aCAtIHNlbGYuY29udGFpbmVyTGVmdFBhZGRpbmcgLSBzZWxmLmNvbnRhaW5lclJpZ2h0UGFkZGluZyAtIDIwO1xuICAgICAgICBtYXhJbWFnZUhlaWdodCA9IHdpbmRvd0hlaWdodCAtIHNlbGYuY29udGFpbmVyVG9wUGFkZGluZyAtIHNlbGYuY29udGFpbmVyQm90dG9tUGFkZGluZyAtIDEyMDtcblxuICAgICAgICAvLyBDaGVjayBpZiBpbWFnZSBzaXplIGlzIGxhcmdlciB0aGVuIG1heFdpZHRofG1heEhlaWdodCBpbiBzZXR0aW5nc1xuICAgICAgICBpZiAoc2VsZi5vcHRpb25zLm1heFdpZHRoICYmIHNlbGYub3B0aW9ucy5tYXhXaWR0aCA8IG1heEltYWdlV2lkdGgpIHtcbiAgICAgICAgICBtYXhJbWFnZVdpZHRoID0gc2VsZi5vcHRpb25zLm1heFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLm9wdGlvbnMubWF4SGVpZ2h0ICYmIHNlbGYub3B0aW9ucy5tYXhIZWlnaHQgPCBtYXhJbWFnZVdpZHRoKSB7XG4gICAgICAgICAgbWF4SW1hZ2VIZWlnaHQgPSBzZWxmLm9wdGlvbnMubWF4SGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSXMgdGhlcmUgYSBmaXR0aW5nIGlzc3VlP1xuICAgICAgICBpZiAoKHByZWxvYWRlci53aWR0aCA+IG1heEltYWdlV2lkdGgpIHx8IChwcmVsb2FkZXIuaGVpZ2h0ID4gbWF4SW1hZ2VIZWlnaHQpKSB7XG4gICAgICAgICAgaWYgKChwcmVsb2FkZXIud2lkdGggLyBtYXhJbWFnZVdpZHRoKSA+IChwcmVsb2FkZXIuaGVpZ2h0IC8gbWF4SW1hZ2VIZWlnaHQpKSB7XG4gICAgICAgICAgICBpbWFnZVdpZHRoICA9IG1heEltYWdlV2lkdGg7XG4gICAgICAgICAgICBpbWFnZUhlaWdodCA9IHBhcnNlSW50KHByZWxvYWRlci5oZWlnaHQgLyAocHJlbG9hZGVyLndpZHRoIC8gaW1hZ2VXaWR0aCksIDEwKTtcbiAgICAgICAgICAgICRpbWFnZS53aWR0aChpbWFnZVdpZHRoKTtcbiAgICAgICAgICAgICRpbWFnZS5oZWlnaHQoaW1hZ2VIZWlnaHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbWFnZUhlaWdodCA9IG1heEltYWdlSGVpZ2h0O1xuICAgICAgICAgICAgaW1hZ2VXaWR0aCA9IHBhcnNlSW50KHByZWxvYWRlci53aWR0aCAvIChwcmVsb2FkZXIuaGVpZ2h0IC8gaW1hZ2VIZWlnaHQpLCAxMCk7XG4gICAgICAgICAgICAkaW1hZ2Uud2lkdGgoaW1hZ2VXaWR0aCk7XG4gICAgICAgICAgICAkaW1hZ2UuaGVpZ2h0KGltYWdlSGVpZ2h0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNlbGYuc2l6ZUNvbnRhaW5lcigkaW1hZ2Uud2lkdGgoKSwgJGltYWdlLmhlaWdodCgpKTtcbiAgICB9O1xuXG4gICAgcHJlbG9hZGVyLnNyYyAgICAgICAgICA9IHRoaXMuYWxidW1baW1hZ2VOdW1iZXJdLmxpbms7XG4gICAgdGhpcy5jdXJyZW50SW1hZ2VJbmRleCA9IGltYWdlTnVtYmVyO1xuICB9O1xuXG4gIC8vIFN0cmV0Y2ggb3ZlcmxheSB0byBmaXQgdGhlIHZpZXdwb3J0XG4gIExpZ2h0Ym94LnByb3RvdHlwZS5zaXplT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuJG92ZXJsYXlcbiAgICAgIC53aWR0aCgkKGRvY3VtZW50KS53aWR0aCgpKVxuICAgICAgLmhlaWdodCgkKGRvY3VtZW50KS5oZWlnaHQoKSk7XG4gIH07XG5cbiAgLy8gQW5pbWF0ZSB0aGUgc2l6ZSBvZiB0aGUgbGlnaHRib3ggdG8gZml0IHRoZSBpbWFnZSB3ZSBhcmUgc2hvd2luZ1xuICBMaWdodGJveC5wcm90b3R5cGUuc2l6ZUNvbnRhaW5lciA9IGZ1bmN0aW9uKGltYWdlV2lkdGgsIGltYWdlSGVpZ2h0KSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdmFyIG9sZFdpZHRoICA9IHRoaXMuJG91dGVyQ29udGFpbmVyLm91dGVyV2lkdGgoKTtcbiAgICB2YXIgb2xkSGVpZ2h0ID0gdGhpcy4kb3V0ZXJDb250YWluZXIub3V0ZXJIZWlnaHQoKTtcbiAgICB2YXIgbmV3V2lkdGggID0gaW1hZ2VXaWR0aCArIHRoaXMuY29udGFpbmVyTGVmdFBhZGRpbmcgKyB0aGlzLmNvbnRhaW5lclJpZ2h0UGFkZGluZztcbiAgICB2YXIgbmV3SGVpZ2h0ID0gaW1hZ2VIZWlnaHQgKyB0aGlzLmNvbnRhaW5lclRvcFBhZGRpbmcgKyB0aGlzLmNvbnRhaW5lckJvdHRvbVBhZGRpbmc7XG5cbiAgICBmdW5jdGlvbiBwb3N0UmVzaXplKCkge1xuICAgICAgc2VsZi4kbGlnaHRib3guZmluZCgnLmxiLWRhdGFDb250YWluZXInKS53aWR0aChuZXdXaWR0aCk7XG4gICAgICBzZWxmLiRsaWdodGJveC5maW5kKCcubGItcHJldkxpbmsnKS5oZWlnaHQobmV3SGVpZ2h0KTtcbiAgICAgIHNlbGYuJGxpZ2h0Ym94LmZpbmQoJy5sYi1uZXh0TGluaycpLmhlaWdodChuZXdIZWlnaHQpO1xuICAgICAgc2VsZi5zaG93SW1hZ2UoKTtcbiAgICB9XG5cbiAgICBpZiAob2xkV2lkdGggIT09IG5ld1dpZHRoIHx8IG9sZEhlaWdodCAhPT0gbmV3SGVpZ2h0KSB7XG4gICAgICB0aGlzLiRvdXRlckNvbnRhaW5lci5hbmltYXRlKHtcbiAgICAgICAgd2lkdGg6IG5ld1dpZHRoLFxuICAgICAgICBoZWlnaHQ6IG5ld0hlaWdodFxuICAgICAgfSwgdGhpcy5vcHRpb25zLnJlc2l6ZUR1cmF0aW9uLCAnc3dpbmcnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcG9zdFJlc2l6ZSgpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvc3RSZXNpemUoKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRGlzcGxheSB0aGUgaW1hZ2UgYW5kIGl0cyBkZXRhaWxzIGFuZCBiZWdpbiBwcmVsb2FkIG5laWdoYm9yaW5nIGltYWdlcy5cbiAgTGlnaHRib3gucHJvdG90eXBlLnNob3dJbWFnZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1sb2FkZXInKS5zdG9wKHRydWUpLmhpZGUoKTtcbiAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItaW1hZ2UnKS5mYWRlSW4oJ3Nsb3cnKTtcblxuICAgIHRoaXMudXBkYXRlTmF2KCk7XG4gICAgdGhpcy51cGRhdGVEZXRhaWxzKCk7XG4gICAgdGhpcy5wcmVsb2FkTmVpZ2hib3JpbmdJbWFnZXMoKTtcbiAgICB0aGlzLmVuYWJsZUtleWJvYXJkTmF2KCk7XG4gIH07XG5cbiAgLy8gRGlzcGxheSBwcmV2aW91cyBhbmQgbmV4dCBuYXZpZ2F0aW9uIGlmIGFwcHJvcHJpYXRlLlxuICBMaWdodGJveC5wcm90b3R5cGUudXBkYXRlTmF2ID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIHRvdWNoIGV2ZW50cy4gSWYgc28sIHdlIHRha2UgdGhlIGNvbnNlcnZhdGl2ZSBhcHByb2FjaFxuICAgIC8vIGFuZCBhc3N1bWUgdGhhdCBtb3VzZSBob3ZlciBldmVudHMgYXJlIG5vdCBzdXBwb3J0ZWQgYW5kIGFsd2F5cyBzaG93IHByZXYvbmV4dCBuYXZpZ2F0aW9uXG4gICAgLy8gYXJyb3dzIGluIGltYWdlIHNldHMuXG4gICAgdmFyIGFsd2F5c1Nob3dOYXYgPSBmYWxzZTtcbiAgICB0cnkge1xuICAgICAgZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ1RvdWNoRXZlbnQnKTtcbiAgICAgIGFsd2F5c1Nob3dOYXYgPSAodGhpcy5vcHRpb25zLmFsd2F5c1Nob3dOYXZPblRvdWNoRGV2aWNlcykgPyB0cnVlIDogZmFsc2U7XG4gICAgfSBjYXRjaCAoZSkge31cblxuICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1uYXYnKS5zaG93KCk7XG5cbiAgICBpZiAodGhpcy5hbGJ1bS5sZW5ndGggPiAxKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLndyYXBBcm91bmQpIHtcbiAgICAgICAgaWYgKGFsd2F5c1Nob3dOYXYpIHtcbiAgICAgICAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItcHJldiwgLmxiLW5leHQnKS5jc3MoJ29wYWNpdHknLCAnMScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1wcmV2LCAubGItbmV4dCcpLnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbWFnZUluZGV4ID4gMCkge1xuICAgICAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1wcmV2Jykuc2hvdygpO1xuICAgICAgICAgIGlmIChhbHdheXNTaG93TmF2KSB7XG4gICAgICAgICAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItcHJldicpLmNzcygnb3BhY2l0eScsICcxJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbWFnZUluZGV4IDwgdGhpcy5hbGJ1bS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLW5leHQnKS5zaG93KCk7XG4gICAgICAgICAgaWYgKGFsd2F5c1Nob3dOYXYpIHtcbiAgICAgICAgICAgIHRoaXMuJGxpZ2h0Ym94LmZpbmQoJy5sYi1uZXh0JykuY3NzKCdvcGFjaXR5JywgJzEnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gRGlzcGxheSBjYXB0aW9uLCBpbWFnZSBudW1iZXIsIGFuZCBjbG9zaW5nIGJ1dHRvbi5cbiAgTGlnaHRib3gucHJvdG90eXBlLnVwZGF0ZURldGFpbHMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAvLyBFbmFibGUgYW5jaG9yIGNsaWNrcyBpbiB0aGUgaW5qZWN0ZWQgY2FwdGlvbiBodG1sLlxuICAgIC8vIFRoYW5rcyBOYXRlIFdyaWdodCBmb3IgdGhlIGZpeC4gQGh0dHBzOi8vZ2l0aHViLmNvbS9OYXRlV3JcbiAgICBpZiAodHlwZW9mIHRoaXMuYWxidW1bdGhpcy5jdXJyZW50SW1hZ2VJbmRleF0udGl0bGUgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICB0aGlzLmFsYnVtW3RoaXMuY3VycmVudEltYWdlSW5kZXhdLnRpdGxlICE9PSAnJykge1xuICAgICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLWNhcHRpb24nKVxuICAgICAgICAuaHRtbCh0aGlzLmFsYnVtW3RoaXMuY3VycmVudEltYWdlSW5kZXhdLnRpdGxlKVxuICAgICAgICAuZmFkZUluKCdmYXN0JylcbiAgICAgICAgLmZpbmQoJ2EnKS5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoJ3RhcmdldCcpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCQodGhpcykuYXR0cignaHJlZicpLCAkKHRoaXMpLmF0dHIoJ3RhcmdldCcpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICQodGhpcykuYXR0cignaHJlZicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYWxidW0ubGVuZ3RoID4gMSAmJiB0aGlzLm9wdGlvbnMuc2hvd0ltYWdlTnVtYmVyTGFiZWwpIHtcbiAgICAgIHZhciBsYWJlbFRleHQgPSB0aGlzLmltYWdlQ291bnRMYWJlbCh0aGlzLmN1cnJlbnRJbWFnZUluZGV4ICsgMSwgdGhpcy5hbGJ1bS5sZW5ndGgpO1xuICAgICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLW51bWJlcicpLnRleHQobGFiZWxUZXh0KS5mYWRlSW4oJ2Zhc3QnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kbGlnaHRib3guZmluZCgnLmxiLW51bWJlcicpLmhpZGUoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRvdXRlckNvbnRhaW5lci5yZW1vdmVDbGFzcygnYW5pbWF0aW5nJyk7XG5cbiAgICB0aGlzLiRsaWdodGJveC5maW5kKCcubGItZGF0YUNvbnRhaW5lcicpLmZhZGVJbih0aGlzLm9wdGlvbnMucmVzaXplRHVyYXRpb24sIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNlbGYuc2l6ZU92ZXJsYXkoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBQcmVsb2FkIHByZXZpb3VzIGFuZCBuZXh0IGltYWdlcyBpbiBzZXQuXG4gIExpZ2h0Ym94LnByb3RvdHlwZS5wcmVsb2FkTmVpZ2hib3JpbmdJbWFnZXMgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5hbGJ1bS5sZW5ndGggPiB0aGlzLmN1cnJlbnRJbWFnZUluZGV4ICsgMSkge1xuICAgICAgdmFyIHByZWxvYWROZXh0ID0gbmV3IEltYWdlKCk7XG4gICAgICBwcmVsb2FkTmV4dC5zcmMgPSB0aGlzLmFsYnVtW3RoaXMuY3VycmVudEltYWdlSW5kZXggKyAxXS5saW5rO1xuICAgIH1cbiAgICBpZiAodGhpcy5jdXJyZW50SW1hZ2VJbmRleCA+IDApIHtcbiAgICAgIHZhciBwcmVsb2FkUHJldiA9IG5ldyBJbWFnZSgpO1xuICAgICAgcHJlbG9hZFByZXYuc3JjID0gdGhpcy5hbGJ1bVt0aGlzLmN1cnJlbnRJbWFnZUluZGV4IC0gMV0ubGluaztcbiAgICB9XG4gIH07XG5cbiAgTGlnaHRib3gucHJvdG90eXBlLmVuYWJsZUtleWJvYXJkTmF2ID0gZnVuY3Rpb24oKSB7XG4gICAgJChkb2N1bWVudCkub24oJ2tleXVwLmtleWJvYXJkJywgJC5wcm94eSh0aGlzLmtleWJvYXJkQWN0aW9uLCB0aGlzKSk7XG4gIH07XG5cbiAgTGlnaHRib3gucHJvdG90eXBlLmRpc2FibGVLZXlib2FyZE5hdiA9IGZ1bmN0aW9uKCkge1xuICAgICQoZG9jdW1lbnQpLm9mZignLmtleWJvYXJkJyk7XG4gIH07XG5cbiAgTGlnaHRib3gucHJvdG90eXBlLmtleWJvYXJkQWN0aW9uID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgS0VZQ09ERV9FU0MgICAgICAgID0gMjc7XG4gICAgdmFyIEtFWUNPREVfTEVGVEFSUk9XICA9IDM3O1xuICAgIHZhciBLRVlDT0RFX1JJR0hUQVJST1cgPSAzOTtcblxuICAgIHZhciBrZXljb2RlID0gZXZlbnQua2V5Q29kZTtcbiAgICB2YXIga2V5ICAgICA9IFN0cmluZy5mcm9tQ2hhckNvZGUoa2V5Y29kZSkudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoa2V5Y29kZSA9PT0gS0VZQ09ERV9FU0MgfHwga2V5Lm1hdGNoKC94fG98Yy8pKSB7XG4gICAgICB0aGlzLmVuZCgpO1xuICAgIH0gZWxzZSBpZiAoa2V5ID09PSAncCcgfHwga2V5Y29kZSA9PT0gS0VZQ09ERV9MRUZUQVJST1cpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRJbWFnZUluZGV4ICE9PSAwKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlSW1hZ2UodGhpcy5jdXJyZW50SW1hZ2VJbmRleCAtIDEpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCAmJiB0aGlzLmFsYnVtLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VJbWFnZSh0aGlzLmFsYnVtLmxlbmd0aCAtIDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnbicgfHwga2V5Y29kZSA9PT0gS0VZQ09ERV9SSUdIVEFSUk9XKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50SW1hZ2VJbmRleCAhPT0gdGhpcy5hbGJ1bS5sZW5ndGggLSAxKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlSW1hZ2UodGhpcy5jdXJyZW50SW1hZ2VJbmRleCArIDEpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCAmJiB0aGlzLmFsYnVtLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VJbWFnZSgwKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gQ2xvc2luZyB0aW1lLiA6LShcbiAgTGlnaHRib3gucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZGlzYWJsZUtleWJvYXJkTmF2KCk7XG4gICAgJCh3aW5kb3cpLm9mZigncmVzaXplJywgdGhpcy5zaXplT3ZlcmxheSk7XG4gICAgdGhpcy4kbGlnaHRib3guZmFkZU91dCh0aGlzLm9wdGlvbnMuZmFkZUR1cmF0aW9uKTtcbiAgICB0aGlzLiRvdmVybGF5LmZhZGVPdXQodGhpcy5vcHRpb25zLmZhZGVEdXJhdGlvbik7XG4gICAgJCgnc2VsZWN0LCBvYmplY3QsIGVtYmVkJykuY3NzKHtcbiAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJ1xuICAgIH0pO1xuICAgIGlmICh0aGlzLm9wdGlvbnMuZGlzYWJsZVNjcm9sbGluZykge1xuICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdsYi1kaXNhYmxlLXNjcm9sbGluZycpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gbmV3IExpZ2h0Ym94KCk7XG59KSk7XG4iXX0=
