<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Configuring multi-factor authentication - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico_11_Documentation_Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68880397"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico_11_Documentation_Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Managing_users.html">Managing users</a></li>
                                                                                     <li><a href="User_registration_and_authentication.html">User registration and authentication</a></li>
                                                            </ul>
</div>            <h1 id="src-68880397"> <span>Configuring multi-factor authentication</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
        $page.content
<p   
>Multi-factor authentication adds an additional layer of security to the sign-in process. In addition to the basic password, users need to verify their identity using one or more additional security components.</p>
<p   
>By default, Kentico provides support for a combination of standard forms authentication with a username and password, and a <strong class=" ">passcode</strong> generated by an authenticator application using the <a  class="external-link" href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm">Time-based One-time Password Algorithm</a> (TOTP), for example <a  class="external-link" href="https://support.google.com/accounts/answer/1066447?hl=en">Google Authenticator</a>.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The authenticator application must be compatible with <a  class="external-link" href="https://tools.ietf.org/html/rfc6238">RFC 6238</a>.</p>
        </div>
    </div>
<p   
>The default multi-factor authentication process consists of the following steps:</p>
<ol class=" "><li class=" "><p   
>A user wants to sign in and enters their username and password.</p>
</li><li class=" "><p   
>The system verifies the credentials, displays a secret key and requests a passcode.</p>
</li><li class=" "><p   
>The user enters the secret key into their TOTP authenticator application.</p>
</li><li class=" "><p   
>The application generates a temporary passcode.</p>
</li><li class=" "><p   
>The user types the passcode into the Kentico authentication form.</p>
</li><li class=" "><p   
>The system signs in the user.</p>
</li></ol><p   
><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68880397/Multifactor_authentication_schema.png" alt="images/download/attachments/68880397/Multifactor_authentication_schema.png" width="500"  />
        <br/><span class="caption">The process of signing in to Kentico using multi-factor authentication</span>
    </p>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-68880397_Configuringmultifactorauthentication-Securityandlimitations">Security and limitations</a></p>
</li><li class=" "><p   
><a   href="#src-68880397_Configuringmultifactorauthentication-Enablingmulti-factorauthentication">Enabling multi-factor authentication</a></p>
</li><li class=" "><p   
><a   href="#src-68880397_Configuringmultifactorauthentication-Resettingthesecretkeyforusers">Resetting the secret key for users</a></p>
</li><li class=" "><p   
><a   href="#src-68880397_Configuringmultifactorauthentication-Allowinguserstoenableordisablemulti-factorauthentication">Allowing users to enable or disable multi-factor authentication</a></p>
</li><li class=" "><p   
><a   href="#src-68880397_Configuringmultifactorauthentication-Customizingmulti-factorauthentication">Customizing multi-factor authentication</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="Settings_-_Authentication.html">Settings - Authentication</a></p>
</li><li class=" "><p   
><a   href="Handling_custom_multi-factor_authentication.html">Handling custom multi-factor authentication</a></p>
</li></ul>        </div>
    </div>
<p   
>The system only displays the secret key on the first sign-in after multi-factor authentication is enabled. The next time the user signs in, the steps related to the secret key are no longer required, and the user only generates a new passcode in their authenticator application.</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Passcode expiration</strong></p>
<p   
>By default, the system accepts passcodes generated <strong class=" ">5 minutes</strong> before or after the time of the authentication attempt. For example, if a user&#39;s authenticator application and your website server have exactly synchronized time settings, users have 5 minutes to enter the passcode.</p>
        </div>
    </div>
    <h3 id="src-68880397_Configuringmultifactorauthentication-Securityandlimitations" class="heading "><span>Security and limitations</span></h3>
<p  class="confluence-link" 
>The multi-factor authentication is:</p>
<ul class=" "><li class="confluence-link "><p   
>Available only for the default forms authentication method.</p>
</li><li class="confluence-link "><p   
>Not compatible with the <a   href="Autocomplete_deactivation.html">Autocomplete</a> functionality.</p>
</li></ul><p  class="confluence-link" 
>For security reasons, we strongly recommend limiting the <a   href="Invalid_sign-in_attempts.html">maximum number of invalid sign-in attempts</a> to a small value, for example 5. Incorrectly submitted passcodes count as invalid sign-in attempts, so potential attackers cannot guess a valid passcode in the specified number of attempts.</p>
<p  class="confluence-link" 
>If the <a   href="Screen_locking.html">screen locking</a> feature is enabled, entering of the passcode is also required when unlocking the screen.</p>
    <h3 id="src-68880397_Configuringmultifactorauthentication-Enablingmulti-factorauthentication" class="heading "><span>Enabling multi-factor authentication</span></h3>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Notes</strong></p>
<ul class=" "><li class=" "><p   
>The multi-factor authentication settings have a global effect. They cannot be configured differently for individual sites.</p>
</li><li class=" "><p   
>Keep the <strong class=" ">Display secret key</strong> setting enabled unless you have a <a   href="Handling_custom_multi-factor_authentication.html">custom implementation</a> of multi-factor authentication. With the default functionality, users need to enter the secret key into their authenticator application during their first sign-in to generate valid passcodes.</p>
</li></ul><p   
>See also: <a   href="Settings_-_Authentication.html">Settings - Authentication</a></p>
        </div>
    </div>
    <h4 id="src-68880397_Configuringmultifactorauthentication-Enablingmulti-factorauthenticationforselectedusers" class="heading "><span>Enabling multi-factor authentication for selected users</span></h4>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Settings</strong> application.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Security &amp; Membership -&gt; Authentication</strong> category.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Enable multi-factor authentication</strong> check box.</p>
</li><li class=" "><p   
>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p   
>Open the <strong class=" ">Users</strong> application.</p>
</li><li class=" "><p   
>Edit the users for which you want to enable multi-factor authentication and enable the <strong class=" ">Multi-factor authentication is required</strong> option.</p>
</li></ol><p   
>The given users will need to use multi-factor authentication when signing in to your website (or the Kentico administration interface).</p>
<p   
>You can also set up your site&#39;s registration or user account editing forms to allow users to choose whether to enable multi-factor authentication for their accounts. See <a   href="#src-68880397_Configuringmultifactorauthentication-Allowinguserstoenableordisablemulti-factorauthentication">Allowing users to enable or disable multi-factor authentication</a>.</p>
    <h4 id="src-68880397_Configuringmultifactorauthentication-Enablingmulti-factorauthenticationforallusersinthesystem" class="heading "><span>Enabling multi-factor authentication for all users in the system</span></h4>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Keeping administrator access</strong></p>
<p   
>After you enable multi-factor authentication globally, make sure that you do not lose administrator access to the Kentico interface. During the next sign-in under your administrator account, <strong class=" ">note down the multi-factor secret key</strong> for your account.</p>
<p   
>The system only displays the secret key during the first sign-in. If you do not save the secret key or immediately set up your authenticator, you will lose access to the administration interface.</p>
        </div>
    </div>
<p   
>To enforce multi-factor authentication for all users in the system:</p>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Settings</strong> application.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Security &amp; Membership -&gt; Authentication</strong> category.</p>
</li><li class=" "><p   
>Select the following check boxes:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">Enable multi-factor authentication</strong></p>
</li><li class=" "><p   
><strong class=" ">Multi-factor authentication is required globally</strong></p>
</li></ul></li><li class=" "><p   
>Click <strong class=" ">Save</strong>.</p>
</li></ol><p   
>All users now need to use multi-factor authentication when signing in to your website (or the Kentico administration interface). The <strong class=" ">Multi-factor authentication is required</strong> option of individual user accounts has no effect with this configuration.</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Recovering administrator access</strong></p>
<p   
>If you enable multi-factor authentication globally and lose access to your administrator account (for example if you lose the secret key without setting up your authenticator), you can restore access by adding the <strong class=" ">CMSAdminEmergencyReset </strong>key to the <i class=" ">appSettings</i> section of your project&#39;s web.config. For example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">key</code><code class="plain">=</code><code class="string">"CMSAdminEmergencyReset"</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"admin;password;true"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
<ul class=" "><li class=" "><p   
><i class=" ">admin</i> &ndash; the user name of the new account.</p>
</li><li class=" "><p   
><i class=" ">password</i> &ndash; the password for the new account &ndash; you should change it to your own value.</p>
</li><li class=" "><p   
>The third parameter is optional and indicates whether you want to create a new user with the Global administrator <a   href="User_management.html">privilege level</a>.</p>
</li><li class=" "><p   
>The system automatically deletes the key after you gain access to the administration interface.</p>
</li></ul>        </div>
    </div>
    <h3 id="src-68880397_Configuringmultifactorauthentication-Resettingthesecretkeyforusers" class="heading "><span>Resetting the secret key for users</span></h3>
<p   
>For multi-factor authentication to work, users need to enter a shared secret key into their authenticator application. The system displays this secret key to each user <strong class=" ">once</strong> during their first sign-in (after multi-factor authentication is enabled).</p>
<p   
>If a user loses the secret key before initializing their authenticator application, they will not be able to sign in. A new secret key is also required if a user wants to switch to a different authenticator application.</p>
<p   
>In these situations, administrators can reset the multi-factor secret of individual users:</p>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Users</strong> application.</p>
</li><li class=" "><p   
>Edit the given user account.</p>
</li><li class=" "><p   
>On the <strong class=" ">General</strong> tab, click the <strong class=" ">Reset</strong> button next to the <strong class=" ">Reset multi-factor secret</strong> field.</p>
</li></ol><p   
>On the user&#39;s next sign-in attempt, the system displays a new secret key, which the user can enter into their authenticator application.</p>
    <h3 id="src-68880397_Configuringmultifactorauthentication-Allowinguserstoenableordisablemulti-factorauthentication" class="heading "><span>Allowing users to enable or disable multi-factor authentication</span></h3>
<p   
>If you have multi-factor authentication enabled <a   href="#src-68880397_Configuringmultifactorauthentication-Enablingmulti-factorauthenticationforselectedusers">only for selected users</a>, you can allow users to choose whether to enable multi-factor authentication for their account.</p>
<ul class=" "><li class=" "><p   
>The <strong class=" ">Registration form</strong> web part automatically allows new users to choose whether to use multi-factor authentication.</p>
</li><li class=" "><p   
>With the <strong class=" ">Custom registration form</strong> web part, you can allow new users to choose by making the <i class=" ">UserMFRequired</i> field visible in the corresponding <a   href="Creating_alternative_forms.html">alternative form</a>.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>See also: <a   href="Using_the_Registration_form_and_Custom_registration_form_web_parts.html">Using the Registration form and Custom registration form web parts</a></p>
        </div>
    </div>
</li><li class=" "><p   
>For user profile editing pages (on the live site or in the administration interface), you can allow users to enable or disable multi-factor authentication by making the <i class=" ">UserMFRequired</i> field visible in the corresponding <a   href="Creating_alternative_forms.html">alternative form</a>.</p>
</li></ul><p   
>To configure the visibility of the <i class=" ">UserMFRequired</i> field in user <a   href="Creating_alternative_forms.html">alternative forms</a>:</p>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Modules</strong> application.</p>
</li><li class=" "><p   
>Edit the <strong class=" ">Membership </strong>module.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Classes</strong> tab and edit the <strong class=" ">User</strong> class.</p>
</li><li class=" "><p   
>On the <strong class=" ">Alternative forms</strong> tab, edit the form that you use.</p>
</li><li class=" "><p   
>On the <strong class=" ">Fields</strong> tab, select the <strong class=" ">UserMFRequired</strong> field.</p>
</li><li class=" "><p   
>Enable the <strong class=" ">Display field in the editing form</strong> option.</p>
</li><li class=" "><p   
>Configure any required <strong class=" ">Field appearance</strong> settings.</p>
</li><li class=" "><p   
>Click <strong class=" ">Save</strong>.</p>
</li></ol><p   
>The given form then allows users to enable or disable multi-factor authentication for their user account.</p>
    <h3 id="src-68880397_Configuringmultifactorauthentication-Customizingmulti-factorauthentication" class="heading "><span>Customizing multi-factor authentication</span></h3>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If you wish to use a completely different authentication factor or passcode delivery method, you can implement your own solution (for example custom codes sent via email, SMS, etc.).</p>
<p   
>See: <a   href="Handling_custom_multi-factor_authentication.html">Handling custom multi-factor authentication</a></p>
        </div>
    </div>
<p   
>Developers can customize the parameters of the multi-factor authentication functionality by implementing a <a   href="Customizing_providers.html">custom helper class</a> that inherits from the <strong class=" ">CMS.Membership.MFAuthenticationHelper</strong> class.</p>
<p   
>The following example demonstrates how to register a custom helper that changes the length and validity interval of multi-factor authentication passcodes.</p>
<ol class=" "><li class=" "><p   
>Open your Kentico solution in Visual Studio.</p>
</li><li class=" "><p   
>Create a new <i class=" ">Class Library</i> project in the Kentico solution (or reuse an existing custom project).</p>
</li><li class=" "><p   
>Add references to the required Kentico libraries (DLLs) for the new project:<br/></p>
<ul class=" "><li class=" "><p   
>Right-click the project and select <strong class=" ">Add -&gt; Reference</strong>.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Browse</strong> tab of the <strong class=" ">Reference manager</strong> dialog, click <strong class=" ">Browse</strong> and navigate to the <i class=" "><strong class=" ">Lib</strong> </i>folder of your Kentico web project.</p>
</li><li class=" "><p   
>Add references to the following libraries (and any others that you may need in your custom code):</p>
<ul class=" "><li class=" "><p   
><strong class=" ">CMS.Base.dll</strong></p>
</li><li class=" "><p   
><strong class=" ">CMS.Core.dll</strong></p>
</li><li class=" "><p   
><strong class=" ">CMS.DataEngine.dll</strong></p>
</li><li class=" "><p   
><strong class=" ">CMS.Helpers.dll</strong></p>
</li><li class=" "><p   
><strong class=" ">CMS.Membership.dll</strong></p>
</li></ul></li></ul></li><li class=" "><p   
>Reference the custom project from the Kentico web project <i class=" ">(CMSApp</i> or <i class=" ">CMS)</i>.</p>
</li><li class=" "><p   
>Edit the custom project&#39;s <strong class=" ">AssemblyInfo.cs</strong> file (in the <i class=" ">Properties</i> folder).</p>
</li><li class=" "><p   
>Add the <strong class=" ">AssemblyDiscoverable</strong> assembly attribute:<br/></p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">[assembly:AssemblyDiscoverable]</code></div>
</div>
    </div>
</li><li class=" "><p   
>Add a new class under the custom project, inheriting from the <strong class=" ">MFAuthenticationHelper</strong> class.<br/></p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Membership;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Registers the custom MFAuthenticationHelper</code></div>
<div class="line"><code class="plain">[assembly: RegisterCustomHelper(</code><code class="keyword">typeof</code><code class="plain">(CustomMFAuthenticationHelper))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomMFAuthenticationHelper : MFAuthenticationHelper</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The time interval for which the system considers multi-factor passcodes to be valid.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Calculated as a time interval before or after the time of the authentication attempt. </code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The default value is 5 minutes.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> TimeSpan ClockDriftTolerance</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">get</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Sets the passcode validity to 2 minutes before or after the time of the authentication</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">return</code><code class="plain"> TimeSpan.FromMinutes(2);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The length of the multi-factor passcode. The default value is 6.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Important: For the authentication to work, the value must match the number of characters used </code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// by the authenticator applications that generate passcodes for your users.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">int</code><code class="plain"> PasscodeLength</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">get</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Sets the passcode length to 10 characters</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">return</code><code class="plain"> 10;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Save all changes and <strong class=" ">Build</strong> the custom project.<br/></p>
</li></ol><p   
>The custom helper in the example overrides the <strong class=" ">ClockDriftTolerance</strong> and <strong class=" ">PasscodeLength</strong> properties of the default <i class=" ">MFAuthenticationHelper</i>. When users attempt to sign-in with multi-factor authentication enabled, the system applies the customizations &ndash; passcodes must be 10 characters long and the validity tolerance is reduced to 2 minutes.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
