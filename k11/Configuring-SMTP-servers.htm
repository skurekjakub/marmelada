<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Configuring SMTP servers - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico-11-Documentation-Home.htm" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881948"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.htm">Kentico 11 Documentation</a></li>
                                                                                     <li><a href="Configuring-Kentico.htm">Configuring Kentico</a></li>
                                                            </ul>
</div>            <h1 id="src-68881948"> <span>Configuring SMTP servers</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<p   
>Kentico includes many features that utilize email messages as part of their functionality, such as:</p>
<ul class=" "><li class=" "><p   
>Automatic <a   href="k11/Setting-up-content-notifications.htm">notifications</a></p>
</li><li class=" "><p   
><a   href="k11/Email-marketing.htm">Newsletters and email campaigns</a></p>
</li><li class=" "><p   
>Various types of confirmation messages</p>
</li><li class=" "><p   
>Content subscriptions</p>
</li></ul><p   
>To allow the application to send out emails, you need to register and configure at least one SMTP server in the administration interface.</p>
    <h3 id="src-68881948_ConfiguringSMTPservers-SettingupthedefaultSMTPserver" class="heading "><span>Setting up the default SMTP server</span></h3>
<p   
>To register the main SMTP server:</p>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Settings</strong> application.<strong class=" "><br/></strong></p>
</li><li class=" "><p   
>Navigate to the<strong class=" "> System -&gt; Emails</strong> category.</p>
</li><li class=" "><p   
>Select an option in the <strong class=" ">Site</strong> selector:<br/></p>
<ul class=" "><li class=" "><p   
>Choose a specific site to register a server dedicated to a single website.</p>
</li><li class=" "><p   
>Choose <i class=" "><strong class=" ">(global)</strong> </i>to register a designated global server &ndash; the server processes emails from all sites in the system and also handles emails that are not related to any specific website.</p>
</li></ul></li><li class=" "><p   
>Fill in the following settings:<br/></p>
<ul class=" "><li class=" "><p   
><strong class=" ">SMTP server</strong> &ndash; enter the domain name or IP address of the server. Enter <i class=" ">localhost</i> to use a server provided by your local machine.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">SMTP server on non-standard port</strong></p>
<p   
>If you are running SMTP server on a non-standard port (other than 25), you need to specify the port. For example: <i class=" ">127.0.0.1:26</i></p>
        </div>
    </div>
</li><li class=" "><p   
><strong class=" ">SMTP server user</strong> &ndash; if the server requires authentication, type the user name here.</p>
</li><li class=" "><p   
><strong class=" ">SMTP server password</strong> &ndash; if the server requires authentication, type the password here.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Info</strong>: After you enter and save a password, the field always displays 8 &quot;masking&quot; characters, even if the password is longer or shorter. This measure helps protect your password.</p>
        </div>
    </div>
</li><li class=" "><p   
><strong class=" ">Use SSL</strong> &ndash; enable to use an SSL secured connection to the SMTP server. The server must be configured for SSL in order for this to work.</p>
</li></ul></li><li class=" "><p   
>Click <strong class=" ">Save</strong>.</p>
</li></ol><p   
>The system uses the primary server as the default option when sending emails.</p>
<p   
><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68881948/Setting_Default_SMTP.png" alt="images/download/attachments/68881948/Setting_Default_SMTP.png" width="500"  />
        <br/><span class="caption">Configuring the primary global SMTP server</span>
    </p>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="k11/#src-68881948_ConfiguringSMTPservers-SettingupthedefaultSMTPserver">Setting up the default SMTP server</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68881948_ConfiguringSMTPservers-ConfiguringadditionalSMTPservers">Configuring additional SMTP servers</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68881948_ConfiguringSMTPservers-Configuringemailprocessing">Configuring email processing</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68881948_ConfiguringSMTPservers-TestingSMTPservers">Testing SMTP servers</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68881948_ConfiguringSMTPservers-Debuggingemails">Debugging emails</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="k11/Sending-emails.htm">Sending emails</a></p>
</li></ul>        </div>
    </div>
    <h3 id="src-68881948_ConfiguringSMTPservers-ConfiguringadditionalSMTPservers" class="heading "><span>Configuring additional SMTP servers</span></h3>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Kentico EMS required</strong></p>
<p   
>You need the <strong class=" ">Kentico EMS</strong> license to register multiple SMTP servers.</p>
        </div>
    </div>
<p   
>In addition to the default server, you can add any number of servers in the <strong class=" ">SMTP servers</strong> application. Having multiple SMTP servers allows the system to send out a greater volume of email traffic. Emails use the extra servers whenever the default server is busy.</p>
<p   
>You can manage existing servers through the following actions:</p>
<ul class=" "><li class=" "><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/68879208/edit.png" alt="images/download/attachments/68879208/edit.png"   />
 <strong class=" ">Edit</strong> &ndash; opens the server&#39;s configuration interface</p>
</li><li class=" "><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/68879208/delete.png" alt="images/download/attachments/68879208/delete.png"   />
 <strong class=" ">Delete</strong></p>
</li><li class=" "><p   
><img  class="confluence-embedded-image"  src="images/download/attachments/68879208/approve.png" alt="images/download/attachments/68879208/approve.png"   />
 <strong class=" ">Enable</strong> / <img  class="confluence-embedded-image"  src="images/download/attachments/68879208/cancel.png" alt="images/download/attachments/68879208/cancel.png"   />
 <strong class=" ">Disable</strong> &ndash; enables or disables the server within the context of Kentico</p>
</li></ul><p   
><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68881948/SMTP_Server_List.png" alt="images/download/attachments/68881948/SMTP_Server_List.png"   />
        <br/><span class="caption">Viewing the list of SMTP server registered in the system</span>
    </p>
<p   
>To register new servers, click <strong class=" ">New SMTP server</strong>.</p>
<p   
>When creating new SMTP servers or editing existing ones on the <strong class=" ">General</strong> tab, you can fill in the same options as described for the default server. In addition, you can choose the <strong class=" ">delivery method</strong> for emails:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">Network</strong> &ndash; emails are sent directly to the SMTP server defined by the server name and credentials. This is the default setting for the default SMTP server defined in <i class=" ">Settings -&gt; System -&gt; Emails</i>.</p>
</li><li class=" "><p   
><strong class=" ">Pickup directory</strong> &ndash; emails are copied to a folder on the disk (defined by the Pickup directory option), from where they are processed by the SMTP server. Note that you need to grant the IIS_IUSRS group write permissions for the chosen folder.</p>
</li><li class=" "><p   
><strong class=" ">Pickup directory from IIS</strong> &ndash; similar to the Pickup directory, but may be more difficult to configure. Choose this method if you are already using Microsoft SMTP servers on Windows Server operating systems. You also need to install the SMTP server feature into your IIS and configure it properly. See <a  class="external-link" href="http://technet.microsoft.com/en-us/library/cc772058%28v=ws.10%29.aspx">Configure SMTP Email (IIS 7)</a> for more information. Note that you need to ensure that the NETWORK SERVICE group has write permissions for the defined pickup folder.</p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Microsoft Azure supports only the <strong class=" ">Network</strong> method.</p>
        </div>
    </div>
<p   
>You may also select the server&#39;s <strong class=" ">Priority</strong>. See the <i class=" ">Configuring email processing</i> section below for more information about server priority.</p>
<p   
><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68881948/SMTP_Server_Edit.png" alt="images/download/attachments/68881948/SMTP_Server_Edit.png" width="500"  />
        <br/><span class="caption">Editing an SMTP server</span>
    </p>
<p   
>If there are multiple sites running under your application, you can assign servers to individual websites on the <strong class=" ">Sites</strong> tab. SMTP servers can either be global or limited to one or more specific websites.</p>
    <h3 id="src-68881948_ConfiguringSMTPservers-Configuringemailprocessing" class="heading "><span>Configuring email processing</span></h3>
<p   
>You can configure how the system delivers emails to the SMTP servers through the settings in <strong class=" ">Settings -&gt; System -&gt; Emails</strong>.</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Enabling sending of emails</strong></p>
<p   
>We recommend keeping the <strong class=" ">Enable emails</strong> setting enabled both globally and for all sites (switch between the options using the <strong class=" ">Site</strong> selector in the <i class=" ">Settings</i> application).</p>
<p   
>Having the setting enabled globally is required for the system to send emails that are not related to a specific site (for example emails sent by <a   href="k11/Marketing-automation.htm">marketing automation</a> processes, etc.).</p>
        </div>
    </div>
<p   
>If <strong class=" ">Enable e</strong><strong class=" ">mail queue</strong> is selected, the system temporarily stores all outgoing emails in the database instead of sending them directly to the SMTP servers. This allows advanced email processing and resending of mails that are lost due to errors. <i class=" ">Using the email queue is highly recommended</i> when sending out large amounts of emails over a short amount of time. Refer to <a   href="k11/Sending-emails.htm">Sending emails</a> to learn more about the email queue.</p>
<p   
>The system periodically processes the email queue (every minute by default) and asynchronously distributes the stored emails to the SMTP servers:</p>
<ol class=" "><li class=" "><p   
>A predefined amount of emails is loaded from the queue as a batch.</p>
</li><li class=" "><p   
>The system goes through the emails one by one and assigns them to servers according to their priority and availability.<br/></p>
<ul class=" "><li class=" "><p   
>The default SMTP server always has the highest priority.</p>
</li><li class=" "><p   
>Other servers are ordered according to the value of their <strong class=" ">Priority</strong> property (i.e. emails are first assigned to <i class=" ">High</i> priority servers, then <i class=" ">Normal</i> and finally <i class=" ">Low</i>).</p>
</li></ul></li><li class=" "><p   
>When a server receives an email, the server is flagged as busy until the sending is complete.</p>
</li><li class=" "><p   
>The system loads a new batch from the queue and continues assigning individual emails to available servers.</p>
</li></ol><p   
>This process is repeated until all emails in the queue are mailed out.</p>
    <h4 id="src-68881948_ConfiguringSMTPservers-Batchsize" class="heading "><span>Batch size</span></h4>
<p   
>The maximum number of emails which is loaded from the database in a single batch is determined by the value of the <strong class=" ">Batch size</strong> setting. The batch size affects all sites in the system, so it is only available if the <i class=" ">(global)</i> option is selected in the <strong class=" ">Site</strong> selector on the top left of the settings page.</p>
<p   
>The value of the batch size affects the number and frequency of <strong class=" ">database queries</strong>. If you set the batch size too large, the system will have to process a lot of database data at one time. Using a smaller batch size increases the frequency of database queries and may reduce the database performance.</p>
    <h3 id="src-68881948_ConfiguringSMTPservers-TestingSMTPservers" class="heading "><span>Testing SMTP servers</span></h3>
<p   
>To confirm that your SMTP servers are configured correctly and available, you can send testing emails in the <strong class=" ">System</strong> application on the <strong class=" ">Email</strong> tab.</p>
    <h3 id="src-68881948_ConfiguringSMTPservers-Debuggingemails" class="heading "><span>Debugging emails</span></h3>
<p   
>Debugging can help resolve problems with emails sent by Kentico.</p>
<p   
>To enable email debugging, add the following keys to the <i class=" ">configuration/appSettings</i> <strong class=" "></strong>section of your project&#39;s <i class=" ">web.config</i> file:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">key</code><code class="plain">=</code><code class="string">"CMSLogEmails"</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">key</code><code class="plain">=</code><code class="string">"CMSDebugEmails"</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
</div>
    </div>
<ul class=" "><li class=" "><p   
><strong class=" ">CMSLogEmails</strong> &ndash; logs all sent emails to the <strong class=" ">~/App_Data/logemails.log</strong> file. The log contains each email&#39;s:</p>
<ul class=" "><li class=" "><p   
>Timestamp, identifying when the email was sent</p>
</li><li class=" "><p   
>Recipients</p>
</li><li class=" "><p   
>Sender</p>
</li><li class=" "><p   
>Subject</p>
</li><li class=" "><p   
>Custom headers inserted via the Kentico API</p>
</li><li class=" "><p   
>Custom header encoding (UTF-8 by default)</p>
</li></ul></li><li class=" "><p   
><strong class=" ">CMSDebugEmails</strong> &ndash; disables sending of emails to the actual recipients. The system only logs emails into the <a   href="k11/Working-with-the-system-event-log.htm">event log</a>. Helpful if you need to test the functionality, but do not want the emails to actually reach the recipients.<br/></p>
<ul class=" "><li class=" "><p   
>To view the event log, open the <strong class=" ">Event log</strong> application.</p>
</li><li class=" "><p   
>The emails are logged as <strong class=" ">Information</strong> type events.</p>
</li><li class=" "><p   
>The <strong class=" ">Event code</strong> column contains the recipient&#39;s address.</p>
</li><li class=" "><p   
>The system randomly generates <i class=" ">Sending failed for &lt;recipient&#39;s email address&gt;</i> errors to simulate sending errors.</p>
</li></ul></li></ul>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
