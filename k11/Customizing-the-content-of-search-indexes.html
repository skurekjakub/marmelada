<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Customizing the content of search indexes - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882123"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Configuring-Kentico.html">Configuring Kentico</a></li>
                                                                                     <li><a href="Setting-up-search-on-your-website.html">Setting up search on your website</a></li>
                                                            </ul>
</div>            <h1 id="src-68882123"> <span>Customizing the content of search indexes</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<p   
>The system provides a way to customize the content that   <a   href="Setting-up-search-on-your-website">smart search indexes</a> store for pages or objects. You can add external data into the index, or parse and otherwise modify the text that the smart search adds to the index by default. Such customizations allow you to extend and change how the search finds matching results.</p>
<p   
>To customize the content of indexes, implement   <a   href="Handling-global-events">event handlers</a> for the following events:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">DocumentsEvents.GetContent.Execute</strong> &ndash; occurs before the system writes a page&#39;s data into smart search indexes.</p>
</li><li class=" "><p   
><strong class=" ">ObjectEvents.GetContent.Execute</strong> &ndash; occurs before the system writes the data of objects into search indexes. You can also use <i class=" ">&lt;name&gt;Info.TYPEINFO.Events</i> instead of <i class=" ">ObjectEvents</i> to handle the GetContent events for specific object types.</p>
</li></ul><p   
>You need to assign handlers for the events at the beginning of the application&#39;s life cycle &ndash; create a   <a   href="Initializing-modules-to-run-custom-code">custom module class</a> and override the module&#39;s <strong class=" ">OnInit</strong> method.</p>
<p   
>The system triggers <strong class=" ">GetContent</strong> events when a page or object is updated and when rebuilding search indexes.</p>
<p   
>Inside the GetContent event handler methods, you can access the search index content via the <strong class=" ">Content</strong> property of the handler&#39;s <strong class=" ">DocumentSearchEventArgs</strong> or <strong class=" ">ObjectEventArgs</strong> parameter (string type).</p>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
>  <a   href="#src-68882123_safe-id-Q3VzdG9taXppbmd0aGVjb250ZW50b2ZzZWFyY2hpbmRleGVzLUV4YW1wbGUtQWRkaW5nZGF0YWZyb21hdXNlcmZpZWxkdG9wYWdlaW5kZXhlcyhEb2N1bWVudEV2ZW50cyk">Example - Adding data from a user field to page indexes (DocumentEvents)</a></p>
</li><li class=" "><p   
>  <a   href="#src-68882123_safe-id-Q3VzdG9taXppbmd0aGVjb250ZW50b2ZzZWFyY2hpbmRleGVzLUV4YW1wbGUtSW5kZXhpbmdwZXJzb25hbGNhdGVnb3J5bmFtZXNmb3J1c2VycyhPYmplY3RFdmVudHMp">Example - Indexing personal category names for users (ObjectEvents)</a></p>
</li><li class=" "><p   
>  <a   href="#src-68882123_safe-id-Q3VzdG9taXppbmd0aGVjb250ZW50b2ZzZWFyY2hpbmRleGVzLUV4YW1wbGUtSW5kZXhpbmd0aGVuYW1lc29mYXNzaWduZWRwcm9kdWN0b3B0aW9uc2ZvcnByb2R1Y3RwYWdlcyhEb2N1bWVudEV2ZW50cyk">Example - Indexing the names of assigned product options for product pages (DocumentEvents)</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
>  <a   href="Creating-local-search-indexes">Creating local search indexes</a></p>
</li><li class=" "><p   
>  <a   href="Creating-Azure-Search-indexes">Creating Azure Search indexes</a></p>
</li><li class=" "><p   
>  <a   href="Handling-global-events">Handling global events</a></p>
</li></ul>        </div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Search index content</strong></p>
<p   
>Within search indexes, the content managed by the <strong class=" ">GetContent</strong> events is stored in a system field that combines values from a large number of other fields (all fields that have the <i class=" ">Content</i> flag enabled in the search settings of Kentico object fields). The name of the field within indexes depends on the type of the index:</p>
<ul class=" "><li class=" "><p   
>  <a   href="Using-locally-stored-search-indexes">Locally stored indexes</a>: <strong class=" ">_content</strong></p>
</li><li class=" "><p   
>  <a   href="Using-Azure-Search">Azure Search indexes</a>: <strong class=" ">sys_content</strong></p>
</li></ul>        </div>
    </div>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Index rebuilding requirements</strong></p>
<p   
>If you modify the external data that your GetContent event handlers add to the index, the system does not automatically update the content of the corresponding indexes. To ensure that your indexes are up to date after making changes to the external data, you need to manually <strong class=" ">rebuild</strong> the indexes (or set up automatic updating of the search indexes via additional custom code).</p>
<p   
>For example, if you use GetContent handlers to add <strong class=" ">user</strong> data into <strong class=" ">page</strong> indexes:</p>
<ul class=" "><li class=" "><p   
>Saving a page covered by the index updates the content of the index, including the external user data.</p>
</li><li class=" "><p   
>Saving user objects directly does NOT update the index &ndash; a rebuild is required.</p>
</li></ul>        </div>
    </div>
    <h3 id="src-68882123_safe-id-Q3VzdG9taXppbmd0aGVjb250ZW50b2ZzZWFyY2hpbmRleGVzLUV4YW1wbGUtQWRkaW5nZGF0YWZyb21hdXNlcmZpZWxkdG9wYWdlaW5kZXhlcyhEb2N1bWVudEV2ZW50cyk" class="heading "><span>Example - Adding data from a user field to page indexes (DocumentEvents)</span></h3>
<p   
>Pages in Kentico can have a   <a   href="User-management">user</a> assigned as the owner. The following example shows how to add the <strong class=" ">Description</strong> value from the user settings of a page&#39;s owner into the search index content of each page.</p>
<ol class=" "><li class=" "><p   
>Open your Kentico web project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p   
>Create a   <a   href="Initializing-modules-to-run-custom-code">custom module class</a>. For example, name the class <strong class=" ">CustomSmartSearchModule.cs</strong>.</p>
<ul class=" "><li class=" "><p   
>Either add the class into a custom project within the Kentico solution (recommended) or directly into the Kentico web project (into a custom folder under the <strong class=" ">CMSApp</strong> project for <i class=" ">web application</i> installations, into the <strong class=" ">App_Code</strong> folder for <i class=" ">web site</i> installations).<br/><br/></p>
</li></ul></li><li class=" "><p   
>Override the module&#39;s <strong class=" ">OnInit</strong> method and assign a handler to the <strong class=" ">DocumentEvents.GetContent.Execute</strong> event.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DocumentEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Membership;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Registers the custom module into the system</code></div>
<div class="line"><code class="plain">[assembly: RegisterModule(</code><code class="keyword">typeof</code><code class="plain">(CustomSmartSearchModule))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomSmartSearchModule : Module</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Module class constructor, the system registers the module under the name "CustomSmartSearch"</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> CustomSmartSearchModule()</code></div>
<div class="line"><code class="plain">        : </code><code class="keyword">base</code><code class="plain">(</code><code class="string">"CustomSmartSearch"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="comments">// Contains initialization code that is executed when the application starts</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit()</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">base</code><code class="plain">.OnInit();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">        </code><code class="comments">// Assigns a handler to the GetContent event for pages</code></div>
<div class="line"><code class="plain">        DocumentEvents.GetContent.Execute += OnGetPageContent;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnGetPageContent(</code><code class="keyword">object</code><code class="plain"> sender, DocumentSearchEventArgs e)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Gets an object representing the page that is being indexed</code></div>
<div class="line"><code class="plain">        TreeNode indexedPage = e.Node;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">        </code><code class="comments">// Checks that the page exists</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (indexedPage != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Gets the user object of the page owner</code></div>
<div class="line"><code class="plain">            UserInfo pageOwner = UserInfoProvider.GetUserInfo(indexedPage.NodeOwner);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain"> (pageOwner != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                </code><code class="comments">// Adds the value of the "Description" field from the owner's user settings into the indexed content</code></div>
<div class="line"><code class="plain">                </code><code class="comments">// Spaces added as separators to ensure that typical search index analyzers can correctly tokenize the index content</code></div>
<div class="line"><code class="plain">                e.Content += </code><code class="string">" "</code><code class="plain"> + pageOwner.UserDescription + </code><code class="string">" "</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Save the <strong class=" ">CustomSmartSearchModule.cs</strong> file.</p>
</li><li class=" "><p   
>Sign in to the Kentico administration interface.</p>
</li><li class=" "><p   
>Open the <strong class=" ">Smart search</strong> application and <strong class=" ">Rebuild</strong> your page search indexes.</p>
</li></ol><p   
>The search now returns results for pages if the owner&#39;s description field matches the search text.</p>
    <h3 id="src-68882123_safe-id-Q3VzdG9taXppbmd0aGVjb250ZW50b2ZzZWFyY2hpbmRleGVzLUV4YW1wbGUtSW5kZXhpbmdwZXJzb25hbGNhdGVnb3J5bmFtZXNmb3J1c2VycyhPYmplY3RFdmVudHMp" class="heading "><span>Example - Indexing personal category names for users (ObjectEvents)</span></h3>
<p   
>Users in Kentico can create   <a   href="Creating-personal-page-categories">personal categories</a> for organizing pages. The following example demonstrates how to customize the search so that the display names of personal categories are included in the content of   <a   href="Defining-user-indexes">user indexes</a>.</p>
<ol class=" "><li class=" "><p   
>Open your Kentico web project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p   
>Create a   <a   href="Initializing-modules-to-run-custom-code">custom module class</a>. For example, name the class <strong class=" ">CustomSmartSearchModule.cs</strong>.</p>
<ul class=" "><li class=" "><p   
>Either add the class into a custom project within the Kentico solution (recommended) or directly into the Kentico web project (into a custom folder under the <strong class=" ">CMSApp</strong> project for <i class=" ">web application</i> installations, into the <strong class=" ">App_Code</strong> folder for <i class=" ">web site</i> installations).<br/><br/></p>
</li></ul></li><li class=" "><p   
>Override the module&#39;s <strong class=" ">OnInit</strong> method and assign a handler to the <strong class=" ">UserInfo.TYPEINFO.Events.GetContent.Execute</strong> event.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Membership;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Taxonomy;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Registers the custom module into the system</code></div>
<div class="line"><code class="plain">[assembly: RegisterModule(</code><code class="keyword">typeof</code><code class="plain">(CustomSmartSearchModule))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomSmartSearchModule : Module</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Module class constructor, the system registers the module under the name "CustomSmartSearch"</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">public</code><code class="plain"> CustomSmartSearchModule()</code></div>
<div class="line"><code class="plain">		: </code><code class="keyword">base</code><code class="plain">(</code><code class="string">"CustomSmartSearch"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Contains initialization code that is executed when the application starts</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit()</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">base</code><code class="plain">.OnInit();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Assigns a handler to the GetContent event for user objects            </code></div>
<div class="line"><code class="plain">		UserInfo.TYPEINFO.Events.GetContent.Execute += OnGetUserContent;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnGetUserContent(</code><code class="keyword">object</code><code class="plain"> sender, ObjectEventArgs e)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the indexed user object</code></div>
<div class="line"><code class="plain">		UserInfo indexedUser = (UserInfo)e.Object;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Checks that the object exists</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">if</code><code class="plain"> (indexedUser != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			</code><code class="comments">// Gets the personal page categories of the indexed user</code></div>
<div class="line"><code class="plain">			ObjectQuery&lt;CategoryInfo&gt; personalCategories = CategoryInfoProvider.GetCategories().WhereEquals(</code><code class="string">"CategoryUserID"</code><code class="plain">, indexedUser.UserID);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">			</code><code class="comments">// Loops through the categories</code></div>
<div class="line"><code class="plain">			</code><code class="keyword">foreach</code><code class="plain"> (CategoryInfo category </code><code class="keyword">in</code><code class="plain"> personalCategories)</code></div>
<div class="line"><code class="plain">			{</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Adds the display name of the category to the user search index</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Spaces added as separators to ensure that typical search index analyzers can correctly tokenize the index content</code></div>
<div class="line"><code class="plain">				e.Content += </code><code class="string">" "</code><code class="plain"> + category.CategoryDisplayName + </code><code class="string">" "</code><code class="plain">;</code></div>
<div class="line"><code class="plain">			}</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Save the <strong class=" "><strong class=" ">CustomSmartSearchModule</strong>.cs</strong> file.</p>
</li><li class=" "><p   
>Sign in to the Kentico administration interface.</p>
</li><li class=" "><p   
>Open the <strong class=" ">Smart search</strong> application and <strong class=" ">Rebuild</strong> your user indexes.</p>
</li></ol><p   
>The search results now include users if the name of at least one of the user&#39;s personal page categories matches the search text.</p>
    <h3 id="src-68882123_safe-id-Q3VzdG9taXppbmd0aGVjb250ZW50b2ZzZWFyY2hpbmRleGVzLUV4YW1wbGUtSW5kZXhpbmd0aGVuYW1lc29mYXNzaWduZWRwcm9kdWN0b3B0aW9uc2ZvcnByb2R1Y3RwYWdlcyhEb2N1bWVudEV2ZW50cyk" class="heading "><span>Example - Indexing the names of assigned product options for product pages (DocumentEvents)</span></h3>
<p   
>The following example shows how to add the names of e-commerce   <a   href="Working-with-product-options">product options</a> into the indexed content for the relevant product pages. Only affects product options in categories of the <strong class=" ">Products</strong> type.</p>
<ol class=" "><li class=" "><p   
>Open your Kentico web project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p   
>Create a   <a   href="Initializing-modules-to-run-custom-code">custom module class</a>. For example, name the class <strong class=" ">CustomSmartSearchModule.cs</strong>.</p>
<ul class=" "><li class=" "><p   
>Either add the class into a custom project within the Kentico solution (recommended) or directly into the Kentico web project (into a custom folder under the <strong class=" ">CMSApp</strong> project for <i class=" ">web application</i> installations, into the <strong class=" ">App_Code</strong> folder for <i class=" ">web site</i> installations).<br/><br/></p>
</li></ul></li><li class=" "><p   
>Override the module&#39;s <strong class=" ">OnInit</strong> method and assign a handler to the <strong class=" ">DocumentEvents.GetContent.Execute</strong> event.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DocumentEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Ecommerce;</code></div>
<div class="line"> </div>
<div class="line"><code class="comments">// Registers the custom module into the system</code></div>
<div class="line"><code class="plain">[assembly: RegisterModule(</code><code class="keyword">typeof</code><code class="plain">(CustomSmartSearchModule))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomSmartSearchModule : Module</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Module class constructor, the system registers the module under the name "CustomSmartSearch"</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">public</code><code class="plain"> CustomSmartSearchModule()</code></div>
<div class="line"><code class="plain">		: </code><code class="keyword">base</code><code class="plain">(</code><code class="string">"CustomSmartSearch"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Contains initialization code that is executed when the application starts</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit()</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">base</code><code class="plain">.OnInit();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Assigns a handler to the GetContent event for pages</code></div>
<div class="line"><code class="plain">		DocumentEvents.GetContent.Execute += OnGetProductPageContent;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnGetProductPageContent(</code><code class="keyword">object</code><code class="plain"> sender, DocumentSearchEventArgs e)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets an object representing the page that is being indexed</code></div>
<div class="line"><code class="plain">		TreeNode indexedPage = e.Node;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Checks that the page exists and represents a product (SKU)</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">if</code><code class="plain"> (indexedPage != </code><code class="keyword">null</code><code class="plain"> &amp;&amp; indexedPage.HasSKU)</code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			</code><code class="comments">// Gets the ID of the SKU</code></div>
<div class="line"><code class="plain">			</code><code class="keyword">int</code><code class="plain"> skuId = indexedPage.NodeSKUID;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">			</code><code class="comments">// Checks that the SKU has at least one enabled product option</code></div>
<div class="line"><code class="plain">			</code><code class="keyword">if</code><code class="plain"> (SKUInfoProvider.HasSKUEnabledOptions(skuId))</code></div>
<div class="line"><code class="plain">			{</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Gets the SKU's enabled product option categories of the "Products" type</code></div>
<div class="line"><code class="plain">				ObjectQuery&lt;OptionCategoryInfo&gt; categories = OptionCategoryInfoProvider.GetProductOptionCategories(skuId, </code><code class="keyword">true</code><code class="plain">, OptionCategoryTypeEnum.Products);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">				</code><code class="comments">// Loops through the product option categories</code></div>
<div class="line"><code class="plain">				</code><code class="keyword">foreach</code><code class="plain"> (OptionCategoryInfo category </code><code class="keyword">in</code><code class="plain"> categories)</code></div>
<div class="line"><code class="plain">				{</code></div>
<div class="line"><code class="plain">					</code><code class="comments">// Gets a list of enabled options in the product option category</code></div>
<div class="line"><code class="plain">					ObjectQuery&lt;SKUInfo&gt; options = SKUInfoProvider.GetSKUOptionsForProduct(skuId, category.CategoryID, </code><code class="keyword">true</code><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">					</code><code class="comments">// Loops through the product options</code></div>
<div class="line"><code class="plain">					</code><code class="keyword">foreach</code><code class="plain"> (SKUInfo option </code><code class="keyword">in</code><code class="plain"> options)</code></div>
<div class="line"><code class="plain">					{</code></div>
<div class="line"><code class="plain">						</code><code class="comments">// Adds the name of the product option into the indexed content for the product page</code></div>
<div class="line"><code class="plain">						</code><code class="comments">// Spaces added as separators to ensure that typical search index analyzers can correctly tokenize the index content</code></div>
<div class="line"><code class="plain">						e.Content += </code><code class="string">" "</code><code class="plain"> + option.SKUName + </code><code class="string">" "</code><code class="plain">;</code></div>
<div class="line"><code class="plain">					}</code></div>
<div class="line"><code class="plain">				}</code></div>
<div class="line"><code class="plain">			}</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p   
>Save the <strong class=" ">CustomSmartSearchModule.cs</strong> file.</p>
</li><li class=" "><p   
>Sign in to the Kentico administration interface.</p>
</li><li class=" "><p   
>Open the <strong class=" ">Smart search</strong> application and <strong class=" ">Rebuild</strong> your page search indexes.</p>
</li></ol><p   
>The search now returns product pages if the search text matches the name of one of the page&#39;s product options.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
