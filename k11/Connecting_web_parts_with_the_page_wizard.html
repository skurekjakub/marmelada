<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Connecting web parts with the page wizard - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico_11_Documentation_Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882211"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico_11_Documentation_Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom_development.html">Custom development</a></li>
                                                                                                         <li class="shortcut"><a href="Developing_web_parts.html">Developing web parts</a></li>
                                                                                     <li><a href="Advanced_web_part_development_scenarios.html">Advanced web part development scenarios</a></li>
                                                            </ul>
</div>            <h1 id="src-68882211"> <span>Connecting web parts with the page wizard</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
        $page.content
<p   
>The <a   href="Creating_wizards_on_websites.html">Page wizard</a> is a set of web parts that allow you to guide users through a sequence of steps on the website. The wizard uses standard pages to define the content of steps. You can extend the logic of the wizard by <a   href="Customizing_web_parts.html">customizing the code</a> of the web parts placed onto the wizard steps, for example:</p>
<ul class=" "><li class=" "><p   
>Define validation rules for web parts &mdash; conditions that must be fulfilled before users can move forward from steps containing the web part</p>
</li><li class=" "><p   
>Perform custom actions when moving between steps</p>
</li></ul><p   
>To interact with the page wizard from the code of your web parts, override the methods listed below. The methods handle events that occur during the life cycle of each wizard step:</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Wizard step event</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Description</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>LoadStep</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Occurs when a user opens the step containing the web part.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>StepLoaded</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Occurs after all web parts inside the given step&#39;s content have finished the <i class=" ">LoadStep</i> event.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>ValidateStepData<br/>    <span style="color: #ffffff;">
_________________    </span>
</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Allows you to define step validation requirements for the web part. The event occurs when:</p>
<ul class=" "><li class=" "><p   
>a user moves to the <strong class=" ">next</strong> step by clicking the <i class=" ">Page wizard button</i></p>
</li><li class=" "><p   
>the <i class=" ">Page wizard step action</i> web part automatically skips the step (if validation is enabled)</p>
</li></ul><p   
><strong class=" ">Note</strong>: Moving between steps via the <i class=" ">Page wizard navigation</i> web part does not trigger validation.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>SaveStepData</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Occurs when moving to the next step after the validation is complete.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>StepFinished</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Occurs after all web parts in the given step&#39;s content have finished the <i class=" ">SaveStepData</i> event.</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The base handlers are defined in the <strong class=" ">CMSAbstractWebPart</strong> class, so you can override the page wizard event handlers in the code of any web part.</p>
        </div>
    </div>
<p   
>All of the event handlers provide the <strong class=" ">StepEventArgs</strong> parameter, which allows you to access the data of the current page wizard step.</p>
    <h5 id="src-68882211_Connectingwebpartswiththepagewizard-Cancellingsteptransitions" class="heading "><span>Cancelling step transitions</span></h5>
<p   
>You can interrupt transitions to the next wizard step based on custom conditions. Set the <strong class=" ">CancelEvent</strong> property of the <i class=" ">StepEventArgs</i> parameter during the <i class=" ">ValidateStepData</i>, <i class=" ">SaveStepData</i> or <i class=" ">StepFinished</i> events.</p>
<p   
>For example, add a custom validation condition into the <i class=" ">ValidateStepData</i> handler, and set the <i class=" ">CancelEvent</i> property to true if the validation fails.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">e.CancelEvent = </code><code class="keyword">true</code><code class="plain">;</code></div>
</div>
    </div>
    <h5 id="src-68882211_Connectingwebpartswiththepagewizard-Skippingsteps" class="heading "><span>Skipping steps</span></h5>
<p   
>If you need to completely skip a page wizard step under certain conditions, set the <strong class=" ">Skip</strong> property of the <i class=" ">StepEventArgs</i> parameter to true in the <i class=" ">LoadStep</i> or <i class=" ">StepLoaded</i> handler.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">e.Skip = </code><code class="keyword">true</code><code class="plain">;</code></div>
</div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-68882211_Connectingwebpartswiththepagewizard-Example-Creatingaformforwizardsteps">Example - Creating a form for wizard steps</a></p>
</li><li class=" "><p   
><a   href="#src-68882211_Connectingwebpartswiththepagewizard-Resettingthepagewizard">Resetting the page wizard</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="Creating_wizards_on_websites.html">Creating wizards on websites</a></p>
</li><li class=" "><p   
><a   href="Customizing_web_parts.html">Customizing web parts</a></p>
</li></ul>        </div>
    </div>
    <h3 id="src-68882211_Connectingwebpartswiththepagewizard-Example-Creatingaformforwizardsteps" class="heading "><span>Example - Creating a form for wizard steps</span></h3>
<p   
>The following example demonstrates how to create a customized version of the <strong class=" ">On-line form</strong> web part for use inside page wizard steps. The custom form:</p>
<ul class=" "><li class=" "><p   
>Integrates validation of the form&#39;s data into the validation of the wizard step</p>
</li><li class=" "><p   
>Saves the form&#39;s data when the wizard moves to the next step</p>
</li></ul><p   
>See also: <a   href="Forms.html">Forms</a></p>
    <h4 id="src-68882211_Connectingwebpartswiththepagewizard-Cloningtheformwebpart" class="heading "><span>Cloning the form web part</span></h4>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Web parts</strong> application.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Forms -&gt; On-line form</strong> web part in the tree.</p>
</li><li class=" "><p   
>Click <strong class=" ">Clone web part</strong> (<img  class="confluence-embedded-image"  src="images/download/attachments/68879208/clone.png" alt="images/download/attachments/68879208/clone.png"   />
) and enter the following values:<br/><br/></p>
<ul class=" "><li class=" "><p   
><strong class=" ">New object display name</strong>: Wizard form</p>
</li><li class=" "><p   
><strong class=" ">New object code name</strong>: WizardForm<br/><br/></p>
</li><li class=" "><p   
><strong class=" ">Clone web part to category</strong>: Forms</p>
</li><li class=" "><p   
><strong class=" ">Clone web part files</strong>: yes (checked)</p>
</li><li class=" "><p   
><strong class=" ">Cloned web part file name</strong>: BizForms/WizardForm.ascx<br/><br/></p>
</li></ul></li><li class=" "><p   
>Click <strong class=" ">Clone</strong>.</p>
</li></ol><p   
>The system creates a copy of the existing web part and its code files (ASCX and CS) using the specified names.</p>
    <h4 id="src-68882211_Connectingwebpartswiththepagewizard-Modifyingthewebpartcode" class="heading "><span>Modifying the web part code</span></h4>
<ol class=" "><li class=" "><p   
>Open your web project in Visual Studio.</p>
</li><li class=" "><p   
>Edit the code behind of the cloned web part: <strong class=" ">~/CMSWebParts/BizForms/WizardForm.ascx.cs</strong></p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Important</strong></p>
<p   
>If you installed Kentico as a web application, the clone&#39;s code files will not be visible right away, since they are not included in the project. In this case:</p>
<ol class=" "><li class=" "><p   
>Click <strong class=" ">Show all files</strong> at the top of the Solution Explorer.</p>
</li><li class=" "><p   
>Right-click the <strong class=" ">WizardForm.ascx</strong> file in the BizForms folder.</p>
</li><li class=" "><p   
>Click <strong class=" ">Include in Project</strong>.</p>
</li></ol>        </div>
    </div>
</li><li class=" "><p   
>Add the following code into the <strong class=" ">SetupControl</strong> method (in the <i class=" ">else</i> branch where<i class=" "> StopProcessing</i> is false):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Hides the form's default submit button</code></div>
<div class="line"><code class="plain">viewBiz.SubmitButton.Visible = </code><code class="keyword">false</code><code class="plain">;</code></div>
</div>
    </div>
</li><li class=" "><p   
>Add the following overrides for the <strong class=" ">ValidateStepData</strong> and <strong class=" ">SaveStepData</strong> handlers of page wizard events:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> ValidateStepData(</code><code class="keyword">object</code><code class="plain"> sender, CMS.Base.Web.UI.StepEventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">base</code><code class="plain">.ValidateStepData(sender, e);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Checks whether the form's data is valid</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (!viewBiz.ValidateData())</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Stops the wizard from moving to the next step if the form data is invalid</code></div>
<div class="line"><code class="plain">		e.CancelEvent = </code><code class="keyword">true</code><code class="plain">;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> SaveStepData(</code><code class="keyword">object</code><code class="plain"> sender, CMS.Base.Web.UI.StepEventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">base</code><code class="plain">.SaveStepData(sender, e);</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Saves the data of the form (replaces the form's submit button)</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (!viewBiz.SaveData(</code><code class="keyword">null</code><code class="plain">))</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Stops the wizard from moving to the next step if the form's data wasn't saved successfully</code></div>
<div class="line"><code class="plain">		e.CancelEvent = </code><code class="keyword">true</code><code class="plain">;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Tip</strong>: The sample code is only a demonstration of the available event handlers. You do not need to implement the <strong class=" ">ValidateStepData</strong> handler for forms in real world scenarios. The <strong class=" ">viewBiz.SaveData</strong> method called in the <strong class=" ">SaveStepData</strong> handler includes validation (returns a false value if the form&#39;s data is invalid).</p>
        </div>
    </div>
</li><li class=" "><p   
>Save the file.</p>
</li></ol><p   
>You can now add the customized form web part into the content of page wizard steps. When moving to the next step, the wizard:</p>
<ol class=" "><li class=" "><p   
>Validates the form data (according to the settings of the form&#39;s fields)</p>
</li><li class=" "><p   
>Creates a new <a   href="Managing_form_data.html">data record</a> for the given form (if the form data is valid)</p>
</li></ol>    <h3 id="src-68882211_Connectingwebpartswiththepagewizard-Resettingthepagewizard" class="heading "><span>Resetting the page wizard</span></h3>
<p   
>The page wizard tracks which steps individual users have passed through (the system stores the information in the HTTP session). If the <strong class=" ">Restrict step order</strong> property of the <strong class=" ">Page wizard manager</strong> web part is enabled, the wizard forces users to move through the steps in sequence:</p>
<ul class=" "><li class=" "><p   
>Users can only move forward through the wizard&#39;s steps using the <strong class=" ">Next</strong> button</p>
</li><li class=" "><p   
>The <strong class=" ">Page wizard navigation</strong> web part displays unvisited steps as inactive items (without links)</p>
</li><li class=" "><p   
>If a user attempts to access an unvisited step through the URL of the step page, the wizard opens the last visited step instead</p>
</li></ul><p   
>You can use the API to reset the wizard from the code of any web part placed onto a step. Access the <strong class=" ">DocumentWizardManager</strong> property (inherited by all web parts from <strong class=" ">CMSAbstractWebPart</strong>) and call the <strong class=" ">ResetWizard</strong> method:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">DocumentWizardManager.ResetWizard();</code></div>
</div>
    </div>
<p   
>When executed, the method clears the history of visited steps for the user viewing the page.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Note</strong>: The wizard automatically resets when users click the <strong class=" ">Next</strong> button on the last step (if the <strong class=" ">Final step URL</strong> property is filled for the <strong class=" ">Page wizard manager</strong> web part).</p>
        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
