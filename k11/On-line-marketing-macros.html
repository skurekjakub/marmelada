<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>On-line marketing macros - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882609"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="On-line-marketing-features.html">On-line marketing features</a></li>
                                                                                     <li><a href="Configuring-and-customizing-your-on-line-marketing-features.html">Configuring and customizing your on-line marketing features</a></li>
                                                            </ul>
</div>            <h1 id="src-68882609"> <span>On-line marketing macros</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<p   
>You can use macro expressions to dynamically load values related to on&#8209;line marketing applications. Properly using these expressions allows you to set up flexible content and behavior of your websites. With on&#8209;line marketing, macros are required when building conditions for:</p>
<ul class=" "><li class=" "><p   
>  <a   href="Content-personalization">Content personalization</a> variants</p>
</li><li class=" "><p   
>Condition-based   <a   href="Segmenting-contacts-into-contact-groups">Contact groups</a></p>
</li><li class=" "><p   
>  <a   href="Setting-triggers-for-automation-processes">Marketing automation triggers</a> and   <a   href="Working-with-the-automation-process-designer">process steps</a></p>
</li></ul><p   
>You can also use on-line marketing macros in all other parts of Kentico where macros are supported.</p>
    <div  class="confbox admonition admonition-note">
                    <p class="title">Note</p>
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>All expressions described below are <i class=" ">context macros</i>, which means they must be enclosed in <i class=" ">{% %}</i> parentheses when entered into text or other general fields. You do not need to use macro parentheses inside macro&#8209;specific fields, such as condition editors.</p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
>  <a   href="#src-68882609_Onlinemarketingmacros-GettingContactandScoringdata">Getting Contact and Scoring data</a></p>
<ul class="toc-indentation "><li class=" "><p   
>  <a   href="#src-68882609_Onlinemarketingmacros-On-linemarketingmacromethods">On-line marketing macro methods</a></p>
</li><li class=" "><p   
>  <a   href="#src-68882609_Onlinemarketingmacros-Scoring-Notificationemailtemplatemacros">Scoring - Notification email template macros</a></p>
</li></ul></li><li class=" "><p   
>  <a   href="#src-68882609_safe-id-T25saW5lbWFya2V0aW5nbWFjcm9zLUdldHRpbmdDYW1wYWlnbixBL0J0ZXN0YW5kTVZUdGVzdGRhdGE">Getting Campaign, A/B test and MVT test data</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
>  <a   href="Macro-expressions">Macro expressions</a></p>
</li><li class=" "><p   
>  <a   href="Writing-macro-conditions">Writing macro conditions</a></p>
</li><li class=" "><p   
>  <a   href="Building-conditions-using-macro-rules">Building conditions using macro rules</a></p>
</li><li class=" "><p   
>  <a   href="Improving-custom-macro-performance-in-scoring-and-contact-groups">Improving custom macro performance</a></p>
</li></ul>        </div>
    </div>
    <h3 id="src-68882609_Onlinemarketingmacros-GettingContactandScoringdata" class="heading "><span>Getting Contact and Scoring data</span></h3>
<p   
>The fundamental part of most on&#8209;line marketing macros is the loading of a specific   <a   href="Working-with-contacts">contact</a> or its data. Use the following expressions for this purpose:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">ContactManagementContext.CurrentContact</strong> - returns a <i class=" ">ContactInfo</i> object representing the current contact, i.e. the visitor who is viewing the website when the macro is resolved.</p>
</li><li class=" "><p   
><strong class=" ">ContactManagementContext.CurrentContactID</strong> - returns the ID of the current contact.</p>
</li><li class=" "><p   
><strong class=" ">Contact</strong> - you may use this expression when writing conditions for condition-based contact groups or in marketing automation. The Contact macro allows you to work with a general <i class=" ">ContactInfo</i> object. For example: <i class=" ">Contact.ContactGender == 1</i></p>
</li></ul><p   
><i class=" ">ContactInfo</i> objects serve as a way to access the values set for the given contact (e.g. <i class=" ">ContactManagementContext.CurrentContact.ContactLastName</i>). In addition to standard contact fields, you can also use the following advanced properties to get data related to the contact:</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>ContactInfo property</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Description</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Accounts</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">InfoObjectCollection</i> containing all accounts (<i class=" ">AccountInfo</i> objects) to which the given contact is assigned.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>ContactGroups</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">InfoObjectCollection</i> containing all contact groups (<i class=" ">ContactGroupInfo</i> objects) that contain the given contact.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>LastActivity</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">ActivityInfo</i> object representing the most recently logged   <a   href="Tracking-contact-activities">activity</a> for the given contact.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Orders</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">InfoObjectCollection</i> containing all e&#8209;commerce orders (<i class=" ">OrderInfo</i> objects) made by the contact on the current site.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Processes</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">InfoObjectCollection</i> containing all marketing automation processes in which the contact is running.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>PurchasedProducts</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">InfoObjectCollection</i> containing all products (<i class=" ">SKUInfo</i> objects) purchased by the contact across all sites in the system.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Wishlist</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
><i class=" ">InfoObjectCollection</i> containing all products (<i class=" ">SKUInfo</i> objects) added to the wishlist of the given contact (across all sites in the system).</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <div  class="confbox admonition admonition-tip">
                    <p class="title">Working with InfoObjectCollections</p>
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>There are many ways how you can process <strong class=" ">InfoObjectCollection</strong> objects. For example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.Accounts.Exists(AccountName == </code><code class="string">"CompanyAccount"</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>Checks whether the current contact belongs to an account named <i class=" ">CompanyAccount</i> and returns the result as a boolean value.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.Orders.Exists(OrderTotalPrice &gt; </code><code class="value">500</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>Checks if the current contact has made an order with a total value greater than 500 of the given currency.</p>
        </div>
    </div>
    <h4 id="src-68882609_Onlinemarketingmacros-On-linemarketingmacromethods" class="heading "><span>On-line marketing macro methods</span></h4>
<p   
>You can call the following methods inside macro expressions to retrieve on&#8209;line marketing data:</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Method</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Description / Parameters / Examples</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>AgreedWithConsent</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact has given a consent specified in the parameter.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">ContactInfo contact</strong> &ndash; contains <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String consentName</strong> &ndash; specifies the code name of the   <a   href="Working-with-consents">consent declaration</a>.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.AgreedWithConsent(</code><code class="string">"TrackingConsent"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>FilledFormFieldWithValue</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact has filled in a specific field in a specific form with a given text value.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">ContactInfo contact</strong> &ndash; contains <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String formNameField</strong> &ndash; specifies the name of the form combined with the specific field. Use the &quot;&lt;site name&gt;;&lt;form name&gt;;&lt;form field&gt;&quot; format. For example, &quot;DancingGoat;ContactUs;FirstName&quot;.</p>
</li><li class=" "><p   
><strong class=" ">String expectedValue</strong> &ndash; specifies the value the field should contain.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.FilledFormFieldWithValue(</code><code class="string">"DancingGoat;ContactUs;City"</code><code class="plain">, </code><code class="string">"Chicago"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>UnsubscribedFromAllEmails</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool </i>representing if the contact has unsubscribed from all   <a   href="Integrating-email-feeds-into-sites#src-68882604_Integratingemailfeedsintosites-Allowingrecipientstounsubscribefromemailcampaigns">marketing emails</a>.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.UnsubscribedFromAllEmails()</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>IsInPersona</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact is assigned to the specified persona.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">ContactInfo contact</strong> &ndash; contains the <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">Object persona</strong> &ndash; must contain the appropriate <i class=" ">PersonaInfo </i>object of the contact that is to be evaluated.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">IsInPersona(ContactManagementContext.CurrentContact, persona)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>GetPersona</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns the persona the contact is currently assigned to. Returns null if the contact is not assigned to a persona.</p>
<p   
><strong class=" ">Note:</strong> Always use this method over the ContactPersona property, as this method can correctly take into account the persona selected in the preview mode.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">ContactInfo contact</strong> &ndash; contains the <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.GetPersona()</code></div>
</div>
    </div>
<p   
>or</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">GetPersona(ContactManagementContext.CurrentContact)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>LastActivityOfType</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns an <i class=" ">ActivityInfo</i> object representing the activity most recently logged for the specified contact.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo</i> object of the contact whose activity should be loaded.</p>
</li><li class=" "><p   
><i class=" "><strong class=" ">String activityType</strong> </i>&ndash; optional parameter that may be used to get the last activity of a specific type. The value must be entered as a string matching the code name of the appropriate activity type.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain"> ContactManagementContext.CurrentContact.LastActivityOfType(</code><code class="string">"purchasedproduct"</code><code class="plain">)</code></div>
</div>
    </div>
<p   
>or</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">LastActivityOfType(ContactManagementContext.CurrentContact, </code><code class="string">"purchasedproduct"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>FirstActivityOfType</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns an <i class=" ">ActivityInfo</i> object representing the first activity logged for the specified contact.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo</i> object of the contact whose activity should be loaded.</p>
</li><li class=" "><p   
><i class=" "><strong class=" ">String activityType</strong> </i>&ndash; optional parameter that may be used to get the first activity of a specific type. The value must be entered as a string matching the code name of the appropriate activity type.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.FirstActivityOfType(</code><code class="string">"productaddedtowishlist"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>IsInContactGroup</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact is a member of the specified contact group.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String groupNames</strong> &ndash; must contain the code name of the given contact group.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.IsInContactGroup(</code><code class="string">"MaleCustomers"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>GetScore</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns the total number of score points that the given contact has in the specified score (as an <i class=" ">integer</i>).</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; specifies the <i class=" ">ContactInfo</i> object representing the contact whose score points should be loaded.</p>
</li><li class=" "><p   
><strong class=" ">String scoreName</strong> &ndash; must contain the code name of the given score.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.GetScore(</code><code class="string">"InterestedInSmartphones"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>GetEmailDomain</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Reads an email address and returns only its domain part (all characters after the &quot;@&quot; sign).</p>
<p   
>Note: The <i class=" ">GetEmailDomain</i> method is not available when resolving macros in an external application using the <i class=" ">Kentico.Libraries</i> NuGet package.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">String email</strong> &ndash; specifies the email address from which the domain is taken.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.ContactEmail.GetEmailDomain()</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>CameToLandingUrl</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool </i>representing if the contact has come to the landing page with the specified URL.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String URL </strong>&ndash; defines the part of URL specifying the landing page.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.CameToLandingUrl(</code><code class="string">"smartphones"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>VisitedURL</p>
<p   
><br/></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool </i>representing if the contact has visited a page with the specified URL in the last X days.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String URL</strong> &ndash; specifies the URL of the page that has been visited.<strong class=" "></strong></p>
</li><li class=" "><p   
><i class=" "><strong class=" ">Int lastXDays </strong></i>&ndash; optional parameter specifying how many days ago the page was visited. If you enter the zero value, no constraint is applied.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.VisitedUrl(</code><code class="string">"smartphones"</code><code class="plain">, </code><code class="value">5</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>VisitedSite</p>
<p   
><br/></p>
<p   
><br/></p>
<p   
><br/></p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact has visited the specified site.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String siteName</strong> &ndash; specifies the code name of the site that has been visited.</p>
</li><li class=" "><p   
><i class=" "><strong class=" ">Int lastXDays</strong> </i>&ndash; optional parameter specifying how many days ago the site was visited. If you enter the zero value, no constraint is applied.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.VisitedSite(</code><code class="string">"siteName"</code><code class="plain">, </code><code class="value">0</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
><br/></p>
<p   
>VisitedPage</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact has visited the specified page.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">GUID nodeGuid</strong> &ndash; specifies the GUID of the page that has been visited.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.VisitedPage(Documents[</code><code class="string">"/Home"</code><code class="plain">].NodeGuid)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>OpenedNewsletter</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact opened the specified newsletter.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">GUID newsletterGuid</strong> &ndash; specifies the GUID of the newsletter that has been opened.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.OpenedNewsletter(SiteObjects.Newsletters.CorporateNewsletter.NewsletterGuid)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>SubscribedToNewsletter</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact is subscribed to the specified newsletter.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String newsletterName</strong> &ndash; must contain the name of the specific newsletter.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.SubscribedToNewsletter(SiteObjects.Newsletters.Coffee101)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>VotedInPoll</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact has voted in the poll.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">GUID pollGuid</strong> &ndash; specifies the GUID of the poll that has been voted in.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.VotedInPoll(SiteObjects.Polls.NewWebsitePoll.PollGuid)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>IsInRoles</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact is assigned to any of the specified roles.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String roleGuids</strong> &ndash; specifies the GUIDs of the roles that the contact is assigned to. The GUIDs of the individual roles are separated with a semicolon.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.IsInRoles(SiteObjects.Roles.CMSBasicUsers.RoleGuid + </code><code class="string">";"</code><code class="plain"> + SiteObjects.Roles.CMSDesigner.RoleGuid)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>IsInCommunityGroup</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the contact is a member of the specified community group.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Object contact</strong> &ndash; must contain the appropriate <i class=" ">ContactInfo </i>object of the contact that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String groupGuids</strong> &ndash; specifies the GUID of the community groups that the contact is a member of. The GUIDs of the individual groups are separated with a semicolon.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ContactManagementContext.CurrentContact.IsInCommunityGroup(SiteObjects.Groups.American_travelers.GroupGuid + </code><code class="string">";"</code><code class="plain"> + SiteObjects.Groups.Australian_travelers.GroupGuid)</code></div>
</div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="3" colspan="1">
    <p   
>ActivityLinkedToObject</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Returns a <i class=" ">bool</i> representing if the activity is linked to the given object by GUID or code name.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">AcrivityInfo activity </strong>&ndash; contains the <i class=" ">ActivityInfo </i>object of the activity that is to be evaluated.</p>
</li><li class=" "><p   
><strong class=" ">String objectType </strong>&ndash; specifies the type of the object to which the activity is linked.</p>
</li><li class=" "><p   
><strong class=" ">String objectIdentifier</strong> &ndash; identifies the object in the given object type by GUID or code name.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">Activity.LinkedToObject(</code><code class="string">"polls.poll"</code><code class="plain">, </code><code class="string">"NewWebsitePoll"</code><code class="plain">)</code></div>
</div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <h4 id="src-68882609_Onlinemarketingmacros-Scoring-Notificationemailtemplatemacros" class="heading "><span>Scoring - Notification email template macros</span></h4>
<p   
>You can place macros into the text of the <strong class=" ">Scoring - Notification email</strong>   <a   href="Managing-email-templates">template</a> to dynamically load values. The system uses this template for the automatic messages that inform administrators or marketers that a contact has reached a certain amount of   <a   href="Scoring-contacts">score points</a>.</p>
<p   
>The <strong class=" ">{% ScoreValue %}</strong> expression returns the current number of score points for the given contact.</p>
<p   
>Additionally, you can access the following related objects and their properties (e.g. <i class=" ">{% Score.ScoreDisplayName %}</i> etc.):</p>
<ul class=" "><li class=" "><p   
><strong class=" ">{% Score %}</strong> - <i class=" ">ScoreInfo</i> object representing the given score.</p>
</li><li class=" "><p   
><strong class=" ">{% Contact %}</strong> - <i class=" ">ContactInfo</i> object of the contact that has reached the designated number of score points.</p>
</li></ul>    <h3 id="src-68882609_safe-id-T25saW5lbWFya2V0aW5nbWFjcm9zLUdldHRpbmdDYW1wYWlnbixBL0J0ZXN0YW5kTVZUdGVzdGRhdGE" class="heading "><span>Getting Campaign, A/B test and MVT test data</span></h3>
<p   
>If you wish to check whether the current visitor has arrived on the website via a   <a   href="Campaigns">campaign</a>, or passed through a page with an   <a   href="A_B-testing-website-pages">A/B</a> or   <a   href="Multivariate-testing">multivariate test</a>, you can read the information from the appropriate browser cookie. Use the following macro expressions to get the necessary values from the cookies:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">Cookies.Campaign</strong> - returns the name of the campaign assigned to the visitor.</p>
</li><li class=" "><p   
><strong class=" ">Cookies.CMSAB&lt;A/B test code name&gt;</strong> &ndash; returns JSON data identifying the page variant assigned to the visitor by the specified A/B test, and information about performed conversions.</p>
</li><li class=" "><p   
><strong class=" ">Cookies.CMSMVT&lt;MVT test code name&gt;</strong> &ndash; returns JSON data identifying the combination assigned to the visitor by the specified MVT test.</p>
</li></ul>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
