<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Adding custom web analytics - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico-11-Documentation-Home.htm" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882565"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.htm">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="On-line-marketing-features.htm">On-line marketing features</a></li>
                                                                                                         <li class="shortcut"><a href="Configuring-and-customizing-your-on-line-marketing-features.htm">Configuring and customizing your on-line marketing features</a></li>
                                                                                                         <li class="shortcut"><a href="Configuring-web-analytics.htm">Configuring web analytics</a></li>
                                                                                     <li><a href="Web-analytics-API.htm">Web analytics API</a></li>
                                                            </ul>
</div>            <h1 id="src-68882565"> <span>Adding custom web analytics</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<p   
>The system allows you to track custom events as web analytics and display the results in reports. The following example logs a basic button click event, but you can use the same approach to implement tracking for any type of event on your website.</p>
    <h3 id="src-68882565_Addingcustomwebanalytics-Loggingtheevent" class="heading "><span>Logging the event</span></h3>
<p   
>This example logs the event through a user control:</p>
<ol class=" "><li class=" "><p   
>Open your Kentico web project in Visual Studio.</p>
</li><li class=" "><p   
>Create a <strong class=" ">New folder</strong> under the root named according to the code name of your site, e.g. <i class=" ">CorporateSite</i> (if it doesn&#39;t already exist).</p>
</li><li class=" "><p   
>Create a <strong class=" ">Web User Control</strong> in the new folder named <i class=" ">AnalyticsButton.ascx</i>.</p>
</li><li class=" "><p   
>Add the following code to the control:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;asp:Button id=</code><code class="string">"btnLog"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> Text=</code><code class="string">"Add analytics hit"</code><code class="plain"> onclick=</code><code class="string">"btnLog_Click"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The code inserts a standard Button control, which will be used to add hits to the custom statistic.</p>
        </div>
    </div>
</li><li class=" "><p   
>Switch to the code behind file of the control and modify it according to the following:</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Note</strong>: The name of the class will be different according to the code name of your site.</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Membership;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.SiteProvider;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.WebAnalytics;</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">partial</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CorporateSite_AnalyticsButton : System.Web.UI.UserControl</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Handler for the button's click event</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> btnLog_Click(</code><code class="keyword">object</code><code class="plain"> sender, EventArgs e)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the name of the current site</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">string</code><code class="plain"> siteName = SiteContext.CurrentSiteName;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Checks if web analytics are enabled in the settings</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (AnalyticsHelper.AnalyticsEnabled(siteName))</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Adds a hit to a custom statistic</code></div>
<div class="line"><code class="plain">			HitLogProvider.LogHit(</code><code class="string">"buttonclicked"</code><code class="plain">, siteName, </code><code class="keyword">null</code><code class="plain">, MembershipContext.AuthenticatedUser.UserName, 0);			</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>You can log custom events for web analytics via the API using the <strong class=" ">HitLogProvider</strong> class from the <strong class=" ">CMS.WebAnalytics</strong> namespace, specifically the following method:</p>
<p   
><i class=" ">LogHit(string codeName, string siteName, string culture, string objectName, int objectId, int count, double value)</i></p>
<ul class=" "><li class=" "><p   
><strong class=" ">codeName</strong> - determines the code name of the custom statistic, <i class=" ">buttonclicked</i> in the case of this example. This name is also used in the code names of related reports.</p>
</li><li class=" "><p   
><strong class=" ">siteName</strong> - specifies the code name of the site for which the event is logged.</p>
</li><li class=" "><p   
><strong class=" ">culture</strong> - specifies the culture code under which the system logs the event.</p>
</li><li class=" "><p   
><strong class=" ">objectName / objectId</strong> - specifies the context in which the hit was logged. You can use the name or ID of an object. For example, when logging page views, you could store the alias path and ID of the given page. In the example, the name of the user who clicked the button is logged as the related object.</p>
</li><li class=" "><p   
><strong class=" ">count</strong> - sets the amount of hits added to the statistic. This parameter is optional and the default value (1) is used if not specified.</p>
</li><li class=" "><p   
><strong class=" ">value</strong> - specifies a special value for the hit. This parameter is optional and can be used to assign weight to the hit according to some conditions. The value of a statistic is cumulative, which means that each hit adds to the total value logged for the given analytics record (specified by the <strong class=" ">objectName</strong> and <strong class=" ">objectId</strong>).</p>
</li></ul>        </div>
    </div>
</li><li class=" "><p   
><strong class=" ">Save </strong>the user control&#39;s files.</p>
</li></ol><p   
>When a user clicks the button, the API creates an analytics log. Once the system processes the log, the results containing the given user&#39;s name and the amount of clicks are stored in the database, where they can be used by the web analytics application.</p>
    <div  class="confbox admonition admonition-note">
                    <p class="title">Note</p>
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Custom analytics do not automatically use <a   href="k11/Enabling-web-analytics.htm">JavaScript logging</a>. If your website has JavaScript logging enabled, you may need to leverage JavaScript in the code to keep your custom statistics consistent with the default web analytics.</p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="k11/#src-68882565_Addingcustomwebanalytics-Loggingtheevent">Logging the event</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68882565_Addingcustomwebanalytics-Integratingcustomanalyticsintothewebsite">Integrating custom analytics into the website</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68882565_Addingcustomwebanalytics-Creatingreportsforstatistics">Creating reports for statistics</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68882565_Addingcustomwebanalytics-Settingthetitleforcustomstatistics">Setting the title for custom statistics</a></p>
</li><li class=" "><p   
><a   href="k11/#src-68882565_Addingcustomwebanalytics-Result">Result</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="k11/Web-analytics.htm">Web analytics</a></p>
</li><li class=" "><p   
><a   href="k11/Web-analytics-API.htm">Web analytics API</a></p>
</li><li class=" "><p   
><a   href="k11/Viewing-web-analytics-reports.htm">Viewing web analytics reports</a></p>
</li><li class=" "><p   
><a   href="k11/Debugging-web-analytics.htm">Debugging web analytics</a></p>
</li><li class=" "><p   
><a   href="k11/Working-with-system-reports.htm">Working with system reports</a></p>
</li></ul>        </div>
    </div>
    <h3 id="src-68882565_Addingcustomwebanalytics-Integratingcustomanalyticsintothewebsite" class="heading "><span>Integrating custom analytics into the website</span></h3>
<p   
>Now you need to publish the user control on your website (this example uses the sample Corporate site).</p>
<ol class=" "><li class=" "><p   
>Log into the Kentico administration interface.</p>
</li><li class=" "><p   
>Edit the Corporate site in the <strong class=" ">Pages</strong> application.</p>
</li><li class=" "><p   
>Select the <strong class=" ">Home</strong> page in the content tree and switch to the <strong class=" ">Design</strong> tab.</p>
</li><li class=" "><p   
><a   href="k11/Using-and-configuring-web-parts.htm">Add</a> the <strong class=" ">User control</strong> web part to the <i class=" ">Main zone</i> zone.</p>
</li><li class=" "><p   
>Type <i class=" ">~/CorporateSite/AnalyticsButton.ascx</i> into the web part&#39;s <strong class=" ">User control virtual path</strong> property.</p>
<ul class=" "><li class=" "><p   
>The page now displays the custom button.<br/><br/></p>
</li></ul></li><li class=" "><p   
>View the live site version of the <strong class=" ">Home</strong> page and click the <strong class=" ">Add analytics hit</strong> button several times to add hits to the custom statistic.</p>
<ul class=" "><li class=" "><p   
>Try doing this while logged in under different user accounts.</p>
</li></ul></li></ol><p   
>There are also other ways to add custom web analytics functionality to the pages of your website. For example:</p>
<ul class=" "><li class=" "><p   
>You can implement the control as a <a   href="k11/Developing-web-parts.htm">custom web part</a>, add it to your pages and configure it through the portal engine as necessary.</p>
</li><li class=" "><p   
>If you are using the <a   href="k11/Developing-websites-using-ASPX-templates.htm">ASPX page template</a> development model for your website, you can integrate the analytics logging code and any required interface elements directly into your page templates.</p>
</li></ul>    <div  class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Using the Analytics custom statistics web part</strong></p>
<p   
>If you wish to log a simple event when visitors access a specific page, you can do so without having to write any code using the <strong class=" ">Analytics custom statistics</strong> web part.</p>
<p   
>Once this web part is placed on a page, it automatically adds a hit to a custom statistic when the given page is viewed. You can specify the details of the statistic, such as its code name, the name of the related object or the hit value using the web part&#39;s properties. The web part automatically loads the site name and culture from the context of the page.</p>
        </div>
    </div>
    <h3 id="src-68882565_Addingcustomwebanalytics-Creatingreportsforstatistics" class="heading "><span>Creating reports for statistics</span></h3>
<p   
>Before users can view the statistics of the button click event in the <strong class=" ">Web analytics</strong> application, you need to create reports for displaying the data of the custom statistic. Most statistics have <i class=" ">five types of reports</i>: hourly, daily, weekly, monthly and yearly.</p>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Reporting</strong> application and select the <strong class=" ">Web Analytics</strong> category in the tree.<br/></p>
<ul class=" "><li class=" "><p   
>The sub&#8209;categories contain reports used by the default statistics such as page views, traffic sources, etc.<br/><br/></p>
</li></ul></li><li class=" "><p   
>Click <strong class=" ">...</strong> next to the <strong class=" ">New report</strong> button above the tree and select <strong class=" ">New category</strong> in the menu.</p>
</li><li class=" "><p   
>Type <i class=" ">Button clicks</i> as the <strong class=" ">Category display name</strong> and click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p   
>Create a daily report for the new statistic. Click <strong class=" ">New report</strong> and enter the following values:<br/><br/></p>
<ul class=" "><li class=" "><p   
><strong class=" ">Report display name</strong>: Button clicked - daily report</p>
</li><li class=" "><p   
><strong class=" ">Report name</strong>: buttonclicked.dayreport</p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The names of the reports must use a specific format:</p>
<ul class=" "><li class=" "><p   
>&lt;statistic code name&gt;.hourreport</p>
</li><li class=" "><p   
>&lt;statistic code name&gt;.dayreport</p>
</li><li class=" "><p   
>&lt;statistic code name&gt;.weekreport</p>
</li><li class=" "><p   
>&lt;statistic code name&gt;.monthreport</p>
</li><li class=" "><p   
>&lt;statistic code name&gt;.yearreport</p>
</li></ul><p   
>In this example, the code name of the custom statistic is <strong class=" ">buttonclicked</strong>, as defined above in the code of the user control.</p>
        </div>
    </div>
</li><li class=" "><p   
>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p   
>Switch to the <strong class=" ">Parameters</strong> tab of the new report and use the <strong class=" ">New field</strong> button to create three essential parameters, which the web analytics use internally:<br/><br/></p>
<ul class=" "><li class=" "><p   
><strong class=" ">Field name: </strong>FromDate</p>
</li><li class=" "><p   
><strong class=" ">Data type</strong>: Date and Time</p>
</li><li class=" "><p   
><strong class=" ">Display field in the editing form</strong>: disabled</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Click <strong class=" ">Save </strong>for every parameter before moving on to the next one.</p>
        </div>
    </div>
</li><li class=" "><p   
><strong class=" ">Field name</strong>: ToDate</p>
</li><li class=" "><p   
><strong class=" ">Data type</strong>: Date and Time</p>
</li><li class=" "><p   
><strong class=" ">Display field in the editing form</strong>: disabled</p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The two parameters above define a time interval used to limit which data of the statistic should be loaded. Only hits that occurred during the specified interval will be displayed in the report. The values of these parameters can be set by users when viewing the data of the statistic in the web analytics interface.</p>
        </div>
    </div>
<ul class=" "><li class=" "><p   
><strong class=" ">Field name</strong>: CodeName</p>
</li><li class=" "><p   
><strong class=" ">Data type</strong>: Text</p>
</li><li class=" "><p   
><strong class=" ">Size</strong>: 20</p>
</li><li class=" "><p   
><strong class=" ">Default value</strong>: buttonclicked (the code name of the displayed statistic in general)</p>
</li><li class=" "><p   
><strong class=" ">Display field in the editing form</strong>: disabled</p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The system uses the <i class=" ">CodeName</i> parameter to identify from which statistic the report loads data. The value is usually not modified if the report is dedicated to a single statistic (like the one in this example).</p>
        </div>
    </div>
<p   
><br/><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68882565/WA_Report_Parameters.png" alt="images/download/attachments/68882565/WA_Report_Parameters.png" width="500"  />
        <br/><span class="caption">Defining parameters for a web analytics report</span>
    <br/><br/></p>
</li><li class=" "><p   
>Go to the <strong class=" ">General</strong> tab and click <strong class=" ">New</strong> in the <strong class=" ">Tables</strong> section below the layout editor. Fill in the table&#39;s properties as shown below:<br/></p>
<ul class=" "><li class=" "><p   
><strong class=" ">Display name</strong>: Table</p>
</li><li class=" "><p   
><strong class=" ">Code name</strong>: Table_ButtonClicked_Day</p>
</li><li class=" "><p   
><strong class=" ">Enable export</strong>: true (checked)</p>
</li><li class=" "><p   
><strong class=" ">Query</strong>:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">SET</code><code class="plain"> @FromDate = dbo.Func_Analytics_DateTrim(@FromDate,</code><code class="string">'day'</code><code class="plain">);</code></div>
<div class="line"><code class="keyword">SET</code><code class="plain"> @ToDate = dbo.Func_Analytics_EndDateTrim(@ToDate,</code><code class="string">'day'</code><code class="plain">);</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">SELECT</code><code class="plain"> StatisticsObjectName </code><code class="keyword">as</code><code class="plain"> </code><code class="string">'User'</code><code class="plain">, </code><code class="color2">SUM</code><code class="plain">(HitsCount) </code><code class="keyword">as</code><code class="plain"> </code><code class="string">'Hits'</code></div>
<div class="line"><code class="keyword">FROM</code><code class="plain"> Analytics_Statistics, Analytics_DayHits</code></div>
<div class="line"><code class="keyword">WHERE</code><code class="plain"> (StatisticsSiteID = @CMSContextCurrentSiteID)</code></div>
<div class="line"><code class="color1">AND</code><code class="plain"> (StatisticsCode = @CodeName)</code></div>
<div class="line"><code class="color1">AND</code><code class="plain"> (StatisticsID = HitsStatisticsID)</code></div>
<div class="line"><code class="color1">AND</code><code class="plain"> (HitsStartTime &gt;= @FromDate)</code></div>
<div class="line"><code class="color1">AND</code><code class="plain"> (HitsEndTime &lt;= @ToDate)</code></div>
<div class="line"><code class="keyword">GROUP</code><code class="plain"> </code><code class="keyword">BY</code><code class="plain"> StatisticsObjectName</code></div>
<div class="line"><code class="keyword">ORDER</code><code class="plain"> </code><code class="keyword">BY</code><code class="plain"> </code><code class="color2">SUM</code><code class="plain">(HitsCount) </code><code class="keyword">DESC</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The new report is a daily report, so the data of the table is retrieved from the <i class=" ">Analytics_DayHits</i> table, together with the <i class=" ">Analytics_Statistics</i> table. See <a   href="k11/Web-analytics-API.htm">Web analytics API</a> for more information about the database table structure.</p>
        </div>
    </div>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Trimming the values of the FromDate and ToDate parameters</strong></p>
<p   
>The SET statements included in the query are necessary to ensure that the specified time interval includes the first and last units of time (e.g. the exact days entered into the <strong class=" ">From</strong> and <strong class=" ">To</strong> fields of a daily report).</p>
<p   
>The second parameter of the trimming functions must match the time unit of the given report. The options are: <i class=" ">&#39;hour&#39;</i>, <i class=" ">&#39;day&#39;</i>, <i class=" ">&#39;week&#39;</i>, <i class=" ">&#39;month&#39;</i>, <i class=" ">&#39;year&#39;</i>.</p>
        </div>
    </div>
</li></ul></li><li class=" "><p   
>Click <strong class=" ">Save &amp; Close </strong>to create the table.</p>
</li><li class=" "><p   
>Click <strong class=" ">Insert</strong> in the <strong class=" ">Tables</strong> section to add the new table into the report.</p>
</li><li class=" "><p   
>Click <strong class=" ">Save.</strong></p>
</li></ol><p   
>The daily report is now complete. In a real&#8209;world scenario, the report would usually also contain a graph to display the data. See the <a   href="k11/Working-with-system-reports.htm">Working with system reports</a> chapter to learn more about graphs and other reporting options.</p>
<p   
>You can create the reports for the remaining time intervals using the same approach. The only differences should be in the names of the reports and tables, and the code of the queries, where you need to load data from the appropriate tables &ndash; <i class=" ">Analytics_YearHits</i> in the yearly report, <i class=" ">Analytics_MonthHits</i> in the monthly report, etc. You can make this process easier by using the <strong class=" ">Clone report</strong> (<img  class="confluence-embedded-image"  src="images/download/attachments/68879208/clone.png" alt="images/download/attachments/68879208/clone.png"   />
) button in the menu above the report tree. Simply create copies of the daily report and then make the necessary adjustments.</p>
    <h3 id="src-68882565_Addingcustomwebanalytics-Settingthetitleforcustomstatistics" class="heading "><span>Setting the title for custom statistics</span></h3>
<p   
>To ensure that the user interface displays an appropriate title for your custom statistic, you need to create a resource string:</p>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Localization</strong> application.</p>
</li><li class=" "><p   
>Click <strong class=" ">New string</strong> on the <strong class=" ">Resource strings</strong> tab.</p>
</li><li class=" "><p   
>Enter the <strong class=" ">Key</strong> of the string in format: <strong class=" "><i class=" ">analytics_codename.&lt;statistic code name&gt;</i></strong> (<i class=" ">analytics_codename.buttonclicked</i> for this example)</p>
</li><li class=" "><p   
>Type the text of the string for your system&#39;s default culture, for example: <i class=" ">Button clicks</i></p>
<ul class=" "><li class=" "><p   
>If you are using a multilingual UI, you can enter translations of the string for individual cultures.</p>
</li></ul></li><li class=" "><p   
>Click <strong class=" ">Save</strong>.</p>
</li></ol><p   
>The system uses the string as the title for the matching statistic.</p>
    <h3 id="src-68882565_Addingcustomwebanalytics-Result" class="heading "><span>Result</span></h3>
<p   
>Once there are some hits logged in the database for a custom statistic, the system automatically displays the statistic under the <strong class=" ">Custom</strong> category of the tree in the <strong class=" ">Web analytics</strong> application. The reports of the sample statistic show the number of hits logged for the tracked button click event.</p>
<p   
><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68882565/Custom_WA_Result.png" alt="images/download/attachments/68882565/Custom_WA_Result.png" width="600"  />
        <br/><span class="caption">Viewing the data of a custom statistic in the Web analytics application</span>
    </p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
