!function(e){window.SCROLL_WEBHELP=window.SCROLL_WEBHELP||{},window.SCROLL_WEBHELP.escapeHtml=function(t){return e("<div />").text(t).html()};var t="desktop";navigator.userAgent.indexOf("MSIE")>0||navigator.userAgent.indexOf("Trident"),Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");function n(){e("body").bind("click",(function(t){!e(t.target).parents("#ht-search").length&&e("#ht-search").hasClass("open")&&(e("body").unbind("click"),a())})),e("#ht-search").addClass("open"),setTimeout((function(){e(".ht-search-clear").addClass("show")}),250),d=!0,e(".search-input")[0].focus()}function a(){input=e("#ht-search"),input.find(".ht-search-dropdown").removeClass("open"),e(".ht-search-dropdown a.hover").removeClass("hover"),e(document).unbind("keydown")}function i(t){var n=e(".ht-search-input .ht-search-dropdown"),a=n.find("ul");t=encodeURIComponent(t),a.empty();window.SCROLL_WEBHELP&&window.SCROLL_WEBHELP.search&&window.SCROLL_WEBHELP.search.performSearch(t,(function(t,i){e.each(t,(function(e,t){a.append('<li n="'+e+'" class="search-result"><a href="'+t.link+'">'+SCROLL_WEBHELP.escapeHtml(t.title)+"</a></li>")}));var r=e('<li class="search-key" n="'+t.length+'"></li>'),c=e('<a class="search-key-button" href="#">Search:&nbsp;</a>'),d=e("<b></b>").text(decodeURIComponent(i)),h=r.append(c.append(d));h.bind("click",(function(e){s(),e.preventDefault()})),a.append(h),a.children("li").each((function(t,n){var i=e(n);i.bind("mouseover",(function(){a.find("li a").removeClass("hover"),i.find("a").addClass("hover")}))})),n.addClass("open"),e("#search input.search-input").on("keydown",(function(e){switch(e.which){case 38:o(-1,n);break;case 40:o(1,n);break;default:return}e.preventDefault()}))}))}function o(t,n){var a=n.find("a").length,i=parseInt(n.find("a.hover").parent().attr("n"));isNaN(i)&&(i=-1);var o=i+t,s=n.height()-2,r=parseInt(n.find("a.hover").outerHeight());o<0||o>=a||e.each(n.find("a"),(function(t,a){t==i&&e(this).removeClass("hover"),t==o&&(e(this).addClass("hover"),r*(t+1)-n.scrollTop()>s?n.scrollTop(r*(t+1)-s):r*(t+1)-n.scrollTop()<r&&n.scrollTop()>0&&n.scrollTop(r*t))}))}function s(){var t=e(".ht-search-dropdown a.hover");0!=t.length?t.is(".search-key-button")?kenticoThemeOpenSearchResultsPage():window.location.href=t.attr("href"):kenticoThemeOpenSearchResultsPage()}function r(){e("article.ht-content").outerHeight()<e(window).innerHeight()?e("#ht-jump-top").fadeOut():e("#ht-jump-top").fadeIn()}function c(n){switch(parseInt(e("#ht-mq-detect").css("width").replace("px",""))){case 1:t="mobile";break;case 2:t="potrait";break;case 3:t="landscape";break;case 4:case 5:t="desktop"}var a=e("meta[name='confluence-base-url']").attr("content"),i=e("meta[name='confluence-space-key']").attr("content").toLowerCase(),o=a;i!==CONFIG.DOC_ROOT_URL_SPACE_KEY&&(o=o+"/"+i);var s=e(location).attr("href");s==o||s==o+"/"||s.indexOf(o+"/search")>=0||("desktop"==t?n||e("html").addClass("show-sidebar"):e("html").removeClass("show-sidebar"),"desktop"==t||"landscape"==t?e(".search-input").addClass("show"):e(".search-input").removeClass("show")),setTimeout((function(){e("#ht-sidebar").addClass("animate")}),500),setTimeout((function(){e(".search-input").addClass("animate")}),500)}e(document).ready((function(){c(!1),function(){window.SCROLL&&window.SCROLL.initPageTree&&window.SCROLL.initPageTree();e("#ht-menu-toggle").bind("click",(function(e){e.preventDefault(),setTimeout(toggleSidebar(),.05)}))}(),m(),function(){var t=function(e,t){var n,a;return function(){var i=arguments,o=this,s=function(){a=e.apply(o,i)};return clearTimeout(n),n=setTimeout(s,t),a}},n=t(i,200),a=e("#search input.search-input");a.on("focus",(function(e){d=!0,a.on("blur",(function(e){d=!1}))})),a.on("input",(function(t){var i=a.val();i.length>=3&&n(i),0==i.length&&e(".ht-search-dropdown").removeClass("open")})),a.on("keydown",(function(e){13===e.which&&s()})),e("form#search").on("submit",(function(){return!1}))}(),e("#ht-search-button").bind("click",(function(e){e.preventDefault(),n()})),e("#searchButton").bind("click",(function(t){t.preventDefault(),e(".search-input").hasClass("show")||e(".search-input").is(":visible")?s():e(".search-input").addClass("show")})),e(".ht-search-clear").bind("click",(function(e){e.preventDefault(),a()})),r(),e("#ht-jump-top").bind("click",(function(t){t.preventDefault(),e("body,html").animate({scrollTop:0},100)})),d=!1,e("body").bind("keyup",(function(e){if(!d||27==e.which){switch(e.which){case 219:"desktop"!==t&&toggleSidebar();break;case 191:sidebarExpanded||n();break;case 71:71==h&&(sidebarExpanded||n());break;case 27:a()}h=e.which}})),e(".sp-picker").change((function(){e(this).closest("form").trigger("submit")})),function(){var t=500,n=10;window.location.hash&&setTimeout((function(){e(window).scrollTo(document.getElementById(window.location.hash.substr(1)),{offset:-(e("#ht-headerbar").height()+n),duration:t,interrupt:!0,axis:"y"})}),0);e(".ht-content").on("click",'a[href^="'+location.pathname+'\\#"], a[href^=\\#]',(function(a){a.preventDefault();var i=document.getElementById(this.hash.substr(1));return i||(i=document.getElementById(decodeURI(this.hash.substr(1)))),e(window).stop(!0).scrollTo(i,{offset:-(e("#ht-headerbar").height()+n),duration:t,interrupt:!0,axis:"y"}),history&&"file"!=location.protocol.substr(0,4)&&history.pushState({},"",e(a.target).attr("href")),!1}))}(),e("#ht-loader").hide()})),function(){var t=e(".js-header-search-open"),n=e(".js-header-search-close"),a=e(".js-header-search-box"),i=250;t.click((function(e){a.css("display","flex").hide().fadeIn(i)})),n.click((function(e){a.fadeOut(i)}));var o=e(".js-menu-toggle"),s=e("#ht-sidebar");function r(){o.removeClass("is-active"),s.fadeOut(i)}o.click((function(e){o.hasClass("is-active")?r():(o.addClass("is-active"),s.fadeIn(i))})),window.addEventListener("click",(function(e){o[0].contains(e.target)||s[0].contains(e.target)||r()}))}();var d,h,l,u=new Date(1,1,2e3,12,0,0),p=!1,f=200;function w(){new Date-u<f?setTimeout(w,f):(p=!1,r(),c(!0),m())}function m(){e("#ht-wrap-container").width()>640?(e("#ht-wrap-container").addClass("sp-grid-float"),e("#ht-wrap-container").removeClass("sp-grid-fluid"),e(".sp-grid-cell.sp-grid-60").first().after(e(".sp-grid-cell.sp-grid-40"))):(e("#ht-wrap-container").addClass("sp-grid-fluid"),e("#ht-wrap-container").removeClass("sp-grid-float"),e(".sp-grid-cell.sp-grid-60").first().before(e(".sp-grid-cell.sp-grid-40")))}e(window).resize((function(){u=new Date,!1===p&&(p=!0,setTimeout(w,f))})),new ClipboardJS(".js-codeClipboard",{target:function(t){return e(t).closest(".js-codePanel").find(".js-code")[0]}}).on("success",(function(t){var n=e(t.trigger);n.addClass("is-copied"),l&&window.clearTimeout(l),l=window.setTimeout((function(){n.removeClass("is-copied")}),2e3),t.clearSelection()}))}($);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRoZW1lLm1haW4uanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsIlNDUk9MTF9XRUJIRUxQIiwidGV4dCIsImh0bWwiLCJ2aWV3cG9ydCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImluZGV4T2YiLCJPYmplY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJIVE1MRWxlbWVudCIsInJlc3VsdHNMaXN0IiwiYmluZCIsImUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJsZW5ndGgiLCJoYXNDbGFzcyIsImVtcHR5IiwidW5iaW5kIiwiaGFuZGxlU2VhcmNoUmVzdWx0cyIsImVhY2giLCJzZWFyY2hSZXN1bHRzIiwiYWRkQ2xhc3MiLCJzZWFyY2hGaWVsZEFjdGl2ZSIsImZvY3VzIiwia2V5YnV0dG9uIiwiY2hpbGRyZW4iLCJyZW1vdmVDbGFzcyIsImRvY3VtZW50IiwiZG9TZWFyY2giLCJxdWVyeSIsImRyb3Bkb3duIiwicHJldmVudERlZmF1bHQiLCJmaW5kIiwic2VhcmNoIiwicGVyZm9ybVNlYXJjaCIsImN1cnJlbnRpdGVtIiwiaW5kZXgiLCJzZWFyY2hSZXN1bHQiLCJsaW5rIiwiZXNjYXBlSHRtbCIsInRpdGxlIiwibmV4dGl0ZW0iLCJrZXlidXR0b25fbGluayIsImtleWJ1dHRvbl9zZWFyY2hlZFRlcm0iLCJkZWNvZGVVUklDb21wb25lbnQiLCJrZXlidXR0b25fbGkiLCJhcHBlbmQiLCJzY3JvbGxUb3AiLCJpdGVtaGVpZ2h0IiwiaXRlbSIsImxpIiwic2VsZWN0ZWQiLCJsb2NhdGlvbiIsImF0dHIiLCJ3aGljaCIsImRyb3Bkb3duS2V5ZG93biIsImtlbnRpY29UaGVtZU9wZW5TZWFyY2hSZXN1bHRzUGFnZSIsImNsb3NlU2VhcmNoIiwiZGlyZWN0aW9uIiwiaXRlbWNvdW50IiwicGFyc2VJbnQiLCJwYXJlbnQiLCJpc05hTiIsImRyb3Bkb3duSGVpZ2h0IiwiaGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCIkY2xvc2VTZWFyY2giLCJ0cmFuc2l0aW9uTXMiLCJ2YWwiLCJjbGljayIsInRoaXMiLCJjc3MiLCIkc2lkZWJhciIsIiRtZW51VG9nZ2xlIiwiaXMiLCJocmVmIiwiY2hlY2tGb290ZXIiLCJpbm5lckhlaWdodCIsImZpcmVFdmVudCIsIndvcmtlZCIsImZhZGVJbiIsImNoZWNrRGV2aWNlIiwicmVzaXplIiwiaW5pdEtleWJvYXJkIiwicmVwbGFjZSIsInNpZGViYXJFeHBhbmRlZCIsImJhc2VVcmwiLCJzcGFjZUtleSIsInRvTG93ZXJDYXNlIiwiaG9tZVBhdGgiLCJDT05GSUciLCJET0NfUk9PVF9VUkxfU1BBQ0VfS0VZIiwiY3VyclBhdGgiLCJzZXRDb29raWUiLCJzZXRJdGVtIiwibG9jYWxTdG9yYWdlIiwiY3ZhbHVlIiwiY29va2llIiwiZXhwaXJlcyIsInNldFRpbWVvdXQiLCJyZWFkeSIsImR1cmF0aW9uIiwiU0NST0xMIiwiaW5pdFBhZ2VUcmVlIiwiaW50ZXJydXB0IiwidG9nZ2xlU2lkZWJhciIsImluaXRTaWRlYmFyIiwiaW5pdFNlYXJjaCIsImlucHV0IiwiZnVuYyIsIndhaXQiLCJyZXN1bHQiLCJhcmdzIiwiYXJndW1lbnRzIiwiY29udGV4dCIsImRlYm91bmNlZCIsImFwcGx5IiwiY2xlYXJUaW1lb3V0IiwidGltZW91dCIsIm9wZW5TZWFyY2giLCJkZWJvdW5jZWRTZWFyY2giLCJkZWJvdW5jZSIsIm9uIiwic3RyIiwic3ZnIiwidG9nZ2xlIiwiY29udGFpbmVyIiwibGFiZWwiLCJhbGxBY2Nlc3NpYmxlIiwiYWxsRW50cmllc0FjY2Vzc2libGUiLCJzZWxlY3QiLCJzZWxlY3RvciIsImVsZW1lbnQiLCJhbmltYXRlIiwiY3JlYXRlRXZlbnQiLCJjbGlwYm9hcmQiLCIkdHJpZ2dlciIsImNsaXBib2FyZFRpbWVvdXQiLCJsYXN0S2V5Iiwic2Nyb2xsVG9Qb3NpdGlvbiIsImNoYW5nZSIsImNsb3Nlc3QiLCJ0cmlnZ2VyIiwiYWRkaXRpb25hbE9mZnNldCIsImhhc2giLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdWJzdHIiLCJvZmZzZXQiLCJheGlzIiwicGF0aG5hbWUiLCJkZWNvZGVVUkkiLCJwcm90b2NvbCIsInRhcmdldCIsImhpZGUiLCIkb3BlblNlYXJjaCIsIiRzZWFyY2giLCJ0b29nbGVEcm9wZG93biIsImZhZGVPdXQiLCJoaWRlTWVudSIsImNyZWF0ZU9wdGlvblRleHQiLCJvcHRpb24iLCJvcHRpb25UZXh0IiwidmVyc2lvbkFjY2Vzc2libGUiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJvcGVuIiwicnRpbWUiLCJ2YWx1ZSIsImRlbHRhIiwicmVzaXplZW5kIiwiRGF0ZSIsInN1YnN0cmluZyIsImNoZWNrR3JpZCIsIndpZHRoIiwiZmlyc3QiLCJhZnRlciIsImJlZm9yZSIsImNvbnNvbGUiLCJuYW1lIiwic3BsaXQiLCJDbGlwYm9hcmRKUyIsImNsZWFyU2VsZWN0aW9uIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFDQSxHQVFHQyxPQUFPQyxlQUFpQkQsT0FBT0MsZ0JBQW9CLENBQUEsRUFHL0NELE9BQU9ELGVBQWFHLFdBQWUsU0FBRUEsR0FDeEMsT0FBQUgsRUFBQSxXQUFBRyxLQUFBQSxHQUFBQyxNQUVELEVBRUEsSUFDQUMsRUFBQSxVQUlZQyxVQUFVQyxVQUFVQyxRQUFRLFFBQVUsR0FBT0YsVUFBVUMsVUFBVUMsUUFBUSxXQUdwRUMsT0FBQ0MsVUFBV0MsU0FBQUMsS0FBQVgsT0FBQVksYUFBQUwsUUFBQSxlQTRQekIsU0FBSU0sSUFDTGQsRUFBQSxRQUFBZSxLQUFBLFNBQUEsU0FBQUMsSUFDR0MsRUFBQUEsRUFBQUEsUUFBQUEsUUFBeUIsY0FBQUMsUUFBQWxCLEVBQUEsY0FBQW1CLFNBQUEsVUFFZkMsRUFBQUEsUUFBT0MsT0FBQSxTQUVmQyxJQTFDSixJQTZDTUMsRUFBQUEsY0FBS0MsU0FBZSxRQUNsQlYsWUFBVyxXQUNiZCxFQUFBLG9CQUFBeUIsU0FBQSxPQTNDTixHQUFHLEtBNkNDQyxHQUFBLEVBQ0ExQixFQUFBLGlCQUFBLEdBQUEyQixPQTNDUixDQUdBLFNBNENZQyxJQUVKQSxNQUFVYixFQUFBQSxjQU1WRCxNQUFBQSxLQUFZZSx1QkFBb0JDLFlBQWMsUUFHZDlCLEVBQUM4QiwrQkFDSEEsWUFBUSxTQUVwQzlCLEVBQUErQixVQUFBVixPQUFBLFVBN0NWLENBV0EsU0FtRG9CVyxFQUFBQyxHQUFPLElBQUFDLEVBQUFsQyxFQUFBLHdDQUdibUMsRUFBZ0JELEVBQUFFLEtBQUEsTUFsRGhDSCxFQW9ET2hCLG1CQUFBZ0IsR0FHR2hDLEVBQU9DLFFBK0RERCxPQUFBQyxnQkFBMEJELE9BQU9DLGVBQUFtQyxRQUN2Q3BDLE9BQUFDLGVBQUFtQyxPQUFBQyxjQUFBTCxHQTlEUixTQUFBVCxFQUFBUyxHQUlRTSxFQUFBQSxLQUFXZixHQUFZVSxTQUFhTSxFQUFDQyxHQUMvQkYsRUFBYUEsT0FBQUEsVUFBZ0JDLEVBQUEsb0NBQUFDLEVBQUFDLEtBQUEsS0FBQXhDLGVBQUF5QyxXQUFBRixFQUFBRyxPQUFBLFlBRW5DQyxJQU9HWCxJQUFBQSxFQUFvQmxDLEVBQUEsNkJBQXNCd0IsRUFBQU4sT0FBQSxXQUNwQzRCLEVBQWlCOUMsRUFBQywyREFDbEIrQyxFQUFjL0MsRUFBQSxXQUFBRyxLQUFBNkMsbUJBQUFmLElBQ1hSLEVBQVN3QixFQUFRQyxPQUFBSixFQUFBSSxPQUFBSCxJQUdyQmIsRUFBU2lCLEtBQUFBLFNBQVdDLFNBQWNaLEdBQy9CRixJQUNISixFQUFRQyxnQkFDWixJQUNKckIsRUFBQW9DLE9BQUF0QixHQUVSZCxFQUFBZSxTQUFBLE1BQUFOLE1BQUEsU0FBQWlCLEVBQUFhLEdBMURZLElBQUlDLEVBQUt0RCxFQUFFcUQsR0E2RHZCQyxFQUFBdkMsS0FBQSxhQUFBLFdBQ1N1QixFQUFnQkYsS0FBQSxRQUFBTixZQUFBLFNBQzNCd0IsRUFBQWxCLEtBQUEsS0FBQVgsU0FBQSxRQUNrQixHQUVkOEIsSUFFSXJCLEVBQUFULFNBQUEsUUFFU3pCLEVBQUEsOEJBRUl3RCxHQUFBQSxXQUFnQkQsU0FBU0UsR0FDcEMsT0FBQXpDLEVBQUEwQyxPQUNHLEtBQUEsR0FDWkMsR0FBQSxFQUFBekIsR0FDUzBCLE1BRVIsS0FBQSxHQTVEb0JELEVBQWdCLEVBQUd6QixHQStEbkIsTUFHVkMsUUFDVSxPQUlWQSxFQUFBQSxnQkFDRyxHQUNKRyxHQU1MdEMsQ0EvREosU0FpRVE2RCxFQUFhQyxFQUFBNUIsR0FDZixJQUFBNkIsRUFBQTdCLEVBQUFFLEtBQUEsS0FBQWxCLE9BQ05xQixFQUFBeUIsU0FBQTlCLEVBQUFFLEtBQUEsV0FBQTZCLFNBQUFSLEtBQUEsTUFoRVFTLE1BQU0zQixLQUFhQSxHQUFlLEdBbUU5QyxJQUFBTSxFQUFBTixFQUFBdUIsRUFDQUssRUFBQWpDLEVBQUFrQyxTQUFBLEVBRUtoQixFQUFXWSxTQUFBOUIsRUFBQUUsS0FBQSxXQUFBaUMsZUFFSkMsRUFBZXRFLEdBQUU2QyxHQUFBa0IsR0FFakJRLEVBQUFBLEtBQUFBLEVBQWVuQyxLQUFHLE1BQUEsU0FBQUksRUFBQWdDLEdBRVZDLEdBQU1sQyxHQUFZdkMsRUFBQTBFLE1BQUE1QyxZQUFBLFNBRXJCNkMsR0FBSTlCLElBR1g3QyxFQUFBMEUsTUFBQWpELFNBQUEsU0FHaUIyQixHQUFjWixFQUFBLEdBQUFOLEVBQUFpQixZQUFBZ0IsRUFDL0JqQyxFQUFBaUIsVUFBQUMsR0FBQVosRUFBQSxHQUFBMkIsR0FFa0JmLEdBQWtCWixFQUFBLEdBQUFOLEVBQUFpQixZQUFBQyxHQUFBbEIsRUFBQWlCLFlBQUEsR0FDdEJqQixFQUFDaUIsVUFBY0MsRUFBQVosR0FJM0JvQyxHQUNKLENBS0EsU0FBQXRDLElBR0ksSUFBSXVDLEVBQVkxRCxFQUFBQSwrQkFFVCxHQUFQb0MsRUFBT3JDLE9BQ0txQyxFQUFFdUIsR0FBQSxzQkFFaEJsQixvQ0FJYzNELE9BQUV1RCxTQUFBdUIsS0FBQXhCLEVBQUFFLEtBQUEsUUF2RWRHLG1DQThFWixDQXdQUSxTQUFPb0IsSUFBeUJoRixFQUFBLHNCQUFBcUUsY0FBQXJFLEVBQUFDLFFBQUFnRixjQUN0QmpGLEVBQUEsZ0JBQVdrRixVQUVoQkMsRUFBQUEsZ0JBQVVDLFFBR25CLENBT0EsU0FBV0MsRUFBQUMsR0FLTCxPQUhHQyxTQUFZdkYsRUFBRyxpQkFBQTJFLElBQUEsU0FBQWEsUUFBQSxLQUFBLE1BSVo5RCxLQUFBQSxFQUNBckIsRUFBQSxTQUNKLE1BR0ksS0FBUSxFQUFFQSxFQUFBLFVBQ0ZBLE1BRUosS0FBQSxFQUNBQSxFQUFBLFlBRUksTUFDSixLQUFLb0YsRUFLVCxLQUFPLEVBQUVwRixFQUFBLFVBdEdqQixJQTBHZ0JxRixFQUFBMUYsRUFBQSxvQ0FBQXlELEtBQUEsV0FDSmtDLEVBQUEzRixFQUFBLHFDQUFBeUQsS0FBQSxXQUFBbUMsY0FDQUMsRUFBQUgsRUF4R2RDLElBMEdtQkcsT0FBQUMseUJBekd0QkYsRUEwR2lCaEMsRUFBYSxJQUFBOEIsR0FDUCxJQUFBSyxFQUFBaEcsRUFBQXdELFVBQUFDLEtBQUEsUUFLdEJ1QyxHQUFBSCxHQUFBRyxHQUFBSCxFQUFBLEtBQUFHLEVBQUF4RixRQUFBcUYsRUFBQSxZQUFBLElBMUd3QixXQUFaeEYsRUE2R1ppRixHQUNKdEYsRUFBQSxRQUFBeUIsU0FBQSxnQkFHYXdFLEVBQUFBLFFBQWVuRSxZQUFVLGdCQUdUb0UsV0FBYkMsR0FBbUMsYUFBUEMsRUFDdkJwRixFQUFDLGlCQUFFUyxTQUFBLFFBRVp6QixFQUFBLGlCQUFBOEIsWUFBQSxTQUtBQyxZQUFTc0UsV0FBY3JHLEVBQUcsZUFBZXlCLFNBQU82RSxVQUFVLEdBQUEsS0FDOURDLFlBQUEsV0FBQXZHLEVBQUEsaUJBQUF5QixTQUFBLFVBQUEsR0FBQSxJQUNKLENBN3VCSXpCLEVBQUErQixVQUFBeUUsT0FBQSxXQUlBbkIsR0FBQSxHQXNGSixXQTJCb0JvQixPQUFRQyxRQUFVekcsT0FBQXlHLE9BQUFDLGNBQ2xCQyxPQUFTRixPQUFNQyxlQUkxQjNHLEVBQUcsbUJBQUNlLEtBQUEsU0FBQSxTQUFBQyxHQUNUQSxFQUFBbUIsaUJBRUVvRSxXQUFpQk0sZ0JBQVUsSUFDdkIxRSxHQTNCVixDQTNGSTJFLEdBQ0FDLElBMkxBQyxXQUNJLElBQU10RCxFQUFVLFNBQUl1RCxFQUFBQyxHQUNoQjVFLElBQUFBLEVBQ0o2RSxFQUNGLE9BQUEsV0F2Q00sSUFBSUMsRUFBT0MsVUF5Q0hDLEVBQUk1QyxLQUF1QjZDLEVBQUEsV0FDM0JKLEVBQUFGLEVBQUFPLE1BQUFGLEVBQUFGLEVBQ2QsRUFJUXJHLE9BSGQwRyxhQUFBQyxHQUVTQyxFQUFhcEIsV0FBQWdCLEVBQUFMLEdBQ0hDLENBQ0wsQ0FDRm5ILEVBRUo0SCxFQUFBQyxFQUFBN0YsRUFBQSxLQUVGZ0YsRUFBY3ZGLEVBQUFBLDhCQUNoQjhFLEVBQVV1QixHQUFDLFNBQUEsU0FBWTlHLEdBQ2pCVSxHQUFvQkQsRUFFMUJDLEVBQUFBLEdBQWlCLFFBQU8sU0FBQVYsR0FDdEJVLEdBQTJCLENBQ2pDLEdBdkNJLElBMkNBc0YsRUFBVWMsR0FBQSxTQUFZLFNBQUM5RyxHQUN2QixJQUFBK0csRUFBQWYsRUFBQXhDLE1BQ0F1RCxFQUFBN0csUUFBQSxHQUNBMEcsRUFBQUcsR0FyQ3NCLEdBQWRBLEVBQUk3RyxRQXlDWmxCLEVBQUEsdUJBQUE4QixZQUFBLE9BSUVDLElBdkNGaUYsRUFBTWMsR0FBRyxXQUFXLFNBQVU5RyxHQTBDbEMsS0FBQUEsRUFBQTBDLE9BQ0FwQixHQUVKLElBRUF0QyxFQUFBLGVBQUE4SCxHQUFBLFVBQUEsV0FDQSxPQUFBLENBeENRLEdBMkNKLENBMU9JZixHQXNhSWlCLEVBQUFBLHFCQUFNakgsS0FBQSxTQUFBLFNBQUFDLEdBQ05pSCxFQUFNOUYsaUJBQ1YrRixHQUVJQyxJQUdBakcsRUFBQUEsaUJBQWFuQixLQUFBLFNBQUEsU0FBQUMsR0FDakJrSCxFQUFVaEYsaUJBRU5rRixFQUFBQSxpQkFBZ0JDLFNBQUFBLFNBQTRCckksRUFBQSxpQkFBQThFLEdBQUEsWUFDekN3RCxJQUVNbEcsRUFBQUEsaUJBQWtCaUIsU0FBSyxPQUdwQ2lGLElBRUlMLEVBQUFBLG9CQUF3QmxILEtBQUN1SCxTQUFZLFNBQUF0SCxHQUN2Q0EsRUFBQW1CLGlCQUVLcEIsR0FDRG9CLElBbU5WNkMsSUFFQWhGLEVBQUEsZ0JBQW9CdUksS0FBUSxTQUFFLFNBQUF2SCxHQUN0QndILEVBQUFBLGlCQUFnQ3hJLEVBQUEsYUFBUXlJLFFBQUEsQ0FFL0JDLFVBQWEsR0FBRSxJQUN4QixJQW9JQWhILEdBQUEsRUFHSmlILEVBQUFBLFFBQWE1SCxLQUFBLFNBQVcsU0FBYUMsR0FDN0I0SCxJQUFBQSxHQUF1QixJQUFBNUgsRUFBQTBDLE1BQXZCa0YsQ0FLSixPQUFBNUgsRUFBQTBDLE9BRUFtRixLQUFBQSxJQUN5QixZQUFaL0csR0FDTCtFLGdCQUdWLE1BRUwsS0FBQSxJQW5Ib0JwQixpQkFDRGtDLElBRUosTUFFSixLQUFLLEdBQ2MsSUFBWG1CLElBQ0tyRCxpQkFDRGtDLEtBR1IsTUFFSixLQUFLLEdBQ0Q5RCxJQUlSaUYsRUFBVTlILEVBQUUwQyxLQXNGUm1GLENBckZSLElBanNCQUUsRUFBQUEsY0FBa0JDLFFBQUEsV0FKZGhKLEVBQUUwRSxNQUFNdUUsUUFBUSxRQUFRQyxRQUFRLFNBTXBDLElBaUZKLFdBK0JnQnRDLElBQUFBLEVBQWUsSUFDWHVDLEVBQUUsR0E1QmRsSixPQUFPdUQsU0FBUzRGLE1BaUNoQjdDLFlBQUEsV0FDSThDLEVBQU9wSixRQUFJdUQsU0FDSDhGLFNBQVlDLGVBQWdCdEosT0FBT3VELFNBQVE0RixLQUFBSSxPQUFBLElBQ3ZELENBQ1lDLFNBQUF6SixFQUFBLGlCQUFBb0UsU0FBQStFLEdBQ2QxQyxTQUFBQSxFQUNORyxXQUFBLEVBOUJvQjhDLEtBQU0sS0FtQzlCLEdBQUEsR0FHWTdCLEVBQUFBLGVBQVdDLEdBQVhELFFBQW9CWixZQUFZekQsU0FBQW1HLFNBQUEsdUJBQUEsU0FBQTNJLEdBQzVCMEcsRUFBQUEsaUJBQ0FQLElBQU1xQixFQUFBekcsU0FBQXdILGVBQUE3RSxLQUFBMEUsS0FBQUksT0FBQSxJQXlCTixPQXhCR2hCLElBRUNsQixFQUFjdkYsU0FBQXdILGVBQUFLLFVBQUFsRixLQUFBMEUsS0FBQUksT0FBQSxNQUVkckMsRUFBQUEsUUFBU0YsTUFBS08sR0FBTUYsU0FDdkJrQixFQUNEZixDQUNVbEIsU0FBV2dCLEVBQUFBLGlCQUFnQm5ELFNBQUErRSxHQUM5QmhDLFNBQU1WLEVBQ2hCRyxXQUFBLEVBQ0o4QyxLQUFBLE1BU09oSSxTQUF5QixRQUFSOEIsU0FBUXFHLFNBQUFMLE9BQUEsRUFBQSxJQUMzQkgsUUFBQUMsVUFBQSxDQUFBLEVBQUEsR0FBQXRKLEVBQUFnQixFQUFBOEksUUFBQXJHLEtBQUEsVUFJRyxDQUNMLEdBcENSLENBOUhJc0YsR0FRUi9JLEVBQUEsY0FBQStKLE1BSkksSUFvV0EsV0FxRlkvSixJQUFFZ0ssRUFBTWxJLEVBQVksMEJBQ3ZCd0MsRUFBTXRFLEVBQUEsMkJBQ0R1QixFQUFVdkIsRUFBR2tJLHlCQUNYM0QsRUFBaUIsSUFsRjdCeUYsRUFvRll2RixPQUFBLFNBQUF6RCxHQUNGaUosRUFFRkMsSUFBQUEsVUFBd0IsUUFDaEJ6SSxPQUNaMkQsT0FBQWIsRUFFQSxJQUVSRCxFQUFBRyxPQUFBLFNBQUF6RCxHQXJGUWlKLEVBQVFFLFFBQVE1RixFQXVGeEIsSUFFUTZELElBQUFBLEVBQWdCcEksRUFBSSxtQkFDcEJzSSxFQUFZdEksRUFBQSxlQS9FaEIsU0FBU29LLElBdUZidkYsRUFBQS9DLFlBQUEsYUFDU3VJLEVBQUFBLFFBQWlCQyxFQUNsQkMsQ0FFQTFGLEVBQUkyRixPQUFBQSxTQUFvQkYsR0FDcEJFLEVBQWlCckosU0FBRSxhQUNuQm9KLEtBWEYxRixFQUFBcEQsU0FBQSxhQUNObUQsRUFBQVEsT0FBQWIsR0FjUWdHLElBRVJ0SyxPQUFBd0ssaUJBQUEsU0FBQSxTQUFBekosR0FDT3VKLEVBQVUsR0FBQUcsU0FBQTFKLEVBQUE4SSxTQUFBbEYsRUFBQSxHQUFBOEYsU0FBQTFKLEVBQUE4SSxTQUNyQk0sR0FHUU8sR0F0RlAsQ0EzQ0QsR0F3UUEsSUEwSlFiLEVBQ0loQixFQUpKRCxFQXZKSitCLEVBNkdZLElBQU9DLEtBQUssRUFBQSxFQUFBLElBQUEsR0FBQSxFQUFBLEdBQ2hCbkQsR0FBQSxFQUNGb0QsRUFBUSxJQXBHbEIsU0E2R2lCQyxJQUNELElBQUFDLEtBQVNDLEVBQWNILEVBQzNCdkUsV0FBQXdFLEVBQUFELElBRVJwRCxHQUFBLEVBRU8xQyxJQUNYSyxHQUFBLEdBN0dRNkYsSUFpSFosQ0FFSSxTQUFTQSxJQUNEbEwsRUFBRSxzQkFBc0JtTCxRQUFVLEtBQ2xDbkwsRUFBRSxzQkFBc0J5QixTQUFTLGlCQUNqQ3pCLEVBQUUsc0JBQXNCOEIsWUFBWSxpQkFFcEM5QixFQUFFLDRCQUE0Qm9MLFFBQVFDLE1BQU1yTCxFQUFFLCtCQUU5Q0EsRUFBRSxzQkFBc0J5QixTQUFTLGlCQUNqQ3pCLEVBQUUsc0JBQXNCOEIsWUFBWSxpQkFFcEM5QixFQUFFLDRCQUE0Qm9MLFFBQVFFLE9BQU90TCxFQUFFLDZCQUV2RCxDQTlJQUEsRUFBRUMsUUE2R1VzTCxRQUFZLFdBQ2hCWCxFQUFBLElBQUFJLE1BQ0csSUFBQXRELElBQ0M4RCxHQUFZLEVBQ1ZqRixXQUFXd0UsRUFBUVUsR0EzR2pDLElBZ0pvQixJQUFJQyxZQUFZLG9CQUFxQixDQUNqRDVCLE9BQVEsU0FBU1osR0FJYixPQUhhbEosRUFBRWtKLEdBQVNELFFBQVEsaUJBQ2I3RyxLQUFLLFlBRVgsRUFDakIsSUFHTTBGLEdBQUcsV0FBVyxTQUFVOUcsR0FDOUIsSUFBSTRILEVBQVc1SSxFQUFFZ0IsRUFBRWtJLFNBQ25CTixFQUFTbkgsU0FBUyxhQUVkb0gsR0FDQTVJLE9BQU93SCxhQUFhb0IsR0FHeEJBLEVBQW1CNUksT0FBT3NHLFlBQVcsV0FDakNxQyxFQUFTOUcsWUFBWSxZQUN6QixHQUFHLEtBRUhkLEVBQUUySyxnQkFDTixHQUVQLENBbjFCRCxDQW0xQkczTCIsImZpbGUiOiJ0aGVtZS5tYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCQpIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEsxNXQgSGVscCBUaGVtZVxuICAgICAqIE1vZGlmaWVkIE1haW4gSmF2YXNjcmlwdFxuICAgICAqXG4gICAgICoqL1xuXG4gICAgd2luZG93LlNDUk9MTF9XRUJIRUxQID0gd2luZG93LlNDUk9MTF9XRUJIRUxQIHx8IHt9O1xuXG4gICAgd2luZG93LlNDUk9MTF9XRUJIRUxQLmVzY2FwZUh0bWwgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIHJldHVybiAkKCc8ZGl2IC8+JykudGV4dCh0ZXh0KS5odG1sKCk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgc2VhcmNoVVJMID0gJ3NlYXJjaC5qc29uJztcbiAgICB2YXIgdmlld3BvcnQgPSAnZGVza3RvcCc7XG4gICAgdmFyIHN2ZHJvcGRvd24gPSBmYWxzZTtcbiAgICAvLyB2YXIgcGFnZUlkO1xuXG4gICAgLy8gZmlyZWZveCBkZXRlY3Rpb25cbiAgICB2YXIgaXNGaXJlZm94ID0gdHlwZW9mIEluc3RhbGxUcmlnZ2VyICE9PSAndW5kZWZpbmVkJzsgLy8gRmlyZWZveCAxLjArXG4gICAgdmFyIGlzSUUgPSAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRVwiKSA+IDApIHx8IChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJUcmlkZW50XCIpID4gMCk7XG4gICAgdmFyIGlzU2FmYXJpID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHdpbmRvdy5IVE1MRWxlbWVudCkuaW5kZXhPZignQ29uc3RydWN0b3InKSA+IDA7IC8vIEF0IGxlYXN0IFNhZmFyaSAzKzogXCJbb2JqZWN0IEhUTUxFbGVtZW50Q29uc3RydWN0b3JdXCJcblxuICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIC8vIHBhZ2VJZCA9ICQoJ2JvZHknKS5hdHRyKCdwYWdlaWQnKTtcbiAgICAgICAgLyogU2V0IFR5cGUgb2YgRGV2aWNlICovXG4gICAgICAgIGNoZWNrRGV2aWNlKGZhbHNlKTsgLy8gQ1VTVE9NIC0gZmFsc2UgcGFyYW1ldGVyIHRvIGluZGljYXRlIHRoYXQgdGhlIGNhbGwgaXMgb24gdGhlIGluaXRpYWwgcGFnZSBsb2FkXG5cbiAgICAgICAgLyogaW5pdCBTaWRlYmFyIEZ1bmN0aW9ucyAqL1xuICAgICAgICAvLyBpbml0RHJhZ2JhcigpO1xuICAgICAgICBpbml0U2lkZWJhcigpO1xuICAgICAgICBjaGVja0dyaWQoKTtcblxuICAgICAgICAvKiBpbml0IFNlYXJjaCBGdW5jdGlvbnMgKi9cbiAgICAgICAgaW5pdFNlYXJjaCgpO1xuICAgICAgICBpbml0QnV0dG9ucygpO1xuXG4gICAgICAgIGluaXRGb290ZXIoKTtcbiAgICAgICAgLy8gc2V0Q29udGVudFdpZHRoKCk7IC8vIENVU1RPTSBjb250ZW50IHdpZHRoIGFkanVzdG1lbnRzXG5cbiAgICAgICAgLyogaW5pdCBLZXlib2FyZCAqL1xuICAgICAgICBpbml0S2V5Ym9hcmQoKTtcblxuICAgICAgICAkKCcuc3AtcGlja2VyJykuY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQodGhpcykuY2xvc2VzdCgnZm9ybScpLnRyaWdnZXIoJ3N1Ym1pdCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvKiBoYW5kbGUgbGlua3MgdG8gYW5jaG9ycyBjb3JyZWN0bHkgd2l0aCB0aGUgaGVhZGVyYmFyICovXG4gICAgICAgIHNjcm9sbFRvUG9zaXRpb24oKTtcblxuICAgICAgICAvL3NldFRpbWVvdXQoZnVuY3Rpb24oKSB7JCgnI2h0LWxvYWRlcicpLmhpZGUoKTt9LCA1MDApO1xuICAgICAgICAkKCcjaHQtbG9hZGVyJykuaGlkZSgpO1xuICAgIH0pO1xuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgUmVzaXplIFNpZGViYXIgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgIGZ1bmN0aW9uIGluaXREcmFnYmFyKCkge1xuICAgICAgICBzZXREcmFnYmFyKHBhcnNlSW50KGdldENvb2tpZSgnc2lkZWJhci13aWR0aCcpKSk7XG5cbiAgICAgICAgJCgnI2h0LXNpZGViYXItZHJhZ2JhcicpLm1vdXNlZG93bihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgJChkb2N1bWVudCkubW91c2Vtb3ZlKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vdXNleCA9IGUucGFnZVggKyAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1vdXNleCA8IDE5MCB8fCBtb3VzZXggPiAkKHdpbmRvdykuaW5uZXJXaWR0aCgpIC0gNDU1KXJldHVybjtcblxuICAgICAgICAgICAgICAgIGlmIChtb3VzZXggPCAyMjApJCgnI2h0LXNpZGViYXInKS5hZGRDbGFzcygnc21hbGwnKTtcbiAgICAgICAgICAgICAgICBlbHNlICQoJyNodC1zaWRlYmFyJykucmVtb3ZlQ2xhc3MoJ3NtYWxsJyk7XG5cblxuICAgICAgICAgICAgICAgIHNldERyYWdiYXIobW91c2V4KTtcbiAgICAgICAgICAgICAgICBzZXRDb29raWUoJ3NpZGViYXItd2lkdGgnLCBtb3VzZXgpO1xuXG4gICAgICAgICAgICAgICAgY2hlY2tHcmlkKCk7XG5cbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5tb3VzZXVwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCgnbW91c2Vtb3ZlJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2V0U2Nyb2xsVmVyc2lvblNlbGVjdCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldERyYWdiYXIodmFsKSB7XG4gICAgICAgIGlmICh2aWV3cG9ydCAhPSAnZGVza3RvcCcpcmV0dXJuO1xuXG4gICAgICAgIGlmICh2YWwgPT0gaXNOYU4oKSl2YWwgPSAyOTU7XG5cbiAgICAgICAgJCgnI2h0LXNpZGViYXInKS53aWR0aCh2YWwpO1xuICAgICAgICBpZiAodmFsIDwgMjIwKSQoJyNodC1zaWRlYmFyJykuYWRkQ2xhc3MoJ3NtYWxsJyk7XG5cbiAgICAgICAgJCgnI2h0LXdyYXAtY29udGFpbmVyJykuY3NzKFwibGVmdFwiLCB2YWwgKyAxMCk7XG4gICAgICAgICQoJyNodC1oZWFkZXJiYXInKS5jc3MoJ2xlZnQnLCB2YWwpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuZERyYWdiYXIoKSB7XG4gICAgICAgIGlmICgkKCcjaHQtc2lkZWJhcicpLmF0dHIoJ3N0eWxlJykgPT0gJycpcmV0dXJuO1xuICAgICAgICAkKCcjaHQtc2lkZWJhcicpLmF0dHIoJ3N0eWxlJywgJycpO1xuICAgICAgICAkKCcjaHQtd3JhcC1jb250YWluZXInKS5hdHRyKCdzdHlsZScsICcnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTY3JvbGxWZXJzaW9uU2VsZWN0KHZpc2libGUpIHtcbiAgICAgICAgJC5lYWNoKCQoJy5odC1zY3JvbGwtdmVyc2lvbnMtc2VsZWN0IHNlbGVjdCcpLCBmdW5jdGlvbiAoaW5kZXgsIHZhbCkge1xuICAgICAgICAgICAgc2V0RHJvcGRvd24oJCh0aGlzKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgVG9nZ2xlIFNpZGViYXJuYXYgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgIGZ1bmN0aW9uIGluaXRTaWRlYmFyKCkge1xuICAgICAgICBpZiAod2luZG93LlNDUk9MTCAmJiB3aW5kb3cuU0NST0xMLmluaXRQYWdlVHJlZSkge1xuICAgICAgICAgICAgd2luZG93LlNDUk9MTC5pbml0UGFnZVRyZWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgICQoJyNodC1tZW51LXRvZ2dsZScpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQodG9nZ2xlU2lkZWJhcigpLCAwLjA1KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gIFxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgICAgIEhlYWRlcmJhciAgICAgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgIGZ1bmN0aW9uIHNjcm9sbFRvUG9zaXRpb24oKSB7XG4gICAgICAgIHZhciBkdXJhdGlvbiA9IDUwMDtcbiAgICAgICAgdmFyIGFkZGl0aW9uYWxPZmZzZXQgPSAxMDtcblxuICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2gpIHtcbiAgICAgICAgICAgIC8vIE5ldCB0byBwdXQgaXQgYXQgdGhlIGVuZCBvZiB0aGUgZXZlbnQgbG9vcCBmb3IgbWFraW5nIGl0IHdvcmsgaW4gSUUgOi0oXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQod2luZG93KS5zY3JvbGxUbyhcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQod2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyKDEpKSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAtKCQoJyNodC1oZWFkZXJiYXInKS5oZWlnaHQoKSArIGFkZGl0aW9uYWxPZmZzZXQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJydXB0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXhpczogJ3knXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICAkKCcuaHQtY29udGVudCcpLm9uKCdjbGljaycsICdhW2hyZWZePVwiJytsb2NhdGlvbi5wYXRobmFtZSsnXFxcXCNcIl0sIGFbaHJlZl49XFxcXCNdJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmhhc2guc3Vic3RyKDEpKTtcbiAgICAgICAgICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIC8vIGxvb2sgZm9yIGVsZW1lbnQgd2l0aCBlbmNvZGVkIElEIC0gaGFzaCBpcyBwcm92aWRlZCBkaWZmZXJlbnQgaW4gRmlyZWZveFxuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkZWNvZGVVUkkodGhpcy5oYXNoLnN1YnN0cigxKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJCh3aW5kb3cpLnN0b3AodHJ1ZSkuc2Nyb2xsVG8oXG4gICAgICAgICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldDogLSgkKCcjaHQtaGVhZGVyYmFyJykuaGVpZ2h0KCkgKyBhZGRpdGlvbmFsT2Zmc2V0KSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBpbnRlcnJ1cHQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGF4aXM6ICd5J1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFB1c2hTdGF0ZSBpcyBub3Qgc3VwcG9ydGVkIGZvciBsb2NhbCBmaWxlcyAoZmlsZTovLy8uLi4pXG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzAxMjEwXG4gICAgICAgICAgICBpZiAoaGlzdG9yeSAmJiBsb2NhdGlvbi5wcm90b2NvbC5zdWJzdHIoMCw0KSAhPSAnZmlsZScpIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZSh7fSwgJycsICQoZS50YXJnZXQpLmF0dHIoJ2hyZWYnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICA9ICAgICAgICAgICAgICAgU2VhcmNoICAgICAgICAgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgIGZ1bmN0aW9uIGluaXRTZWFyY2goKSB7XG4gICAgICAgIHZhciBkZWJvdW5jZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHtcbiAgICAgICAgICAgIHZhciB0aW1lb3V0O1xuICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGRlYm91bmNlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGRlYm91bmNlZCwgd2FpdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRlYm91bmNlZFNlYXJjaCA9IGRlYm91bmNlKGRvU2VhcmNoLCAyMDApO1xuXG4gICAgICAgIHZhciBpbnB1dCA9ICQoJyNzZWFyY2ggaW5wdXQuc2VhcmNoLWlucHV0Jyk7XG4gICAgICAgIGlucHV0Lm9uKCdmb2N1cycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBzZWFyY2hGaWVsZEFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIGlucHV0Lm9uKCdibHVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBzZWFyY2hGaWVsZEFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgaW5wdXQub24oJ2lucHV0JywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIHN0ciA9IGlucHV0LnZhbCgpO1xuICAgICAgICAgICAgaWYgKHN0ci5sZW5ndGggPj0gMykge1xuICAgICAgICAgICAgICAgIGRlYm91bmNlZFNlYXJjaChzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoc3RyLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgJCgnLmh0LXNlYXJjaC1kcm9wZG93bicpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaW5wdXQub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUud2hpY2ggPT09IDEzKSB7XG4gICAgICAgICAgICAgICAgcGVyZm9ybVNlYXJjaCgpOyAvLyBDVVNUT01cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnZm9ybSNzZWFyY2gnKS5vbignc3VibWl0JywgZnVuY3Rpb24oKSB7IC8vIENVU1RPTVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcGVuU2VhcmNoKCkge1xuICAgICAgICAkKCdib2R5JykuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKCEkKGUudGFyZ2V0KS5wYXJlbnRzKCcjaHQtc2VhcmNoJykubGVuZ3RoICYmICQoJyNodC1zZWFyY2gnKS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICAgICAgICAgICAgJCgnYm9keScpLnVuYmluZCgnY2xpY2snKTtcbiAgICAgICAgICAgICAgICBjbG9zZVNlYXJjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgJCgnI2h0LXNlYXJjaCcpLmFkZENsYXNzKCdvcGVuJyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCgnLmh0LXNlYXJjaC1jbGVhcicpLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgICAgIH0sIDI1MCk7XG4gICAgICAgIHNlYXJjaEZpZWxkQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgJCgnLnNlYXJjaC1pbnB1dCcpWzBdLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgLy8gQ1VTVE9NOiBXZSBvbmx5IGhpZGUgc2VhcmNoIHN1Z2dlc3Rpb25zIG9uIGVzY1xuICAgIGZ1bmN0aW9uIGNsb3NlU2VhcmNoKCkge1xuICAgICAgICBpbnB1dCA9ICQoJyNodC1zZWFyY2gnKTtcbiAgICAgICAgLy9pbnB1dC5maW5kKCdpbnB1dCcpLnZhbCgnJyk7XG4gICAgICAgIC8vaW5wdXQuZmluZCgnaW5wdXQnKS5ibHVyKCk7XG4gICAgICAgIC8vaW5wdXQucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgLy8kKCcuaHQtc2VhcmNoLWNsZWFyJykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICAgaW5wdXQuZmluZCgnLmh0LXNlYXJjaC1kcm9wZG93bicpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XG4gICAgICBcbiAgICAgICAgLy8gQ1VTVE9NIC0gUmVtb3ZlcyB0aGUgaG92ZXIgY2xhc3MgZnJvbSBpdGVtcyBzZWxlY3RlZCBpbiB0aGUgc2VhcmNoIGRyb3AtZG93blxuXHRcdHZhciBzZWxlY3RlZFNlYXJjaExpbmtFbGVtZW50ID0gJChcIi5odC1zZWFyY2gtZHJvcGRvd24gYS5ob3ZlclwiKTtcbiAgICAgICAgc2VsZWN0ZWRTZWFyY2hMaW5rRWxlbWVudC5yZW1vdmVDbGFzcyhcImhvdmVyXCIpO1xuICAgICAgXG4gICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCgna2V5ZG93bicpO1xuICAgIH1cblxuICAgIC8vIENVU1RPTSAtIGNvbW1lbnRlZCBvdXQsIG5vdCB1c2VkIGluIG91ciBpbXBsZW1lbnRhdGlvblxuICAgIC8qZnVuY3Rpb24gbmF2aWdhdGVUb1NlYXJjaFJlc3VsdHNQYWdlKHF1ZXJ5KSB7XG4gICAgICAgIGlmICh3aW5kb3cuU0NST0xMX1dFQkhFTFAgJiYgd2luZG93LlNDUk9MTF9XRUJIRUxQLnNlYXJjaCkge1xuICAgICAgICAgICAgd2luZG93LlNDUk9MTF9XRUJIRUxQLnNlYXJjaC5uYXZpZ2F0ZVRvU2VhcmNoUGFnZShxdWVyeSk7XG4gICAgICAgICAgICBjbG9zZVNlYXJjaCgpO1xuICAgICAgICB9XG4gICAgfSovXG5cblxuICAgIGZ1bmN0aW9uIGRvU2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBkcm9wZG93biA9ICQoJy5odC1zZWFyY2gtaW5wdXQgLmh0LXNlYXJjaC1kcm9wZG93bicpO1xuICAgICAgICB2YXIgcmVzdWx0c0xpc3QgPSBkcm9wZG93bi5maW5kKCd1bCcpO1xuICAgICAgXHQvLyBDVVNUT00gLSBFc2NhcGVzIGZvcmJpZGRlbiBjaGFyYWN0ZXJzXG5cdFx0cXVlcnkgPSBlbmNvZGVVUklDb21wb25lbnQocXVlcnkpO1xuICAgICAgXG4gICAgICAgIHJlc3VsdHNMaXN0LmVtcHR5KCk7XG5cbiAgICAgICAgdmFyIGhhbmRsZVNlYXJjaFJlc3VsdHMgPSBmdW5jdGlvbihzZWFyY2hSZXN1bHRzLCBxdWVyeSkge1xuICAgICAgICAgICAgLy8gJChkb2N1bWVudCkudW5iaW5kKCdrZXlkb3duJyk7XG5cbiAgICAgICAgICAgICQuZWFjaChzZWFyY2hSZXN1bHRzLCBmdW5jdGlvbiAoaW5kZXgsIHNlYXJjaFJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdHNMaXN0LmFwcGVuZCgnPGxpIG49XCInICsgaW5kZXggKyAnXCIgY2xhc3M9XCJzZWFyY2gtcmVzdWx0XCI+PGEgaHJlZj1cIicgKyBzZWFyY2hSZXN1bHQubGluayArICdcIj4nICsgU0NST0xMX1dFQkhFTFAuZXNjYXBlSHRtbChzZWFyY2hSZXN1bHQudGl0bGUpICsgJzwvYT48L2xpPicpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIENVU1RPTSAtIEJyb2tlbiBkb3duIGludG8gaW5kaXZpZHVhbCBjb21wb25lbnQgZWxlbWVudHMsIG5lZWRlZCB0byBzZWN1cmVseSBkaXNwbGF5IHRoZSBxdWVyeSB2YWx1ZVxuICAgICAgICAgICAgLy8gQ1VTVE9NIC0gQWRkZWQgdGhlICdkZWNvZGVVUklDb21wb25lbnQoKScgY2FsbCB0byB0aGUgZGlzcGxheWVkIHNlYXJjaCBxdWVyeSAoc3RvcHMgZGlzcGxheWluZyBvZiBlbmNvZGVkIFwiU2VhcmNoOlwiIHZhbHVlcyBpbiB0aGUgc2VhcmNoIHN1Z2dlc3RlciBkcm9wLWRvd24pXG4gICAgICAgICAgICB2YXIga2V5YnV0dG9uX2xpID0gJCgnPGxpIGNsYXNzPVwic2VhcmNoLWtleVwiIG49XCInICsgc2VhcmNoUmVzdWx0cy5sZW5ndGggKyAnXCI+PC9saT4nKTtcbiAgICAgICAgICAgIHZhciBrZXlidXR0b25fbGluayA9ICQoJzxhIGNsYXNzPVwic2VhcmNoLWtleS1idXR0b25cIiBocmVmPVwiI1wiPlNlYXJjaDombmJzcDs8L2E+Jyk7XG4gICAgICAgICAgICB2YXIga2V5YnV0dG9uX3NlYXJjaGVkVGVybSA9ICQoJzxiPjwvYj4nKS50ZXh0KGRlY29kZVVSSUNvbXBvbmVudChxdWVyeSkpO1xuICAgICAgICAgICAgdmFyIGtleWJ1dHRvbiA9IGtleWJ1dHRvbl9saS5hcHBlbmQoa2V5YnV0dG9uX2xpbmsuYXBwZW5kKGtleWJ1dHRvbl9zZWFyY2hlZFRlcm0pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAga2V5YnV0dG9uLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIHBlcmZvcm1TZWFyY2goKTsgLy8gQ1VTVE9NXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXN1bHRzTGlzdC5hcHBlbmQoa2V5YnV0dG9uKTtcblxuICAgICAgICAgICAgcmVzdWx0c0xpc3QuY2hpbGRyZW4oJ2xpJykuZWFjaChmdW5jdGlvbihpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBsaSA9ICQoaXRlbSk7XG4gICAgICAgICAgICAgICAgbGkuYmluZCgnbW91c2VvdmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRzTGlzdC5maW5kKCdsaSBhJykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGxpLmZpbmQoJ2EnKS5hZGRDbGFzcygnaG92ZXInKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkcm9wZG93bi5hZGRDbGFzcygnb3BlbicpO1xuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAkKCcjc2VhcmNoIGlucHV0LnNlYXJjaC1pbnB1dCcpO1xuXG4gICAgICAgICAgICBpbnB1dC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChlLndoaWNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bktleWRvd24oLTEsIGRyb3Bkb3duKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd25LZXlkb3duKDEsIGRyb3Bkb3duKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAod2luZG93LlNDUk9MTF9XRUJIRUxQICYmIHdpbmRvdy5TQ1JPTExfV0VCSEVMUC5zZWFyY2gpIHtcbiAgICAgICAgICAgIHdpbmRvdy5TQ1JPTExfV0VCSEVMUC5zZWFyY2gucGVyZm9ybVNlYXJjaChxdWVyeSwgaGFuZGxlU2VhcmNoUmVzdWx0cyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkcm9wZG93bktleWRvd24oZGlyZWN0aW9uLCBkcm9wZG93bikge1xuICAgICAgICB2YXIgaXRlbWNvdW50ID0gZHJvcGRvd24uZmluZCgnYScpLmxlbmd0aDtcbiAgICAgICAgdmFyIGN1cnJlbnRpdGVtID0gcGFyc2VJbnQoZHJvcGRvd24uZmluZCgnYS5ob3ZlcicpLnBhcmVudCgpLmF0dHIoJ24nKSk7XG4gICAgICAgIGlmIChpc05hTihjdXJyZW50aXRlbSkpY3VycmVudGl0ZW0gPSAtMTtcblxuICAgICAgICB2YXIgbmV4dGl0ZW0gPSBjdXJyZW50aXRlbSArIGRpcmVjdGlvbjtcbiAgICAgICAgdmFyIGRyb3Bkb3duSGVpZ2h0ID0gZHJvcGRvd24uaGVpZ2h0KCkgLSAyO1xuXG4gICAgICAgIHZhciBpdGVtaGVpZ2h0ID0gcGFyc2VJbnQoZHJvcGRvd24uZmluZCgnYS5ob3ZlcicpLm91dGVySGVpZ2h0KCkpO1xuXG4gICAgICAgIGlmIChuZXh0aXRlbSA8IDAgfHwgbmV4dGl0ZW0gPj0gaXRlbWNvdW50KXJldHVybjtcblxuICAgICAgICAkLmVhY2goZHJvcGRvd24uZmluZCgnYScpLCBmdW5jdGlvbiAoaW5kZXgsIHZhbCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID09IGN1cnJlbnRpdGVtKSQodGhpcykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT0gbmV4dGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdob3ZlcicpO1xuXG4gICAgICAgICAgICAgICAgaWYgKChpdGVtaGVpZ2h0ICogKGluZGV4ICsgMSkpIC0gZHJvcGRvd24uc2Nyb2xsVG9wKCkgPiBkcm9wZG93bkhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zY3JvbGxUb3AoKGl0ZW1oZWlnaHQgKiAoaW5kZXggKyAxKSkgLSBkcm9wZG93bkhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoaXRlbWhlaWdodCAqIChpbmRleCArIDEpKSAtIGRyb3Bkb3duLnNjcm9sbFRvcCgpIDwgaXRlbWhlaWdodCAmJiBkcm9wZG93bi5zY3JvbGxUb3AoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2Nyb2xsVG9wKGl0ZW1oZWlnaHQgKiBpbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9ICBcblxuICBcbiAgICAvLyBDVVNUT006IFBlcmZvcm1zIGEgc2VhcmNoXG4gICAgZnVuY3Rpb24gcGVyZm9ybVNlYXJjaCgpIHtcblx0XHQvLyBBdHRlbXB0cyB0byBnZXQgYSBzZWxlY3RlZCBzZWFyY2ggZHJvcC1kb3duIGxpbmsgZWxlbWVudFxuICAgICAgICB2YXIgc2VsZWN0ZWQgPSAkKCcuaHQtc2VhcmNoLWRyb3Bkb3duIGEuaG92ZXInKTsgICAgICAgIFxuXG5cdFx0aWYgKHNlbGVjdGVkLmxlbmd0aCAhPSAwKSB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWQuaXMoJy5zZWFyY2gta2V5LWJ1dHRvbicpKSB7XG5cdFx0ICAgICAgICAvLyBJZiB0aGUgc2VsZWN0ZWQgaXRlbSBpcyB0aGUgZmluYWwgXCJTZWFyY2g6IDxxdWVyeT5cIiBlbGVtZW50LCBvcGVucyB0aGUgc2VhcmNoIHJlc3VsdCBwYWdlIFxuICAgICAgICAgICAgICAgIGtlbnRpY29UaGVtZU9wZW5TZWFyY2hSZXN1bHRzUGFnZSgpOyAvLyBGdW5jdGlvbiBkZWZpbmVkIGluIHRoZW1lLmN1c3RvbS5qc1xuICAgICAgICAgICAgfSBlbHNlIHtcblx0XHRcdFx0Ly8gSWYgdGhlIHNlbGVjdGVkIGl0ZW0gaXMgYSBwYWdlIHJlc3VsdCwgcmVkaXJlY3RzIGRpcmVjdGx5IHRvIGdpdmVuIGRvY3VtZW50YXRpb24gcGFnZVxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gc2VsZWN0ZWQuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuXHRcdFx0Ly8gT3BlbnMgdGhlIHNlYXJjaCByZXN1bHQgcGFnZSAoZGVmYXVsdCBjYXNlKVxuICAgICAgICAgICAga2VudGljb1RoZW1lT3BlblNlYXJjaFJlc3VsdHNQYWdlKCk7IC8vIEZ1bmN0aW9uIGRlZmluZWQgaW4gdGhlbWUuY3VzdG9tLmpzXG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGluaXRCdXR0b25zKCkge1xuXG4gICAgICAgICQoJyNodC1zZWFyY2gtYnV0dG9uJykuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgb3BlblNlYXJjaCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkKCcjc2VhcmNoQnV0dG9uJykuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIFx0aWYgKCQoXCIuc2VhcmNoLWlucHV0XCIpLmhhc0NsYXNzKFwic2hvd1wiKSB8fCAkKFwiLnNlYXJjaC1pbnB1dFwiKS5pcyhcIjp2aXNpYmxlXCIpKSB7XG4gICAgICAgICAgICBcdHBlcmZvcm1TZWFyY2goKTtcbiAgICAgICAgXHR9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQoXCIuc2VhcmNoLWlucHV0XCIpLmFkZENsYXNzKFwic2hvd1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnLmh0LXNlYXJjaC1jbGVhcicpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNsb3NlU2VhcmNoKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICBIZWFkZXIgcmVzcG9uc2l2aXR5ICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgIChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICRvcGVuU2VhcmNoID0gJCgnLmpzLWhlYWRlci1zZWFyY2gtb3BlbicpO1xuICAgICAgICB2YXIgJGNsb3NlU2VhcmNoID0gJCgnLmpzLWhlYWRlci1zZWFyY2gtY2xvc2UnKTtcbiAgICAgICAgdmFyICRzZWFyY2ggPSAkKCcuanMtaGVhZGVyLXNlYXJjaC1ib3gnKTtcbiAgICAgICAgdmFyIHRyYW5zaXRpb25NcyA9IDI1MDtcblxuICAgICAgICAkb3BlblNlYXJjaC5jbGljayhmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAkc2VhcmNoXG4gICAgICAgICAgICAgICAgLmNzcyhcImRpc3BsYXlcIiwgXCJmbGV4XCIpXG4gICAgICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgICAgIC5mYWRlSW4odHJhbnNpdGlvbk1zKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGNsb3NlU2VhcmNoLmNsaWNrKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICRzZWFyY2guZmFkZU91dCh0cmFuc2l0aW9uTXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgJG1lbnVUb2dnbGUgPSAkKCcuanMtbWVudS10b2dnbGUnKTtcbiAgICAgICAgdmFyICRzaWRlYmFyID0gJCgnI2h0LXNpZGViYXInKTtcblxuICAgICAgICBmdW5jdGlvbiBzaG93TWVudSgpIHtcbiAgICAgICAgICAgICRtZW51VG9nZ2xlLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgICAgICRzaWRlYmFyLmZhZGVJbih0cmFuc2l0aW9uTXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGlkZU1lbnUoKSB7XG4gICAgICAgICAgICAkbWVudVRvZ2dsZS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgICAgICAgICAkc2lkZWJhci5mYWRlT3V0KHRyYW5zaXRpb25Ncyk7XG4gICAgICAgIH1cblxuICAgICAgICAkbWVudVRvZ2dsZS5jbGljayhmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZiAoJG1lbnVUb2dnbGUuaGFzQ2xhc3MoJ2lzLWFjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgaGlkZU1lbnUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2hvd01lbnUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZiAoISRtZW51VG9nZ2xlWzBdLmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhJHNpZGViYXJbMF0uY29udGFpbnMoZS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgaGlkZU1lbnUoKTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgIH0pO1xuICAgIH0pKCk7XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgIERyb3Bkb3duICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICBmdW5jdGlvbiBzZXREcm9wZG93bihzZWxlY3QpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IHNlbGVjdC5wYXJlbnQoKTtcbiAgICAgICAgdmFyIHN2ZyA9ICc8c3ZnIHdpZHRoPVwiMTBweFwiIGhlaWdodD1cIjEwcHhcIiB2aWV3Qm94PVwiMCAwIDEwIDEwXCIgdmVyc2lvbj1cIjEuMVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIj48ZyBjbGFzcz1cImh0LXNlbGVjdC1idXR0b24taWNvblwiPjxwYXRoIGQ9XCJNMiwzIEw4LDMgTDUsNyBMMiwzIFpcIj48L3BhdGg+PC9nPjwvc3ZnPic7XG4gICAgICAgIHZhciB0b2dnbGUgPSAkKCc8YSBjbGFzcz1cImh0LXNlbGVjdC1idXR0b25cIj48c3Bhbj4nICsgY3JlYXRlT3B0aW9uVGV4dChzZWxlY3QuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykpICsgJzwvc3Bhbj4nICsgc3ZnICsgJzwvYT4nKTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZCh0b2dnbGUpO1xuXG4gICAgICAgIHZhciBsYWJlbCA9IGNvbnRhaW5lci5wYXJlbnQoKS5maW5kKCdsYWJlbCcpLnJlbW92ZSgpO1xuICAgICAgICB0b2dnbGUucHJlcGVuZChsYWJlbCk7XG5cbiAgICAgICAgdmFyIGRyb3Bkb3duID0gJCgnPGRpdiBjbGFzcz1cImh0LWRyb3Bkb3duIGh0LWRyb3Bkb3duLXNlbGVjdFwiPjx1bD48L3VsPjwvZGl2PicpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kKGRyb3Bkb3duKTtcblxuICAgICAgICB2YXIgYWxsQWNjZXNzaWJsZSA9IGFsbEVudHJpZXNBY2Nlc3NpYmxlKHNlbGVjdCk7XG4gICAgICAgICQuZWFjaChzZWxlY3QuZmluZCgnb3B0aW9uJyksIGZ1bmN0aW9uIChpbmRleCwgdmFsKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9ICQoJzxsaSBuPVwiJyArIGluZGV4ICsgJ1wiPjxhIGRhdGEtc2Nyb2xsLWludGVncmF0aW9uLW5hbWU9XCInICsgc2VsZWN0LmF0dHIoJ25hbWUnKSArICdcIiBkYXRhLXNjcm9sbC1pbnRlZ3JhdGlvbi10aXRsZT1cIicgKyAkKHRoaXMpLnRleHQoKSArICdcIiBkYXRhLXNjcm9sbC1pbnRlZ3JhdGlvbi12YWx1ZT1cIicgKyAkKHRoaXMpLmF0dHIoJ3ZhbHVlJykgKyAnXCI+JyArIGNyZWF0ZU9wdGlvblRleHQoJCh0aGlzKSwgIWFsbEFjY2Vzc2libGUpICsgJzwvYT48L2xpPicpO1xuICAgICAgICAgICAgZHJvcGRvd24uZmluZCgndWwnKS5hcHBlbmQoaXRlbSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlbGVjdC5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZhbCA9IHNlbGVjdC52YWwoKTtcbiAgICAgICAgICAgIHRvZ2dsZS5maW5kKCdzcGFuJykudGV4dChzZWxlY3QuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudGV4dCgpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdG9nZ2xlLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgIGlmICh2aWV3cG9ydCA9PSAnbW9iaWxlJyAmJiAhKGlzRmlyZWZveCB8fCBpc0lFKSkge1xuICAgICAgICAgICAgICAgIG9wZW5TZWxlY3Qoc2VsZWN0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgdG9vZ2xlRHJvcGRvd24oY29udGFpbmVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQuZWFjaCgkKCcuJyArIGNvbnRhaW5lci5hdHRyKCdjbGFzcycpKSwgZnVuY3Rpb24gKGluZGV4LCB2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuZmluZCgnLmh0LXNlbGVjdC1idXR0b24nKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2dsZURyb3Bkb3duKCQodGhpcyksIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdG9vZ2xlRHJvcGRvd24oY29udGFpbmVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKiogQ2hlY2sgaWYgYWxsIG9mIHRoZSBlbnRyaWVzIGluIHRoZSBnaXZlbiBzZWxlY3QgYXJlIHJ1bnRpbWUgYWNjZXNzaWJsZSAoY3VycmVudGx5IG9ubHkgcmVsZXZhbnQgZm9yIHZlcnNpb25zKS4gKi9cbiAgICBmdW5jdGlvbiBhbGxFbnRyaWVzQWNjZXNzaWJsZShzZWxlY3QpIHtcbiAgICAgICAgdmFyIGFsbEFjY2Vzc2libGUgPSB0cnVlO1xuICAgICAgICBpZiAoc2VsZWN0LmF0dHIoJ25hbWUnKSA9PT0gJ3Njcm9sbC12ZXJzaW9uczp2ZXJzaW9uLW5hbWUnKSB7XG4gICAgICAgICAgICAkLmVhY2goc2VsZWN0LmZpbmQoJ29wdGlvbicpLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYWxsQWNjZXNzaWJsZSAmPSAoJCh0aGlzKS5hdHRyKCdkYXRhLXZlcnNpb24tYWNjZXNzaWJsZScpID09PSAndHJ1ZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsbEFjY2Vzc2libGU7XG4gICAgfVxuXG4gICAgLyoqIENyZWF0ZSB0aGUgdGV4dCBmb3IgdGhlIGRyb3AtZG93biBlbnRyaWVzICh2ZXJzaW9uIGVudHJpZXMgbWF5IGNvbnRhaW4gc29tZSBleHRyYSBpbmZvIG90aGVyIHRoYW4gdGhlIHByb3BlcnR5IG5hbWUpLiAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZU9wdGlvblRleHQob3B0aW9uLCBzaG93VmVyc2lvbkFjY2Vzc2liaWxpdHkpIHtcbiAgICAgICAgdmFyIG9wdGlvblRleHQgPSBvcHRpb24udGV4dCgpO1xuICAgICAgICBpZiAoc2hvd1ZlcnNpb25BY2Nlc3NpYmlsaXR5KSB7XG4gICAgICAgICAgICB2YXIgdmVyc2lvbkFjY2Vzc2libGUgPSBvcHRpb24uYXR0cignZGF0YS12ZXJzaW9uLWFjY2Vzc2libGUnKTtcbiAgICAgICAgICAgIGlmICh2ZXJzaW9uQWNjZXNzaWJsZSkge1xuICAgICAgICAgICAgICAgIG9wdGlvblRleHQgKz0gJyA8c3BhbiBzdHlsZT1cImZsb2F0OiByaWdodDsgbWFyZ2luLWxlZnQ6IDAuOGVtOyBjb2xvcjogI2RkZGRkZDsnO1xuICAgICAgICAgICAgICAgIGlmICh2ZXJzaW9uQWNjZXNzaWJsZSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvblRleHQgKz0gJ3Zpc2liaWxpdHk6IGhpZGRlbjsnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcHRpb25UZXh0ICs9ICdcIiBjbGFzcz1cImsxNXQtaWNvbi12aWV3cG9ydFwiPjwvc3Bhbj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcHRpb25UZXh0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvb2dsZURyb3Bkb3duKGNvbnRhaW5lciwgb3Blbikge1xuICAgICAgICBpZiAob3Blbikge1xuICAgICAgICAgICAgJCgnYm9keScpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCQoZS50YXJnZXQpLmlzKGNvbnRhaW5lci5maW5kKCcqJykpKXJldHVybjtcbiAgICAgICAgICAgICAgICB0b29nbGVEcm9wZG93bihjb250YWluZXIsICFvcGVuKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCdib2R5JykudW5iaW5kKCdjbGljaycpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHRvZ2dsZSA9IGNvbnRhaW5lci5maW5kKCcuaHQtc2VsZWN0LWJ1dHRvbicpO1xuICAgICAgICB2YXIgZHJvcGRvd24gPSBjb250YWluZXIuZmluZCgnLmh0LWRyb3Bkb3duJyk7XG5cbiAgICAgICAgaWYgKG9wZW4pIHtcbiAgICAgICAgICAgIHRvZ2dsZS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICBkcm9wZG93bi5hZGRDbGFzcygnb3BlbicpO1xuXG4gICAgICAgICAgICAkLmVhY2goZHJvcGRvd24uZmluZCgnbGknKSwgZnVuY3Rpb24gKGluZGV4LCB2YWwpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmJpbmQoJ21vdXNlb3ZlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uZmluZCgnbGkgYScpLnJlbW92ZUNsYXNzKCdob3ZlcicpO1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ2EnKS5hZGRDbGFzcygnaG92ZXInKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICQodGhpcykuZmluZCgnYScpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gJChlLnRhcmdldCkuY2xvc2VzdCgnYScpLmF0dHIoJ2RhdGEtc2Nyb2xsLWludGVncmF0aW9uLW5hbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gJChlLnRhcmdldCkuY2xvc2VzdCgnYScpLmF0dHIoJ2RhdGEtc2Nyb2xsLWludGVncmF0aW9uLXZhbHVlJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKS5hdHRyKCdkYXRhLXNjcm9sbC1pbnRlZ3JhdGlvbi10aXRsZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZS5maW5kKCdzcGFuJykudGV4dCh0aXRsZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSArICc/JyArIG5hbWUgKyAnPScgKyB2YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHRvZ2dsZS5jbG9zZXN0KCdmb3JtJykuZmluZCgnaW5wdXRbbmFtZT1jb250ZXh0XScpLnZhbCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ICs9ICcmY29udGV4dD0nICsgY29udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGFyZ2V0O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0b2dnbGUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZHJvcGRvd24ucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgIEluaXQgRm9vdGVyICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG4gICAgZnVuY3Rpb24gaW5pdEZvb3RlcigpIHtcbiAgICAgICAgY2hlY2tGb290ZXIoKTtcblxuICAgICAgICAkKCcjaHQtanVtcC10b3AnKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAkKCdib2R5LGh0bWwnKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiAwfSxcbiAgICAgICAgICAgICAgICAxMDApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja0Zvb3RlcigpIHtcbiAgICAgICAgaWYgKCQoJ2FydGljbGUuaHQtY29udGVudCcpLm91dGVySGVpZ2h0KCkgPCAkKHdpbmRvdykuaW5uZXJIZWlnaHQoKSkge1xuICAgICAgICAgICAgJCgnI2h0LWp1bXAtdG9wJykuZmFkZU91dCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnI2h0LWp1bXAtdG9wJykuZmFkZUluKCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICBNZWRpYSBRdWVyeSBEZXRlY3Rpb24gICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG4gICAgZnVuY3Rpb24gY2hlY2tEZXZpY2UocmVzaXplKSB7IC8vIENVU1RPTSAtIHJlc2l6ZSBwYXJhbWV0ZXIgYWRkZWQgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIHBhZ2UgbG9hZCBhbmQgcmVzaXplIGNhbGxzXG4gICAgICAgIHZhciBpID0gcGFyc2VJbnQoJCgnI2h0LW1xLWRldGVjdCcpLmNzcygnd2lkdGgnKS5yZXBsYWNlKCdweCcsICcnKSk7XG5cbiAgICAgICAgc3dpdGNoIChpKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgdmlld3BvcnQgPSAnbW9iaWxlJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHZpZXdwb3J0ID0gJ3BvdHJhaXQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgdmlld3BvcnQgPSAnbGFuZHNjYXBlJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHZpZXdwb3J0ID0gJ2Rlc2t0b3AnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgdmlld3BvcnQgPSAnZGVza3RvcCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYmFzZVVybCA9ICQoXCJtZXRhW25hbWU9J2NvbmZsdWVuY2UtYmFzZS11cmwnXVwiKS5hdHRyKFwiY29udGVudFwiKTtcbiAgICAgICAgdmFyIHNwYWNlS2V5ID0gJChcIm1ldGFbbmFtZT0nY29uZmx1ZW5jZS1zcGFjZS1rZXknXVwiKS5hdHRyKFwiY29udGVudFwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB2YXIgaG9tZVBhdGggPSBiYXNlVXJsO1xuXHRcdC8vIEhhbmRsaW5nIGZvciBjYXNlcyB3aGVyZSB0aGUgdmVyc2lvbiBpcyBkaXNwbGF5ZWQgd2l0aG91dCBhIHNwYWNlIGtleSBpbiB0aGUgVVJMXG5cdFx0aWYgKHNwYWNlS2V5ICE9PSBDT05GSUcuRE9DX1JPT1RfVVJMX1NQQUNFX0tFWSkge1xuXHRcdFx0aG9tZVBhdGggPSBob21lUGF0aCArICcvJyArIHNwYWNlS2V5O1xuXHRcdH1cbiAgICAgICAgdmFyIGN1cnJQYXRoID0gJChsb2NhdGlvbikuYXR0cignaHJlZicpO1xuXG4gICAgICAgIC8vIE5vIHNpZGViYXIgZm9yIGhvbWVwYWdlcyBhbmQgc2VhcmNoIHJlc3VsdHMgKyBDb2xsYXBzZWQgc21hbGwgc2VhcmNoIGJveCBmb3Igc21hbGxlciBzY3JlZW5zXG4gICAgICAgIGlmICggIShjdXJyUGF0aCA9PSBob21lUGF0aCB8fCBjdXJyUGF0aCA9PSAoaG9tZVBhdGggKyAnLycpIHx8IGN1cnJQYXRoLmluZGV4T2YoaG9tZVBhdGggKyAnL3NlYXJjaCcpID49IDApICl7XG4gICAgICAgICAgICBpZiAodmlld3BvcnQgPT0gJ2Rlc2t0b3AnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNpemUpIHsgLy8gRG9lcyBub3QgYXV0by1vcGVuIHRoZSBzaWRlYmFyIHdoZW4gcmVzaXppbmdcbiAgICAgICAgICAgICAgICAgICAgJCgnaHRtbCcpLmFkZENsYXNzKCdzaG93LXNpZGViYXInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQoJ2h0bWwnKS5yZW1vdmVDbGFzcygnc2hvdy1zaWRlYmFyJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgXHRpZiAodmlld3BvcnQgPT0gJ2Rlc2t0b3AnIHx8IHZpZXdwb3J0ID09ICdsYW5kc2NhcGUnKSB7XG4gICAgICAgICAgICAgIFx0JCgnLnNlYXJjaC1pbnB1dCcpLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBcdCQoJy5zZWFyY2gtaW5wdXQnKS5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gT25jZSByZW5kZXJlZCwgYWRkIENTUyBhbmltYXRpb24gY2xhc3MgdG8gc2lkZWJhciBlbGVtZW50XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXskKCcjaHQtc2lkZWJhcicpLmFkZENsYXNzKCdhbmltYXRlJyk7fSw1MDApO1xuICAgICAgXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JCgnLnNlYXJjaC1pbnB1dCcpLmFkZENsYXNzKCdhbmltYXRlJyk7fSw1MDApO1xuICAgIH1cblxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICBXaW5kb3cgUmVzaXplICAgICAgICAgICAgPVxuICAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cbiAgICB2YXIgcnRpbWUgPSBuZXcgRGF0ZSgxLCAxLCAyMDAwLCAxMiwgMCwgMCk7XG4gICAgdmFyIHRpbWVvdXQgPSBmYWxzZTtcbiAgICB2YXIgZGVsdGEgPSAyMDA7XG4gICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJ0aW1lID0gbmV3IERhdGUoKTtcbiAgICAgICAgaWYgKHRpbWVvdXQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aW1lb3V0ID0gdHJ1ZTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQocmVzaXplZW5kLCBkZWx0YSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHJlc2l6ZWVuZCgpIHtcbiAgICAgICAgaWYgKG5ldyBEYXRlKCkgLSBydGltZSA8IGRlbHRhKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJlc2l6ZWVuZCwgZGVsdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGltZW91dCA9IGZhbHNlO1xuICAgICAgICAgICAgY2hlY2tGb290ZXIoKTtcbiAgICAgICAgICAgIGNoZWNrRGV2aWNlKHRydWUpOyAvLyBDVVNUT00gLSB0cnVlIHBhcmFtZXRlciB0byBpbmRpY2F0ZSB0aGF0IHRoZSBjYWxsIGlzIG9uIHJlc2l6ZVxuICAgICAgICAgICAgY2hlY2tHcmlkKCk7XG4gICAgICAgICAgICAvLyBzZXRDb250ZW50V2lkdGgoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wZW5TZWxlY3Qoc2VsZWN0b3IpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSAkKHNlbGVjdG9yKVswXSwgd29ya2VkID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50KSB7IC8vIGFsbCBicm93c2Vyc1xuICAgICAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIk1vdXNlRXZlbnRzXCIpO1xuICAgICAgICAgICAgZS5pbml0TW91c2VFdmVudChcIm1vdXNlZG93blwiLCB0cnVlLCB0cnVlLCB3aW5kb3csIDAsIDAsIDAsIDAsIDAsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCBudWxsKTtcbiAgICAgICAgICAgIHdvcmtlZCA9IGVsZW1lbnQuZGlzcGF0Y2hFdmVudChlKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuZmlyZUV2ZW50KSB7IC8vIGllXG4gICAgICAgICAgICB3b3JrZWQgPSBlbGVtZW50LmZpcmVFdmVudChcIm9ubW91c2Vkb3duXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghd29ya2VkKSB7IC8vIHVua25vd24gYnJvd3NlciAvIGVycm9yXG5cbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICAgS2V5Ym9hcmQgICAgICAgICAgICAgID1cbiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG4gICAgdmFyIHNlYXJjaEZpZWxkQWN0aXZlO1xuICAgIHZhciBsYXN0S2V5O1xuXG4gICAgZnVuY3Rpb24gaW5pdEtleWJvYXJkKCkge1xuICAgICAgICBzZWFyY2hGaWVsZEFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgICQoJ2JvZHknKS5iaW5kKCdrZXl1cCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoc2VhcmNoRmllbGRBY3RpdmUgJiYgZS53aGljaCAhPSAyNykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3dpdGNoIChlLndoaWNoKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAyMTk6IC8vIFtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdwb3J0ICE9PSAnZGVza3RvcCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZVNpZGViYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMTkxOiAvLyAvXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2lkZWJhckV4cGFuZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuU2VhcmNoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDcxOiAvLyBnXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0S2V5ID09IDcxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNpZGViYXJFeHBhbmRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5TZWFyY2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMjc6IC8vIGVzY1xuICAgICAgICAgICAgICAgICAgICBjbG9zZVNlYXJjaCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGFzdEtleSA9IGUud2hpY2g7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICAgIENvb2tpZXMgICAgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuXG4gICAgZnVuY3Rpb24gc2V0Q29va2llKGNuYW1lLCBjdmFsdWUpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gPT0gJ2ZpbGU6Ly8nKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGNuYW1lLCBjdmFsdWUpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTYXZpbmcgdGhlIHN0YXRlIG9mIHRoZSBkcmFnLWJhciBpcyBub3Qgc3VwcG9ydGVkIGJlY2F1c2UgbG9jYWxTdG9yYWdlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGQuc2V0VGltZShkLmdldFRpbWUoKSArICgyNCAqIDYwICogNjAgKiAxMDAwKSk7XG4gICAgICAgICAgICB2YXIgZXhwaXJlcyA9IFwiZXhwaXJlcz1cIiArIGQudG9VVENTdHJpbmcoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNuYW1lICsgXCI9XCIgKyBjdmFsdWUgKyBcIjsgXCIgKyBleHBpcmVzICsgXCI7IHBhdGg9L1wiO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q29va2llKGNuYW1lKSB7XG4gICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ub3JpZ2luID09ICdmaWxlOi8vJykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjbmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTYXZpbmcgdGhlIHN0YXRlIG9mIHRoZSBkcmFnLWJhciBpcyBub3Qgc3VwcG9ydGVkIGJlY2F1c2UgbG9jYWxTdG9yYWdlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gY25hbWUgKyBcIj1cIjtcbiAgICAgICAgICAgIHZhciBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjID0gY2FbaV07XG4gICAgICAgICAgICAgICAgd2hpbGUgKGMuY2hhckF0KDApID09ICcgJykgYyA9IGMuc3Vic3RyaW5nKDEpO1xuICAgICAgICAgICAgICAgIGlmIChjLmluZGV4T2YobmFtZSkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5zdWJzdHJpbmcobmFtZS5sZW5ndGgsIGMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG5cbiAgICAvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgPSAgICAgICAgICAgICAgIEdSSUQgICAgICAgICAgICAgICAgID1cbiAgICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cbiAgICBmdW5jdGlvbiBjaGVja0dyaWQoKSB7XG4gICAgICAgIGlmICgkKCcjaHQtd3JhcC1jb250YWluZXInKS53aWR0aCgpID4gNjQwKSB7XG4gICAgICAgICAgICAkKCcjaHQtd3JhcC1jb250YWluZXInKS5hZGRDbGFzcygnc3AtZ3JpZC1mbG9hdCcpO1xuICAgICAgICAgICAgJCgnI2h0LXdyYXAtY29udGFpbmVyJykucmVtb3ZlQ2xhc3MoJ3NwLWdyaWQtZmx1aWQnKTtcbiAgICAgICAgICAgIC8vIFB1dHMgc2lkZSBjZWxsIGFmdGVyIG1haW4gY2VsbFxuICAgICAgICAgICAgJCgnLnNwLWdyaWQtY2VsbC5zcC1ncmlkLTYwJykuZmlyc3QoKS5hZnRlcigkKCcuc3AtZ3JpZC1jZWxsLnNwLWdyaWQtNDAnKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCcjaHQtd3JhcC1jb250YWluZXInKS5hZGRDbGFzcygnc3AtZ3JpZC1mbHVpZCcpO1xuICAgICAgICAgICAgJCgnI2h0LXdyYXAtY29udGFpbmVyJykucmVtb3ZlQ2xhc3MoJ3NwLWdyaWQtZmxvYXQnKTtcbiAgICAgICAgICAgIC8vIFB1dHMgbWFpbiBjZWxsIGJlZm9yZSBzaWRlIGNlbGxcbiAgICAgICAgICAgICQoJy5zcC1ncmlkLWNlbGwuc3AtZ3JpZC02MCcpLmZpcnN0KCkuYmVmb3JlKCQoJy5zcC1ncmlkLWNlbGwuc3AtZ3JpZC00MCcpKTtcbiAgICAgICAgfSAgICAgICAgXG4gICAgfVxuXG4gICAgLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgID0gICAgICAgICAgICAgQ2xpcGJvYXJkICAgICAgICAgICAgICA9XG4gICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qL1xuICAgIChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgY2xpcGJvYXJkVGltZW91dDtcblxuICAgICAgICB2YXIgY2xpcGJvYXJkID0gbmV3IENsaXBib2FyZEpTKCcuanMtY29kZUNsaXBib2FyZCcsIHtcbiAgICAgICAgICAgIHRhcmdldDogZnVuY3Rpb24odHJpZ2dlcikge1xuICAgICAgICAgICAgICAgIHZhciAkcGFuZWwgPSAkKHRyaWdnZXIpLmNsb3Nlc3QoJy5qcy1jb2RlUGFuZWwnKTtcbiAgICAgICAgICAgICAgICB2YXIgJGNvZGUgPSAkcGFuZWwuZmluZCgnLmpzLWNvZGUnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiAkY29kZVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2xpcGJvYXJkLm9uKCdzdWNjZXNzJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciAkdHJpZ2dlciA9ICQoZS50cmlnZ2VyKTtcbiAgICAgICAgICAgICR0cmlnZ2VyLmFkZENsYXNzKCdpcy1jb3BpZWQnKTtcblxuICAgICAgICAgICAgaWYgKGNsaXBib2FyZFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KGNsaXBib2FyZFRpbWVvdXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjbGlwYm9hcmRUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHRyaWdnZXIucmVtb3ZlQ2xhc3MoJ2lzLWNvcGllZCcpO1xuICAgICAgICAgICAgfSwgMjAwMCk7XG5cbiAgICAgICAgICAgIGUuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgfSk7XG4gICAgfSgpKVxufSkoJCk7XG4iXX0=
