<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Logging activities on MVC sites - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68880510"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Developing-websites.html">Developing websites</a></li>
                                                                                                         <li class="shortcut"><a href="Developing-sites-using-ASP.NET-MVC.html">Developing sites using ASP.NET MVC</a></li>
                                                                                     <li><a href="Implementing-on-line-marketing-features-on-MVC-sites.html">Implementing on-line marketing features on MVC sites</a></li>
                                                            </ul>
</div>            <h1 id="src-68880510"> <span>Logging activities on MVC sites</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"><p>Activities represent actions that your <a href="working-with-contacts">contacts</a> perform. For example, the system logs activities when visitors register as a member of a site or when visitors sign in to a site. The data gathered in the activity log allows you to evaluate the behavior of your website's users and visitors. To learn more about activities, see <a href="tracking-contact-activities">Tracking contact activities.</a></p><p>Some activities are logged automatically when you enable <a href="tracking-contacts-on-mvc-sites">tracking of contacts</a>. However, certain activities require additional adjustments of your MVC application (see the table below).</p><div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>You need to install the following <a href="installing-kentico-integration-packages">integration packages</a> into your MVC project to track all supported types of activities:</p>
<ul class=" "><li class=" "><p><strong class=" ">Kentico.Activities</strong></p>
</li><li class=" "><p><strong class=" ">Kentico.Activities.Web.Mvc</strong></p>
</li></ul>        </div>
    </div><h3 id="src-68880510_LoggingactivitiesonMVCsites-OverviewofactivitiessupportedinMVC" class="heading "><span>Overview of activities supported in MVC</span></h3><div class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col>
                                    <col>
                            </colgroup>
        <thead class=" ">    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>E-commerce</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Product added to shopping cart</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Product added to wishlist</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged after adjusting your MVC application.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Product removed from shopping cart</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Purchase</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Purchased product</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Shopping cart abandoned</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>On-line marketing</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Clicked link in marketing email</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Opened marketing email</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Subscription to a newsletter</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Unsubscription from a single email feed</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Opted out from all marketing emails</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Membership</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>User login</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged after adjusting your MVC application.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>User registration</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged after adjusting your MVC application.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Other</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Form submission</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Page</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Landing page</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged after adjusting your MVC application.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Page visit</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged after adjusting your MVC application.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Search</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>External search</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged after adjusting your MVC application.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Internal search</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The activity is logged automatically.</p>
            </td>
        </tr>
</tbody>        </table>
            </div><p><br></p><p>For details on logging of activities that require additional adjustments of your MVC application, see <a href="enabling-tracking-of-activities-on-mvc-sites">Enabling tracking of activities on MVC sites</a>.</p><p>Please note that the process for setting up logging of the <i class=" ">External search</i> and the <i class=" ">Page </i>related activities is different from setting up logging of the <i class=" ">Membership</i> related activities. To <a href="enabling-tracking-of-activities-on-mvc-sites#src-68880511_enablingtrackingofactivitiesonmvcsites-enablingtrackingoftheexternalsearchandthepagerelatedactivitiesinmvc">log the <i class=" ">External search</i> and the <i class=" ">Page</i> related activities</a>, you need to adjust your MVC application only once by registering routes that receive logging requests. However, to log the <i class=" ">Membership </i>related activities, you need to adjust your MVC application for each of them separately by calling the logging service in your own controllers.</p><div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The <i class=" ">Landing page</i> activity logging is affected by the <i class=" ">CMSLandingPageLoaded</i> cookie key, which expires after 20 minutes. The expiration period of the key is renewed every time the website is accessed again.</p>
        </div>
    </div><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Limitation</strong>: Because pages on MVC sites are not directly connected to pages from the Kentico content tree, activities are logged without a reference to the related Kentico page (i.e. the <i class=" ">ActivityNodeID</i> value is not assigned). For activities that occur on a specific page, such as <i class=" ">Page visit</i> or <i class=" ">Landing page</i>, the system logs the <i class=" ">Activity URL</i> value, which stores the live URL of the page on the MVC site.</p>
        </div>
    </div></div>

    
    
    



    
    
    <div class="section-right"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880510_loggingactivitiesonmvcsites-overviewofactivitiessupportedinmvc">Overview of activities supported in MVC</a></p>
</li><li class=" "><p><a href="#src-68880510_loggingactivitiesonmvcsites-configuringactivityandcontactupdatesprocessing">Configuring activity and contact updates processing</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class="_mce_tagged_br "><p><a href="tracking-contact-activities">Tracking contact activities</a></p>
</li><li class=" "><p><a href="tracking-contacts-on-mvc-sites">Tracking contacts on MVC sites</a></p>
</li><li class=" "><p><a href="enabling-tracking-of-activities-on-mvc-sites">Enabling tracking of activities on MVC sites</a></p>
</li></ul>        </div>
    </div></div>
    
<p></p>
    <div class="confbox admonition admonition-info">
                    <p class="title">Kentico EMS required</p>
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Features described on this page require the <strong class=" ">Kentico EMS</strong> license.</p>
        </div>
    </div>
<p></p>
    <h3 id="src-68880510_LoggingactivitiesonMVCsites-Configuringactivityandcontactupdatesprocessing" class="heading "><span>Configuring activity and contact updates processing</span></h3>
<p>When logging activities from MVC applications, the API does not ensure recalculation of <a href="scoring-contacts">contact scores</a>, <a href="segmenting-contacts-into-contact-groups">contact groups</a>, <a href="personas">personas </a>and <a href="marketing-automation">marketing automation trigger</a><a href="marketing-automation">s</a>. For performance reasons, these recalculations are performed by the Kentico application. Because the Kentico application itself does not usually receive traffic from site visitors, you need to keep the application alive. For example, you can set the <a class="external-link" href="https://technet.microsoft.com/en-us/library/cc771956%28v=ws.10%29.aspx">Idle Time-out (minutes) setting</a> of your IIS application pool to 0.</p>
<p>By default, the system batch processes activities and contact detail updates every 10 seconds. You can configure the processing interval separately for the Kentico and MVC application. Adding the below key to the MVC application affects at what interval the logged activities and contact detail updates are saved from the memory into the database. Adding the below key to the Kentico application affects how often Kentico recalculates the data that could be affected by activities and contact updates.</p>
<p>If your system processes a large number of activities and contact updates, you may need to increase the default interval.</p>
<ol class=" "><li class=" "><p>Open your project's web.config file.</p>
</li><li class=" "><p>Add the following key into the <i class=" ">appSettings</i> section of the file. Increase the value to reflect how often you want the activities and contact updates to be processed.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Processing activities and contact updates every 30 seconds</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Processing activities and contact updates every 30 seconds" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSProcessContactActionsInterval"</code><code class="plain"> value=</code><code class="string">"30"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
</li><li class=" "><p>Save the file.</p>
</li></ol><p>The system now processes activities and contact detail updates in accordance with the configured intervals.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>