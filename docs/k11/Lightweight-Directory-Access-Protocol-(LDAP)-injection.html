<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Lightweight Directory Access Protocol (LDAP) injection - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881106"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Securing-websites.html">Securing websites</a></li>
                                                                                     <li><a href="Developing-secure-websites.html">Developing secure websites</a></li>
                                                            </ul>
</div>            <h1 id="src-68881106"> <span>Lightweight Directory Access Protocol (LDAP) injection</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"><p>LDAP is a protocol for accessing and modifying the directory services over TCP/IP. This protocol has many implementations. However, we will focus only on the Active Directory Lightweight Directory service in this topic, as it is used by Kentico.</p><p>The LDAP injection attacks are similar to SQL injection attacks in principle. The attacker tries to exploit a web application to construct a malicious LDAP statement. If the application does not sanitize the user input, the attacker may be able to execute various commands.</p><h3 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1FeGFtcGxlc29mTERBUGluamVjdGlvbnM" class="heading "><span>Examples of LDAP injections</span></h3><h5 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1PYnRhaW5pbmd1c2VyaW5mb3JtYXRpb24" class="heading "><span>Obtaining user information</span></h5><div class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Original query</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>http://www.example.com/people_search.aspx?name=Andy)(zone=public)</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Malformed query</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>http://www.example.com/people_search.aspx?name=Andy)(zone=*)</p>
            </td>
        </tr>
</tbody>        </table>
            </div><p>Effect: Using the malformed query, the attacker can obtain all user information of the user Andy, not only the public information as in the original query.</p><h5 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1FbGV2YXRpb25vZnByaXZpbGVnZXM" class="heading "><span>Elevation of privileges</span></h5><div class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Original query</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>http://www.example.com/page.aspx?path=Pages&amp;recursive=yes</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Malformed query</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>http://www.example.com/page.aspx?path=Pages|(level=*))&amp;recursive=yes</p>
            </td>
        </tr>
</tbody>        </table>
            </div><p>Effect: Using the malformed query, the attacker can obtain all pages, not only those he has permissions for in the original query.</p><p><br></p></div>

    
    
    

    
    


    <div class="section-right"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1fegftcgxlc29mterbugluamvjdglvbnm">Examples of LDAP injections</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1pynrhaw5pbmd1c2vyaw5mb3jtyxrpb24">Obtaining user information</a></p>
</li><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1fbgv2yxrpb25vznbyaxzpbgvnzxm">Elevation of privileges</a></p>
</li></ul></li><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1xagf0y2futerbugluamvjdglvbmf0dgfja2rv">What can LDAP injection attack do</a></p>
</li><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1gaw5kaw5nterbugluamvjdglvbnz1bg5lcmfiawxpdgllcw">Finding LDAP injection vulnerabilities</a></p>
</li><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1ib3d0b3byzxzlbnrmrefqaw5qzwn0aw9uaw5lzw50awnv">How to prevent LDAP injection in Kentico</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881106_safe-id-tglnahr3zwlnahreaxjly3rvcnlby2nlc3nqcm90b2nvbchmrefqkwluamvjdglvbi1fc2nhcgluz3nwzwnpywxjagfyywn0zxjz">Escaping special characters</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div></div>
    <h3 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1XaGF0Y2FuTERBUGluamVjdGlvbmF0dGFja2Rv" class="heading "><span>What can LDAP injection attack do</span></h3>
<p>The attacker can, for example, obtain user logins and employee information, achieve privilege elevation, or modify the content inside the LDAP tree.</p>
    <h3 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1GaW5kaW5nTERBUGluamVjdGlvbnZ1bG5lcmFiaWxpdGllcw" class="heading "><span>Finding LDAP injection vulnerabilities</span></h3>
<ul class=" "><li class=" "><p>Black box testing – try to insert LDAP queries into <strong class=" ">sign-in</strong>, <strong class=" ">forgotten password</strong>, or <strong class=" ">search user</strong> fields. Also, try to insert bogus LDAP queries into these fields (see <strong class=" ">Examples of LDAP injections</strong> section).<br></p>
</li><li class=" "><p>Searching in code – try to find usages of the LDAP API in the code (see <a class="external-link" href="http://msdn.microsoft.com/en-us/library/ms180826.aspx">Directory Services in the .NET Framework</a> for information). Then, make sure that the input passed to the API is sanitized and validated correctly.</p>
</li></ul>    <h3 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1Ib3d0b3ByZXZlbnRMREFQaW5qZWN0aW9uaW5LZW50aWNv" class="heading "><span>How to prevent LDAP injection in Kentico</span></h3>
<p>In Kentico, LDAP is used during the authentication process via forms. The input data is not authenticated against a database, but against Active Directory. Therefore, this spot in the system is vulnerable to LDAP injection attacks. Knowing that, we have made sure the input data is correctly validated to prevent these attacks.</p>
<p>However, if you plan to create a custom web part which operates with the AD data, be sure to check and secure the input before sending the LDAP queries to the server. Good techniques are:</p>
<ul class=" "><li class=" "><p>restrict user input using regular expressions - where a number is expected, validate the input for numbers; where a name is expected, validate for characters.</p>
</li><li class=" "><p>escape special characters.</p>
</li></ul>    <h4 id="src-68881106_safe-id-TGlnaHR3ZWlnaHREaXJlY3RvcnlBY2Nlc3NQcm90b2NvbChMREFQKWluamVjdGlvbi1Fc2NhcGluZ3NwZWNpYWxjaGFyYWN0ZXJz" class="heading "><span>Escaping special characters</span></h4>
<p>The required escape sequence depends on whether the user input is used to create the Distinguished Name or used as a part of the search filter.</p>
<p><strong class=" ">Used in DN - escape using / is needed:</strong></p>
    <div class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>&amp;</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>!</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>|</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>=</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>&lt;</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>&gt;</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>,</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>+</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>-</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>"</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>'</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>;</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p><strong class=" ">Used in filter - escape using {\ASCII} is needed:</strong></p>
    <div class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>(</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>{\28}</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>)</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>{\29}</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>\</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>{\5c}</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>*</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>{\2a}</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>/</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>{\2f}</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Null</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>{\0}</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p>It is also a good practice to include '\\' at the beginning of escaped character listings to prevent recursive replacements.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>