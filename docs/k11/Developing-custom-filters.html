<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Developing custom filters - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882212">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882212"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom-development.html">Custom development</a></li>
                                                                                                         <li class="shortcut"><a href="Developing-web-parts.html">Developing web parts</a></li>
                                                                                     <li><a href="Advanced-web-part-development-scenarios.html">Advanced web part development scenarios</a></li>
                                                            </ul>
</div>            <h1 id="src-68882212"> <span>Developing custom filters</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>Filters are components that allow users to modify the data loaded and displayed by other website components. Filters provide two types of functionality:</p><ul class=" "><li class=" "><p>Limiting the range of items displayed in a list</p>
</li><li class=" "><p>Changing the order of items in a list</p>
</li></ul><p>Kentico comes with a built-in set of filters for various types of data, but you can also create custom filters to fulfill specific requirements.</p><ol class=" "><li class=" "><p>Implement filters as <i class=" ">user controls</i> that inherit from one of the following base classes:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">CMSAbstractDataFilterControl</strong> - works with page data sources</p>
</li><li class=" "><p><strong class=" ">CMSAbstractControlFilterControl</strong> - works with navigation web parts</p>
</li><li class=" "><p><strong class=" ">CMSAbstractQueryFilterControl</strong> - works with custom table and query data sources</p>
</li></ul>    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Select the appropriate base class according to the type of data that you need to filter. You can find these base classes in the <strong class=" ">CMS.DocumentEngine.Web.UI</strong> namespace.</p>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: If you are connecting a <strong class=" ">CMSAbstractQueryFilterControl</strong> filter to a data source with a custom query, the code of the query must contain the ##WHERE## and ##ORDERBY## expressions. When applied, the filter replaces the expressions with dynamically generated SQL code. See: <a href="loading-data-using-custom-queries#src-68880629_loadingdatausingcustomqueries-usingpropertiestomodifyqueries">Using properties to modify queries</a></p>
        </div>
    </div>
</li><li class=" "><p>Add the filter control onto your website through the <strong class=" ">Filter</strong> web part.<br></p>
<ul class=" "><li class=" "><p>You need to specify the path to the <i class=" ">.ascx</i> file in the <strong class=" ">Filter control path</strong> property.</p>
</li></ul></li><li class=" "><p>Attach the filter web part to the data source web part of the matching type.</p>
</li></ol><p>You can also use custom filters anywhere in your code as standard user controls, for example on ASPX templates or in other web parts. All necessary properties, such as the <strong class=" ">FilterName</strong> used to connect with the data source, are inherited from the base class.</p></div>


    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882212_developingcustomfilters-example-creatingacustomproductfilter">Example - Creating a custom product filter</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882212_developingcustomfilters-creatingthefiltercontrol">Creating the filter control</a></p>
</li><li class=" "><p><a href="#src-68882212_developingcustomfilters-implementingthefilteringlogic">Implementing the filtering logic</a></p>
</li><li class=" "><p><a href="#src-68882212_developingcustomfilters-addingthefiltertoaportalenginepage">Adding the filter to a portal engine page</a></p>
</li></ul></li></ul>        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="loading-and-displaying-data-on-websites">Loading and displaying data on websites</a></p>
</li><li class=" "><p><a href="filtering-and-paging-data">Filtering and paging data</a></p>
</li><li class=" "><p><a href="developing-data-source-web-parts">Developing data source web parts</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882212_developingcustomfilters-example-creatingacustomproductfilter">Example - Creating a custom product filter</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882212_developingcustomfilters-creatingthefiltercontrol">Creating the filter control</a></p>
</li><li class=" "><p><a href="#src-68882212_developingcustomfilters-implementingthefilteringlogic">Implementing the filtering logic</a></p>
</li><li class=" "><p><a href="#src-68882212_developingcustomfilters-addingthefiltertoaportalenginepage">Adding the filter to a portal engine page</a></p>
</li></ul></li></ul>        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="loading-and-displaying-data-on-websites">Loading and displaying data on websites</a></p>
</li><li class=" "><p><a href="filtering-and-paging-data">Filtering and paging data</a></p>
</li><li class=" "><p><a href="developing-data-source-web-parts">Developing data source web parts</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Example - Creating a custom product filter</span></h3>
<p>The following example demonstrates how to develop a custom filter for <i class=" ">product pages</i>. The filter allows users to view products from specific departments and determine the order in which products are displayed. The filter applies when a postback occurs on the page. You can create filters for all types of pages or other objects using the same approach.</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Creating the filter control</span></h4>
<ol class=" "><li class=" "><p>Open your web project in Visual Studio.</p>
</li><li class=" "><p>Create a <strong class=" ">New folder</strong> under the root called <i class=" ">CMSGlobalFiles</i> (if it doesn't already exist).</p>
<ul class=" "><li class=" "><p>The system can export the content of this folder along with your site when you <a href="deploying-websites">deploy</a> it to another instance of Kentico.</p>
</li></ul></li><li class=" "><p>Add a <strong class=" ">Web User Control</strong> named <i class=" ">CustomProductFilter.ascx</i> into the <strong class=" ">CMSGlobalFiles</strong> folder.</p>
</li><li class=" "><p>Add the following markup to the control:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;%@ Control Language=</code><code class="string">"C#"</code><code class="plain"> AutoEventWireup=</code><code class="string">"true"</code><code class="plain"> CodeFile=</code><code class="string">"CustomProductFilter.ascx.cs"</code><code class="plain"> Inherits=</code><code class="string">"CMSGlobalFiles_CustomProductFilter"</code><code class="plain"> %&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">&lt;table&gt;</code></div>
<div class="line"><code class="plain">  &lt;tr&gt;</code></div>
<div class="line"><code class="plain">    &lt;td style=</code><code class="string">"padding:2px"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;cms:LocalizedLabel ID=</code><code class="string">"lblDepartment"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> Text=</code><code class="string">"Product department"</code><code class="plain"> DisplayColon=</code><code class="string">"true"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;/cms:LocalizedLabel&gt;</code></div>
<div class="line"><code class="plain">    &lt;/td&gt;</code></div>
<div class="line"><code class="plain">    &lt;td style=</code><code class="string">"padding:2px"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;cms:LocalizedDropDownList ID=</code><code class="string">"drpDepartment"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> Width=</code><code class="string">"180"</code><code class="plain"> &gt;</code></div>
<div class="line"><code class="plain">      &lt;/cms:LocalizedDropDownList&gt;</code></div>
<div class="line"><code class="plain">    &lt;/td&gt;</code></div>
<div class="line"><code class="plain">  &lt;/tr&gt;</code></div>
<div class="line"><code class="plain">  &lt;tr&gt;</code></div>
<div class="line"><code class="plain">    &lt;td style=</code><code class="string">"padding:2px"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;cms:LocalizedLabel ID=</code><code class="string">"lblOrder"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> Text=</code><code class="string">"Order by"</code><code class="plain"> DisplayColon=</code><code class="string">"true"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;/cms:LocalizedLabel&gt;</code></div>
<div class="line"><code class="plain">    &lt;/td&gt;</code></div>
<div class="line"><code class="plain">    &lt;td style=</code><code class="string">"padding:2px"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;cms:LocalizedDropDownList ID=</code><code class="string">"drpOrder"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> Width=</code><code class="string">"180"</code><code class="plain"> &gt;</code></div>
<div class="line"><code class="plain">      &lt;/cms:LocalizedDropDownList&gt;</code></div>
<div class="line"><code class="plain">    &lt;/td&gt;</code></div>
<div class="line"><code class="plain">  &lt;/tr&gt;</code></div>
<div class="line"><code class="plain">  &lt;tr&gt;</code></div>
<div class="line"><code class="plain">    &lt;td colspan=</code><code class="string">"2"</code><code class="plain"> style=</code><code class="string">"padding:2px"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;cms:LocalizedButton ID=</code><code class="string">"btnFilter"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> Text=</code><code class="string">"Apply Filter"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">    &lt;/td&gt;</code></div>
<div class="line"><code class="plain">  &lt;/tr&gt;</code></div>
<div class="line"><code class="plain">&lt;/table&gt;</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>This creates the design of the filter's user interface. The filter is composed of localized labels, drop-down lists and a button, arranged in a simple table layout. Alternatively, you can use a CSS‑based layout applied through HTML elements (e.g. &lt;div&gt;, &lt;span&gt;, etc.).</p>
<p>You can enter the captions of the filter's child controls using <a href="working-with-resource-strings">localization strings</a> through the <strong class=" ">ResourceString</strong> property, rather than directly as <strong class=" ">Text</strong>.</p>
        </div>
    </div>
</li></ol>    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Implementing the filtering logic</span></h4>
<ol class=" "><li class=" "><p>Switch to the user control's code behind file and add the following references:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System.Data;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> System.Web.UI.WebControls;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DocumentEngine.Web.UI;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Ecommerce;</code></div>
</div>
    </div>
</li><li class=" "><p>Set the control to inherit from the appropriate base class.</p>
<ul class=" "><li class=" "><p>This example uses the <strong class=" ">CMSAbstractDataFilterControl</strong> class, since the filter is intended for use with a page data source.</p>
</li></ul>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">partial</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CMSGlobalFiles_CustomProductFilter : CMSAbstractDataFilterControl</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Add the following methods into the user control class to load the filtering options into the child drop-down lists:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Sets up the inner child controls.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> SetupControl()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Hides the filter if StopProcessing is enabled</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (</code><code class="keyword">this</code><code class="plain">.StopProcessing)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.Visible = </code><code class="keyword">false</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Initializes only if the current request is NOT a postback</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">else</code><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (!RequestHelper.IsPostBack())</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Loads product departments as filtering options</code></div>
<div class="line"><code class="plain">        InitializeDepartments();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Initializes the Order by drop-down list</code></div>
<div class="line"><code class="plain">        IntializeOrder();</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Loads the ordering options into the Order by drop-down list.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> IntializeOrder()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Initializes the ordering options</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.drpOrder.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Price - Ascending"</code><code class="plain">, </code><code class="string">"priceAsc"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.drpOrder.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Price - Descending"</code><code class="plain">, </code><code class="string">"priceDesc"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.drpOrder.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Product name"</code><code class="plain">, </code><code class="string">"name"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Loads all existing product departments as filtering options into the department drop-down list.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> InitializeDepartments()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Gets all product departments from the system's database</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">var</code><code class="plain"> departments = DepartmentInfoProvider.GetDepartments();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Checks that at least one product department exists</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (!DataHelper.DataSourceIsEmpty(departments))</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Binds the departments to the drop-down list</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.drpDepartment.DataSource = departments;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.drpDepartment.DataTextField = </code><code class="string">"DepartmentDisplayName"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.drpDepartment.DataValueField = </code><code class="string">"DepartmentID"</code><code class="plain">;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.drpDepartment.DataBind();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Adds the default '(all)' option</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.drpDepartment.Items.Insert(0, </code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"(all)"</code><code class="plain">, </code><code class="string">"##ALL##"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Define the <strong class=" ">SetFilter()</strong> method:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Generates a WHERE condition and ORDER BY clause based on the current filtering selection.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> SetFilter()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">string</code><code class="plain"> where = </code><code class="keyword">null</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">string</code><code class="plain"> order = </code><code class="keyword">null</code><code class="plain">;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Generates a WHERE condition based on the selected product department</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (</code><code class="keyword">this</code><code class="plain">.drpDepartment.SelectedValue != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the ID of the selected department</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">int</code><code class="plain"> departmentId = ValidationHelper.GetInteger(</code><code class="keyword">this</code><code class="plain">.drpDepartment.SelectedValue, 0);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (departmentId &gt; 0)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            where = </code><code class="string">"SKUDepartmentID = "</code><code class="plain"> + departmentId;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Applies the selected product order</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (</code><code class="keyword">this</code><code class="plain">.drpOrder.SelectedValue != </code><code class="string">""</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">switch</code><code class="plain"> (</code><code class="keyword">this</code><code class="plain">.drpOrder.SelectedValue)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"priceAsc"</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                order = </code><code class="string">"SKUPrice"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"priceDesc"</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                order = </code><code class="string">"SKUPrice Desc"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">            </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"name"</code><code class="plain">:</code></div>
<div class="line"><code class="plain">                order = </code><code class="string">"SKUName"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (where != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Sets the Where condition</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.WhereCondition = where;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (order != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Sets the OrderBy clause</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.OrderBy = order;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">// Raises the filter changed event</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">this</code><code class="plain">.RaiseOnFilterChanged();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The filter control dynamically generates a WHERE condition and ORDER BY statement based on the selected filtering options. The values are stored in the <strong class=" ">WhereCondition</strong> and <strong class=" ">OrderBy</strong> properties inherited from the base class. When you attach the filter to a data source, it reads the values of the properties and inserts them into the SQL query used to load the data.</p>
<p>Note:</p>
<ul class=" "><li class=" "><p>The filter must inherit from the appropriate base class according to the type of the used data source.</p>
</li><li class=" "><p>If you are connecting a filter to a data source with a custom query, the code of the query must contain the ##WHERE## and ##ORDERBY## expressions. When applied, the filter replaces the expressions with the dynamically generated SQL code. See: <a href="loading-data-using-custom-queries#src-68880629_loadingdatausingcustomqueries-usingpropertiestomodifyqueries">Using properties to modify queries</a></p>
</li></ul>        </div>
    </div>
</li><li class=" "><p>Add two more methods that override the handlers of the control's <strong class=" ">Init</strong> and <strong class=" ">PreRender</strong> events:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Init event handler.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit(EventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Creates the child controls</code></div>
<div class="line"><code class="plain">    SetupControl();</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">base</code><code class="plain">.OnInit(e);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// PreRender event handler</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnPreRender(EventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Checks if the current request is a postback</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (RequestHelper.IsPostBack())</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Applies the filter to the displayed data</code></div>
<div class="line"><code class="plain">        SetFilter();</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="keyword">base</code><code class="plain">.OnPreRender(e);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The <i class=" ">OnInit</i> and <i class=" ">OnPreRender</i> handlers call the previously defined private methods during the correct stages of the page life cycle.</p>
        </div>
    </div>
</li></ol><p>When a user clicks the <strong class=" ">Apply Filter</strong> button, a postback occurs, which triggers the <strong class=" ">SetFilter()</strong> method during the <strong class=" ">PreRender</strong> event and the filter applies the conditions to the displayed data. Notice the use of the <strong class=" ">CMS.Helpers.RequestHelper.IsPostBack()</strong> method in the conditions. The control only calls the <strong class=" ">SetFilter()</strong> method when the current page request is a postback, and initializes the child controls only on the first page load (i.e. when the request is <i class=" ">not</i> a postback).</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Adding the filter to a portal engine page</span></h4>
<p>The filter control is now ready and you can try out its functionality. It is recommended to test the filter on the <strong class=" ">Corporate</strong> or <strong class=" ">E-commerce</strong> sample sites, which already contain examples of product pages.</p>
<ol class=" "><li class=" "><p>Log in to the administration interface.</p>
</li><li class=" "><p>Open the <strong class=" ">Pages</strong> application and <a href="creating-new-pages">create a new page</a>.</p>
</li><li class=" "><p>Switch to the page's <strong class=" ">Design</strong> tab and add the following web parts:</p>
    <div class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" ">    <tr>
            <td class="confluenceTh" rowspan="1" colspan="1">
    <p>Web part</p>
            </td>
                <td class="confluenceTh" rowspan="1" colspan="1">
    <p>Instructions</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Pages data source<br>    <span style="color: #ffffff;">
____________________    </span>
</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p>Configure the web part to load product pages.</p>
</li><li class=" "><p>Fill in the <strong class=" ">Filter name</strong> property (e.g. <i class=" ">CustomProductFilter)</i>.</p>
</li></ol><p><strong class=" ">Note</strong>: You can alternatively use the <i class=" ">Products data source</i> web part for this purpose.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Filter</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p>Assign a <strong class=" ">Filter name</strong> that matches the data source (<i class=" ">CustomProductFilter</i>).</p>
</li><li class=" "><p>Enter the path of the .ascx file implementing your custom filter into the <strong class=" ">Filter control path</strong> property:<br><i class=" ">~/CMSGlobalFiles/CustomProductFilter.ascx</i></p>
</li></ol>            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Basic repeater</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p>Enter the ID of the Pages data source web part into the <strong class=" ">Data source name</strong> property.</p>
</li><li class=" "><p>Set an appropriate <strong class=" ">Transformation name</strong>, for example: <i class=" ">CMS.Product.CorporateSite</i></p>
</li></ol>            </td>
        </tr>
</tbody>        </table>
            </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>For more information about setting up web parts that display data and allow filtering, see:</p>
<ul class=" "><li class=" "><p><a href="loading-and-displaying-data-on-websites">Loading and displaying data on websites</a></p>
</li><li class=" "><p><a href="filtering-and-paging-data">Filtering and paging data</a></p>
</li></ul>        </div>
    </div>
</li></ol><p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68882212/CustomFilter_WebParts.png" alt="images/download/attachments/68882212/CustomFilter_WebParts.png" width="500">
        <br><span class="caption">Creating a page that displays product pages and a custom filter</span>
    </p>
<p>If you view the page on the live site, you can see a list of products with the custom filter above. Try filtering the products by their department and changing their order.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68882212/Custom_Filter_Result.png" alt="images/download/attachments/68882212/Custom_Filter_Result.png" width="500">
        <br><span class="caption">Filtering the products to display only Laptops and tables, in descending order according to their price</span>
    </p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>