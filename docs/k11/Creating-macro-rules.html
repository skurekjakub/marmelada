<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Creating macro rules - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882631">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882631"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Macro-expressions.html">Macro expressions</a></li>
                                                                                     <li><a href="Writing-macro-conditions.html">Writing macro conditions</a></li>
                                                            </ul>
</div>            <h1 id="src-68882631"> <span>Creating macro rules</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>Macro rules allow non-technical users to create <a href="writing-macro-conditions">macro conditions</a> without any knowledge of K# macro syntax. The rules are internally implemented as predefined macro expressions but appear as purely text-based clauses describing certain requirements. Users <a href="building-conditions-using-macro-rules">build conditions out of macro rules</a> inside a dedicated <i class=" ">Rule designer</i> interface.</p><p>The system contains many different types of rules by default and allows you to create custom rules to fulfill any requirements of your users. There are several categories of macro rules:</p><div class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col>
                                    <col>
                                    <col>
                            </colgroup>
        <thead class=" ">    <tr>
            <td class="confluenceTh" rowspan="1" colspan="1">
    <p style="text-align:center;">Rule category</p>
            </td>
                <td class="confluenceTh" rowspan="1" colspan="1">
    <p style="text-align:center;">Description</p>
            </td>
                <td class="confluenceTh" rowspan="1" colspan="1">
    <p>Managed in</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Global<br>    <span style="color: #ffffff;">
_______________    </span>
</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Global rules are available when creating conditions in any part of the system.</p>
<p><strong class=" ">Note</strong>: Certain types of conditions that are closely related to individual applications do not offer global rules.</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p><strong class=" ">Macro rules -&gt; Global</strong></p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Form validation</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Allow the system to validate input values of form fields. Users can select the validation rules when defining fields in the <a href="reference---field-editor">field editor</a> (general fields) and the <a href="designing-forms-using-the-form-builder">form builder</a>.</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p><strong class=" ">Macro rules -&gt; Form validation</strong></p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Workflow</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Users can select workflow rules when adding conditions to <a href="applying-workflows-to-pages">workflow scopes</a> or <a href="designing-advanced-workflows">advanced workflow steps</a>.</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p><strong class=" ">Workflows -&gt; Macro rules</strong></p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>On-line marketing</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Users can select on-line marketing rules when building conditions for:</p>
<ul class=" "><li class=" "><p><a href="content-personalization">Content personalization variants</a></p>
</li><li class=" "><p><a href="segmenting-contacts-into-contact-groups">Condition-based contact groups</a></p>
</li><li class=" "><p><a href="setting-triggers-for-automation-processes">Triggers</a> and <a href="working-with-the-automation-process-designer">step transitions</a> for marketing automation processes</p>
</li><li class=" "><p><a href="personas">Personas</a></p>
</li><li class=" "><p><a href="managing-contact-scores">Scoring</a></p>
</li></ul>            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p><strong class=" ">Contact management -&gt; Configuration -&gt; Macro rules</strong></p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Reporting</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Users can select reporting rules when specifying conditions for <a href="subscribing-to-reports">Report subscriptions</a>.</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Open the <strong class=" ">Reporting</strong> application, select any report category in the tree and open the <strong class=" ">Macro rules</strong> tab (in the collapsible panel).</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>E-commerce</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The system provides rules for creating conditions that can limit the following types of discounts and offers:</p>
<ul class=" "><li class=" "><p><a href="working-with-catalog-discounts">Catalog discounts</a></p>
</li><li class=" "><p><a href="working-with-order-discounts">Order discounts</a></p>
</li><li class=" "><p><a href="working-with-free-shipping-offers">Free shipping offers</a></p>
</li><li class=" "><p><a href="working-with-gift-cards">Gift cards</a></p>
</li></ul>            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p><strong class=" ">Store configuration</strong> or<strong class=" "> Multistore configuration -&gt; Discount rules</strong></p>
            </td>
        </tr>
</tbody>        </table>
            </div></div>

    
    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882631_creatingmacrorules-definingmacrorules">Defining macro rules</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882631_creatingmacrorules-addingruleparameters">Adding rule parameters</a></p>
</li></ul></li><li class=" "><p><a href="#src-68882631_creatingmacrorules-modifyingexistingmacrorules">Modifying existing macro rules</a></p>
</li><li class=" "><p><a href="#src-68882631_safe-id-q3jlyxrpbmdtywnyb3j1bgvzluv4yw1wbgxigjndcmvhdgluz2ftywnyb3j1bgu">Example – Creating a macro rule</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="writing-macro-conditions">Writing macro conditions</a></p>
</li><li class=" "><p><a href="macro-syntax">Macro syntax</a></p>
</li><li class=" "><p><a href="building-conditions-using-macro-rules">Building conditions using macro rules</a></p>
</li><li class=" "><p><a href="improving-custom-macro-performance-in-scoring-and-contact-groups">Improving custom macro performance in scoring and contact groups</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882631_creatingmacrorules-definingmacrorules">Defining macro rules</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882631_creatingmacrorules-addingruleparameters">Adding rule parameters</a></p>
</li></ul></li><li class=" "><p><a href="#src-68882631_creatingmacrorules-modifyingexistingmacrorules">Modifying existing macro rules</a></p>
</li><li class=" "><p><a href="#src-68882631_safe-id-q3jlyxrpbmdtywnyb3j1bgvzluv4yw1wbgxigjndcmvhdgluz2ftywnyb3j1bgu">Example – Creating a macro rule</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="writing-macro-conditions">Writing macro conditions</a></p>
</li><li class=" "><p><a href="macro-syntax">Macro syntax</a></p>
</li><li class=" "><p><a href="building-conditions-using-macro-rules">Building conditions using macro rules</a></p>
</li><li class=" "><p><a href="improving-custom-macro-performance-in-scoring-and-contact-groups">Improving custom macro performance in scoring and contact groups</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Defining macro rules</span></h3>
<p>To prepare new macro rules for your users:</p>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Tip</strong>: For a step-by-step example of creating a macro rule, see <a href="#src-68882631_safe-id-q3jlyxrpbmdtywnyb3j1bgvzluv4yw1wbgxigjndcmvhdgluz2ftywnyb3j1bgu">Creating a macro rule</a>.</p>
        </div>
    </div>
<ol class=" "><li class=" "><p>Navigate to the management interface for the appropriate type of rule (see the table above).</p>
</li><li class=" "><p>Click <strong class=" ">New macro rule</strong>.</p>
</li><li class=" "><p>Fill in the following properties:</p>
    <div class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col>
                                    <col>
                            </colgroup>
        <thead class=" ">    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>General</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Display name</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Sets the name displayed to users in the list of macro rules in the rule designer. Also serves as a basic description of the rule's purpose.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Name</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Serves as a unique identifier of the rule (for example in the API).</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Description</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>A text description of the rule's purpose and parameters. The text appears as a tooltip when users hover over the rule in the rule designer.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Enabled</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>If disabled, users cannot select the rule when building conditions.</p>
<p><strong class=" ">Note</strong>: Disabling a rule does not affect the functionality of existing conditions where users have added the given rule.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Rule data</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>User text</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Defines the text displayed in the rule designer when users insert the rule into a condition.</p>
<p>To add parameters into the text, enter the <i class=" ">Field name</i> of a specific parameter enclosed in curly brackets, for example <strong class=" ">{days}</strong>. In the rule designer, the parameter appears as an underlined section in the text. Users can set the parameter's value by clicking the underlined text.</p>
<p>See the <a href="#src-68882631_creatingmacrorules-addingruleparameters">Adding rule parameters</a> section for more information.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Condition</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The actual condition represented by the rule. Define the condition through standard <a href="macro-syntax">macro code (K#)</a>. The field provides <a href="entering-macro-expressions">autocomplete support</a>.</p>
<p>Add any parameters offered by the rule to the appropriate position in the code, using the same syntax as for the <strong class=" ">User text</strong> field, for example <strong class=" ">{days}</strong>. When the system resolves the condition, the parameter expression is replaced by the value set for the parameter by users in the rule designer.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Required data</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Limits for which conditions the macro rule is available. The rule only appears when building conditions that have the specified data items available in the resolving context. You can add multiple required data items separated by semicolons (;).</p>
<p>Leave this property empty unless you are creating rules specifically for conditions with a <a href="extending-the-macro-engine">customized resolving context</a>.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Requires context</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Enable this property if the rule's condition needs to access context data (information about the current user, the currently viewed page, etc.) in order to work correctly. This ensures that the rule only appears for conditions that have the context available when they are resolved.</p>
<p>For example, the context is accessible when evaluating the conditions of <a href="content-personalization">Content personalization</a> variants on the website's page, but not when the system is building condition-based <a href="segmenting-contacts-into-contact-groups">Contact groups</a>.</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol>    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Adding rule parameters</span></h4>
<p>Parameters are variables inside macro rules that modify the resulting condition. By adding parameters, you can make flexible rules that are usable for a wide range of scenarios. For example, in a macro rule that requires the current user to be a member of certain roles, the names of the roles would be a parameter.</p>
<p>To create a parameter for a macro rule:</p>
<ol class=" "><li class=" "><p>Edit the macro rule.</p>
</li><li class=" "><p>Open the <strong class=" ">Parameters</strong> tab.</p>
</li><li class=" "><p>Prepare the parameter as a form field. Every parameter has a certain data type and various other settings. The interface that users see when editing the parameter's values depends on the selected <a href="developing-form-controls">Form control</a>.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Refer to <a href="reference---field-editor">Reference - Field editor</a> for details about working with the field editor.</p>
        </div>
    </div>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p>Switch to the rule's <strong class=" ">General</strong> tab.</p>
</li><li class=" "><p>Place the parameter into the rule's <strong class=" ">User text</strong> and <strong class=" ">Condition</strong> code.</p>
<ul class=" "><li class=" "><p>The syntax for inserting parameters is the parameter's <i class=" ">Field name</i> enclosed in curly brackets, for example <strong class=" "><i class=" ">{role}</i></strong>.</p>
</li><li class=" "><p>When the system resolves conditions containing the macro rule, the parameter expressions in the condition code are replaced by the values entered by users. You need to position the parameter expression accordingly.<br><br></p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>Users can now set the values of the rule's parameters when building conditions.</p>
    <h5 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Automatic rule parameters</span></h5>
<p>There are several predefined parameters you can use to add common functionality to macro rules:</p>
<ul class=" "><li class=" "><p><strong class=" ">{_is}</strong>, <strong class=" ">{_has}</strong>, <strong class=" ">{_was}</strong>, <strong class=" ">{_will}</strong>, <strong class=" ">{_perfectum}</strong> - provide an easy way to negate a rule's condition. Each variant offers different wording, so you can use the one that matches the text of your rule. The parameters allow users to choose between a positive and negative option, for example, <i class=" ">is</i> or <i class=" ">is not</i>. If the negative option is selected, the parameter resolves into the K# negation operator "!" in the condition code. With the positive option, the parameter returns an empty string.<br><br></p>
</li><li class=" "><p><strong class=" ">{_any}</strong> - useful for rules where a list of items needs to be specified through another parameter. The parameter allows users to switch between two options that determine how the rule processes the item list — <i class=" ">any</i> (at least one of the items must meet the given condition) or <i class=" ">all</i> (the condition must be fulfilled for all items in the list). When resolved, the parameter returns either a <i class=" ">false</i> (any) or <i class=" ">true</i> (all) value. In the condition code, you can insert the parameter as an additional argument of macro methods that work with object lists, which automatically ensures the required functionality. For example: <i class=" ">CurrentUser.IsInRole("{roles}", {_any})</i></p>
</li></ul><p>When you enter one of the automatic parameters into the <strong class=" ">User text</strong> field of a rule, the system automatically creates a field with the corresponding configuration and default values on the <strong class=" ">Parameters</strong> tab.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Escaping special characters in text parameters</strong></p>
<p>Certain characters inside the values of text parameters could cause the macro condition of rules to become invalid if unhandled. For example, if a rule's condition is <i class=" ">CurrentUser.UserNickName == "{name}"</i>, a quote character inside the value of the <i class=" ">name</i> parameter would prematurely close the string, leading to invalid macro syntax and an incorrect parameter value.</p>
<p>To avoid the problem, the system automatically escapes quote and backslash characters inside parameters entered as string literals (directly enclosed inside quotes).</p>
<p>For more complex parameters, you can explicitly enable escaping of string special characters by adding <strong class=" ">|(escapestring)</strong> to the parameter, for example:<br><i class=" ">"Prefix {parameter|(escapestring)}"</i></p>
        </div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Modifying existing macro rules</span></h3>
<p>When you make changes in the definition of a macro rule or its parameters, the system does NOT update the functionality of existing conditions. This may lead to incorrect behavior of conditions containing the modified rule.</p>
<p>To make sure your conditions are up-to-date, you need to manually perform the following steps after modifying an existing macro rule:</p>
<ol class=" "><li class=" "><p>Find the condition fields that contain the rule. You can use the <a href="searching-for-macros">macro report tool</a> to search.</p>
</li><li class=" "><p>Click <strong class=" ">Edit</strong> next to the field to open the rule designer.</p>
</li><li class=" "><p>If required, update the parameters for all occurrences of the modified rule.</p>
</li><li class=" "><p>Click <strong class=" ">Save &amp; Close</strong>.</p>
</li></ol><p>When you save the condition, the system uses the current definitions of the contained macro rules.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Example – Creating a macro rule</span></h3>
<p>The following is a step-by-step example that demonstrates how to create a custom macro rule. The sample macro rule allows users to create conditions that are fulfilled only during selected months.</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Macro rules</strong> application.</p>
</li><li class=" "><p>Click <strong class=" ">New macro rule</strong> under the<strong class=" "> Global</strong> tab.</p>
</li><li class=" "><p>Fill in the following properties:<br></p>
<ul class=" "><li class=" "><p><strong class=" ">Display name</strong>: Current month is</p>
</li><li class=" "><p><strong class=" ">User text</strong>: Current month {_is} one of the following months: {months}.</p>
</li><li class=" "><p><strong class=" ">Condition</strong>: {_is}CurrentDateTime.Month.EqualsAny("{months}".Split("|"))<br><br></p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Parameters</strong> tab. Kentico automatically creates the <strong class=" ">months</strong> field from the<i class=" "> {months}</i> parameter entered into the <strong class=" ">User text </strong>and <strong class=" ">Condition </strong>fields.</p>
</li><li class=" "><p>Select the <strong class=" ">months</strong> field.</p>
</li><li class=" "><p>Fill in the following properties:</p>
<ul class=" "><li class=" "><p><strong class=" ">Field caption</strong>: select months</p>
</li><li class=" "><p><strong class=" ">Form control</strong>: Multiple choice</p>
</li><li class=" "><p><strong class=" ">Data source</strong>: List of options<br><br></p>
</li></ul></li><li class=" "><p>Copy the following into the<strong class=" "> Data source</strong> text area:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="value">1</code><code class="plain">;January</code></div>
<div class="line"><code class="value">2</code><code class="plain">;February</code></div>
<div class="line"><code class="value">3</code><code class="plain">;March</code></div>
<div class="line"><code class="value">4</code><code class="plain">;April</code></div>
<div class="line"><code class="value">5</code><code class="plain">;May</code></div>
<div class="line"><code class="value">6</code><code class="plain">;June</code></div>
<div class="line"><code class="value">7</code><code class="plain">;July</code></div>
<div class="line"><code class="value">8</code><code class="plain">;August</code></div>
<div class="line"><code class="value">9</code><code class="plain">;September</code></div>
<div class="line"><code class="value">10</code><code class="plain">;October</code></div>
<div class="line"><code class="value">11</code><code class="plain">;November</code></div>
<div class="line"><code class="value">12</code><code class="plain">;December</code></div>
</div>
    </div>
</li><li class=" "><p>Click <strong class=" ">Save</strong> at the top of the page.</p>
</li></ol><p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68882631/custom_macro_rule.png" alt="images/download/attachments/68882631/custom_macro_rule.png" width="500">
        <br><span class="caption">Custom rule parameters</span>
    </p>
<p>Your custom macro rule is now finished, available globally across all your sites, and ready to be inserted into conditions through the <strong class=" ">Rule designer</strong> dialog.</p>
<p>For example, you can use the rule to limit the visibility of a feedback form field asking for a user's opinion about a campaign running only from June to August. The following demonstration uses the <i class=" ">Send us a message</i> form available on the <strong class=" ">Dancing Goat</strong> sample website:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Forms</strong> application.</p>
</li><li class=" "><p>Edit the <strong class=" ">Send us a message </strong>form.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Fields </strong>tab.</p>
</li><li class=" "><p>Select the <strong class=" ">UserMessage </strong>field.</p>
</li><li class=" "><p>Click <strong class=" ">Edit</strong> next to the <strong class=" ">Visibility condition</strong> setting under the <strong class=" ">Field advanced settings</strong> section. This opens the <strong class=" ">Edit macro condition</strong> dialog.</p>
</li><li class=" "><p>Select your macro rule from the list and insert it by clicking <strong class=" ">Add rule</strong> (<img class="confluence-embedded-image" src="images/download/attachments/68879208/left.png" alt="images/download/attachments/68879208/left.png">
).</p>
</li><li class=" "><p>Click on <u class=" ">select months</u> within the macro rule text. A <strong class=" ">Set parameter value</strong> dialog window opens.</p>
</li><li class=" "><p>Select the <i class=" ">June</i>, <i class=" ">July</i>, and <i class=" ">August</i> options and click <strong class=" ">Set parameter</strong>.</p>
</li><li class=" "><p>Click <strong class=" ">Save &amp; Close</strong>.</p>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>Now whenever a user visits a page with the Send us a message form outside of the specified three-month interval, the <strong class=" ">UserMessage</strong> form field will be hidden.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>