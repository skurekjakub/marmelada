<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Migration of Kentico projects from Azure Cloud Services to Azure Web Apps - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68881693">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881693"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Running-Kentico-on-Microsoft-Azure.html">Running Kentico on Microsoft Azure</a></li>
                                                                                     <li><a href="Running-Kentico-in-Azure-Web-Apps.html">Running Kentico in Azure Web Apps</a></li>
                                                            </ul>
</div>            <h1 id="src-68881693"> <span>Migration of Kentico projects from Azure Cloud Services to Azure Web Apps</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>The scenario described on this page assumes that you have a Kentico Azure project running in Azure Cloud Services, connected to the Azure SQL server and Azure Blob Storage and you have access to the local development project. When you decide to migrate your project from Azure Cloud Services to Azure Web Apps, you need to create a new Web App service and transfer your configurations to the web.config file of your project. You can utilize the existing Azure SQL Database and Azure Blob Storage.</p><p>To migrate an Azure project from Cloud Services to Web Apps, you need to:</p><ol class=" "><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-part1-configuringazureprojectsforazurewebapps">Transfer configurations</a> from the ServiceConfiguration.Cloud.cscfg file to the web.config file.</p>
</li><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-part2-creatingazurewebappsfromvisualstudio">Create a new Azure Web App service</a>.</p>
</li><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-part3-deployingazureprojectstoazurewebapps">Deploy the project as a web application through Visual Studio</a>. Alternatively, you can also <a href="setting-up-kentico-in-azure-web-apps#src-68881682_settingupkenticoinazurewebapps-uploadingkenticotoazurewebappsoverftp">deploy your project over FTP</a>.</p>
</li></ol><h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Part 1 - Configuring Azure projects for Azure Web Apps</span></h3><p>You can deploy only Kentico web site or web application projects to Azure Web Apps. Kentico projects installed as Azure projects contain a standard web application project in them. Therefore, you need to transfer configuration settings from the <strong class=" ">ServiceConfiguration.Cloud.cscfg</strong> file to the <strong class=" ">web.config</strong> file in the web application project and then deploy the web application project to Azure Web Apps.</p><ol class=" "><li class=" "><p>Open your Azure project in Visual Studio using the <strong class=" ">WebApp.sln</strong> file.</p>
</li><li class=" "><p>Open the <strong class=" ">CMSApp\Web.config</strong> file.</p>
</li><li class=" "><p>Add the <strong class=" ">CMSConnectionString</strong> key and value to the <i class=" ">connectionStrings</i> section of the web.config file.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">connectionStrings</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"CMSConnectionString"</code><code class="plain"> </code><code class="color1">connectionString</code><code class="plain">=</code><code class="string">"Data Source=tcp:YourServerName.database.windows.net,1433;Initial Catalog=YourDatabaseName;User Id=YourUsername@YourServerName;Password=YourPassword;"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">connectionStrings</code><code class="plain">&gt;</code></div>
</div>
    </div>
</li><li class=" "><p>Add the <strong class=" ">CMSAzureAccountName</strong> and <strong class=" ">CMSAzureSharedKey</strong> keys to the <i class=" ">appSettings</i> section of the web.config file.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">appSettings</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">	...</code></div>
<div class="line"><code class="plain">	&lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">key</code><code class="plain">=</code><code class="string">"CMSAzureAccountName"</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"StorageAccountName"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">	&lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">key</code><code class="plain">=</code><code class="string">"CMSAzureSharedKey"</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"PrimaryAccessKey"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">appSettings</code><code class="plain">&gt;</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Replace <i class=" ">StorageAccountName</i> and <i class=" ">PrimaryAccessKey</i> with values from the ServiceConfiguration.Cloud.cscfg file.</p>
        </div>
    </div>
</li><li class=" "><p>Configure the application to use Azure Blob storage according to the instructions in <a href="configuring-azure-storage">Configuring Azure storage</a>.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>For Azure Web Apps deployments, we recommend mapping<i class=" "> <strong class=" ">only media library folders</strong> </i>to the Azure storage.</p>
<p>In this scenario, you need to manually transfer any project files that exist on your Blob storage, but are not present in your local development project. Do not transfer your media library folders and the folders listed in <a href="azure-web-apps-problematic-folders">Azure Web Apps problematic folders</a>.</p>
        </div>
    </div>
</li><li class=" "><p>Right-click the <strong class=" ">CMSApp</strong> project in the Solution Explorer and select <strong class=" ">Set as StartUp Project</strong>.</p>
</li><li class=" "><p>Transfer any custom settings from the ServiceConfiguration.Cloud.cscfg file to the web.config file.</p>
</li></ol><p>Your project is now ready to be deployed to Azure Web Apps, but first you need to create a new Azure Web App service.</p></div>

    


    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-part1-configuringazureprojectsforazurewebapps">Part 1 - Configuring Azure projects for Azure Web Apps</a></p>
</li><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-part2-creatingazurewebappsfromvisualstudio">Part 2 - Creating Azure Web Apps from Visual Studio</a></p>
</li><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-part3-deployingazureprojectstoazurewebapps">Part 3 - Deploying Azure projects to Azure Web Apps</a></p>
</li><li class=" "><p><a href="#src-68881693_migrationofkenticoprojectsfromazurecloudservicestoazurewebapps-configuringwebfarmsforazurewebapps">Configuring web farms for Azure Web Apps</a></p>
</li></ul><p></p>
        </div>
    </div></div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Part 2 - Creating Azure Web Apps from Visual Studio</span></h3>
<p>Before you can deploy your project, you need to create a new Azure Web App service. You can do this from the <a class="external-link" href="https://portal.azure.com/">Microsoft Azure management portal</a> or directly from Visual Studio:</p>
<ol class=" "><li class=" "><p>Open your Kentico project in Visual Studio via the <strong class=" ">WebApp.sln</strong> file.</p>
</li><li class=" "><p>Open the <strong class=" ">Server Explorer</strong> tab (or Database Explorer tab in Express editions of Visual Studio).</p>
</li><li class=" "><p>Right-click <strong class=" ">Azure</strong>, select <strong class=" ">Connect to Microsoft Azure Subscription</strong> and sign in to your Azure account.</p>
</li><li class=" "><p>Expand the <strong class=" ">Azure</strong> node.</p>
</li><li class=" "><p>Right-click <strong class=" ">App Service</strong> and select <strong class=" ">Create New App Service...</strong>.<br></p>
<ol class=" "><li class=" "><p>On the <strong class=" ">Hosting</strong> tab, enter your web app name, select your subscription, Resource Group, and App Service Plan.</p>
</li><li class=" "><p>On the <strong class=" ">Services </strong>tab, create an SQL database for the application if necessary.</p>
</li></ol></li><li class=" "><p>Click <strong class=" ">Create</strong>.</p>
<ul class=" "><li class=" "><p>The system creates a new Azure Web App.</p>
</li></ul></li><li class=" "><p>Right-click the newly created web app and select <strong class=" ">View settings</strong>.</p>
</li><li class=" "><p>Modify the connection string to connect to your database deployed to an Azure SQL server (change the name of the database to correspond to your Azure SQL database).</p>
</li></ol><p>You can view the newly created Azure Web App in the <a class="external-link" href="https://portal.azure.com/">Azure management portal</a> under Web Apps. The Web App service is now empty. You can now deploy your web application project to Azure Web Apps.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Automatically created Azure SQL Database</strong></p>
<p>Note that creating a Web App from Visual Studio also creates a new Azure SQL Database on the specified server. If you already have a database on Azure, you will not need this automatically created database. Therefore, you should delete this database to avoid additional costs:</p>
<ol class=" "><li class=" "><p>Open the <a class="external-link" href="https://portal.azure.com/">Azure management portal</a>.</p>
</li><li class=" "><p>Select <strong class=" ">SQL Databases</strong>.</p>
</li><li class=" "><p>Select the automatically created database. The name should correspond to the name of the newly created Web App with a '<i class=" ">_db'</i> suffix.</p>
</li><li class=" "><p>Click <strong class=" ">Delete</strong>.</p>
</li></ol>        </div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Part 3 - Deploying Azure projects to Azure Web Apps</span></h3>
<p>You are deploying your Azure project as a Kentico web application project.</p>
<ol class=" "><li class=" "><p>Open your Kentico project in Visual Studio via the <strong class=" ">WebApp.sln</strong> file.</p>
</li><li class=" "><p>Open the web.config file and make sure that the <i class=" ">sessionState</i> mode is set to <strong class=" ">InProc</strong>.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">sessionState</code><code class="plain"> </code><code class="color1">mode</code><code class="plain">=</code><code class="string">"InProc"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Use <i class=" ">InProc</i> mode if you plan to use one instance of the Web App service. If you want to scale your web app to more instances, you will need to configure the session state differently. See <a href="storing-cache-and-session-state-data-in-azure-environment">Storing cache and session state data in Azure environment</a>.</p>
        </div>
    </div>
</li><li class=" "><p>Right-click the <strong class=" ">CMSApp</strong> project in the Solution Explorer and select <strong class=" ">Publish</strong>.</p>
</li><li class=" "><p>Select <strong class=" ">Microsoft Azure App Service</strong>.</p>
</li><li class=" "><p>Select the previously created web app in the drop-down list.</p>
</li><li class=" "><p>Click <strong class=" ">OK</strong>. The system downloads the publish profile.</p>
</li><li class=" "><p>Leave the settings as they are.</p>
</li><li class=" "><p>Click <strong class=" ">Publish</strong>.</p>
</li></ol><p>The system deploys your project to the Azure Web App service. Check that the project is correctly connected to the database (the database installation dialog does not appear).</p>
<p>Proceed to performing the following final configurations:</p>
<ul class=" "><li class=" "><p><a href="adjusting-the-web-hosting-plan-mode-on-azure-web-apps">Adjust the web hosting plan mode for your Web App service</a>.</p>
</li><li class=" "><p>Check that your Azure SQL database adheres to our <a href="recommendations-on-using-azure-sql-database-tiers">recommendations</a>.</p>
</li><li class=" "><p><a href="increasing-storage-capacity-on-azure-web-apps">Increasing storage capacity on Azure Web Apps</a></p>
</li></ul><p>After that, your Kentico project is ready to run in Azure Web Apps.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Configuring web farms for Azure Web Apps</span></h3>
<p>If you plan to increase the number of instances associated with your Web App service (via the <strong class=" ">Scale out (App Service plan)</strong> tab), you need to configure web farms in your project to dynamically create and delete web farm servers. See <a href="enabling-web-farms-on-azure-web-apps">Enabling web farms on Windows Azure Web Apps</a> for instructions.</p>
<p>Web farms are configured automatically for Cloud Services environment, however, they need to be enabled manually in Web Apps.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>