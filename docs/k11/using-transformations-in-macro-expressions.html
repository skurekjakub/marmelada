<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Using transformations in macro expressions - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68880616">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68880616"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Developing-websites.html">Developing websites</a></li>
                                                                                                         <li class="shortcut"><a href="Loading-and-displaying-data-on-websites.html">Loading and displaying data on websites</a></li>
                                                                                     <li><a href="Writing-transformations.html">Writing transformations</a></li>
                                                            </ul>
</div>            <h1 id="src-68880616"> <span>Using transformations in macro expressions</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-section"><div class="sp-grid-cell sp-grid-60"><div class="sp-grid-section"></div></div><div class="sp-grid-cell sp-grid-60"><p>You can apply <a href="writing-transformations">transformations</a> of the <strong class=" ">Text/XML</strong> and <strong class=" ">HTML</strong> type to pages and other objects retrieved via <a href="macro-expressions">macro expressions</a>. Transformations in macro expressions allow you to display dynamically loaded data inside text and HTML content, where you cannot add <a href="loading-and-displaying-data-on-websites">listing web parts or controls</a>. Typical examples include:</p><ul class=" "><li class=" "><p><a href="managing-email-templates">Email templates</a> that define the content of system emails</p>
</li><li class=" "><p><a href="preparing-email-templates">Marketing email templates</a></p>
</li></ul><p>You can also use transformations in all locations where macro resolving is supported.</p><p>To apply transformations to data inside macros, call the following macro method:</p><div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ApplyTransformation(String transformationName)</code></div>
</div>
    </div><p>The parameter must match the full name of the transformation that you wish to use. An overload with three parameters is also possible, which allows you to place additional transformations before and after the displayed data:</p><div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ApplyTransformation(String transformationName, String contentBeforeTransformationName, String contentAfterTransformationName)</code></div>
</div>
    </div><p>You can call the method for collections of objects that implement the <i class=" ">IEnumerable</i> interface, or for single instances of an object. When the system resolves such macro expressions, they return the objects of the given collection, formatted into the output code defined by the transformation.</p><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Security considerations</strong></p>
<p>When you save a macro expression, the system automatically adds a security signature. The signature is used to check access permissions for the data collections loaded by the expression. Macro security depends on the user who entered and saved the macro expression, not on the user viewing the resolved result.</p>
<p>As a result, the system does not resolve macro expressions if their author does not have permissions to access the requested data.</p>
<p>See also: <a href="working-with-macro-signatures">Working with macro signatures</a></p>
        </div>
    </div><div class="sp-grid-section"></div><div class="sp-grid-section"></div></div><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-examples-transformationsinmacroexpressions">Examples - transformations in macro expressions</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-preparingtheenvironment">Preparing the environment</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-displayingthecurrentuser">Displaying the current user</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-displayingpagesfromthecontenttree">Displaying pages from the content tree</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-retrievinganddisplayingsiteobjects">Retrieving and displaying site objects</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="macro-expressions">Macro expressions</a></p>
</li></ul>        </div>
    </div></div><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-examples-transformationsinmacroexpressions">Examples - transformations in macro expressions</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-preparingtheenvironment">Preparing the environment</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-displayingthecurrentuser">Displaying the current user</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-displayingpagesfromthecontenttree">Displaying pages from the content tree</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-retrievinganddisplayingsiteobjects">Retrieving and displaying site objects</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="macro-expressions">Macro expressions</a></p>
</li></ul>        </div>
    </div></div></div><div class="sp-grid-section"></div>


    

    

    
    
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Examples - transformations in macro expressions</span></h3>
<ul class=" "><li class=" "><p><strong class=" ">Preparing the environment</strong></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-displayingthecurrentuser">Displaying the current user</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-displayingpagesfromthecontenttree">Displaying pages from the content tree</a></p>
</li><li class=" "><p><a href="#src-68880616_usingtransformationsinmacroexpressions-retrievinganddisplayingsiteobjects">Retrieving and displaying site objects</a></p>
</li></ul>    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>This scenario is intended primarily for demonstration purposes. The recommended way to display data on standard website pages is using <a href="loading-and-displaying-data-on-websites">listing web parts or controls</a>, which provide support for transformations.</p>
        </div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Preparing the environment</span></h4>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Pages</strong> application and select the root of the website.</p>
</li><li class=" "><p>Click <strong class=" ">New</strong> (<img class="confluence-embedded-image" src="images/download/attachments/68879208/new.png" alt="images/download/attachments/68879208/new.png">
).</p>
</li><li class=" "><p>Select the <strong class=" ">Page (menu item)</strong> page type.</p>
</li><li class=" "><p>Type <i class=" ">Macros </i>as the <strong class=" ">Page name</strong> and select the <strong class=" ">Create a blank page</strong> template option.</p>
</li><li class=" "><p>Click <strong class=" ">Save</strong> to create the page.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Design </strong>tab of the new page and <a href="using-and-configuring-web-parts">add</a> an<strong class=" "> Editable text</strong> web part.</p>
</li></ol><p>You can now insert the macro expressions described below into the editable region on the page's <strong class=" ">Page</strong> tab. The system resolves the macros on the live versions of the page.</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Displaying the current user</span></h4>
<p>First you need to create the transformation:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Page types</strong> application.</p>
</li><li class=" "><p><strong class=" ">Edit</strong> (<img class="confluence-embedded-image" src="images/download/attachments/68879208/edit.png" alt="images/download/attachments/68879208/edit.png">
) the <strong class=" ">Root</strong> page type and open the<strong class=" "> Transformations</strong> tab.</p>
</li><li class=" "><p>Click <strong class=" ">New transformation</strong> and enter the following data:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Transformation name</strong>: <i class=" ">UsersInText</i></p>
</li><li class=" "><p><strong class=" ">Transformation type</strong>: <i class=" ">Text / XML</i></p>
</li><li class=" "><p><strong class=" ">Code</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;div </code><code class="keyword">class</code><code class="plain">=</code><code class="string">"member"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;a href=</code><code class="string">"{% GetMemberProfileUrl(UserName) %}"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    {% GetUserAvatarImage(UserAvatarID, UserID, FullName, </code><code class="value">52</code><code class="plain">, </code><code class="value">0</code><code class="plain">, </code><code class="value">0</code><code class="plain">) %}</code></div>
<div class="line"><code class="plain">  &lt;/a&gt;</code></div>
<div class="line"><code class="plain">&lt;div </code><code class="keyword">class</code><code class="plain">=</code><code class="string">"memberInfo"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;p&gt;</code></div>
<div class="line"><code class="plain">  &lt;h3&gt;</code></div>
<div class="line"><code class="plain">    &lt;a href=</code><code class="string">"{% GetMemberProfileUrl(UserName) %}"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      {% FullName %}</code></div>
<div class="line"><code class="plain">    &lt;/a&gt;</code></div>
<div class="line"><code class="plain">  &lt;/h3&gt;</code></div>
<div class="line"><code class="plain">&lt;/p&gt;</code></div>
<div class="line"><code class="plain">&lt;/div&gt;</code></div>
<div class="line"><code class="plain">&lt;/div&gt;</code></div>
</div>
    </div>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>Your transformation is now registered in the system. You can apply the transformation to user objects inside macro expressions:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Pages</strong> application.</p>
</li><li class=" "><p>Edit the previously created <i class=" ">Macros</i> page on the <strong class=" ">Page</strong> tab.</p>
</li><li class=" "><p>Enter the following expression into the editable region.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">{% CurrentUser.ApplyTransformation(</code><code class="string">"CMS.Root.UsersInText"</code><code class="plain">) %}</code></div>
</div>
    </div>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>The macro expression above retrieves an object containing the data of the user currently viewing the page, which is then formatted according to the specified transformation. You can view the page on the live website to see how the macro is resolved.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68880616/image2013-4-5-13_39_50.png" alt="images/download/attachments/68880616/image2013-4-5-13_39_50.png" width="286" height="316">
        <br><span class="caption">Viewing the transformed content - the current user</span>
    </p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Displaying pages from the content tree</span></h4>
<p>First you need to create the transformation.</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Page types</strong> application.</p>
</li><li class=" "><p><strong class=" ">Edit</strong> (<img class="confluence-embedded-image" src="images/download/attachments/68879208/edit.png" alt="images/download/attachments/68879208/edit.png">
) the <strong class=" ">Root</strong> page type and open the <strong class=" ">Transformations</strong> tab.</p>
</li><li class=" "><p>Click <strong class=" ">New transformation</strong> and enter the following data:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Transformation name</strong>: <i class=" ">NewsInText</i></p>
</li><li class=" "><p><strong class=" ">Transformation type</strong>: <i class=" ">Text / XML</i></p>
</li><li class=" "><p><strong class=" ">Code</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;div </code><code class="keyword">class</code><code class="plain">=</code><code class="string">"description"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;a </code><code class="keyword">class</code><code class="plain">=</code><code class="string">"header bold"</code><code class="plain"> href=</code><code class="string">"{% GetDocumentUrl() %}"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    {% NewsTitle %}</code></div>
<div class="line"><code class="plain">  &lt;/a&gt;</code></div>
<div class="line"><code class="plain">  &lt;p&gt;</code></div>
<div class="line"><code class="plain">    {% NewsSummary %}</code></div>
<div class="line"><code class="plain">    &lt;br /&gt;</code></div>
<div class="line"><code class="plain">  &lt;/p&gt;</code></div>
<div class="line"><code class="plain">&lt;/div&gt;</code></div>
</div>
    </div>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>Your transformation is now registered in the system. You can apply the transformation to collections of news pages inside macro expressions:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Pages</strong> application.</p>
</li><li class=" "><p>Edit the previously created <i class=" ">Macros</i> page on the <strong class=" ">Page</strong> tab.</p>
</li><li class=" "><p>Enter the following expression into the editable region.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">{% Documents[</code><code class="string">"/News"</code><code class="plain">].Children.WithAllData.ApplyTransformation(</code><code class="string">"CMS.Root.NewsInText"</code><code class="plain">) %}</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>In the expression above, the page under the <i class=" ">/News</i> path is selected from the <strong class=" ">Pages</strong> collection. Through its <strong class=" ">Children</strong> property, the system then accesses a collection containing all child pages. Using the <strong class=" ">WithAllData</strong> property ensures that the retrieved page objects include their coupled data, i.e. the specific fields defined for the given page type.</p>
        </div>
    </div>
<p></p>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>If you view the page on the live website, you can see how the macro is resolved.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68880616/image2013-4-5-13_48_46.png" alt="images/download/attachments/68880616/image2013-4-5-13_48_46.png" width="500">
        <br><span class="caption">Viewing the transformed content - pages from the content tree</span>
    </p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Retrieving and displaying site objects</span></h4>
<p>In this example, you first need to create three separate <i class=" ">Text / XML</i> transformations.</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Page types</strong> application.</p>
</li><li class=" "><p><strong class=" ">Edit</strong> (<img class="confluence-embedded-image" src="images/download/attachments/68879208/edit.png" alt="images/download/attachments/68879208/edit.png">
) the <strong class=" ">Root</strong> page type and open the<strong class=" "> Transformations</strong> tab.</p>
</li><li class=" "><p>Click <strong class=" ">New transformation</strong> and enter the following data:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Transformation name</strong>: <i class=" ">ProductTableHeader</i></p>
</li><li class=" "><p><strong class=" ">Transformation type</strong>: <i class=" ">Text / XML</i></p>
</li><li class=" "><p><strong class=" ">Code</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;table border=</code><code class="string">"2"</code><code class="plain"> cellpadding=</code><code class="string">"3"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;tr&gt;</code></div>
<div class="line"><code class="plain">    &lt;td width=</code><code class="string">"200"</code><code class="plain">&gt;&lt;b&gt;Product name&lt;/b&gt;&lt;/td&gt;</code></div>
<div class="line"><code class="plain">    &lt;td width=</code><code class="string">"100"</code><code class="plain">&gt;&lt;b&gt;Price&lt;/b&gt;&lt;/td&gt;</code></div>
<div class="line"><code class="plain">  &lt;/tr&gt;</code></div>
</div>
    </div>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p>Reload the page type's <strong class=" ">Transformations</strong> tab.</p>
</li><li class=" "><p>Click <strong class=" ">New transformation</strong> and enter data for the second transformation:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Transformation name</strong>: <i class=" ">ProductTableRow</i></p>
</li><li class=" "><p><strong class=" ">Transformation type</strong>: <i class=" ">Text / XML</i></p>
</li><li class=" "><p><strong class=" ">Code</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;tr&gt;</code></div>
<div class="line"><code class="plain">  &lt;td&gt;{% SKUName %}&lt;/td&gt;</code></div>
<div class="line"><code class="plain">  &lt;td&gt;{% GetSKUPrice(SKUID) %}&lt;/td&gt;</code></div>
<div class="line"><code class="plain">&lt;/tr&gt;</code></div>
</div>
    </div>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p>Reload the page type's <strong class=" ">Transformations</strong> tab again.</p>
</li><li class=" "><p>Click <strong class=" ">New transformation</strong> and enter data for the third transformation:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Transformation name</strong>: <i class=" ">ProductTableFooter</i></p>
</li><li class=" "><p><strong class=" ">Transformation type</strong>: <i class=" ">Text / XML</i></p>
</li><li class=" "><p><strong class=" ">Code</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;/table&gt;</code></div>
</div>
    </div>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>All three transformations are now registered in the system. You can apply the transformation to collections of SKU objects (products) inside macro expressions:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Pages</strong> application.</p>
</li><li class=" "><p>Edit the previously created <i class=" ">Macros</i> page on the <strong class=" ">Page</strong> tab.</p>
</li><li class=" "><p>Enter the following expression into the editable region.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">{% SiteObjects.SKUs.Where(</code><code class="string">"SKUDepartmentID = 2"</code><code class="plain">).OrderBy(</code><code class="string">"SKUName"</code><code class="plain">).ApplyTransformation (</code><code class="string">"CMS.Root.ProductTableRow"</code><code class="plain">, </code><code class="string">"CMS.Root.ProductTableHeader"</code><code class="plain">, </code><code class="string">"CMS.Root.ProductTableFooter"</code><code class="plain">) %}</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The system retrieves product objects (SKUs) from the <strong class=" ">SiteObjects</strong> collection. The <strong class=" ">Where</strong> macro method is then used to filter the collection according to a standard SQL condition specified as the parameter. In this case, only products from the Smartphones department are loaded. The <strong class=" ">OrderBy</strong> method sorts the objects according to the values in their <strong class=" ">SKUName</strong> field.</p>
<p>You can apply the <strong class=" ">Where</strong> and <strong class=" ">OrderBy</strong> methods to all types of collections, including pages.</p>
        </div>
    </div>
<p></p>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>The <strong class=" ">ApplyTransformation</strong> method is called with additional parameters to add the header and footer transformations before and after the main data items. This ensures that the transformations are combined to achieve the desired result:</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68880616/macro_transformations_product_table.png" alt="images/download/attachments/68880616/macro_transformations_product_table.png" width="355" height="208">
        <br><span class="caption">Viewing the transformed content - site objects</span>
    </p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>