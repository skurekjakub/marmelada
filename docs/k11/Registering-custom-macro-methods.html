<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Registering custom macro methods - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882638">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882638"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Macro-expressions.html">Macro expressions</a></li>
                                                                                     <li><a href="Extending-the-macro-engine.html">Extending the macro engine</a></li>
                                                            </ul>
</div>            <h1 id="src-68882638"> <span>Registering custom macro methods</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>In addition to the <a href="reference---macro-methods">default macro methods</a>, you can also create your own methods. Users can then run custom functionality by calling the methods inside macro expressions.</p><p>Use the following process to add macro methods into the system:</p><ol class=" "><li class=" "><p>Define the methods inside a container class</p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-registeringmacromethodcontainers">Register your macro method container</a> for a certain object type or macro namespace</p>
</li></ol><h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Defining macro methods</span></h3><ol class=" "><li class=" "><p>Open your project in Visual Studio.</p>
</li><li class=" "><p>Create a new class. In <i class=" ">web site</i> projects, you can either add the class into the <strong class=" ">App_Code</strong> folder or as part of a custom assembly.</p>
</li><li class=" "><p>Edit the class and add a reference to the <strong class=" ">CMS.MacroEngine</strong> namespace:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.MacroEngine;</code></div>
</div>
    </div>
</li><li class=" "><p>Make the class inherit from <strong class=" ">MacroMethodContainer</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Sample MacroMethodContainer class.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomMacroMethods : MacroMethodContainer</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Define your methods inside the container class. Macro methods must always have the following signature:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">static</code><code class="plain"> </code><code class="keyword">object</code><code class="plain"> MyMethod(EvaluationContext context, </code><code class="keyword">params</code><code class="plain"> </code><code class="keyword">object</code><code class="plain">[] parameters)</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The <strong class=" ">EvaluationContext</strong> parameter allows you to get information about the context in which the macro containing the method was resolved. For example, you can check the identity of the user in the <a href="working-with-macro-signatures">macro signature</a> (for security purposes) or the values of <a href="macro-syntax#src-68882641_macrosyntax-macroparameters">macro parameters</a>, such as the culture or case sensitivity of string comparisons.</p>
<p>The <strong class=" ">parameters</strong> array stores the method's parameters. When the system resolves the method, the values of the arguments pass into the array. You need to define individual parameters via attributes (see below).</p>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong></p>
<p>We strongly recommend that you ensure the following in the code of your methods:</p>
<ul class=" "><li class=" "><p><strong class=" ">Caching</strong> – if you load data in the method's code, use the <a href="caching-in-custom-code">Kentico caching API</a> to optimize the performance</p>
</li><li class=" "><p><strong class=" ">Security</strong> – you need to handle permissions and other security checks manually in the method's code to avoid security vulnerabilities. To build security conditions, get the <i class=" ">UserInfo</i> object representing the user who entered the macro from the <strong class=" ">User</strong> property of the method's <strong class=" ">EvaluationContext</strong> parameter.</p>
</li></ul>        </div>
    </div>
</li><li class=" "><p>Add the <strong class=" ">MacroMethod</strong> attribute above the method declaration. Specify the following parameters for the attribute:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Type</strong> – the return type of the method.</p>
</li><li class=" "><p><strong class=" ">Comment</strong> – comment displayed for the method in the macro autocomplete help.</p>
</li><li class=" "><p><strong class=" ">Minimum parameters</strong> – the minimum number of parameters that must be specified when calling the method (minimum overload).<br><br></p>
</li></ul></li><li class=" "><p>Add a <strong class=" ">MacroMethodParam</strong> attribute for each of the method's parameters. For every parameter, you must specify:<br><br></p>
<ul class=" "><li class=" "><p><strong class=" ">Index number</strong> (sets the index of the parameter in the <i class=" ">params</i> array)</p>
</li><li class=" "><p><strong class=" ">Name</strong></p>
</li><li class=" "><p><strong class=" ">Data type</strong></p>
</li><li class=" "><p><strong class=" ">Comment</strong> (appears in the macro autocomplete)</p>
</li></ul>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.MacroEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomMacroMethods : MacroMethodContainer</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	[MacroMethod(</code><code class="keyword">typeof</code><code class="plain">(</code><code class="keyword">string</code><code class="plain">), </code><code class="string">"Combines two strings, or appends a culture suffix when called with one parameter."</code><code class="plain">, 1)]</code></div>
<div class="line"><code class="plain">	[MacroMethodParam(0, </code><code class="string">"param1"</code><code class="plain">, </code><code class="keyword">typeof</code><code class="plain">(</code><code class="keyword">string</code><code class="plain">), </code><code class="string">"First part of the string."</code><code class="plain">)]</code></div>
<div class="line"><code class="plain">	[MacroMethodParam(1, </code><code class="string">"param2"</code><code class="plain">, </code><code class="keyword">typeof</code><code class="plain">(</code><code class="keyword">string</code><code class="plain">), </code><code class="string">"Second part of the string (optional)."</code><code class="plain">)]</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">public</code><code class="plain"> </code><code class="keyword">static</code><code class="plain"> </code><code class="keyword">object</code><code class="plain"> ConnectStrings(EvaluationContext context, </code><code class="keyword">params</code><code class="plain"> </code><code class="keyword">object</code><code class="plain">[] parameters)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Branches according to the number of the method's parameters</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">switch</code><code class="plain"> (parameters.Length)</code></div>
<div class="line"><code class="plain">	    {</code></div>
<div class="line"><code class="plain">			</code><code class="keyword">case</code><code class="plain"> 1:</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Overload with one parameter</code></div>
<div class="line"><code class="plain">				</code><code class="keyword">return</code><code class="plain"> ValidationHelper.GetString(parameters[0], </code><code class="string">""</code><code class="plain">) + </code><code class="string">" - Resolved in culture: "</code><code class="plain"> + context.Culture;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">			</code><code class="keyword">case</code><code class="plain"> 2:</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Overload with two parameters</code></div>
<div class="line"><code class="plain">				</code><code class="keyword">return</code><code class="plain"> ValidationHelper.GetString(parameters[0], </code><code class="string">""</code><code class="plain">) + </code><code class="string">" - "</code><code class="plain"> + ValidationHelper.GetString(parameters[1], </code><code class="string">""</code><code class="plain">);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">			</code><code class="keyword">default</code><code class="plain">:</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// No other overloads are supported</code></div>
<div class="line"><code class="plain">				</code><code class="keyword">throw</code><code class="plain"> </code><code class="keyword">new</code><code class="plain"> NotSupportedException();</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li></ol></div>

    
    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-definingmacromethods">Defining macro methods</a></p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-registeringmacromethodcontainers">Registering macro method containers</a></p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-result-callingcustommethodsinmacros">Result - Calling custom methods in macros</a></p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-macromethodcodesamples">Macro method code samples</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="reference---macro-methods">Reference - Macro methods</a></p>
</li><li class=" "><p><a href="macro-syntax">Macro syntax</a></p>
</li><li class=" "><p><a href="creating-macro-namespaces">Creating macro namespaces</a></p>
</li><li class=" "><p><a href="adding-custom-macro-fields">Adding custom macro fields</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-definingmacromethods">Defining macro methods</a></p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-registeringmacromethodcontainers">Registering macro method containers</a></p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-result-callingcustommethodsinmacros">Result - Calling custom methods in macros</a></p>
</li><li class=" "><p><a href="#src-68882638_registeringcustommacromethods-macromethodcodesamples">Macro method code samples</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="reference---macro-methods">Reference - Macro methods</a></p>
</li><li class=" "><p><a href="macro-syntax">Macro syntax</a></p>
</li><li class=" "><p><a href="creating-macro-namespaces">Creating macro namespaces</a></p>
</li><li class=" "><p><a href="adding-custom-macro-fields">Adding custom macro fields</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Registering macro method containers</span></h3>
<p>After you <a href="#src-68882638_registeringcustommacromethods-definingmacromethods">prepare your macro methods in a container class</a>, register the container by extending an object type or macro namespace.</p>
<ol class=" "><li class=" "><p>Edit the class containing your macro method container.</p>
</li><li class=" "><p>Add a <strong class=" ">RegisterExtension</strong> assembly attribute above the class declaration for each type that you wish to extend (requires a reference to the <strong class=" ">CMS</strong> namespace).</p>
</li></ol><p>Specify the type parameters for the <strong class=" ">RegisterExtension</strong> attribute in the following format:</p>
<p><strong class=" ">[assembly: RegisterExtension(typeof(<i class=" ">&lt;macro method container class&gt;</i>), typeof(<i class=" ">&lt;extended type&gt;</i>))]</strong></p>
<p>You can extend the following types:</p>
<ul class=" "><li class=" "><p>General system types (string, int, ...)</p>
</li><li class=" "><p>Kentico API object types (UserInfo, TreeNode, ...)</p>
</li><li class=" "><p><a href="creating-macro-namespaces">Macro namespaces</a> (SystemNamespace, StringNamespace, MathNamespace, ...)</p>
</li><li class=" "><p>Custom types</p>
</li></ul>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.MacroEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Makes all methods in the 'CustomMacroMethods' container class available for string objects</code></div>
<div class="line"><code class="plain">[assembly: RegisterExtension(</code><code class="keyword">typeof</code><code class="plain">(CustomMacroMethods), </code><code class="keyword">typeof</code><code class="plain">(</code><code class="keyword">string</code><code class="plain">))]</code></div>
<div class="line"><code class="comments">// Registers methods from the 'CustomMacroMethods' container into the "String" macro namespace</code></div>
<div class="line"><code class="plain">[assembly: RegisterExtension(</code><code class="keyword">typeof</code><code class="plain">(CustomMacroMethods), </code><code class="keyword">typeof</code><code class="plain">(StringNamespace))]</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomMacroMethods : MacroMethodContainer</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">...</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Important</strong>: If your macro method container class is defined within a custom assembly, the assembly project must contain the <strong class=" ">[assembly: AssemblyDiscoverable]</strong> attribute (the recommended location is in the <i class=" ">Properties/AssemblyInfo.cs</i> file). To use the attribute, your assembly's project must contain a reference to the <i class=" ">CMS.Core.dll</i> library.</p>
        </div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Result - Calling custom methods in macros</span></h3>
<p>Once you have your custom macro methods implemented and registered, you can call them in macro expressions.</p>
<p>Open any macro code editor in the administration interface. The autocomplete help offers the new methods for the extended types or namespaces.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68882638/Custom_Macro_Method_Result.png" alt="images/download/attachments/68882638/Custom_Macro_Method_Result.png" width="500">
        <br><span class="caption">Custom macro method appearing in the autocomplete of a string property</span>
    </p>
<p>For example:</p>
<ul class=" "><li class=" "><p>Append the method to a macro object of the data type that you extended (<i class=" ">string</i> in the sample code):</p>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>{% CurrentUser.UserName.ConnectStrings() %}</code></pre>
        </div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The recommended K# syntax is to use infix notation for the first parameter of methods. You can call the method in the following forms:</p>
<ul class=" "><li class=" "><p><strong class=" ">{% "String1".ConnectStrings("String2") %}</strong> - recommended and supported by the <a href="entering-macro-expressions">autocomplete help</a></p>
</li><li class=" "><p><strong class=" ">{% ConnectStrings("String1", "String2") %}</strong></p>
</li></ul>        </div>
    </div>
<p><br>OR<br><br></p>
</li><li class=" "><p>Enter the extended macro namespace, and then call the method:</p>
    <div class="confbox programlisting">
                <div class="content">
        <pre><code>{% String.ConnectStrings("First part", "Second part") %}</code></pre>
        </div>
    </div>
</li></ul>    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Macro method code samples</span></h3>
<p>The Kentico installation includes code examples of custom macro method registration, which you can add directly to your web project. To access the samples:</p>
<ol class=" "><li class=" "><p>Open your Kentico installation directory (by default <i class=" ">C:\Program Files\Kentico\&lt;version&gt;</i>).</p>
</li><li class=" "><p>Expand the <i class=" ">CodeSamples\CustomizationSamples\</i> sub-directory.</p>
</li><li class=" "><p>Copy the <strong class=" ">Macros</strong> and <strong class=" ">Modules</strong> folders into the <strong class=" ">CMS\App_Code</strong> folder of your web project.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Web application installations</strong></p>
<p>If your project was installed in the web application format, copy the folders into the <strong class=" ">Old_App_Code</strong> folder instead.</p>
<p>You must also manually include the sample class files into the project:</p>
<ol class=" "><li class=" "><p>Open your application in Visual Studio.</p>
</li><li class=" "><p>Expand the <strong class=" ">CMSApp</strong> project in the Solution Explorer.</p>
</li><li class=" "><p>Click <strong class=" ">Show all files</strong> at the top of the Solution Explorer.</p>
</li><li class=" "><p>Expand the <i class=" ">Old_App_Code</i> folder, right-click the new sub-folders and select <strong class=" ">Include in Project</strong>.</p>
</li></ol>        </div>
    </div>
</li></ol><p>You can find the macro method examples in the following classes:</p>
<ul class=" "><li class=" "><p><strong class=" ">Macros/CustomMacroMethods.cs</strong> – class containing the sample macro methods.</p>
</li><li class=" "><p><strong class=" ">Modules/SampleMacroModule.cs</strong> – initializes the custom method registration.</p>
</li></ul>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>