<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Importing products using API - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881311"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="E-commerce-features.html">E-commerce features</a></li>
                                                                                                         <li class="shortcut"><a href="Configuring-your-store.html">Configuring your store</a></li>
                                                                                                         <li class="shortcut"><a href="Configuring-products.html">Configuring products</a></li>
                                                                                     <li><a href="Importing-products.html">Importing products</a></li>
                                                            </ul>
</div>            <h1 id="src-68881311"> <span>Importing products using API</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"></div><p>You can import <a href="products">products</a> from an external source of data into Kentico using the API. As a source of data, you can use, for example, a CSV (comma-separated values) file.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: Before you start the custom import product import, back up your Kentico database.</p>
        </div>
    </div>
    <h3 id="src-68881311_ImportingproductsusingAPI-Preparingyourproductsourcedata" class="heading "><span>Preparing your product source data</span></h3>
<p>Prepare your external source of data, i.e. a CSV file. Make sure that all product properties required for import into the Kentico database are included.<br><br>In this example, the CSV file contains the following records (comma-separated):</p>
<ul class=" "><li class=" "><p><strong class=" ">Field 1 </strong>- specifies the name of the product, e.g. <i class=" ">Apple iPhone 5</i>.</p>
</li></ul><ul class=" "><li class=" "><p><strong class=" ">Field 2 </strong>- specifies the description of the product, e.g. <i class=" ">New version of iPhone</i>.</p>
</li></ul><ul class=" "><li class=" "><p><strong class=" ">Field 3 </strong>- specifies the price of the product. Use a dot (.) to separate decimal places, e.g. <i class=" ">849.99</i>.</p>
</li></ul><ul class=" "><li class=" "><p><strong class=" ">Field 4</strong> - specifies the <a href="departments">department</a> where the product will be placed after import. You need to enter the department code name, e.g. <i class=" ">EcommerceSite.Electronics</i>. If you leave the record empty or enter an invalid department code name, no department will be assigned to the product after import.</p>
</li></ul><p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/1835257/preparing_external_source_of_data.png" alt="images/download/attachments/1835257/preparing_external_source_of_data.png" width="500" height="72">
        <br><span class="caption">Preparing your external source of data</span>
    </p>
    <div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="importing-products-using-kentico-import-toolkit">Importing products using Kentico Import Toolkit</a></p>
</li></ul>        </div>
    </div>
    <h3 id="src-68881311_ImportingproductsusingAPI-Creatingtheproductimportpage" class="heading "><span>Creating the product import page</span></h3>
<p>Create the following files in your web project folder.</p>
<ul class=" "><li class=" "><p><a href="#src-68881311_importingproductsusingapi-importproducts.aspx">ImportProducts.aspx</a></p>
</li><li class=" "><p><a href="#src-68881311_importingproductsusingapi-importproducts.aspx.cs">ImportProducts.aspx.cs</a></p>
</li><li class=" "><p>products.csv</p>
</li></ul>    <h5 id="src-68881311_ImportingproductsusingAPI-ImportProducts.aspx" class="heading "><span>ImportProducts.aspx</span></h5>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;%@ Page Language=</code><code class="string">"C#"</code><code class="plain"> AutoEventWireup=</code><code class="string">"true"</code><code class="plain"> CodeFile=</code><code class="string">"ImportProducts.aspx.cs"</code><code class="plain"> Inherits=</code><code class="string">"ImportProducts"</code><code class="plain"> Theme=</code><code class="string">"Default"</code><code class="plain"> %&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">&lt;!DOCTYPE html PUBLIC </code><code class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</code><code class="plain"> </code><code class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</code><code class="plain">&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">&lt;html xmlns=</code><code class="string">"http://www.w3.org/1999/xhtml"</code><code class="plain"> &gt;</code></div>
<div class="line"><code class="plain">&lt;head id=</code><code class="string">"Head1"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;title&gt;Import&lt;/title&gt;</code></div>
<div class="line"><code class="plain">&lt;/head&gt;</code></div>
<div class="line"><code class="plain">&lt;body&gt;</code></div>
<div class="line"><code class="plain">    &lt;form id=</code><code class="string">"form1"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;div&gt;</code></div>
<div class="line"><code class="plain">        &lt;asp:Label ID=</code><code class="string">"lblInfo"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> EnableViewState=</code><code class="string">"false"</code><code class="plain"> /&gt;&lt;br /&gt;</code></div>
<div class="line"><code class="plain">        &lt;asp:Label ID=</code><code class="string">"lblError"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> EnableViewState=</code><code class="string">"false"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">    &lt;/div&gt;</code></div>
<div class="line"><code class="plain">    &lt;/form&gt;</code></div>
<div class="line"><code class="plain">&lt;/body&gt;</code></div>
<div class="line"><code class="plain">&lt;/html&gt;&nbsp;</code></div>
</div>
    </div>
    <h5 id="src-68881311_ImportingproductsusingAPI-ImportProducts.aspx.cs" class="heading "><span>ImportProducts.aspx.cs</span></h5>
<p>The following sample code allows you to import products specified in your external source of data to the <strong class=" ">Products -&gt; Electronics -&gt; Cellphones</strong> section as <strong class=" ">Cellphones</strong>.</p>
<p>Modify the code to suit your needs:</p>
<ul class=" "><li class=" "><p><a href="#src-68881311_importingproductsusingapi-changingtheimportlocation">Change the import location</a></p>
</li><li class=" "><p><a href="#src-68881311_importingproductsusingapi-changingtheproducttype">Change the product type</a></p>
</li></ul>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DocumentEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Ecommerce;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.IO;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Membership;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.SiteProvider;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">partial</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> ImportProducts : System.Web.UI.Page</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> userName = </code><code class="string">"Administrator"</code><code class="plain">; </code><code class="comments">// Page owner</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> TreeProvider tree;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> siteName = </code><code class="string">""</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> cultureCode;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">int</code><code class="plain"> siteId;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> className = </code><code class="string">"CMSProduct.CellPhone"</code><code class="plain">;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> Page_Load(</code><code class="keyword">object</code><code class="plain"> sender, EventArgs e)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Get site info</code></div>
<div class="line"><code class="plain">        siteName = SiteContext.CurrentSiteName;</code></div>
<div class="line"><code class="plain">        siteId = SiteContext.CurrentSiteID;</code></div>
<div class="line"><code class="plain">      </code></div>
<div class="line"><code class="plain">         </code><code class="comments">// Get default site culture </code></div>
<div class="line"><code class="plain">        cultureCode = CultureHelper.GetDefaultCultureCode(siteName);</code></div>
<div class="line"><code class="plain">    </code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Get user info</code></div>
<div class="line"><code class="plain">        UserInfo ui = UserInfoProvider.GetUserInfo(userName);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (ui != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            tree = </code><code class="keyword">new</code><code class="plain"> TreeProvider(ui);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">else</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            tree = </code><code class="keyword">new</code><code class="plain"> TreeProvider();</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">		</code><code class="comments">// Import products</code></div>
<div class="line"><code class="plain">        lblError.Text = Import(Server.MapPath(</code><code class="string">"products.csv"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Imports products from the specified file in *.csv format</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;param name="filePath"&gt;&lt;/param&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;returns&gt;&lt;/returns&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> Import(</code><code class="keyword">string</code><code class="plain"> filePath)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">string</code><code class="plain"> error = </code><code class="string">""</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        FileStream file = </code><code class="keyword">null</code><code class="plain">;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">try</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Specify file with product data</code></div>
<div class="line"><code class="plain">            file = FileStream.New(filePath, FileMode.Open, FileAccess.Read);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">catch</code><code class="plain"> (Exception ex)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            error = </code><code class="string">"Error loading file '"</code><code class="plain"> + filePath + </code><code class="string">"': "</code><code class="plain"> + ex.Message;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (error == </code><code class="string">""</code><code class="plain">)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Get product parent page</code></div>
<div class="line"><code class="plain">            TreeNode parentPage = GetProductParentPage();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">            </code><code class="comments">// Get default product page type</code></div>
<div class="line"><code class="plain">            DataClassInfo productPageType = GetProductPageType();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain"> ((parentPage == </code><code class="keyword">null</code><code class="plain">) || (productPageType == </code><code class="keyword">null</code><code class="plain">))</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                error = </code><code class="string">"Unable to create products, some information missing"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">else</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">var</code><code class="plain"> reader = StreamReader.New(file);</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">int</code><code class="plain"> count = 0;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">                </code><code class="comments">// Read file</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">while</code><code class="plain"> (!reader.EndOfStream)</code></div>
<div class="line"><code class="plain">                {</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">string</code><code class="plain"> line = reader.ReadLine();</code></div>
<div class="line"><code class="plain">                    </code><code class="keyword">if</code><code class="plain"> (line != </code><code class="keyword">null</code><code class="plain"> &amp;&amp; line.Trim() != </code><code class="string">""</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                    {</code></div>
<div class="line"><code class="plain">                        </code><code class="comments">// Get product data</code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">string</code><code class="plain">[] productData = line.Trim().Split(</code><code class="string">','</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                         </code></div>
<div class="line"><code class="plain">                        </code><code class="comments">// Create product (SKU)</code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">var</code><code class="plain"> sku = </code><code class="keyword">new</code><code class="plain"> SKUInfo</code></div>
<div class="line"><code class="plain">                        {</code></div>
<div class="line"><code class="plain">                            SKUName = productData[0],</code></div>
<div class="line"><code class="plain">                            SKUDescription = productData[1],</code></div>
<div class="line"><code class="plain">                            SKUPrice = ValidationHelper.GetDecimal(productData[2], 0),</code></div>
<div class="line"><code class="plain">                            SKUEnabled = </code><code class="keyword">true</code><code class="plain">,</code></div>
<div class="line"><code class="plain">                            SKUSiteID = siteId,</code></div>
<div class="line"><code class="plain">                            SKUProductType = SKUProductTypeEnum.Product</code></div>
<div class="line"><code class="plain">                        };</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">                        DepartmentInfo department = DepartmentInfoProvider.GetDepartmentInfo(productData[3], siteName);</code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">if</code><code class="plain"> (department != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                        {</code></div>
<div class="line"><code class="plain">                            </code><code class="comments">// Assign product to its department</code></div>
<div class="line"><code class="plain">                            sku.SKUDepartmentID = department.DepartmentID;</code></div>
<div class="line"><code class="plain">                        }</code></div>
<div class="line"><code class="plain">                         </code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">try</code></div>
<div class="line"><code class="plain">                        {</code></div>
<div class="line"><code class="plain">                            SKUInfoProvider.SetSKUInfo(sku);</code></div>
<div class="line"><code class="plain">                        }</code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">catch</code></div>
<div class="line"><code class="plain">                        {</code></div>
<div class="line"><code class="plain">                            error += </code><code class="string">"Unable to create product '"</code><code class="plain"> + sku.SKUName + </code><code class="string">"'. &lt;br /&gt;"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">                        </code><code class="comments">// If product was created successfully</code></div>
<div class="line"><code class="plain">                        </code><code class="keyword">if</code><code class="plain"> (sku.SKUID &gt; 0)</code></div>
<div class="line"><code class="plain">                        {</code></div>
<div class="line"><code class="plain">                            </code><code class="comments">// Create product page type and assign SKU to it</code></div>
<div class="line"><code class="plain">                            </code><code class="keyword">var</code><code class="plain"> productDoc = (SKUTreeNode)TreeNode.New(productPageType.ClassName, tree);</code></div>
<div class="line"><code class="plain">                            productDoc.DocumentSKUName = sku.SKUName;</code></div>
<div class="line"><code class="plain">                            productDoc.DocumentSKUDescription = sku.SKUDescription;</code></div>
<div class="line"><code class="plain">                            productDoc.NodeSKUID = sku.SKUID;</code></div>
<div class="line"><code class="plain">                            productDoc.DocumentCulture = cultureCode;</code></div>
<div class="line"><code class="plain">                            </code><code class="keyword">try</code></div>
<div class="line"><code class="plain">                            {</code></div>
<div class="line"><code class="plain">                                productDoc.Insert(parentPage, </code><code class="keyword">true</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                                count++;</code></div>
<div class="line"><code class="plain">                            }</code></div>
<div class="line"><code class="plain">                            </code><code class="keyword">catch</code></div>
<div class="line"><code class="plain">                            {</code></div>
<div class="line"><code class="plain">                                error += </code><code class="string">"Unable to create page '"</code><code class="plain"> + sku.SKUName + </code><code class="string">"'. &lt;br /&gt;"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                                SKUInfoProvider.DeleteSKUInfo(sku.SKUID);</code></div>
<div class="line"><code class="plain">                            }</code></div>
<div class="line"><code class="plain">                        }</code></div>
<div class="line"><code class="plain">                    }</code></div>
<div class="line"><code class="plain">                }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">                </code><code class="comments">// Close file</code></div>
<div class="line"><code class="plain">                </code><code class="keyword">if</code><code class="plain"> (file != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                {</code></div>
<div class="line"><code class="plain">                    file.Close();</code></div>
<div class="line"><code class="plain">                }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">                </code><code class="comments">// Close reader</code></div>
<div class="line"><code class="plain">                reader.Close();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">                </code><code class="comments">// Display the number of created products</code></div>
<div class="line"><code class="plain">                lblInfo.Text = </code><code class="string">"Number of created products: "</code><code class="plain"> + count;</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> error;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Ensures parent page for product pages exists.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> TreeNode GetProductParentPage()</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Try to get products' parent page</code></div>
<div class="line"><code class="plain">        TreeNode parent = tree.SelectSingleNode(siteName, </code><code class="string">"/Products/Electronics/Cellphones"</code><code class="plain">, TreeProvider.ALL_CULTURES, </code><code class="keyword">true</code><code class="plain">, </code><code class="string">"cms.menuitem"</code><code class="plain">);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Parent not found</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (parent == </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Get site root</code></div>
<div class="line"><code class="plain">            TreeNode root = tree.SelectSingleNode(siteName, </code><code class="string">"/"</code><code class="plain">, TreeProvider.ALL_CULTURES, </code><code class="keyword">true</code><code class="plain">, </code><code class="string">"cms.root"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">if</code><code class="plain"> (root != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                </code><code class="comments">// Create new parent page</code></div>
<div class="line"><code class="plain">                parent = TreeNode.New(</code><code class="string">"cms.menuitem"</code><code class="plain">, tree);</code></div>
<div class="line"><code class="plain">                parent.SetValue(</code><code class="string">"MenuItemName"</code><code class="plain">, </code><code class="string">"Custom products"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">                parent.DocumentName = </code><code class="string">"Custom products"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">                parent.DocumentCulture = cultureCode;</code></div>
<div class="line"><code class="plain">                parent.Insert(root, </code><code class="keyword">true</code><code class="plain">);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> parent;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Ensures default product page type exists.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;    </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> DataClassInfo GetProductPageType()</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        DataClassInfo defaultProductType = DataClassInfoProvider.GetDataClassInfo(className);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> defaultProductType;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <h5 id="src-68881311_ImportingproductsusingAPI-Changingtheimportlocation" class="heading "><span>Changing the import location</span></h5>
<p>If you need to change import location, customize the <i class=" ">GetProductParentPage()</i> method.</p>
<p>Specifically, you need to modify the value of the <i class=" ">parent</i> variable:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&nbsp;parent = tree.SelectSingleNode(siteName, </code><code class="string">"/Products/Electronics/Cellphones"</code><code class="plain">, TreeProvider.ALL_CULTURES, </code><code class="keyword">true</code><code class="plain">, </code><code class="string">"cms.menuitem"</code><code class="plain">);</code></div>
</div>
    </div>
<p>For example, if you want to import your products directly into the <strong class=" ">Products</strong> section, change the path to <i class=" ">"/Products"</i>.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>If you enter an invalid parent node path, the system creates a new page located in the root directory.</p>
<p>The system then adds the imported products under this parent page.</p>
        </div>
    </div>
    <h5 id="src-68881311_ImportingproductsusingAPI-Changingtheproducttype" class="heading "><span>Changing the product type</span></h5>
<p>If you need to change the product type, customize the value of the <i class=" ">className </i>variable:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">string className = </code><code class="string">"CMSProduct.CellPhone"</code><code class="plain">;</code></div>
</div>
    </div>
<p>For example, if you want to import your products as <strong class=" ">Tablets</strong>, change the value to <i class=" ">"CMSProduct.Tablet"</i>.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>To be able to perform the import, your website must have appropriate <a href="configuring-product-page-types">product types</a> defined.</p>
        </div>
    </div>
    <h3 id="src-68881311_ImportingproductsusingAPI-Runningtheproductimport" class="heading "><span>Running the product import</span></h3>
<p>Open the <i class=" ">ProductImport.aspx</i> page in your browser. The system runs the page's code and informs you about the import result.</p>
<p>If you open the <strong class=" ">Products</strong> application, you can see the imported products listed under <strong class=" ">Electronics -&gt; Cellphones</strong>.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68881311/imported_products.png" alt="images/download/attachments/68881311/imported_products.png" width="500">
        <br><span class="caption">Imported products</span>
    </p>
<p><br></p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>