<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Implementing incoming synchronization - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882910">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882910"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Integrating-3rd-party-systems.html">Integrating 3rd party systems</a></li>
                                                                                                         <li class="shortcut"><a href="Using-the-integration-bus.html">Using the integration bus</a></li>
                                                                                     <li><a href="Creating-integration-connectors.html">Creating integration connectors</a></li>
                                                            </ul>
</div>            <h1 id="src-68882910"> <span>Implementing incoming synchronization</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>To synchronize data from external applications to Kentico, you need to decide:</p><ul class=" "><li class=" "><p>which <strong class=" ">objects</strong> and <strong class=" ">pages </strong>you want to synchronize</p>
</li><li class=" "><p>which <a href="reference---integration-bus-data-types#src-68882893_referenceintegrationbusdatatypes-taskdatatypeenum">data type</a> you want to use</p>
</li></ul><p>Based on this information, choose which methods to implement in your <a href="creating-integration-connectors">connector class</a>. Proceed according to the following list:</p><ol class=" "><li class=" "><p>Call the <a href="#src-68882910_implementingincomingsynchronization-loggingincomingtasks">ProcessExternalTask </a>method to log incoming tasks into the integration task queue. Either call the method in your custom communication service or directly in the code of your external application.</p>
</li><li class=" "><p>Implement the <a href="#src-68882910_implementingincomingsynchronization-prepareinternalobjectmethod">PrepareInternalObject </a>method in your connector class. The method handles transformations of objects and pages from the external application to Kentico.</p>
</li><li class=" "><p>Implement one or both of these methods:</p>
<ul class=" "><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-getinternalobjectparamsmethod">GetInternalObjectParams&nbsp;- </a>implement this method if you plan to synchronize objects or pages which have foreign keys <strong class=" ">referencing objects</strong>.</p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-getinternaldocumentparamsmethod">GetInternalDocumentParams&nbsp;- i</a>mplement this method if you plan to synchronize objects or pages which have foreign keys <strong class=" ">referencing pages</strong>.<br><br></p>
</li></ul></li><li class=" "><p>(Optional) Call the <a href="#src-68882910_implementingincomingsynchronization-requestingtheprocessingofloggedtasks">RequestTasksProcessing </a>method to remotely trigger processing of logged incoming tasks.</p>
</li></ol></div>

    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-loggingincomingtasks">Logging incoming tasks</a></p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-implementingtheincomingsynchronization">Implementing the incoming synchronization</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-prepareinternalobjectmethod">PrepareInternalObject method</a></p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-getinternalobjectparamsmethod">GetInternalObjectParams method</a></p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-getinternaldocumentparamsmethod">GetInternalDocumentParams method</a></p>
</li></ul></li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-requestingtheprocessingofloggedtasks">Requesting the processing of logged tasks</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="integration-bus-overview#src-68882894_integrationbusoverview-incomingtasks-fromexternalapplicationstokenticocms">Integration bus overview - Incoming tasks</a></p>
</li><li class=" "><p><a href="reference---integration-bus-data-types">Reference - Integration bus data types</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-loggingincomingtasks">Logging incoming tasks</a></p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-implementingtheincomingsynchronization">Implementing the incoming synchronization</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-prepareinternalobjectmethod">PrepareInternalObject method</a></p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-getinternalobjectparamsmethod">GetInternalObjectParams method</a></p>
</li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-getinternaldocumentparamsmethod">GetInternalDocumentParams method</a></p>
</li></ul></li><li class=" "><p><a href="#src-68882910_implementingincomingsynchronization-requestingtheprocessingofloggedtasks">Requesting the processing of logged tasks</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="integration-bus-overview#src-68882894_integrationbusoverview-incomingtasks-fromexternalapplicationstokenticocms">Integration bus overview - Incoming tasks</a></p>
</li><li class=" "><p><a href="reference---integration-bus-data-types">Reference - Integration bus data types</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Logging incoming tasks</span></h3>
<p>The <strong class=" ">ProcessExternalTask</strong> method logs object or page tasks into the integration task queue. The system then takes the tasks out of the queue and processes them later. The method is available in the <i class=" ">IntegrationHelper</i> class.</p>
<p>The location where you need to call the method depends on the approach that you use to communicate between Kentico and the external application:</p>
<ul class=" "><li class=" "><p><strong class=" ">Kentico API</strong> – if your external application has references to your connector class and the Kentico DLLs (i.e. has the <i class=" ">Kentico.Libraries</i> NuGet package installed), call the <i class=" ">ProcessExternalTask</i> method directly in your application's code.</p>
</li><li class=" "><p><strong class=" ">Custom service</strong> – if you use a custom service (Web API, WCF, etc.) to communicate, call the <i class=" ">ProcessExternalTask</i> method from the code of the service in the Kentico application.</p>
</li></ul>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Synchronization;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">object</code><code class="plain"> externalObject;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">IntegrationHelper.ProcessExternalTask(</code><code class="string">"CustomConnector"</code><code class="plain">, externalObject, IntegrationProcessTypeEnum.Default, TaskTypeEnum.CreateObject, TaskDataTypeEnum.Simple, </code><code class="string">"SiteCodeName"</code><code class="plain">);</code></div>
</div>
    </div>
<p>The method has the following parameters:</p>
<ul class=" "><li class=" "><p><strong class=" ">connectorName</strong> – the code name of the connector which should process the tasks.</p>
</li><li class=" "><p><strong class=" ">obj</strong> – the external object which should be processed. If you have managed to prepare <i class=" ">ICMSObject</i> earlier, you can pass it as well.</p>
</li><li class=" "><p><strong class=" ">result</strong> – this value indicates how the system behaves when fetching the tasks from the database and how it reacts when an error occurs.</p>
</li><li class=" "><p><strong class=" ">taskType</strong> – by providing this value, you say whether the provided object or page should be created, updated, deleted, etc.</p>
</li><li class=" "><p><strong class=" ">dataType</strong> – indicates, whether the provided object contains child objects. The value also indicates whether the methods for collecting translation information will be called.</p>
</li><li class=" "><p><strong class=" ">siteName</strong> – if the processed object belongs to a site, provide a code name of this site.</p>
</li></ul><p>You can find detailed descriptions of particular enumerations used in the parameters in <a href="reference---integration-bus-data-types#src-68882893_referenceintegrationbusdatatypes-enumerations">Enumerations</a>.</p>
<p>Use a reference to the <strong class=" ">CMS.Synchronization</strong> namespace and call this method anywhere in the code of your external application.</p>
<p><img class="confluence-embedded-image" src="images/download/attachments/68882910/image2013-9-10-16_52_40.png" alt="images/download/attachments/68882910/image2013-9-10-16_52_40.png">
        <br><span class="caption">The sequence of method calls for each incoming synchronization</span>
    </p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Implementing the incoming synchronization</span></h3>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>PrepareInternalObject method</span></h4>
<p>Implement the <i class=" ">PrepareInternalObject</i> method in your connector class. This method transforms objects from the external application into the corresponding objects or pages in Kentico. The method must return a valid <i class=" ">TreeNode</i> page or object inheriting from <i class=" ">BaseInfo</i> (UserInfo, RoleInfo, ForumPostInfo etc.).</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> ICMSObject PrepareInternalObject(</code><code class="keyword">object</code><code class="plain"> obj, TaskTypeEnum taskType, TaskDataTypeEnum dataType, </code><code class="keyword">string</code><code class="plain"> siteName)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    ...</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">return</code><code class="plain"> UserInfo;</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p></p>
<p><img class="confluence-embedded-image" src="images/download/attachments/68882910/image2013-9-10-17_0_13.png" alt="images/download/attachments/68882910/image2013-9-10-17_0_13.png">
        <br><span class="caption">Calling of the PrepareInternalObject method</span>
    </p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>GetInternalObjectParams method</span></h4>
<p>Implement the <i class=" ">GetInternalObjectParams </i>method if you need to synchronize objects that have foreign key bindings with other objects in Kentico. Based on the <i class=" ">id</i> and <i class=" ">objectType</i> parameters, you should be able to find the corresponding object in the external application, and then set the method's <i class=" ">out</i> parameters. At the very least you need to supply the object's code name (<i class=" ">codeName</i> parameter). The <i class=" ">siteName</i>, <i class=" ">parentId</i> and <i class=" ">groupId</i> parameters allow you to specify the object with more precision. The system then finds the related object in the Kentico database according to the <i class=" ">out</i> parameters, and translates the foreign key values.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> GetInternalObjectParams(</code><code class="keyword">int</code><code class="plain"> id, </code><code class="keyword">string</code><code class="plain"> objectType, </code><code class="keyword">out</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> codeName, </code><code class="keyword">out</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> siteName, </code><code class="keyword">ref</code><code class="plain"> </code><code class="keyword">int</code><code class="plain"> parentId, </code><code class="keyword">ref</code><code class="plain"> </code><code class="keyword">int</code><code class="plain"> groupId)</code></div>
</div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>GetInternalDocumentParams method</span></h4>
<p>Implement the <i class=" ">GetInternalDocumentParams</i> method if you need to synchronize objects that have foreign key bindings to pages in Kentico. Based on the <i class=" ">id</i> and <i class=" ">className</i> parameters, you should be able to find the corresponding page in the external application, and then specify the page's <i class=" ">nodeGuid</i>, <i class=" ">cultureCode</i> and <i class=" ">siteName</i> through the method's <i class=" ">out</i> parameters. All of the parameters are mandatory. The system then finds the related page in the Kentico database, and translates the foreign key values.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> GetInternalDocumentParams(</code><code class="keyword">int</code><code class="plain"> id, </code><code class="keyword">string</code><code class="plain"> className, </code><code class="keyword">out</code><code class="plain"> Guid nodeGuid, </code><code class="keyword">out</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> cultureCode, </code><code class="keyword">out</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> siteName)</code></div>
</div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Requesting the processing of logged tasks</span></h3>
<p>The<i class=" "> BaseIntegrationConnector</i> offers two overloads of the <i class=" ">RequestTasksProcessing</i> method:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">HttpStatusCode RequestTasksProcessing(</code><code class="keyword">string</code><code class="plain"> serverUrl)</code></div>
<div class="line"><code class="plain">HttpStatusCode RequestTasksProcessing(</code><code class="keyword">string</code><code class="plain"> serverUrl, </code><code class="keyword">string</code><code class="plain"> connectorName)</code></div>
</div>
    </div>
<p>Call this method in your connector class. When this method is called, the application makes a HTTP request to the <i class=" ">~/CMSPages/IntegrationNotify.aspx</i> page, which starts the processing of incoming tasks logged in the Kentico project. Each connector will be processed in its own thread.</p>
<p>As a parameter of this method, specify a URL leading to the root of the Kentico application (e.g. <i class=" ">http://www.example.com/Kentico</i>). The second overload allows you to also specify the connector whose tasks will be processed. If you do not supply the parameter, all connectors will be processed.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>