<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Working with pages in the API - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882165"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                     <li><a href="Custom-development.html">Custom development</a></li>
                                                            </ul>
</div>            <h1 id="src-68882165"> <span>Working with pages in the API</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<p   
>The Kentico API allows you to retrieve and manage page content using custom code.</p>
<p   
>Use the following classes from the <strong class=" ">CMS.DocumentEngine</strong> namespace to work with pages in the API:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">TreeNode</strong> &ndash; object that represents pages. The <i class=" ">TreeNode</i> class encapsulates data from the <i class=" ">CMS_Tree</i> and <i class=" ">CMS_Document</i>   <a   href="Page-database-structure">tables</a>, and the coupled data tables of individual page types.</p>
</li><li class=" "><p   
><strong class=" ">DocumentQuery</strong> and <strong class=" ">MultiDocumentQuery</strong> &ndash; classes that represent a query for loading pages. You can further parametrize the query to only retrieve the pages you need. Both are similar in functionality:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">DocumentQuery</strong> allows you to retrieve pages of a single   <a   href="Page-types">page type</a> (when an instance is created with a page type class name as the constructor parameter) or general pages of any type (when using a parameterless constructor). If used for a single specific page type, the resulting query automatically includes coupled data of the given page type (e.g., news, articles, blogs). <i class=" ">DocumentQuery</i> is also used internally by   <a   href="Generating-classes-for-Kentico-objects">generated page type providers</a> and any custom providers or repositories built around them.</p>
</li><li class=" "><p   
><strong class=" ">MultiDocumentQuery</strong> allows you to retrieve pages of multiple page types in a single query at the cost of effectiveness. The coupled data of page types is not retrieved unless explicitly requested using the <i class=" ">WithCoupledData</i>   <a   href="Reference---DocumentQuery-methods">parametrization method</a>.</p>
</li></ul></li><li class=" "><p   
><strong class=" ">DocumentHelper</strong> &ndash; provides static methods for retrieving and managing the latest edited versions of pages. Internally, the <i class=" ">DocumentHelper</i> class utilizes <i class=" ">DocumentQuery</i> or <i class=" ">MultiDocumentQuery</i> to retrieve pages and then further adjusts the query, for example by applying the <i class=" ">CombineWithDefaultCulture</i> parametrization method based on the value of the <i class=" ">Combine with default culture</i> setting.</p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Page query parametrization methods</strong></p>
<p   
>For detailed information about the options that allow you to parameterize page queries, see the dedicated reference:   <a   href="Reference---DocumentQuery-methods">Reference - DocumentQuery methods</a></p>
        </div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Loading other objects</strong></p>
<p   
>To learn how to retrieve other types of non-page data from the Kentico database, see   <a   href="Retrieving-database-data-using-ObjectQuery-API">Retrieving database data using ObjectQuery API</a>.</p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
>  <a   href="#src-68882165_WorkingwithpagesintheAPI-Retrievingpages">Retrieving pages</a></p>
<ul class="toc-indentation "><li class=" "><p   
>  <a   href="#src-68882165_WorkingwithpagesintheAPI-Retrievingpagesunderworkflow">Retrieving pages under workflow</a></p>
</li><li class=" "><p   
>  <a   href="#src-68882165_WorkingwithpagesintheAPI-Retrievingpagesforcustomscenarios">Retrieving pages for custom scenarios</a></p>
</li></ul></li><li class=" "><p   
>  <a   href="#src-68882165_WorkingwithpagesintheAPI-Workingwithretrievedpages">Working with retrieved pages</a></p>
</li><li class=" "><p   
>  <a   href="#src-68882165_WorkingwithpagesintheAPI-Updatingpages">Updating pages</a></p>
</li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
>  <a   href="Working-with-pages">Working with pages</a></p>
</li><li class=" "><p   
>  <a   href="Page-types">Page types</a></p>
</li><li class=" "><p   
>  <a   href="Generating-classes-for-Kentico-objects">Generating classes for Kentico objects</a></p>
</li><li class=" "><p   
>  <a   href="Reference---DocumentQuery-methods">Reference - DocumentQuery methods</a></p>
</li><li class=" "><p   
>  <a   href="Retrieving-database-data-using-ObjectQuery-API">Retrieving database data using ObjectQuery API</a></p>
</li></ul>        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related blogs</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a  class="external-link" href="http://devnet.kentico.com/articles/kentico-8-technology-documentquery-api">Kentico 8 Technology &ndash; DocumentQuery API</a></p>
</li></ul>        </div>
    </div>
    <h3 id="src-68882165_WorkingwithpagesintheAPI-Retrievingpages" class="heading "><span>Retrieving pages</span></h3>
<p   
>For basic retrieval of pages in your code, use the <strong class=" ">DocumentHelper.GetDocuments</strong> method and parameterize it using   <a   href="Reference---DocumentQuery-methods">parametrization methods</a> to only include the pages you need. If you have   <a   href="Generating-classes-for-Kentico-objects">generated page type providers</a> available, you can use them with the same parametrization methods, and then work with strongly typed page objects.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Retrieves the published English version of articles that are in the '/Articles/May' section of the 'MySite' site's content tree</code></div>
<div class="line"><code class="comments">// Only loads pages that are currently published on the live site according to the value of their Published from/to setting</code></div>
<div class="line"><code class="keyword">var</code><code class="plain"> pages = DocumentHelper.GetDocuments(</code><code class="string">"MySite.Articles"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">					.OnSite(</code><code class="string">"MySite"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">					.Culture(</code><code class="string">"en-us"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">					.Path(</code><code class="string">"/Articles/May"</code><code class="plain">, PathTypeEnum.Children)</code></div>
<div class="line"><code class="plain">					.PublishedVersion()</code></div>
<div class="line"><code class="plain">					.Published();</code></div>
</div>
    </div>
    <h4 id="src-68882165_WorkingwithpagesintheAPI-Retrievingpagesunderworkflow" class="heading "><span>Retrieving pages under workflow</span></h4>
<p   
>When working with pages under   <a   href="Configuring-workflows">workflow</a>, you may want to retrieve the latest edited version in some cases and the published version in others.</p>
<ul class=" "><li class=" "><p   
>Use the <strong class=" ">PublishedVersion</strong>   <a   href="Reference---DocumentQuery-methods">parametrization method</a> to retrieve the published version of pages under workflow (when retrieving pages to be displayed on the live site).</p>
</li><li class=" "><p   
>Use the <strong class=" ">LatestVersion</strong>   <a   href="Reference---DocumentQuery-methods">method</a> to retrieve the latest edited version of pages under workflow (when retrieving pages for further editing or previewing of unpublished changes).</p>
</li></ul>    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Note</strong>: The <strong class=" ">Published</strong>   <a   href="Reference---DocumentQuery-methods">parametrization method</a> does not specify the version of the pages you retrieve, instead it limits the retrieved pages to only those that are currently published according to the value of their <strong class=" ">Published from</strong> / <strong class=" ">Published to</strong> settings and have a published version.</p>
        </div>
    </div>
    <h4 id="src-68882165_WorkingwithpagesintheAPI-Retrievingpagesforcustomscenarios" class="heading "><span>Retrieving pages for custom scenarios</span></h4>
<p   
><strong class=" ">DocumentHelper</strong> automatically performs some parameterization of the query to simplify the code for the most common scenarios. However, if you require full control over the query, you can directly use the <strong class=" ">DocumentQuery</strong> or <strong class=" ">MultiDocumentQuery</strong> classes to ensure that there is not any unexpected parametrization done in the background.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Retrieves all pages that match the query</code></div>
<div class="line"><code class="keyword">var</code><code class="plain"> pages = </code><code class="keyword">new</code><code class="plain"> MultiDocumentQuery()</code></div>
<div class="line"><code class="plain">                    .OnCurrentSite()</code></div>
<div class="line"><code class="plain">                    .Path(</code><code class="string">"/Articles/Reviews"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                    .Culture(</code><code class="string">"en-us"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                    .PublishedVersion()</code></div>
<div class="line"><code class="plain">                    .WithCoupledColumns();</code></div>
</div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Retrieves pages of the specified page type that match the query</code></div>
<div class="line"><code class="keyword">var</code><code class="plain"> pages = </code><code class="keyword">new</code><code class="plain"> DocumentQuery(</code><code class="string">"Custom.Smartphone"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                    .OnCurrentSite()</code></div>
<div class="line"><code class="plain">                    .Path(</code><code class="string">"/Products"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                    .Culture(</code><code class="string">"en-us"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                    .PublishedVersion();</code></div>
</div>
    </div>
    <h3 id="src-68882165_WorkingwithpagesintheAPI-Workingwithretrievedpages" class="heading "><span>Working with retrieved pages</span></h3>
<p   
>You can iterate through the retrieved collection to access the properties of individual pages. The available columns depend on how you parametrized the query when retrieving the pages.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Retrieves smartphone pages</code></div>
<div class="line"><code class="plain">DocumentQuery smartphones = DocumentHelper.GetDocuments(</code><code class="string">"CMS.Smartphone"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">                                .Path(</code><code class="string">"/Products/"</code><code class="plain">, PathTypeEnum.Children)</code></div>
<div class="line"><code class="plain">                                .OnSite(</code><code class="string">"CorporateSite"</code><code class="plain">);</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="comments">// Writes the 'DocumentName' and 'SmartphoneOS' values of each of the retrieved smartphones into an HTTP output response stream</code></div>
<div class="line"><code class="keyword">foreach</code><code class="plain"> (TreeNode smartphone </code><code class="keyword">in</code><code class="plain"> smartphones)</code></div>
<div class="line"><code class="plain">{      </code></div>
<div class="line"><code class="plain">    </code><code class="keyword">string</code><code class="plain"> smartphoneOS = smartphone.GetValue&lt;</code><code class="keyword">string</code><code class="plain">&gt;(</code><code class="string">"SmartphoneOS"</code><code class="plain">, </code><code class="string">"Default OS"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    Response.Write(HTMLHelper.HTMLEncode(smartphone.DocumentName) + </code><code class="string">" - "</code><code class="plain"> + HTMLHelper.HTMLEncode(smartphoneOS) + </code><code class="string">"&lt;br /&gt;"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <h3 id="src-68882165_WorkingwithpagesintheAPI-Updatingpages" class="heading "><span>Updating pages</span></h3>
<p   
>To update a page (<i class=" ">TreeNode</i> object):</p>
<ol class=" "><li class=" "><p   
>Retrieve the latest edited version of a page using the methods described above.</p>
</li><li class=" "><p   
>Modify the page&#39;s data:</p>
<ul class=" "><li class=" "><p   
>For general page fields, directly set the corresponding <i class=" ">TreeNode</i> properties.</p>
</li><li class=" "><p   
>For the fields of specific page types, call the <i class=" ">TreeNode.SetValue(&quot;FieldName&quot;, value)</i> method.</p>
</li></ul></li><li class=" "><p   
>Call the <strong class=" ">TreeNode.Update()</strong> method.</p>
</li></ol>    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Updating pages under workflow</strong></p>
<p   
>When using the API to update pages under   <a   href="Configuring-workflows">workflow</a> or   <a   href="Configuring-and-using-page-versioning">versioning</a>, always retrieve the page objects with all fields. Otherwise, the update may cause data loss. Use one of the following approaches:</p>
<ul class=" "><li class=" "><p   
>Call the <i class=" ">DocumentHelper.GetDocuments(string className)</i> method with a <i class=" ">className</i> parameter for a specific page type.</p>
</li><li class=" "><p   
>Use the <strong class=" ">Types</strong> query method to identify the page types and then apply the <strong class=" ">WithCoupledColumns</strong> method.</p>
</li></ul>        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
