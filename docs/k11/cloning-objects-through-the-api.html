<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Cloning objects through the API - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882147">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882147"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom-development.html">Custom development</a></li>
                                                                                     <li><a href="Miscellaneous-custom-development-tasks.html">Miscellaneous custom development tasks</a></li>
                                                            </ul>
</div>            <h1 id="src-68882147"> <span>Cloning objects through the API</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-section"><div class="sp-grid-cell sp-grid-60"></div></div><p>Cloning allows you to create exact copies of objects in the system. All objects support cloning, from the most basic records to complex data structures such as <a href="page-types">page types</a> or <a href="managing-users">user accounts</a>.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Manually cloning objects</strong></p>
<p>To clone an object in the Kentico administration interface:</p>
<ol class=" "><li class=" "><p>Find the object on the listing page in the appropriate section of the UI.</p>
</li><li class=" "><p>Click <strong class=" ">...</strong> next to the object and select <strong class=" ">Clone</strong>.</p>
<ul class=" "><li class=" "><p>For objects displayed in a tree menu instead of a standard list, use the clone button (<img class="confluence-embedded-image" src="images/download/attachments/68879208/clone.png" alt="images/download/attachments/68879208/clone.png">
) in the panel above the tree.</p>
</li></ul></li><li class=" "><p>Configure the clone settings and click <strong class=" ">Clone</strong>.</p>
</li></ol>        </div>
    </div>
<p>You can clone object by calling the appropriate API in your custom code, for example in:</p>
<ul class=" "><li class=" "><p><a href="handling-global-events">Global event handlers</a></p>
</li><li class=" "><p>User controls or <a href="developing-web-parts">web parts</a></p>
</li></ul><p>The following sample code demonstrates how to clone objects using the API. The <strong class=" ">CloneCountry</strong> method in the example:</p>
<ul class=" "><li class=" "><p>Creates a clone of the USA country object, including all child states.</p>
</li><li class=" "><p>Manually sets the country code values of the new object.</p>
</li></ul>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Globalization;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> CloneCountry()</code></div>
<div class="line"><code class="plain">{        </code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Gets the country to be cloned.</code></div>
<div class="line"><code class="plain">    CountryInfo country = CountryInfoProvider.GetCountryInfo(</code><code class="string">"USA"</code><code class="plain">);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (country != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Prepares the settings used for the cloning process.</code></div>
<div class="line"><code class="plain">        CloneSettings settings = </code><code class="keyword">new</code><code class="plain"> CloneSettings()</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Sets the clone names.</code></div>
<div class="line"><code class="plain">            CodeName = </code><code class="string">"MyClonedCountry"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">            DisplayName = </code><code class="string">"My Cloned Country"</code><code class="plain">,</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">            </code><code class="comments">// Ensures that the state objects under the country are also cloned.</code></div>
<div class="line"><code class="plain">            IncludeChildren = </code><code class="keyword">true</code><code class="plain">,</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">            </code><code class="comments">// Registers a callback method that performs additional actions before the clone is added.</code></div>
<div class="line"><code class="plain">            BeforeCloneInsertCallback = ChangeCountryCodes</code></div>
<div class="line"><code class="plain">        };</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Clones the country according to the defined settings.</code></div>
<div class="line"><code class="plain">        country.Generalized.InsertAsClone(settings);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> ChangeCountryCodes(CloneSettings settings, BaseInfo cloneToBeInserted)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">// Changes the values of additional fields before the clone is inserted to the DB.</code></div>
<div class="line"><code class="plain">    CountryInfo country = cloneToBeInserted </code><code class="keyword">as</code><code class="plain"> CountryInfo;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="keyword">if</code><code class="plain"> (country != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        country.CountryThreeLetterCode = </code><code class="string">"MCC"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">        country.CountryTwoLetterCode = </code><code class="string">"MC"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p>To clone an object, you need to:</p>
<ol class=" "><li class=" "><p>Prepare an instance of the <strong class=" ">CloneSettings</strong> class (requires a reference to the <strong class=" ">CMS.DataEngine</strong> namespace).</p>
</li><li class=" "><p>Configure the cloning process by assigning values to the properties of the CloneSettings object.</p>
</li><li class=" "><p>Call the <strong class=" ">InsertAsClone</strong> method for the original object (converted to a generalized object type), with the prepared <i class=" ">CloneSettings</i> specified through the parameter.</p>
</li></ol>    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">CloneSettings properties</strong></p>
<p>In addition to setting the code name and display name of the cloned object, the properties of the <strong class=" ">CloneSettings</strong> class determine what operations the system performs during the cloning process. In the example, the <strong class=" ">IncludeChildren</strong> flag is set to true, so the code also clones all state objects under the given country and assigns them to the new country.</p>
<p>The <strong class=" ">BeforeCloneInsertCallback</strong> property registers a custom handler method that the system executes just before the clone is inserted into the database. Such methods allow you to implement any functionality required to correctly clone the object. The object that is being cloned and the corresponding <i class=" ">CloneSettings</i> object are passed as parameters, so you can dynamically set the values based on the currently assigned clone settings.</p>
<p>Other possible callback options are:</p>
<ul class=" "><li class=" "><p><strong class=" ">AfterCloneInsertCallback</strong> - executed after the cloned object itself is created and inserted, but before the system starts cloning any associated child objects or bindings.</p>
</li><li class=" "><p><strong class=" ">AfterCloneStructureInsertCallback</strong> - called once all objects included in the cloning process are created.</p>
</li></ul>        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>