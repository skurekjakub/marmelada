<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Securing media libraries - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68879374">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68879374"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Managing-website-content.html">Managing website content</a></li>
                                                                                                         <li class="shortcut"><a href="Configuring-the-environment-for-content-editors.html">Configuring the environment for content editors</a></li>
                                                                                                         <li class="shortcut"><a href="Configuring-media-libraries.html">Configuring media libraries</a></li>
                                                                                     <li><a href="Media-libraries-security.html">Media libraries security</a></li>
                                                            </ul>
</div>            <h1 id="src-68879374"> <span>Securing media libraries</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"></div><p>Media libraries on your site can be secured or unsecured. To ensure the required functionality, several settings need to be done as described below.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>By default, files in media libraries are NOT secured and can be accessed directly by anybody who knows the exact link to the file. If you want to prevent this behavior, secure your media library as described in this topic.</p>
        </div>
    </div>
    <div class="section section-1" id="src-68879374_Securingmedialibraries-Settingupasecuredmedialibrary">
        <h1 class="heading "><span>Setting up a secured media library</span></h1>
<p>Secured media libraries allow viewing of their content to members of authorized roles or to authenticated users only. Keep in mind that secured media libraries are slower than the unsecured ones as permission checking involves processing overhead.</p>
    <div class="section section-2" id="src-68879374_Securingmedialibraries-IISsettings">
        <h2 class="heading "><span>IIS settings</span></h2>
<p>You have to <strong class=" ">set up your IIS</strong> so that files can't be downloaded directly from the library by typing the link to the file like <i class=" ">&lt;site url&gt;/media/file.jpg</i> into the browser.</p>
<ol class=" "><li class=" "><p>To open IIS, navigate to <strong class=" ">Start</strong> -&gt; <strong class=" ">Control Panel</strong> -&gt; <strong class=" ">Administrative Tools</strong> and start the <strong class=" ">Internet Information Services (IIS) Manager</strong>.<br><br></p>
<img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/1310858/opening_iis.png" alt="images/download/attachments/1310858/opening_iis.png" width="286" height="232">
        <br><span class="caption">Opening IIS</span>
    <p><br></p>
</li><li class=" "><p>In the connections pane, select the application for which you want to change the settings.</p>
</li><li class=" "><p>Navigate to the folder of your application for which you want to want to change the settings. You can find individual media library folder under <i class=" ">&lt;site name&gt;/media</i>.</p>
</li><li class=" "><p>In the Features View, double-click on <strong class=" ">Authentication</strong>.<br><br></p>
<img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68879374/configuring_iis_authentication.png" alt="images/download/attachments/68879374/configuring_iis_authentication.png" width="371" height="250">
    <p><br></p>
</li><li class=" "><p>Select <strong class=" ">Anonymous Authentication</strong>.</p>
</li><li class=" "><p>In the <strong class=" ">Actions list</strong>, click on <strong class=" ">Disable</strong>.<br><br></p>
<img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/1310858/enaabling_anonymous_auth.png" alt="images/download/attachments/1310858/enaabling_anonymous_auth.png" width="500" height="172">
        <br><span class="caption">Disabling IIS anonymous authentication</span>
    <p><br></p>
</li><li class=" "><p>(Optional) If <strong class=" ">Windows Authentication</strong> is enabled as well, disable it.</p>
</li></ol>    </div>
    <div class="section section-2" id="src-68879374_Securingmedialibraries-Medialibrarysecuritysettings">
        <h2 class="heading "><span>Media library security settings</span></h2>
<p>Once you changed the settings in IIS, you need to make changes in Kentico as well.</p>
    <div class="section section-3" id="src-68879374_Securingmedialibraries-Changingsecuritysettingsforaparticularmedialibrary">
        <h3 class="heading "><span>Changing security settings for a particular media library</span></h3>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Media libraries </strong>application.</p>
</li><li class=" "><p><strong class=" ">Edit</strong> (<img class="confluence-embedded-image" src="images/download/attachments/41484305/edit.png" alt="images/download/attachments/41484305/edit.png">
) the Media library for which you want to set the permissions.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Security</strong> tab.</p>
</li><li class=" "><p>Assign the <strong class=" ">See library content</strong> permission to <strong class=" ">Authenticated users</strong> or to <strong class=" ">Authorized roles</strong>.</p>
</li><li class=" "><p>(Optional) If you assigned the permission to <strong class=" ">Authorized roles</strong>, turn the <strong class=" ">See library content</strong> check-box on for the roles which you want to allow to see the library content.<br></p>
</li></ol><p>By default, Kentico doesn't check for the <strong class=" ">See library content</strong> permission. To make the system check for the permission, you need to turn on the <strong class=" ">Check file permissions</strong> option as described below.</p>
    </div>
    <div class="section section-3" id="src-68879374_Securingmedialibraries-Changingcheckfilepermissionssettings">
        <h3 class="heading "><span>Changing check file permissions settings</span></h3>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Settings </strong>application.</p>
</li><li class=" "><p>Switch to <strong class=" ">Content -&gt; Media</strong>.</p>
</li><li class=" "><p>In the <strong class=" ">Security</strong> settings group, select <strong class=" ">Check file permissions</strong>.</p>
</li><li class=" "><p><strong class=" ">Save </strong>the changes.</p>
</li></ol>    </div>
    </div>
    <div class="section section-2" id="src-68879374_Securingmedialibraries-Mediagallerywebpartsettings">
        <h2 class="heading "><span>Media gallery web part settings</span></h2>
<ol class=" "><li class=" "><p>In the <strong class=" ">Pages </strong>application, navigate to the page on which you use the <a href="displaying-media-library-content-on-the-live-site">Media gallery web part</a>.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Design</strong> tab.</p>
</li><li class=" "><p><strong class=" ">Configure</strong> the web part.</p>
</li><li class=" "><p>In the <strong class=" ">Content</strong> category, enable the <strong class=" ">Use secure links</strong> property.</p>
</li><li class=" "><p>Click <strong class=" ">Save &amp; Close</strong>.</p>
</li></ol>    <div class="section section-3" id="src-68879374_Securingmedialibraries-WritingtransformationsfortheMediagallerywebpart">
        <h3 class="heading "><span>Writing transformations for the Media gallery web part</span></h3>
<p>When writing your transformations for the <strong class=" ">Media gallery</strong> web part:</p>
<ul class=" "><li class=" "><p>Obtain <strong class=" ">File previews</strong> and <strong class=" ">file details</strong> using the following control:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&nbsp;&lt;cc1:MediaFilePreview ID=</code><code class="string">"filePreview"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> maxsidesize=</code><code class="string">"117"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
<p><br></p>
</li><li class=" "><p>Obtain <strong class=" ">Download links</strong> using the following method:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&nbsp;&lt;%# MediaLibraryFunctions.GetMediaFileUrl(Eval(</code><code class="string">"FileLibraryID"</code><code class="plain">) ,Eval(</code><code class="string">"FilePath"</code><code class="plain">), Eval(</code><code class="string">"FileGUID"</code><code class="plain">), Eval(</code><code class="string">"FileName"</code><code class="plain">), GetDataControlValue&lt;bool&gt;(</code><code class="string">"UseSecureLinks"</code><code class="plain">)) %&gt;</code></div>
</div>
    </div>
</li></ul><p>You can see an example of a use of this web part, including the defined transformations, on the <strong class=" ">Community Site</strong> sample website, in the <strong class=" ">Media</strong> section.</p>
<p>Using the settings above, you can ensure that only members of authorized roles or authenticated users are allowed to view media library content.</p>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-68879374_Securingmedialibraries-Settingupaunsecuredmedialibrary">
        <h1 class="heading "><span>Setting up a unsecured media library</span></h1>
<p>Secured media libraries allow viewing of their content to members of authorized roles or to authenticated users only. Keep in mind that secured media libraries are slower than the non-secured ones as permission checking involves processing overhead.</p>
    <div class="section section-2" id="src-68879374_Securingmedialibraries-IISsettings.1">
        <h2 class="heading "><span>IIS settings</span></h2>
<p>You have to <strong class=" ">set up your IIS</strong> so that files can be downloaded directly from the library by typing the link to the file like <i class=" ">&lt;site url&gt;/media/file.jpg</i> into the browser.</p>
<ol class=" "><li class=" "><p>To open IIS, navigate to <strong class=" ">Start</strong> -&gt; <strong class=" ">Control Panel</strong> -&gt; <strong class=" ">Administrative Tools</strong> and start the <strong class=" ">Internet Information Services (IIS) Manager</strong>.<br><br></p>
<img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/1310858/opening_iis.png" alt="images/download/attachments/1310858/opening_iis.png" width="286" height="232">
        <br><span class="caption">Opening IIS</span>
    <p><br></p>
</li><li class=" "><p>In the connections pane, select the application for which you want to change the settings.</p>
</li><li class=" "><p>Navigate to the folder of your application for which you want to want to change the settings. You can find individual media library folder under <i class=" ">&lt;site name&gt;/media</i>.<br></p>
</li><li class=" "><p>In the Features View, double-click on <strong class=" ">Authentication</strong>.<br><br></p>
<img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68879374/configuring_iis_authentication.png" alt="images/download/attachments/68879374/configuring_iis_authentication.png" width="371" height="250">
    <p><br></p>
</li><li class=" "><p>Select <strong class=" ">Anonymous Authentication</strong>.</p>
</li><li class=" "><p>In the <strong class=" ">Actions list</strong>, click on <strong class=" ">Enable</strong>.<br><br></p>
<img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/1310858/enabling_anonymous_auth.png" alt="images/download/attachments/1310858/enabling_anonymous_auth.png" width="500" height="181">
        <br><span class="caption">Enabling IIS anonymous authentication</span>
    <p><br></p>
</li><li class=" "><p>(Optional) If you disabled <strong class=" ">Windows authentication</strong> in order to secure your media libraries previously, you can now <strong class=" ">enable</strong> it.</p>
</li></ol>    </div>
    <div class="section section-2" id="src-68879374_Securingmedialibraries-Medialibrarysecuritysettings.1">
        <h2 class="heading "><span>Media library security settings</span></h2>
<p>Once you changed the settings in IIS, you need to make changes in Kentico as well.</p>
    <div class="section section-3" id="src-68879374_Securingmedialibraries-Changingsecuritysettingsforaparticularmedialibrary.1">
        <h3 class="heading "><span>Changing security settings for a particular media library</span></h3>
<p>Note that if you want to change the settings temporarily and then revert back to the secured mode, you can simply turn checking file permissions off.</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Media libraries </strong>application.</p>
</li><li class=" "><p><strong class=" ">Edit</strong> (<img class="confluence-embedded-image" src="images/download/attachments/41484305/edit.png" alt="images/download/attachments/41484305/edit.png">
) the Media library for which you want to set the permissions.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Security</strong> tab.</p>
</li><li class=" "><p>Assign the <strong class=" ">See library content</strong> permission to <strong class=" ">All users</strong>.</p>
</li></ol>    </div>
    <div class="section section-3" id="src-68879374_Securingmedialibraries-Changingcheckfilepermissionssettings.1">
        <h3 class="heading "><span>Changing check file permissions settings</span></h3>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Settings </strong>application.</p>
</li><li class=" "><p>Switch to <strong class=" ">Content -&gt; Media</strong>.</p>
</li><li class=" "><p>In the <strong class=" ">Security</strong> settings group, deselect <strong class=" ">Check file permissions</strong>.</p>
</li><li class=" "><p><strong class=" ">Save </strong>the changes.</p>
</li></ol>    </div>
    </div>
    <div class="section section-2" id="src-68879374_Securingmedialibraries-Mediagallerywebpartsettings.1">
        <h2 class="heading "><span>Media gallery web part settings</span></h2>
<ol class=" "><li class=" "><p>In the <strong class=" ">Pages </strong>application, navigate to the page on which you use the <a href="displaying-media-library-content-on-the-live-site">Media gallery web part</a>.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Design</strong> tab.</p>
</li><li class=" "><p><strong class=" ">Configure</strong> the web part.</p>
</li><li class=" "><p>In the <strong class=" ">Content</strong> section, disable the <strong class=" ">Use secure links</strong> property.</p>
</li><li class=" "><p>Click <strong class=" ">Save &amp; Close</strong>.</p>
</li></ol>    <div class="section section-3" id="src-68879374_Securingmedialibraries-WritingtransformationsfortheMediagallerywebpart.1">
        <h3 class="heading "><span>Writing transformations for the Media gallery web part</span></h3>
<p>When writing your transformations for the <strong class=" ">Media gallery</strong> web part:</p>
<ul class=" "><li class=" "><p>Obtain <strong class=" ">File previews</strong> and <strong class=" ">file details</strong> using the following control:<br></p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;cc1:MediaFilePreview ID=</code><code class="string">"filePreview"</code><code class="plain"> runat=</code><code class="string">"server"</code><code class="plain"> maxsidesize=</code><code class="string">"117"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
<p><br></p>
</li><li class=" "><p>You can obtain other <strong class=" ">file type previews</strong>, <strong class=" ">details</strong> and <strong class=" ">download links</strong> directly.</p>
</li></ul>    </div>
    </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>