<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Customizing product prices - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68881652">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881652"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="E-commerce-features.html">E-commerce features</a></li>
                                                                                                         <li class="shortcut"><a href="Customizing-and-developing-your-store.html">Customizing and developing your store</a></li>
                                                                                     <li><a href="Product-related-customizing.html">Product-related customizing</a></li>
                                                            </ul>
</div>            <h1 id="src-68881652"> <span>Customizing product prices</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>The Kentico E-commerce Solution allows you to customize how the system retrieves <a href="products">product</a> prices. For example, you can:</p><ul class=" "><li class=" "><p>Adjust the system to load price values from a custom database column</p>
</li><li class=" "><p>Integrate an external system that fully provides prices for products and their various configurations</p>
</li></ul><p>To customize the retrieval of prices:</p><ol class=" "><li class=" "><p>Open your Kentico project in Visual Studio.</p>
</li><li class=" "><p>Create new classes that implement one or more of the <a href="#src-68881652_customizingproductprices-pricingcustomizationinterfaces">pricing customization interfaces</a> (described below).</p>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Class location</strong><br></p>
<p>For production sites, we recommend creating a new assembly (Class library project) in your Kentico solution and including the classes there. Then, add the appropriate references to both the assembly and the main Kentico web project. For more information, see <a href="best-practices-for-customization">Best practices for customization</a>.</p>
        </div>
    </div>
</li><li class=" "><p>Implement all methods required by the given interfaces.</p>
</li><li class=" "><p>Register your implementations of the interfaces using the <strong class=" ">RegisterImplementation</strong> assembly attribute (or use a <i class=" ">Factory</i> class to serve instances dynamically in certain cases).</p>
</li></ol><p>When you reload the website, the system uses the custom implementations that you registered instead of the default pricing functionality.</p></div>


    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881652_customizingproductprices-pricingcustomizationinterfaces">Pricing customization interfaces</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881652_customizingproductprices-productpricesource">Product price source</a></p>
</li><li class=" "><p><a href="#src-68881652_customizingproductprices-productpricingservice">Product pricing service</a></p>
</li><li class=" "><p><a href="#src-68881652_customizingproductprices-catalogpricecalculation">Catalog price calculation</a></p>
</li></ul></li><li class=" "><p><a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnmb2fkaw5nchjvzhvjdhbyawnlc2zyb21jdxn0b21jb2x1bw5z">Example – Loading product prices from custom columns</a></p>
</li><li class=" "><p><a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnvc2luz2fuzxh0zxjuywxwcmljaw5nc2vydmljzq">Example – Using an external pricing service</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="products">Products</a></p>
</li><li class=" "><p><a href="configuring-products">Configuring products</a></p>
</li><li class=" "><p><a href="custom-development">Custom development</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881652_customizingproductprices-pricingcustomizationinterfaces">Pricing customization interfaces</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881652_customizingproductprices-productpricesource">Product price source</a></p>
</li><li class=" "><p><a href="#src-68881652_customizingproductprices-productpricingservice">Product pricing service</a></p>
</li><li class=" "><p><a href="#src-68881652_customizingproductprices-catalogpricecalculation">Catalog price calculation</a></p>
</li></ul></li><li class=" "><p><a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnmb2fkaw5nchjvzhvjdhbyawnlc2zyb21jdxn0b21jb2x1bw5z">Example – Loading product prices from custom columns</a></p>
</li><li class=" "><p><a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnvc2luz2fuzxh0zxjuywxwcmljaw5nc2vydmljzq">Example – Using an external pricing service</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="products">Products</a></p>
</li><li class=" "><p><a href="configuring-products">Configuring products</a></p>
</li><li class=" "><p><a href="custom-development">Custom development</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Pricing customization interfaces</span></h3>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>All mentioned interfaces can be found in the <strong class=" ">CMS.Ecommerce</strong> namespace.</p>
        </div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Product price source</span></h4>
<p>The price source implementation determines how the system gets product prices on the most basic level. The default Kentico price source loads product prices from the <i class=" ">SKUPrice</i> (standard price) or <i class=" ">SKURetailPrice</i> (list price) columns of the <i class=" ">COM_SKU</i> database table.</p>
<p>This type of customization allows you to change the source of the product price (for example a database column) while keeping all other parts of the default Kentico price processing.</p>
<ul class=" "><li class=" "><p><strong class=" ">ISKUPriceSource</strong> – implementations must contain the <i class=" ">GetPrice</i> method, which returns a price value (decimal) for a specified product and currency.</p>
</li><li class=" "><p><strong class=" ">ISKUPriceSourceFactory</strong> – serves a separate instance of a class implementing <i class=" ">ISKUPriceSource</i> for each site. Must be implemented to use custom <i class=" ">ISKUPriceSource</i> implementations. Requires the following methods:</p>
<ul class=" "><li class=" "><p><strong class=" ">GetSKUPriceSource</strong> – returns an <i class=" ">ISKUPriceSource</i> instance for loading standard product prices.</p>
</li><li class=" "><p><strong class=" ">GetSKUListPriceSource</strong> – returns an <i class=" ">ISKUPriceSource</i> instance for loading product list prices.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>When writing the <i class=" ">GetSKUPriceSource</i> and <i class=" ">GetSKUListPriceSource</i> methods, you can either return instances of different <i class=" ">ISKUPriceSource</i> implementations or use a single implementation with constructor parameters for switching between the standard price and list price.</p>
        </div>
    </div>
</li></ul></li></ul><p>See: <a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnmb2fkaw5nchjvzhvjdhbyawnlc2zyb21jdxn0b21jb2x1bw5z">Example - Loading product prices from custom columns</a></p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Product pricing service</span></h4>
<p>The system uses a pricing service to calculate the prices of products within a specific context, including adjustments from <a href="working-with-product-options">product options</a> (of the <i class=" ">Attribute</i> and <i class=" ">Text</i> type) and product unit <a href="discounts">discounts</a> (catalog discounts and volume discounts). The default Kentico pricing service uses the <i class=" ">ISKUPriceSource</i> and <i class=" ">ISKUPriceSourceFactory</i> implementations to get the basic price, adds adjustments for any assigned product options, and then applies all valid product discounts.</p>
<p>Creating a custom implementation of the <strong class=" ">IProductPricingService</strong> interface allows you to fully replace the default Kentico price processing, for example using an external pricing service.</p>
<p>Implementations of <i class=" ">IProductPricingService</i> must contain the <strong class=" ">GetPrices</strong> method. The method provides the following parameters:</p>
<ul class=" "><li class=" "><p>The product (<i class=" ">SKUInfo</i>) – can be a standard product, <a href="working-with-product-variants">product variant</a>, or <a href="working-with-product-options">product option</a> of the <i class=" ">Products</i> type.</p>
</li><li class=" "><p>Applied product options of the <i class=" ">Attribute</i> or <i class=" ">Text</i> type (<i class=" ">IEnumerable&lt;SKUInfo&gt;</i>).</p>
</li><li class=" "><p>A <strong class=" ">PriceParameters</strong> object holding additional data related to the price context, with the following properties:<br></p>
<ul class=" "><li class=" "><p><strong class=" ">Currency</strong> – the currency (<i class=" ">CurrencyInfo</i>) in which the price is requested.</p>
</li><li class=" "><p><strong class=" ">Quantity</strong> – the number of product units within the pricing context (can be used to calculate custom volume discounts).</p>
</li><li class=" "><p><strong class=" ">SiteID</strong> – an identifier of the site on which the price is calculated.</p>
</li><li class=" "><p><strong class=" ">User</strong> – the user object (<i class=" ">UserInfo</i>) for which the prices are calculated. Is <i class=" ">null</i> for anonymous customers who are not registered as website users.</p>
</li><li class=" "><p><strong class=" ">Customer</strong> – the <a href="customers">customer</a> object (<i class=" ">CustomerInfo</i>) for which the prices are calculated. Is <i class=" ">null</i> when calculating prices for anonymous visitors before they enter customer details in the checkout process.</p>
</li><li class=" "><p><strong class=" ">CalculationDate</strong> – a <i class=" ">DateTime</i> value storing the time for which the price is calculated (can be used to check the validity of product discounts). For most price calculations, the value is equal to the current time. When calculating prices for existing orders, the value is equal to the date and time when the order was created.</p>
</li></ul></li></ul><p>The <i class=" ">GetPrices</i> method must return a <strong class=" ">ProductPrices</strong> object, which holds the following properties:</p>
<ul class=" "><li class=" "><p><strong class=" ">StandardPrice</strong> – the calculated price before any discounts are applied.</p>
</li><li class=" "><p><strong class=" ">Price</strong> – the calculated final price including discounts.</p>
</li><li class=" "><p><strong class=" ">AppliedDiscounts</strong> – a summary of any applied discounts (represented by a <i class=" ">ValuesSummary</i> object containing discount name and value pairs).</p>
</li></ul><p>See: <a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnvc2luz2fuzxh0zxjuywxwcmljaw5nc2vydmljzq">Example - Using an external pricing service</a></p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Catalog price calculation</span></h4>
<p>The system uses an additional API layer to calculate the prices displayed in product catalogs on the live website. The default Kentico catalog price calculation uses the <i class=" ">IProductPricingService</i> implementation to get product prices, adds adjustments for any selected product accessories (<a href="working-with-product-options">product options</a> of the <i class=" ">Products</i> type), and then uses the <i class=" ">ICatalogTaxCalculator</i> implementation to get information about tax values (see <a href="customizing-tax-calculation">Customizing tax calculation</a>).</p>
<p>Customize the catalog price calculation if you need to adjust how prices are displayed in the live site catalog, without affecting the price calculations during the checkout process.</p>
<ul class=" "><li class=" "><p><strong class=" ">ICatalogPriceCalculator</strong></p>
</li><li class=" "><p><strong class=" ">ICatalogPriceCalculatorFactory</strong> – serves a separate instance of a class implementing <i class=" ">ICatalogPriceCalculator</i> for each site. Must be implemented to use custom <i class=" ">ICatalogPriceCalculator</i> implementations.</p>
</li></ul><p>Implementations of <i class=" ">ICatalogPriceCalculator</i> must contain two methods:</p>
<ul class=" "><li class=" "><p><strong class=" ">GetPrices</strong> – calculates the prices displayed on the live site in product catalogs.</p>
</li><li class=" "><p><strong class=" ">GetAdjustment</strong> – calculates the price adjustment value for selectors of product options. Returns a <i class=" ">decimal</i> price adjustment value, and provides parameters representing the given product option (<i class=" ">SKUInfo</i>), parent product or product variant (<i class=" ">SKUInfo</i>), and the current shopping cart (<i class=" ">ShoppingCartInfo</i>).</p>
</li></ul><p>The <strong class=" ">GetPrices</strong> method provides the following parameters:</p>
<ul class=" "><li class=" "><p>The product or <a href="working-with-product-variants">product variant</a> (<i class=" ">SKUInfo</i>).</p>
</li><li class=" "><p>Applied product options (<i class=" ">IEnumerable&lt;SKUInfo&gt;</i>) of all types.</p>
</li><li class=" "><p>The current shopping cart (<i class=" ">ShoppingCartInfo</i>) of the user browsing the catalog, which provides any required context data, such as the user object or selected currency.</p>
</li></ul><p>The <i class=" ">GetPrices</i> method must return a <strong class=" ">ProductCatalogPrices</strong> object, which holds the following properties:</p>
<ul class=" "><li class=" "><p><strong class=" ">StandardPrice</strong> – the calculated price before any discounts are applied.</p>
</li><li class=" "><p><strong class=" ">Price</strong> – the calculated price including discounts.</p>
</li><li class=" "><p><strong class=" ">Tax</strong> – the tax value calculated for the <i class=" ">Price</i> (depending on the site's <i class=" ">Prices include tax</i> <a href="settings---e-commerce">setting</a>, the value either represents the tax that will be added to the price in the checkout process, or the tax component extracted from the price).</p>
</li><li class=" "><p><strong class=" ">Discounts</strong> – a summary of any applied discounts (represented by a <i class=" ">ValuesSummary</i> object containing discount name and value pairs).</p>
</li></ul>    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Example – Loading product prices from custom columns</span></h3>
<p>The following example demonstrates how to customize the system to load product prices from a different database column than the default <i class=" ">SKUPrice</i>. The example loads prices from a custom <i class=" ">SKUCustomPrice</i> column for products that have their <a href="product-statuses">internal status</a> set to <i class=" ">Special offer</i>.</p>
<p>Start by adding a custom column (field) for product objects:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Modules</strong> application.</p>
</li><li class=" "><p>Edit the <strong class=" ">E-commerce</strong> module.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Classes</strong> tab.</p>
</li><li class=" "><p>Edit the <strong class=" ">SKU</strong> class.</p>
</li><li class=" "><p>Switch to the <strong class=" ">Fields</strong> tab.</p>
</li><li class=" "><p><a href="reference---field-editor">Create a new field</a> based on your needs.<br></p>
<ul class=" "><li class=" "><p>The example uses <i class=" ">SKUCustomPrice</i> as the <strong class=" ">Field name</strong>.</p>
</li><li class=" "><p>We strongly recommend using <i class=" "><strong class=" ">Decimal number</strong></i> as the <strong class=" ">Data type</strong> of fields storing price values.</p>
</li><li class=" "><p>You can use the default <i class=" "><strong class=" ">Price selector</strong></i> as the field's <strong class=" ">Form control</strong> if you wish to show the field in editing forms in the product administration interface.</p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>The custom price column is ready for use. By default, store administrators can edit the value in the <strong class=" ">Products</strong> application when viewing products on the <strong class=" ">General</strong> tab, under the <strong class=" ">Custom properties</strong> section.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68881652/custom_price_column_editing.png" alt="images/download/attachments/68881652/custom_price_column_editing.png" width="500">
        <br><span class="caption">Editing the value of a custom price column in the Products application</span>
    </p>
<p>Prepare a separate project for custom classes in your Kentico solution:</p>
<ol class=" "><li class=" "><p>Open your Kentico solution in Visual Studio.</p>
</li><li class=" "><p>Create a new <i class=" ">Class Library</i> project in the Kentico solution (or reuse an existing custom project).</p>
</li><li class=" "><p>Add references to the required Kentico libraries (DLLs) for the new project:<br></p>
<ol class=" "><li class=" "><p>Right-click the project and select <strong class=" ">Add -&gt; Reference</strong>.</p>
</li><li class=" "><p>Select the <strong class=" ">Browse</strong> tab of the <strong class=" ">Reference manager</strong> dialog, click <strong class=" ">Browse</strong> and navigate to the <i class=" "><strong class=" ">Lib</strong> </i>folder of your Kentico web project.</p>
</li><li class=" "><p>Add references to the following libraries (and any others that you may need in your custom code):</p>
<ul class=" "><li class=" "><p><strong class=" ">CMS.Base.dll</strong></p>
</li><li class=" "><p><strong class=" ">CMS.Core.dll</strong></p>
</li><li class=" "><p><strong class=" ">CMS.DataEngine.dll</strong></p>
</li><li class=" "><p><strong class=" ">CMS.Ecommerce.dll</strong></p>
</li><li class=" "><p><strong class=" ">CMS.Globalization.dll</strong></p>
</li><li class=" "><p><strong class=" ">CMS.Helpers.dll</strong></p>
</li><li class=" "><p><strong class=" ">CMS.Membership.dll</strong></p>
</li></ul></li></ol></li><li class=" "><p>Reference the custom project from the Kentico web project <i class=" ">(CMSApp</i> or <i class=" ">CMS)</i>.</p>
</li><li class=" "><p>Edit the custom project's <strong class=" ">AssemblyInfo.cs</strong> file (in the <i class=" ">Properties</i> folder).</p>
</li><li class=" "><p>Add the <strong class=" ">AssemblyDiscoverable</strong> assembly attribute:<br></p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">[assembly:AssemblyDiscoverable]</code></div>
</div>
    </div>
</li></ol><p>Continue by creating custom implementations of the <strong class=" ">ISKUPriceSource</strong> and <strong class=" ">ISKUPriceSourceFactory</strong> interfaces:</p>
<p></p>
<ol class=" "><li class=" "><p>Add a new class under the custom project, implementing the <i class=" ">ISKUPriceSource</i> interface.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Ecommerce;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomSKUPriceSource : ISKUPriceSource</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">readonly</code><code class="plain"> ISiteMainCurrencySource mainCurrencySource;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">readonly</code><code class="plain"> ICurrencyConverter currencyConverter;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">readonly</code><code class="plain"> </code><code class="keyword">bool</code><code class="plain"> getListPrice;    </code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The first two constructor parameters accept instances of currency-related classes from CustomSKUPriceSourceFactory.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The third parameter determines whether the price source loads the list price instead of the standard price.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> CustomSKUPriceSource(ISiteMainCurrencySource mainCurrencySource, ICurrencyConverter currencyConverter, </code><code class="keyword">bool</code><code class="plain"> getListPrice)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.mainCurrencySource = mainCurrencySource;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.currencyConverter = currencyConverter;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.getListPrice = getListPrice;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Loads the basic price value for a specified product and currency.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The returned price is then further processed by the system.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> </code><code class="keyword">decimal</code><code class="plain"> GetPrice(SKUInfo sku, CurrencyInfo currency)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Gets the basic price according to custom logic</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">decimal</code><code class="plain"> price = GetCustomPrice(sku, currency);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Uses the default Kentico currency API to convert the price</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// from the site's main currency into the requested currency (if necessary)</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">string</code><code class="plain"> siteMainCurrencyCode = mainCurrencySource.GetSiteMainCurrencyCode(sku.SKUSiteID);</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> currencyConverter.Convert(price, siteMainCurrencyCode, currency.CurrencyCode);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Gets the basic product price. You can replace this method with any type of custom logic.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">decimal</code><code class="plain"> GetCustomPrice(SKUInfo sku, CurrencyInfo currency)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// If the list price is requested, loads the value from the product's default 'SKURetailPrice' column</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (getListPrice)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">return</code><code class="plain"> sku.SKURetailPrice;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Gets the product's internal status</code></div>
<div class="line"><code class="plain">        InternalStatusInfo status = InternalStatusInfoProvider.GetInternalStatusInfo(sku.SKUInternalStatusID);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Checks whether the product has the 'specialoffer' internal status</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> ((status != </code><code class="keyword">null</code><code class="plain">) &amp;&amp; (status.InternalStatusName.ToLowerInvariant() == </code><code class="string">"specialoffer"</code><code class="plain">))</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="comments">// Gets the product's price from a custom database column - SKUCustomPrice</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">return</code><code class="plain"> ValidationHelper.GetDecimal(sku.GetValue(</code><code class="string">"SKUCustomPrice"</code><code class="plain">), 0);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// If none of the custom conditions are fulfilled, gets the price from the default 'SKUPrice' column</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> sku.SKUPrice;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Add a new class under the custom project, implementing the <i class=" ">ISKUPriceSourceFactory</i> interface.<br></p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Ecommerce;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Registers the custom implementation of ISKUPriceSourceFactory</code></div>
<div class="line"><code class="plain">[assembly: RegisterImplementation(</code><code class="keyword">typeof</code><code class="plain">(ISKUPriceSourceFactory), </code><code class="keyword">typeof</code><code class="plain">(CustomSKUPriceSourceFactory))]</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomSKUPriceSourceFactory : ISKUPriceSourceFactory</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">readonly</code><code class="plain"> ISiteMainCurrencySource mainCurrencySource;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">readonly</code><code class="plain"> ICurrencyConverterFactory currencyConverterFactory;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Constructor.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The system automatically supplies instances of the ISiteMainCurrencySource and ICurrencyConverterFactory implementations.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> CustomSKUPriceSourceFactory(ISiteMainCurrencySource mainCurrencySource, ICurrencyConverterFactory currencyConverterFactory)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.mainCurrencySource = mainCurrencySource;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">this</code><code class="plain">.currencyConverterFactory = currencyConverterFactory;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Provides a ISKUPriceSource instance for loading standard product prices.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> ISKUPriceSource GetSKUPriceSource(</code><code class="keyword">int</code><code class="plain"> siteId)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Returns an instance of the custom price source implementation</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// The first two parameters provide instances of currency-related classes required by CustomSKUPriceSource</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// The third parameter configures CustomSKUPriceSource to load standard prices</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> </code><code class="keyword">new</code><code class="plain"> CustomSKUPriceSource(mainCurrencySource, currencyConverterFactory.GetCurrencyConverter(siteId), getListPrice: </code><code class="keyword">false</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Provides a ISKUPriceSource instance for loading product list prices.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> ISKUPriceSource GetSKUListPriceSource(</code><code class="keyword">int</code><code class="plain"> siteId)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Returns an instance of the custom price source implementation</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// The first two parameters provide instances of currency-related classes required by CustomSKUPriceSource</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// The third parameter configures CustomSKUPriceSource to load list prices</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> </code><code class="keyword">new</code><code class="plain"> CustomSKUPriceSource(mainCurrencySource, currencyConverterFactory.GetCurrencyConverter(siteId), getListPrice: </code><code class="keyword">true</code><code class="plain">);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Save all changes and <strong class=" ">Build</strong> the custom project.</p>
</li></ol><p>The registered <strong class=" ">CustomSKUPriceSourceFactory</strong> class provides an instance of <strong class=" ">CustomSKUPriceSource</strong>, with a parameter that indicates whether the standard price or list price is requested. The <strong class=" ">CustomSKUPriceSource</strong> implementation ensures that products with the <i class=" ">Special offer</i> internal status load their basic price from the <i class=" ">SKUCustomPrice</i> column instead of the default <i class=" ">SKUPrice</i>. The basic price is then further processed by the system, and affects both price calculations during the checkout process and prices displayed in product catalogs on the live site (when using appropriate <a href="reference---transformation-methods">transformation methods</a> or the default built-in web parts).</p>
<p>The sample code also demonstrates how to use the default implementations of currency-related interfaces to convert the returned price value for stores using multiple currencies.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Example – Using an external pricing service</span></h3>
<p>The following example demonstrates how to use a custom <strong class=" ">IProductPricingService</strong> implementation to integrate a 3rd-party service that fully provides prices for products. In this example, the returned price values are static, but you can replace the code with calls to the API of an external pricing service. Product data can be supplied to the pricing service from the parameters of the <strong class=" ">GetPrices</strong> method, which is required in all implementations of the <i class=" ">IProductPricingService</i> interface.</p>
<ol class=" "><li class=" "><p>Recreate or reuse the custom project from the <a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnmb2fkaw5nchjvzhvjdhbyawnlc2zyb21jdxn0b21jb2x1bw5z">previous example</a>.</p>
</li><li class=" "><p>Create a new class under the custom project, implementing the <i class=" ">IProductPricingService</i> interface.</p>
</li><li class=" "><p>Save all changes and <strong class=" ">Build</strong> the custom project.</p>
</li></ol>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System.Collections.Generic;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Ecommerce;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Registers the custom implementation of IProductPricingService</code></div>
<div class="line"><code class="plain">[assembly: RegisterImplementation(</code><code class="keyword">typeof</code><code class="plain">(IProductPricingService), </code><code class="keyword">typeof</code><code class="plain">(CustomProductPricingService))]</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CustomProductPricingService : IProductPricingService</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Calculates the price for a specified product and product option configuration.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Additional data related to the price context is provided in the PriceParameters.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Returns a 'ProductPrices' object containing the calculated price and information about any applied discounts.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">public</code><code class="plain"> ProductPrices GetPrices(SKUInfo sku, IEnumerable&lt;SKUInfo&gt; options, PriceParameters priceParams)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Gets a custom price for the basic product</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">decimal</code><code class="plain"> standardPrice = GetCustomPrice(sku, priceParams);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Gets a custom price total for any product options</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">decimal</code><code class="plain"> optionsPrice = 0;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (options != </code><code class="keyword">null</code><code class="plain">)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">foreach</code><code class="plain"> (SKUInfo option </code><code class="keyword">in</code><code class="plain"> options)</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                optionsPrice += GetCustomPrice(option, priceParams);</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">decimal</code><code class="plain"> priceWithOptions = standardPrice + optionsPrice;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Gets a ValuesSummary object containing information about any discounts used by the custom pricing logic</code></div>
<div class="line"><code class="plain">        ValuesSummary appliedDiscounts = GetCustomDiscounts(sku, priceWithOptions, priceParams);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Sums up the total discount value</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">decimal</code><code class="plain"> discountValue = 0;</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">foreach</code><code class="plain"> (SummaryItem discount </code><code class="keyword">in</code><code class="plain"> appliedDiscounts)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            discountValue += discount.Value;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Returns the calculated product prices. The constructor parameters are:</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// price - the final price of the product</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// standardPrice - the price before any discounts</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// discounts - a ValuesSummary object containing information about applied discounts</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> </code><code class="keyword">new</code><code class="plain"> ProductPrices(priceWithOptions - discountValue, priceWithOptions, appliedDiscounts);</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Gets a custom price for the specified product.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The example only provides a static number, but you can use any type of custom logic,</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// e.g. call the API of a 3rd-party pricing service.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">decimal</code><code class="plain"> GetCustomPrice(SKUInfo sku, PriceParameters priceParams)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="comments">// Returns a price for product options (the currency is specified in the PriceParameters)</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (sku.IsProductOption)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">return</code><code class="plain"> 5m;</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Returns a base price for products (the currency is specified in the PriceParameters)</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> 50m;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// Collects information about discounts applied by the custom pricing logic.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// The example only returns a basic set of discounts, but you can use any type of custom logic,</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// e.g. based on data returned by a 3rd-party pricing service.</code></div>
<div class="line"><code class="plain">    </code><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">private</code><code class="plain"> ValuesSummary GetCustomDiscounts(SKUInfo sku, </code><code class="keyword">decimal</code><code class="plain"> price, PriceParameters priceParams)</code></div>
<div class="line"><code class="plain">    {</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">var</code><code class="plain"> appliedDiscounts = </code><code class="keyword">new</code><code class="plain"> ValuesSummary();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Applies a custom discount of '5' (the currency is specified in the PriceParameters)</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">var</code><code class="plain"> discount = </code><code class="keyword">new</code><code class="plain"> SummaryItem</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            Name = </code><code class="string">"Custom discount"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">            Value = 5m</code></div>
<div class="line"><code class="plain">        };</code></div>
<div class="line"><code class="plain">        appliedDiscounts.Add(discount);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="comments">// Applies a 10% volume discount if the product quantity is more than 5</code></div>
<div class="line"><code class="plain">        </code><code class="keyword">if</code><code class="plain"> (priceParams.Quantity &gt; 5)</code></div>
<div class="line"><code class="plain">        {</code></div>
<div class="line"><code class="plain">            </code><code class="keyword">var</code><code class="plain"> volumeDiscount = </code><code class="keyword">new</code><code class="plain"> SummaryItem</code></div>
<div class="line"><code class="plain">            {</code></div>
<div class="line"><code class="plain">                Name = </code><code class="string">"Custom volume discount"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">                Value = price * 0.1m</code></div>
<div class="line"><code class="plain">            };</code></div>
<div class="line"><code class="plain">            appliedDiscounts.Add(volumeDiscount);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">        </code><code class="keyword">return</code><code class="plain"> appliedDiscounts;</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p>The registered <strong class=" ">CustomProductPricingService</strong> implementation fully overrides the default Kentico pricing logic. The customization affects both prices displayed in product catalogs on the live site (when using appropriate <a href="reference---transformation-methods">transformation methods</a> or the default built-in web parts) and price calculations during the checkout process.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: This example does not convert prices for stores using multiple currencies. See the <a href="#src-68881652_safe-id-q3vzdg9taxppbmdwcm9kdwn0chjpy2vzluv4yw1wbgxigjnmb2fkaw5nchjvzhvjdhbyawnlc2zyb21jdxn0b21jb2x1bw5z">previous example</a> for information about implementing currency conversions in custom code.</p>
        </div>
    </div>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Caching external price data</strong></p>
<p>We <i class=" "><strong class=" ">strongly recommend that you implement caching</strong></i> for any data retrieved from external pricing services. The system may request the price data very frequently when displaying product catalogs, particularly on sites with heavy traffic.</p>
<p>To learn about the custom caching options provided by the Kentico API, see: <a href="caching-in-custom-code">Caching in custom code</a></p>
        </div>
    </div>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Using the default pricing functionality</strong></p>
<p>If you do not wish to completely replace the default Kentico pricing functionality, but only need to make minor adjustments, you can access and use the default implementations of related interfaces:</p>
<ol class=" "><li class=" "><p>Add a constructor for your custom <i class=" ">IProductPricingService</i> class with <strong class=" ">ISKUPriceSourceFactory</strong> and <strong class=" ">IProductDiscountService</strong> parameters.</p>
</li><li class=" "><p>Use the instances obtained from the parameters to get the default basic price and discounts.</p>
</li></ol>        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>