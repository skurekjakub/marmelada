<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Configuring UI data export - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68879340">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68879340"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Managing-website-content.html">Managing website content</a></li>
                                                                                     <li><a href="Configuring-the-environment-for-content-editors.html">Configuring the environment for content editors</a></li>
                                                            </ul>
</div>            <h1 id="src-68879340"> <span>Configuring UI data export</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>This page explains how to customize the Excel and CSV export for data in the Kentico administration interface:</p><p></p><ul class="toc-indentation "><li class=" "><p><a href="#src-68879340_configuringuidataexport-customizingexcelexporttemplates">Customizing Excel export templates</a></p>
</li><li class=" "><p><a href="#src-68879340_configuringuidataexport-customizingcsvdelimiters">Customizing CSV delimiters</a></p>
</li></ul><p></p><h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Customizing Excel export templates</span></h3><p>You can customize the default appearance of exported XLSX templates. On each export, the system searches for a <i class=" ">Template.xlsx</i> file in the following locations:</p><ol class=" "><li class=" "><p><strong class=" ">~\CMS\App_Data\CMSModules\DataExport\&lt;site code name&gt;\&lt;object type&gt;\Template.xlsx</strong></p>
</li><li class=" "><p><strong class=" ">~\CMS\App_Data\CMSModules\DataExport\&lt;object type&gt;\Template.xlsx</strong></p>
</li><li class=" "><p><strong class=" ">~\CMS\App_Data\CMSModules\DataExport\&lt;site code name&gt;\Template.xlsx</strong></p>
</li><li class=" "><p><strong class=" ">~\CMS\App_Data\CMSModules\DataExport\Template.xlsx</strong></p>
</li></ol><p>The system searches for the templates according to the listed priorities. This means that when exporting listings of an object type on a specified website, the path stated in 1. is searched first. If the <i class=" ">Template.xlsx</i> file is not found there, location 2 is searched and so on. This allows you to add dedicated templates for each object type and website in your system.</p><p>The <i class=" ">DataExport</i> folder is NOT present under <i class=" ">~\App_Data\CMSModules</i> by default. You need to create the folder and all required subfolders manually to use custom templates.</p><p>The <i class=" ">&lt;object type&gt;</i> folder name must be identical to the name of the exported file, e.g. <i class=" ">cms_user</i> for user listings as the exported file name is <i class=" ">cms_user.xlsx </i>(the actual object type name is <i class=" ">cms.user</i>, but dots are replaced with underscores in file names).</p><p>The <i class=" ">&lt;site code name&gt;</i> folders are only searched when exporting site-related objects.</p><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>For objects that can be both global (shared among all sites in the system) and site-related, such as <a href="role-management">roles</a>, we recommend adding the <i class=" ">Template.xlsx</i> file to both the site and global folders. Such objects use the global or site-related export template, depending on the selected user interface or the type of the user doing the export (global template for global administrators, site-related template for standard users).</p>
        </div>
    </div><div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>If the <i class=" ">Template.xlsx</i> file is not found in any of the locations, the default template is used. The same happens if the template is opened for editing at the time of export or if the current user doesn't have the Read and Write permissions for the template file (on the operating system level).</p>
        </div>
    </div></div>


    





    
    
    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68879340_configuringuidataexport-customizingexcelexporttemplates">Customizing Excel export templates</a></p>
</li><li class=" "><p><a href="#src-68879340_configuringuidataexport-customizingcsvdelimiters">Customizing CSV delimiters</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="exporting-data-from-the-user-interface">Exporting data from the user interface</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68879340_configuringuidataexport-customizingexcelexporttemplates">Customizing Excel export templates</a></p>
</li><li class=" "><p><a href="#src-68879340_configuringuidataexport-customizingcsvdelimiters">Customizing CSV delimiters</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="exporting-data-from-the-user-interface">Exporting data from the user interface</a></p>
</li></ul>        </div>
    </div></div>
    
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Custom data export folder</span></h4>
<p>Excel export templates can also be stored in a different location than the default <i class=" ">~\App_Data\CMSModules\DataExport</i>. The custom location can be defined by adding the following key to the <i class=" ">AppSettings</i> section of the <i class=" ">web.config</i> file:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSDataExportTemplateFolder"</code><code class="plain"> value=</code><code class="string">"\\server1\MyDataExportTemplates"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
<p>For the value of the key, you can either use a local disk path (for example, <i class=" ">C:\MyDataExportTemplates</i>) or a UNC path (for example, <i class=" ">\\server1\MyDataExportTemplates</i>). Using a UNC path may be useful in cases when you want to share the same templates between several Kentico instances running on separate servers.</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Template format</span></h4>
<p>The template spreadsheet can contain any graphics, text or any other pre‑filled data in it, while the following macros can be used in any cells. On export, the macros are replaced with the actual exported data:</p>
<ul class=" "><li class=" "><p><strong class=" ">##HEADER##</strong> - replaced with the header row. When advanced export is used, it is only replaced if the <strong class=" ">Export header row</strong> option is enabled.</p>
</li><li class=" "><p><strong class=" ">##DATA##</strong> - replaced with the actual exported data.</p>
</li><li class=" "><p><strong class=" ">##TABLE##</strong> - replaced with both the header row and the exported data.</p>
</li><li class=" "><p><strong class=" ">{%WhereCondition%}</strong> - replaced with the WHERE condition used for export (only relevant when exporting via the <strong class=" ">Advanced export</strong> dialog).</p>
</li><li class=" "><p><strong class=" ">{%OrderBy%}</strong> - replaced with the ORDER BY expression used to order exported items (either the expression configured in the <strong class=" ">Advanced export</strong> dialog or the default column according to which records are sorted when exporting using the <strong class=" ">Export to Excel </strong>action).</p>
</li><li class=" "><p><strong class=" ">{%TotalRecords%}</strong> - replaced with the total number of exported records.</p>
</li><li class=" "><p><strong class=" ">{%ObjectType%}</strong> - replaced with the type of exported object (e.g. <i class=" ">cms.userlist</i>).</p>
</li></ul><p>You can also use all standard Context (data) <a href="macro-expressions">macros </a>the same way as you are used to within Kentico user interface.</p>
<p>So for example, if you create a <i class=" ">Template.xlsx</i> file as in the screenshot below and upload it to <i class=" ">~\App_Data\CMSModules\DataExport\cms_user\</i>...</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68879340/template_example.png" alt="images/download/attachments/68879340/template_example.png" width="500">
        <br><span class="caption">Example of an XLSX template</span>
    </p>
<p>... the XLSX file with exported users will look as you can see on the following screenshot.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68879340/export_example.png" alt="images/download/attachments/68879340/export_example.png" width="500">
        <br><span class="caption">Example of an exported XLSX file</span>
    </p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Customizing CSV delimiters</span></h3>
<p>CSV is an abbreviation for <a class="external-link" href="http://en.wikipedia.org/wiki/Comma-separated_values">Comma-separated values</a>. It is a file format that stores tabular data in text form — each line represents one row of data, while particular values (columns) in each row are separated by a comma (,) or a semicolon (;).</p>
<p>The comma is used as a column delimiter by default if you select the <strong class=" ">Export to CSV </strong>action, while you can choose between the comma and the semicolon in the <strong class=" ">Advanced export</strong> dialog. The choice of the correct delimiter depends on your operating system's regional settings.</p>
<p>If you use an inappropriate delimiter, <strong class=" ">data from each row will be displayed in a single cell</strong>, as the displaying software (for example, Microsoft Excel) will not be able to identify the boundaries between individual values.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68879340/csv_inappropriate_delimiter.png" alt="images/download/attachments/68879340/csv_inappropriate_delimiter.png" width="500">
        <br><span class="caption">Incorrect CSV delimiters </span>
    </p>
<p>If an appropriate delimiter is used, <strong class=" ">data from each column will be displayed in individual cells</strong> as expected.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68879340/csv_appropriate_delimiter.png" alt="images/download/attachments/68879340/csv_appropriate_delimiter.png" width="500">
        <br><span class="caption">Correct CSV delimiters</span>
    </p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Delimiter settings on operating system level</span></h4>
<p>To find out which delimiter you should use in your environment or to configure your system to use the other one than the one currently used:</p>
<ol class=" "><li class=" "><p>Go to <strong class=" ">Start menu -&gt; Control Panel</strong> in Windows.</p>
</li><li class=" "><p>Open the <strong class=" ">Clock, Language, and Region </strong>settings category.</p>
</li><li class=" "><p>Click the <strong class=" ">Region and Language</strong> category.</p>
<ul class=" "><li class=" "><p>The Region and Language dialog opens on the <strong class=" ">Formats</strong> tab.</p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Additional settings...</strong>.<br></p>
<ul class=" "><li class=" "><p>The <strong class=" ">Customize Format</strong> dialog opens on the <strong class=" ">Numbers</strong> tab.</p>
</li></ul></li><li class=" "><p>Here you can choose the delimiter in the <strong class=" ">List separator</strong> field.<br><br></p>
<img class="confluence-embedded-image" src="images/download/attachments/68879340/image2013-11-6-13_24_40.png" alt="images/download/attachments/68879340/image2013-11-6-13_24_40.png" width="350">
    <p><br></p>
<ul class=" "><li class=" "><p>The separator chosen here is the one that you should use when exporting listings data in order to get it displayed correctly.<br><br></p>
</li></ul></li><li class=" "><p>If you made any changes, click <strong class=" ">OK</strong> in the <strong class=" ">Customize format dialog</strong> and also click <strong class=" ">OK</strong> in the <strong class=" ">Region and Language</strong> dialog.</p>
</li></ol>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>