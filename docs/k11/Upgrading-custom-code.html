<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Upgrading custom code - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882767"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Installation.html">Installation</a></li>
                                                                                     <li><a href="Upgrading-to-Kentico-11.html">Upgrading to Kentico 11</a></li>
                                                            </ul>
</div>            <h1 id="src-68882767"> <span>Upgrading custom code</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"></div><p>The <strong class=" ">Kentico Code upgrade tool</strong> provides a way to analyze Kentico 10 projects and helps convert custom code to version 11. You can download the tool from the <a class="external-link" href="https://devnet.kentico.com/documentation/api-changes/kentico-11">API Changes</a> page on the DevNet portal.</p>
<p>The tool has the following functionality:</p>
<ul class=" "><li class=" "><p>Detects custom code that is no longer valid in version 11</p>
</li><li class=" "><p>Provides recommendations for each occurrence of invalid code</p>
</li><li class=" "><p>Automatic conversion of the majority of code to the Kentico 11 API</p>
</li></ul>    <div class="section section-1" id="src-68882767_Upgradingcustomcode-Prerequisites">
        <h1 class="heading "><span>Prerequisites</span></h1>
<p>The machine where you plan to run the code upgrade tool must fulfill the following requirements:</p>
<ul class=" "><li class=" "><p><a class="external-link" href="http://www.microsoft.com/en-US/download/details.aspx?id=40773">Microsoft .NET Framework 4.5.1 or newer</a></p>
</li><li class=" "><p>Development and compilation tools:</p>
<ul class=" "><li class=" "><p>Visual Studio 2015<br>– OR –</p>
</li><li class=" "><p>Visual Studio 2017 with <a class="external-link" href="https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017">Build Tools for Visual Studio 2017</a> (including <i class=" ">Web development build tools</i>)</p>
</li></ul></li></ul><p>The Kentico 10 solution that you wish to analyze must compile without errors.</p>
<p>To allow the tool to check the code of Kentico virtual objects, such as <a href="writing-transformations">transformations</a> and <a href="editing-page-layouts">page layouts</a>, you need to enable <a href="deployment-mode-for-virtual-objects">Deployment mode</a> for your Kentico 10 instance.</p>
    </div>
    <div class="section section-1" id="src-68882767_Upgradingcustomcode-AnalyzingKentico10projects">
        <h1 class="heading "><span>Analyzing Kentico 10 projects</span></h1>
    <div class="section section-2" id="src-68882767_Upgradingcustomcode-Basicdetection">
        <h2 class="heading "><span>Basic detection</span></h2>
<p>Open the <i class=" ">Tool_VS2015</i> or <i class=" ">Tool_VS2017</i> folder in the code upgrade tool package, based on the Visual Studio version that you use on your machine.</p>
<p>Run <strong class=" ">CodeUpgrade.exe</strong> from the <strong class=" ">command line</strong>, with the path to your project’s solution file as the parameter (<i class=" ">WebSite.sln</i> or <i class=" ">WebApp</i>.<i class=" ">sln</i>).</p>
<p>For example:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">CodeUpgrade.exe C:\inetpub\wwwroot\Kentico10\WebSite.sln</code></div>
</div>
    </div>
<p>The tool generates a <strong class=" ">csv</strong> file containing a list of custom code occurrences in your project that are no longer valid in Kentico 11. The information will help you update your custom code after you perform the upgrade.</p>
<p>Each listed occurrence in the csv file has one of the following statuses:</p>
<ul class=" "><li class=" "><p><strong class=" ">Detected</strong> – an occurrence of invalid code that the tool cannot resolve automatically. See the <i class=" ">Instructions</i> value of the occurrence for more information.</p>
</li><li class=" "><p><strong class=" ">CanBeResolved</strong> – a detected code occurrence that the tool can resolve automatically if you run it with the <i class=" ">-resolve</i> parameter (see the <i class=" ">Automatic conversion</i> section).</p>
</li><li class=" "><p><strong class=" ">Resolved</strong> – invalid code that the tool automatically resolved in the specified output folder. Only used when running the tool with the <i class=" ">-resolve</i> parameter.</p>
</li></ul>    </div>
    <div class="section section-2" id="src-68882767_Upgradingcustomcode-Automaticconversion">
        <h2 class="heading "><span>Automatic conversion</span></h2>
<p>You can also use the tool to provide automatic resolutions for most types of code expressions. Add the <strong class=" ">-resolve</strong> parameter when running <i class=" ">CodeUpgrade.exe</i>.</p>
<p>For example:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">CodeUpgrade.exe -resolve C:\inetpub\wwwroot\Kentico10\WebSite.sln</code></div>
</div>
    </div>
<p>If the tool detects code issues that can be automatically resolved, it creates copies of the given files under the <strong class=" ">Converted</strong> folder in the tool directory. All resolvable issues in the files are updated to be compatible with the Kentico 11 API.</p>
    </div>
    <div class="section section-2" id="src-68882767_Upgradingcustomcode-Optionalparameters">
        <h2 class="heading "><span>Optional parameters</span></h2>
<p>You can also add the following parameters when running the tool:</p>
<ul class=" "><li class=" "><p><strong class=" ">-vstoolspath=&lt;path&gt;</strong> – only available when using the Visual Studio 2017 version of the tool. Sets the path to the Visual Studio build tools required to analyze the solution. You need to set the path if your build tools are installed in a different directory than the default     <span style="color: #16233a;">
(<i class=" ">C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\MSBuild\Microsoft\VisualStudio\v15.0</i>    </span>
).</p>
</li><li class=" "><p><strong class=" ">-output=results.csv</strong> – sets the name of the file containing the tool’s results.</p>
</li><li class=" "><p><strong class=" ">-verbose=0</strong> – determines how detailed the tool’s output is in the console (enter values from 0 to 3). Does not affect the output file.</p>
</li></ul>    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>For more details about the available parameters, run the tool without any parameters.</p>
        </div>
    </div>
    </div>
    <div class="section section-2" id="src-68882767_Upgradingcustomcode-Limitingthescopeoftheanalysis">
        <h2 class="heading "><span>Limiting the scope of the analysis</span></h2>
<p>For customized Kentico files, the tool reports all detected issues, including the default Kentico 10 code. You can avoid reporting of these false positives by enclosing your custom code into <strong class=" ">#region</strong> directives with a specific name. For ASPX markup, use the following syntax:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;%-- #region Name --%&gt; ... &lt;%-- #endregion --%&gt;</code></div>
</div>
    </div>
<p>To analyze only the code placed inside the regions, run the tool with an additional parameter:<strong class=" "> -customregion=&lt;regionName&gt;</strong></p>
    </div>
    </div>
    <div class="section section-1" id="src-68882767_Upgradingcustomcode-ImplementingtheAPIchanges">
        <h1 class="heading "><span>Implementing the API changes</span></h1>
<p>Use the output of the tool to update your custom code AFTER you <a href="upgrading-to-kentico-11">upgrade the project to Kentico 11</a>.</p>
<p>The output file lists all occurrences of invalid custom code, including:</p>
<ul class=" "><li class=" "><p>The path of the affected file and line number</p>
</li><li class=" "><p>The exact source code of the expression</p>
</li><li class=" "><p>A set of instructions on how to resolve the issue</p>
</li></ul><p>If you generated automatic conversions for your code, use the following approaches to insert the new code into your upgraded project:</p>
<ul class=" "><li class=" "><p><strong class=" ">Customized Kentico files</strong> – use a code comparison tool and merge the Kentico 11 files with the matching files in the <i class=" ">Converted</i> output folder.</p>
</li><li class=" "><p><strong class=" ">Fully custom files</strong> – directly replace the files using the converted files created by the tool.</p>
</li></ul>    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Tip</strong>: To update the code of virtual objects, enable <a href="deployment-mode-for-virtual-objects">Deployment mode</a>. You can then fix the code in the corresponding physical files, which match the output of the code upgrade tool. Disable deployment mode to return the updated virtual objects back into the database.</p>
        </div>
    </div>
<p><strong class=" "><br></strong></p>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>