<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Generating image variants - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68880830">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68880830"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Developing-websites.html">Developing websites</a></li>
                                                                                     <li><a href="Managing-responsive-images.html">Managing responsive images</a></li>
                                                            </ul>
</div>            <h1 id="src-68880830"> <span>Generating image variants</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-section"><div class="sp-grid-cell sp-grid-60"><div class="sp-grid-section"></div></div><div class="sp-grid-cell sp-grid-60"><p>Image variants are user-defined versions of <a href="page-attachments">page attachments</a>. They allow you to create a set of images that can differ in size, color, image quality, and other aspects of your choice.</p><p>Before you can use image variants, you need to <a href="defining-image-variants">define the image variants</a> in code by using custom <a href="defining-image-filters">filters</a>. Once defined, you can generate the image variants manually or, in certain cases, the system can generate them for you. The image variants can be generated for <a href="creating-grouped-page-attachments">grouped</a>, <a href="page-attachments">unsorted</a>, and <i class=" ">File</i> field attachments.</p><p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68880830/viewing_image_variants.png" alt="images/download/attachments/68880830/viewing_image_variants.png" width="500">
    </p><div class="sp-grid-section"></div><div class="sp-grid-section"></div></div><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880830_generatingimagevariants-automaticimagevariantgeneration">Automatic image variant generation</a></p>
</li><li class=" "><p><a href="#src-68880830_generatingimagevariants-handlingimagevariantsmanually">Handling image variants manually</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880830_generatingimagevariants-creatingnewimagevariantsforexistingpageattachments">Creating new image variants for existing page attachments</a></p>
</li><li class=" "><p><a href="#src-68880830_generatingimagevariants-updatingexistingimagevariants">Updating existing image variants</a></p>
</li><li class=" "><p><a href="#src-68880830_generatingimagevariants-deletingimagevariantswithoutvaliddefinition">Deleting image variants without valid definition</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div></div><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880830_generatingimagevariants-automaticimagevariantgeneration">Automatic image variant generation</a></p>
</li><li class=" "><p><a href="#src-68880830_generatingimagevariants-handlingimagevariantsmanually">Handling image variants manually</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68880830_generatingimagevariants-creatingnewimagevariantsforexistingpageattachments">Creating new image variants for existing page attachments</a></p>
</li><li class=" "><p><a href="#src-68880830_generatingimagevariants-updatingexistingimagevariants">Updating existing image variants</a></p>
</li><li class=" "><p><a href="#src-68880830_generatingimagevariants-deletingimagevariantswithoutvaliddefinition">Deleting image variants without valid definition</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div></div></div><div class="sp-grid-section"></div>


    
<p><strong class=" "><br></strong></p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Automatic image variant generation</span></h3>
<p>The system generates image variants automatically when you:</p>
<ul class=" "><li class=" "><p>Add new page attachments</p>
</li><li class=" "><p>Update existing page attachments</p>
</li></ul><p>Automatic generation of image variants applies only to image page attachments.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">WebDAV and image variants<br></strong></p>
<p>If you use <a href="webdav-browse-mode">WebDAV browse mode</a>, you can only see and manage page attachments, image variants are not visible. Based on <a href="defining-image-variants#src-68880833_definingimagevariants-limitingthescopeofimagevariantdefinitions">scope restrictions</a> configured for image variant definitions and the file location of the page attachments, image variants are created (or, if the page attachment is moved to a location for which no image variant definition is set up, deleted) automatically by Kentico.</p>
        </div>
    </div>
<p>By default, the system does NOT automatically generate image variants for page attachments that are added or updated via the following features:</p>
<ul class=" "><li class=" "><p><a href="integration-bus-overview">Integration bus</a></p>
</li><li class=" "><p><a href="kentico-import-toolkit">Import toolkit</a></p>
</li></ul>    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: If you have an image variant definition restricted to a certain path in the content tree, image variants can be generated for the attachments of pages in the set path. Copying and moving of these pages to a different location has no effect on the generated image variants, i.e., the image variants are not re-generated, deleted, or otherwise modified. The copied or moved page retains the original data even if there are different image variant definitions configured for the target location.</p>
        </div>
    </div>
<p>Depending on the performed action, you may need to <a href="#src-68880830_generatingimagevariants-updatingexistingimagevariants">re-generate</a> existing image variants or <a href="#src-68880830_generatingimagevariants-creatingnewimagevariantsforexistingpageattachments">generate new</a> ones manually via API.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Handling image variants manually</span></h3>
<p>    <span style="color: #000000;">
    </span>
The system does not perform any action when <a href="defining-image-variants">image variant definitions</a> change. These changes include the following:</p>
<ul class=" "><li class=" "><p>    <span style="color: #000000;">
    </span>
Adding a new image variant definition</p>
</li><li class=" "><p>Editing implementation of an existing image variant definition</p>
</li><li class=" "><p>Deleting an image variant definition</p>
</li></ul><p>    <span style="color: #000000;">
    </span>
In such cases, you need to handle the changes and their expected outcome (such as <a href="#src-68880830_safe-id-r2vuzxjhdgluz2ltywdldmfyawfudhmti0nyzwf0aw5nbmv3aw1hz2v2yxjpyw50c2zvcmv4axn0aw5ncgfnzwf0dgfjag1lbnrz">creating new</a>, <a href="#src-68880830_generatingimagevariants-updatingexistingimagevariants">re-generating</a>, or deleting image variants) in code via API.</p>
<p><span id="src-68880830_Generatingimagevariants-Codeexample"></span>For example, to perform create or update actions over the page attachments of pages on the <i class=" ">Dancing Goat</i> site, you can use the following code:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Iterates over all pages on the Dancing Goat site</code></div>
<div class="line"><code class="keyword">new</code><code class="plain"> DocumentQuery()</code></div>
<div class="line"><code class="plain">	.OnSite(</code><code class="string">"DancingGoat"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	.ForEachObject(page =&gt;</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		AttachmentInfoProvider.GetAttachments()</code></div>
<div class="line"><code class="plain">			.WhereEquals(</code><code class="string">"AttachmentDocumentID"</code><code class="plain">, page.DocumentID)</code></div>
<div class="line"><code class="plain">			.WhereStartsWith(</code><code class="string">"AttachmentMimeType"</code><code class="plain">, </code><code class="string">"image/"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">			.ExceptVariants()</code></div>
<div class="line"><code class="plain">			.ForEachObject(</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Create or update image variants of published page attachments</code></div>
<div class="line"><code class="plain">				...</code></div>
<div class="line"><code class="plain">			, 50);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">		AttachmentHistoryInfoProvider.GetAttachmentHistories()</code></div>
<div class="line"><code class="plain">			.WhereEquals(</code><code class="string">"AttachmentDocumentID"</code><code class="plain">, page.DocumentID)</code></div>
<div class="line"><code class="plain">			.WhereStartsWith(</code><code class="string">"AttachmentMimeType"</code><code class="plain">, </code><code class="string">"image/"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">			.ExceptVariants()</code></div>
<div class="line"><code class="plain">			.ForEachObject(</code></div>
<div class="line"><code class="plain">				</code><code class="comments">// Create or update image variants of versioned page attachments</code></div>
<div class="line"><code class="plain">				...</code></div>
<div class="line"><code class="plain">			, 50);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"> }, 100);</code></div>
</div>
    </div>
<p>In the <i class=" ">ForEachObject</i> extension method, you can work with attachments of pages to generate or re-generate image variants. The second parameter of the <i class=" ">ForEachObject</i> extension method states the number of objects that can be processed at a time. You can adjust the value to suit your scenario. Note that page context is not required for deleting image variants.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Pages under workflow</strong></p>
<p>When you make changes to image variants of page attachments, the current workflow step of pages is not modified.</p>
        </div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Creating new image variants for existing page attachments</span></h4>
<p>After adding an image variant definition, you need to generate new image variants for existing page attachments. To generate missing image variants, you can use the following code in the <i class=" ">ForEachObject</i> extension method from the <a href="#src-68880830_generatingimagevariants-codeexample">example</a>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Generates new image variants for attachments of pages</code></div>
<div class="line"><code class="plain">attachment =&gt; attachment.GenerateMissingVariants(</code><code class="keyword">new</code><code class="plain"> AttachmentVariantContext(page))</code></div>
</div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Updating existing image variants</span></h4>
<p>When you make changes to image variant definitions, the existing image variants are not re-generated automatically. To update the image variants, you can use the following code in the <i class=" ">ForEachObject</i> extension method from the <a href="#src-68880830_generatingimagevariants-codeexample">example</a>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Re-generates image variants for attachments of pages</code></div>
<div class="line"><code class="plain">attachment =&gt; attachment.GenerateAllVariants(</code><code class="keyword">new</code><code class="plain"> AttachmentVariantContext(page))</code></div>
</div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Deleting image variants without valid definition</span></h4>
<p>After deleting an image variant definition, you can use the following code to delete image variants that were associated with the definition:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Iterates over all published page attachments and deletes image variants with the specified definition</code></div>
<div class="line"><code class="plain">AttachmentInfoProvider.GetAttachments()</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Specify the identifier of the deleted image variant definition</code></div>
<div class="line"><code class="plain">    .WhereEquals(</code><code class="string">"AttachmentVariantDefinitionIdentifier"</code><code class="plain">, </code><code class="string">"DeletedImageVariantDefinitionIdentifier"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	.ForEachObject(imageVariant =&gt; imageVariant.Delete(), 50);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Iterates over all versioned page attachments and deletes image variants with the specified definition</code></div>
<div class="line"><code class="plain">AttachmentHistoryInfoProvider.GetAttachmentHistories()</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Specify the identifier of the deleted image variant definition</code></div>
<div class="line"><code class="plain">    .WhereEquals(</code><code class="string">"AttachmentVariantDefinitionIdentifier"</code><code class="plain">, </code><code class="string">"DeletedImageVariantDefinitionIdentifier"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	.ForEachObject(imageVariant =&gt; imageVariant.Delete(), 50);</code></div>
</div>
    </div>
<p><br></p>
<p>After creating the image variants for your attachments, you can <a href="defining-image-variants">display the image variants</a> on your pages.</p>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>