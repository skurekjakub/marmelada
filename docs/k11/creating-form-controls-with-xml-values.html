<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Creating form controls with XML values - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882188">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882188"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom-development.html">Custom development</a></li>
                                                                                     <li><a href="Developing-form-controls.html">Developing form controls</a></li>
                                                            </ul>
</div>            <h1 id="src-68882188"> <span>Creating form controls with XML values</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>When developing complex <a href="developing-form-controls">form controls</a> consisting of multiple input elements, you can use values in <a class="external-link" href="http://en.wikipedia.org/wiki/XML">XML</a> format to save the resulting data into form fields. XML allows you to store structured data that can be processed by APIs and is also readable by humans.</p><p>Kentico provides the following recommendations and API methods to help you correctly create form controls with XML values:</p><ul class=" "><li class=" "><p>When adding XML elements manually (for example via the <a class="external-link" href="https://msdn.microsoft.com/en-us/library/fw1ys7w6%28v=vs.100%29.aspx">XmlDocument.CreateElement</a>, <a class="external-link" href="https://msdn.microsoft.com/en-us/library/system.xml.xmlnode.appendchild%28v=vs.100%29.aspx">XmlElement.AppendChild</a> or <a class="external-link" href="https://msdn.microsoft.com/en-us/library/system.xml.xmlnode.prependchild%28v=vs.100%29.aspx">PrependChild</a> methods), make sure that the <i class=" "><strong class=" ">element order is always consistent</strong></i> in the resulting XML document.<br><br></p>
</li><li class=" "><p>To add attributes to elements, call the <strong class=" ">XmlElement.AddAttributes</strong> extension method, which ensures that all attributes are always in alphabetical order (based on the attribute names).<br><br></p>
</li><li class=" "><p>When creating child elements based on dynamic data, prepare an <i class=" ">IDictionary</i> collection containing the required values, and call the <strong class=" ">XmlElement.AddChildElements</strong> extension method. The method ensures that the child elements are ordered alphabetically based on their element names.<br><br></p>
</li><li class=" "><p>Call the <strong class=" ">XmlDocument.ToFormattedXmlString</strong> extension method on the resulting XML document to convert the XML data to a string that can be saved as the form control's value. The method provides whitespace formatting, including line breaking and indentation for each XML element.<br><br></p>
</li><li class=" "><p>Once the form control is developed and registered in the system, use the <strong class=" ">Long text</strong> data type for form fields where you plan to use the control.</p>
</li></ul><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: The <i class=" ">XmlElement.AddAttributes</i>, <i class=" ">XmlElement.AddChildElements</i> and <i class=" ">XmlDocument.ToFormattedXmlString</i> extension methods are provided within the <strong class=" ">CMS.Helpers</strong> library.</p>
        </div>
    </div><p>The steps above ensure that the XML data is formatted correctly and has consistent order. Consistency is important to allow easy comparison and change tracking in object data, particularly when objects containing fields with values provided by the form control are serialized (for example during <a href="exporting-objects">Export</a>, <a href="content-staging">Staging</a> or <a href="working-with-object-versioning">Object versioning</a>).</p><div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Other data formats</strong></p>
<p>If your form control saves its value in a different structured data format than XML (for example JSON), you need to ensure the consistency of the data manually.</p>
        </div>
    </div></div>

    

    
    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="developing-form-controls">Developing form controls</a></p>
</li><li class=" "><p><a href="example---developing-custom-form-controls">Example - Developing custom form controls</a></p>
</li></ul>        </div>
    </div></div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Example</span></h3>
<p>The following example demonstrates how to create a <a href="developing-form-controls">form control</a> that consists of multiple internal controls and saves the resulting data into an XML value. The sample control allows users to:</p>
<ul class=" "><li class=" "><p>Select an animal type from a list of predefined options</p>
</li><li class=" "><p>Enter a species name</p>
</li><li class=" "><p>Mark continents that the animal inhabits</p>
</li></ul>    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Form control implementation options</strong></p>
<p>This example implements the custom form control as a Web user control (.ascx file) within the Kentico web project. You can alternatively create form controls by adding a control class to a separate assembly (the class must also inherit from the <i class=" ">FormEngineUserControl</i> base class).</p>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: For the sake of simplicity, the example only provides the most basic implementation (without sufficient input validation, error handling, etc.).</p>
        </div>
    </div>
<ol class=" "><li class=" "><p>Open your web project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p>Right-click the <strong class=" ">CMSFormControls</strong> folder and choose <strong class=" ">Add -&gt; Add New Item</strong>.</p>
</li><li class=" "><p>Create a new <strong class=" ">Web User Control</strong>, for example named <i class=" ">CustomAnimals.ascx</i>.</p>
</li><li class=" "><p>Add the following input controls into the user control's markup:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">asp</code><code class="plain">:DropDownList </code><code class="color1">ID</code><code class="plain">=</code><code class="string">"drpAnimalType"</code><code class="plain"> </code><code class="color1">runat</code><code class="plain">=</code><code class="string">"server"</code><code class="plain">&gt;&lt;/</code><code class="keyword">asp</code><code class="plain">:DropDownList&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">asp</code><code class="plain">:TextBox </code><code class="color1">ID</code><code class="plain">=</code><code class="string">"txtSpecies"</code><code class="plain"> </code><code class="color1">runat</code><code class="plain">=</code><code class="string">"server"</code><code class="plain">&gt;&lt;/</code><code class="keyword">asp</code><code class="plain">:TextBox&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">asp</code><code class="plain">:CheckBoxList </code><code class="color1">ID</code><code class="plain">=</code><code class="string">"checkContinents"</code><code class="plain"> </code><code class="color1">runat</code><code class="plain">=</code><code class="string">"server"</code><code class="plain">&gt;&lt;/</code><code class="keyword">asp</code><code class="plain">:CheckBoxList&gt;</code></div>
</div>
    </div>
</li><li class=" "><p>Switch to the code behind, add the following <i class=" ">using</i> statements, and adjust the class declaration so that the control inherits from <strong class=" ">FormEngineUserControl</strong>:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> System.Collections.Generic;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> System.Web;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> System.Xml;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> System.Web.UI;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> System.Web.UI.WebControls;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.FormEngine.Web.UI;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Helpers;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">partial</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CMSFormControls_CustomAnimals : FormEngineUserControl</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Add the following members into the class:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Gets or sets the value of the field, in this case XML data stored in string format.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">object</code><code class="plain"> Value</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">get</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets XML data in string format based on the values of the internal controls</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">return</code><code class="plain"> GetXmlString();</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">set</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Gets the field's value as a string</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">string</code><code class="plain"> strValue = ValidationHelper.GetString(value, </code><code class="keyword">string</code><code class="plain">.Empty);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">		</code><code class="comments">// Sets up the drop-down and checkbox items of the control (occurs for new forms when attempting to set the default field value)</code></div>
<div class="line"><code class="plain">		EnsureItems();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">		</code><code class="keyword">if</code><code class="plain"> (!</code><code class="keyword">string</code><code class="plain">.IsNullOrEmpty(strValue))</code></div>
<div class="line"><code class="plain">		{</code></div>
<div class="line"><code class="plain">			</code><code class="comments">// Creates an XmlDocument based on the field's value</code></div>
<div class="line"><code class="plain">			XmlDocument xmlValue = </code><code class="keyword">new</code><code class="plain"> XmlDocument();</code></div>
<div class="line"><code class="plain">			xmlValue.LoadXml(strValue);  </code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">			</code><code class="comments">// Sets values for the internal controls based on the XML data</code></div>
<div class="line"><code class="plain">			SetValuesFromXml(xmlValue);</code></div>
<div class="line"><code class="plain">		}</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}    </code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Sets up the items of the internal drop-down list and checkboxes.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> EnsureItems()</code></div>
<div class="line"><code class="plain">{        </code></div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (drpAnimalType.Items.Count == 0)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		drpAnimalType.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Birds"</code><code class="plain">, </code><code class="string">"Birds"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		drpAnimalType.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Bees"</code><code class="plain">, </code><code class="string">"Bees"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		drpAnimalType.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Marsupials"</code><code class="plain">, </code><code class="string">"Marsupials"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (checkContinents.Items.Count == 0)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Africa"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"North America"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"South America"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Asia"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Europe"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Australia"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">		checkContinents.Items.Add(</code><code class="keyword">new</code><code class="plain"> ListItem(</code><code class="string">"Antarctica"</code><code class="plain">));</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Returns a string containing XML data based on the values of the internal controls.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">string</code><code class="plain"> GetXmlString()</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Creates a new XML document</code></div>
<div class="line"><code class="plain">	XmlDocument xmlDoc = </code><code class="keyword">new</code><code class="plain"> XmlDocument();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Creates an animal XML element</code></div>
<div class="line"><code class="plain">	XmlElement xmlAnimal = xmlDoc.CreateElement(</code><code class="string">"animal"</code><code class="plain">);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Prepares attributes for the animal element</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">var</code><code class="plain"> animalAttributes = </code><code class="keyword">new</code><code class="plain"> Dictionary&lt;</code><code class="keyword">string</code><code class="plain">, </code><code class="keyword">string</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		{</code><code class="string">"type"</code><code class="plain">, drpAnimalType.SelectedValue},</code></div>
<div class="line"><code class="plain">		{</code><code class="string">"species"</code><code class="plain">, txtSpecies.Text}</code></div>
<div class="line"><code class="plain">	};</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Adds the attributes to the animal element (ensures consistent alphabetical order)</code></div>
<div class="line"><code class="plain">	xmlAnimal.AddAttributes(animalAttributes);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Adds the animal element as the root of the XML document</code></div>
<div class="line"><code class="plain">	xmlDoc.AppendChild(xmlAnimal);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Prepares a dictionary of child elements</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">var</code><code class="plain"> continentElements = </code><code class="keyword">new</code><code class="plain"> Dictionary&lt;</code><code class="keyword">string</code><code class="plain">, </code><code class="keyword">bool</code><code class="plain">&gt;();</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">foreach</code><code class="plain"> (ListItem item </code><code class="keyword">in</code><code class="plain"> checkContinents.Items)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		continentElements.Add(item.Text.Replace(</code><code class="string">" "</code><code class="plain">, </code><code class="keyword">string</code><code class="plain">.Empty), item.Selected);</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Creates child elements under the animal element</code></div>
<div class="line"><code class="plain">	xmlAnimal.AddChildElements(continentElements);</code></div>
<div class="line"><code class="plain">        </code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Ensures line breaks and indentation formatting for the XML text, omits the XML declaration</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">return</code><code class="plain"> xmlDoc.ToFormattedXmlString(</code><code class="keyword">true</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">/// &lt;summary&gt;</code></div>
<div class="line"><code class="comments">/// Sets up the internal controls based on data from an XmlDocument.</code></div>
<div class="line"><code class="comments">/// &lt;/summary&gt;</code></div>
<div class="line"><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> SetValuesFromXml(XmlDocument xmlValue)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Sets the animal type value based on the type attribute of the animal element</code></div>
<div class="line"><code class="plain">	drpAnimalType.SelectedValue = System.Convert.ToString(xmlValue[</code><code class="string">"animal"</code><code class="plain">].Attributes[</code><code class="string">"type"</code><code class="plain">].Value);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Sets the species name based on the species attribute of the animal element (if it has a value)</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">if</code><code class="plain"> (xmlValue[</code><code class="string">"animal"</code><code class="plain">].HasAttribute(</code><code class="string">"species"</code><code class="plain">))</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		txtSpecies.Text = System.Convert.ToString(xmlValue[</code><code class="string">"animal"</code><code class="plain">].Attributes[</code><code class="string">"species"</code><code class="plain">].Value);</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	</code><code class="comments">// Sets the continent checkboxes based on the child elements under the animal element</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">foreach</code><code class="plain"> (ListItem item </code><code class="keyword">in</code><code class="plain"> checkContinents.Items)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		item.Selected = System.Convert.ToBoolean(xmlValue[</code><code class="string">"animal"</code><code class="plain">][item.Text.Replace(</code><code class="string">" "</code><code class="plain">, </code><code class="keyword">string</code><code class="plain">.Empty)].InnerText);</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li><li class=" "><p>Save the control's files. <strong class=" ">Build</strong> your project if it is installed as a web application.</p>
</li></ol><p>To register the form control in the system:</p>
<ol class=" "><li class=" "><p>Sign in to the Kentico administration interface.</p>
</li><li class=" "><p>Open the <strong class=" ">Form controls</strong> application.</p>
</li><li class=" "><p>Click <strong class=" ">New form control</strong>.</p>
</li><li class=" "><p>Enter the following values:</p>
<ul class=" "><li class=" "><p><strong class=" ">Control source</strong>: Web user control</p>
</li><li class=" "><p><strong class=" ">Display name</strong>: Animals XML</p>
</li><li class=" "><p><strong class=" ">Code name</strong>: Leave the <i class=" ">(automatic)</i> value</p>
</li><li class=" "><p><strong class=" ">File name</strong>: ~/CMSFormControls/CustomAnimals.ascx (you can click <strong class=" ">Select</strong> to choose the file)</p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p>On the <strong class=" ">General</strong> tab, set the <strong class=" ">Control scope</strong>:</p>
<ul class=" "><li class=" "><p>Use control for: <strong class=" ">Long text</strong></p>
</li><li class=" "><p>Show control in: Any required options</p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>You can now assign the form control to form fields with the <i class=" ">Long text</i> data type.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68882188/custom_xml_form_control.png" alt="images/download/attachments/68882188/custom_xml_form_control.png" height="150">
        <br><span class="caption">The custom animal form control as it appears inside an editing form</span>
    </p>
<p>The control saves the user input into XML data, and ensures consistent alphabetical order of attributes and child elements. For example, a field using the <i class=" ">Animals XML</i> control would have the following value for the input shown in the screenshot above:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">animal</code><code class="plain"> </code><code class="color1">species</code><code class="plain">=</code><code class="string">"Swallow"</code><code class="plain"> </code><code class="color1">type</code><code class="plain">=</code><code class="string">"Birds"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">Africa</code><code class="plain">&gt;True&lt;/</code><code class="keyword">Africa</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">Antarctica</code><code class="plain">&gt;False&lt;/</code><code class="keyword">Antarctica</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">Asia</code><code class="plain">&gt;True&lt;/</code><code class="keyword">Asia</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">Australia</code><code class="plain">&gt;True&lt;/</code><code class="keyword">Australia</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">Europe</code><code class="plain">&gt;True&lt;/</code><code class="keyword">Europe</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">NorthAmerica</code><code class="plain">&gt;True&lt;/</code><code class="keyword">NorthAmerica</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">SouthAmerica</code><code class="plain">&gt;True&lt;/</code><code class="keyword">SouthAmerica</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">animal</code><code class="plain">&gt;</code></div>
</div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>