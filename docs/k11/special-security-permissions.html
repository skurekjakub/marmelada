<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Special security permissions - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68881160">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881160"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Securing-websites.html">Securing websites</a></li>
                                                                                                         <li class="shortcut"><a href="Designing-secure-websites.html">Designing secure websites</a></li>
                                                                                     <li><a href="Configuring-permissions-securely.html">Configuring permissions securely</a></li>
                                                            </ul>
</div>            <h1 id="src-68881160"> <span>Special security permissions</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-section"><div class="sp-grid-cell sp-grid-60"></div><div class="sp-grid-cell sp-grid-60"></div></div><div class="sp-grid-section"></div><p>The purpose of special permissions in Kentico is to prevent <strong class=" ">privilege escalation </strong>attacks. In this type of attack, a lower privilege user can gain access to functions only available for higher privilege user. For example, editors with permissions to edit only content elevate themselves to the global administrator level.</p>
<p>The special permissions cover the following areas:</p>
<ul class=" "><li class=" "><p><a href="#src-68881160_specialsecuritypermissions-ascxcodeinlayouts">ASCX code in layouts</a></p>
</li><li class=" "><p><a href="#src-68881160_specialsecuritypermissions-sqlcodeinwebpartproperties">SQL code in web part properties</a></p>
</li><li class=" "><p><a href="#src-68881160_specialsecuritypermissions-sqlcodeinreports">SQL code in reports</a></p>
</li><li class=" "><p><a href="#src-68881160_specialsecuritypermissions-sqlcodeinformfields">SQL code in form fields</a></p>
</li><li class=" "><p><a href="#src-68881160_specialsecuritypermissions-sqlcodeintheadvancedexportdialog">SQL code in the advanced export dialog</a></p>
</li></ul>    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Only the users with the Global administrator <a href="user-management">privilege level </a>can configure these settings.</strong></p>
        </div>
    </div>
<p>Editors and other users<strong class=" "> cannot grant or remove these special permissions</strong>. Even if you assign users to a role which is allowed to modify permissions, these special permissions will be disabled, which is indicated by a warning icon (<img class="confluence-embedded-image" src="images/download/attachments/68879208/warning.png" alt="images/download/attachments/68879208/warning.png">
).</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68881160/Special_security_permissions2.png" alt="images/download/attachments/68881160/Special_security_permissions2.png" width="500">
        <br><span class="caption">Special permissions which can be granted only by global administrators</span>
    </p>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-ASCXcodeinlayouts">
        <h1 class="heading "><span>ASCX code in layouts</span></h1>
<p>The <strong class=" ">Edit ASCX code</strong> permission for the <strong class=" ">Design</strong> module allows users to edit ASPX/ASCX code of <a href="editing-page-layouts">page layouts</a>, <a href="writing-transformations">transformations</a> and <a href="defining-custom-form-layout">form layouts</a>.</p>
<p>When you grant the <i class=" ">Edit ASCX code</i> permission to a certain role, then users in that role can edit such code and run any inline code within the layout – for example, code that elevates privileges. Without the permission, users cannot do this.</p>
    </div>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-SQLcodeinwebpartproperties">
        <h1 class="heading "><span>SQL code in web part properties</span></h1>
<p>The <strong class=" ">Edit SQL code</strong> permission for the <strong class=" ">Design</strong> module allows users to edit the <strong class=" ">WHERE condition</strong>,<strong class=" "> ORDER BY</strong> and <strong class=" ">Columns</strong> properties of web parts with a data source (for example various repeaters). If you grant this permission to a role, users in that role can write SQL statements into the given properties without any restrictions.</p>
<p>Without the <strong class=" ">Edit SQL code</strong> permission, users can only write the following types of SQL syntax:</p>
    <div class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td class="confluenceTh" rowspan="1" colspan="1">
    <p>WHERE conditions</p>
            </td>
                <td class="confluenceTh" rowspan="1" colspan="1">
    <p>ORDER BY expressions</p>
            </td>
                <td class="confluenceTh" rowspan="1" colspan="1">
    <p>Columns expressions</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p>column names, values and basic operators: =, !=, &gt;, &lt;</p>
</li><li class=" "><p>AND &amp; OR operators, parentheses</p>
</li><li class=" "><p><i class=" ">column</i> BETWEEN <i class=" ">value</i> AND <i class=" ">value</i></p>
</li><li class=" "><p><i class=" ">column</i> LIKE <i class=" ">value</i></p>
</li><li class=" "><p><i class=" ">column</i> IN <i class=" ">(values)</i></p>
</li><li class=" "><p><i class=" ">column</i> IS NULL</p>
</li><li class=" "><p>NOT keyword for the above expressions (NOT BETWEEN, NOT LIKE, NOT IN, IS NOT NULL)</p>
</li></ul><p>For example: <i class=" ">UserID = 1</i></p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p>one or more column names (separated by commas)</p>
</li><li class=" "><p>the ASC and DESC keywords</p>
</li></ul><p>For example: <i class=" ">UserID</i></p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p>one or more column names (separated by commas)</p>
</li><li class=" "><p>SQL aliases for columns defined using the AS keyword (must be upper case)</p>
</li></ul><p>For example: <i class=" ">UserID, UserName</i></p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <div class="section section-2" id="src-68881160_Specialsecuritypermissions-SecuringSQLpropertiesofcustomwebparts">
        <h2 class="heading "><span>Securing SQL properties of custom web parts</span></h2>
<p>You also need to consider privilege escalation vulnerabilities when developing <a href="developing-web-parts">custom web parts</a> with properties that allow users to input SQL code (<i class=" ">Where conditions</i>, <i class=" ">Order by</i> clauses or lists of <i class=" ">Columns</i>). To avoid the problem, assign one of the following predefined <a href="assigning-form-controls-to-fields">form controls</a> to the fields representing the given web part properties (instead of using a standard text box):</p>
<ul class=" "><li class=" "><p><strong class=" ">Where condition</strong></p>
</li><li class=" "><p><strong class=" ">Order by</strong></p>
</li><li class=" "><p><strong class=" ">Columns</strong></p>
</li></ul><p>The form controls prevent privilege escalation by providing the restrictions described above for the SQL properties of the default Kentico web parts. Only users with the <strong class=" ">Global administrator</strong> <a href="user-management">privilege level</a> or the <strong class=" ">Edit SQL code</strong> permission for the <strong class=" ">Design</strong> module can edit the SQL code without restrictions.</p>
<p>For more information about defining web part properties, see: <a href="working-with-web-part-properties">Working with web part properties</a></p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Protecting web part properties against SQL injection</strong></p>
<p>The SQL properties of the default web parts also have a security mechanism that protects against <a href="sql-injection">SQL injection</a> attacks via <a href="macro-expressions">macros</a>. To learn how to provide this protection for custom web part properties, see <a href="macros-and-security#src-68881114_macrosandsecurity-sqlinjections">Macros and security - SQL injections</a>.</p>
        </div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-SQLcodeinreports">
        <h1 class="heading "><span>SQL code in reports</span></h1>
<p>When working with the <a href="working-with-system-reports">Reporting</a> application, users need to write SQL statements to get data from the database and display it in various reporting tools. This could also be dangerous because a user use SQL code to elevate privileges or get sensitive data from the database.</p>
<p>The <strong class=" ">Edit SQL Queries</strong> permission for the <strong class=" ">Reporting</strong> module indicates whether a given role can edit SQL queries in reports.</p>
<p>Alternatively, you can change the connection string for reports. With that, you can create a special user account on the database level with limited permissions. For example, the database user will not be able to execute any <strong class=" ">UPDATE/INSERT/DELETE</strong> queries.</p>
<p>Another approach could be to separate the data into multiple databases. The first database would contain only reporting data, and the second database all other data including users. Then, the reporting module would be able to work only with the reporting data (and the user would not be able to execute malicious queries). Of course, in this scenario, you need to prepare a mechanism that ensures data synchronization.</p>
    <div class="section section-2" id="src-68881160_Specialsecuritypermissions-Configuringmultipleconnectionstrings">
        <h2 class="heading "><span>Configuring multiple connection strings</span></h2>
<ol class=" "><li class=" "><p>Edit your web.config file and specify a new connection string in the <strong class=" ">&lt;connectionStrings&gt;</strong> section. The name attribute must be unique.</p>
</li><li class=" "><p>Go to <strong class=" ">Settings -&gt; Security &amp; Membership</strong>.</p>
</li><li class=" "><p>Select the new connection string as the <strong class=" ">Default report connection string</strong> in the <strong class=" ">Reporting</strong> category.</p>
</li><li class=" "><p>Open the <strong class=" ">Permissions</strong> application and configure the <strong class=" ">Set</strong> <strong class=" ">connection string</strong> permission of the Reporting module.</p>
<ul class=" "><li class=" "><p>Only users in a role with the permission and global administrators can change the connection string used by reports.<br></p>
</li></ul></li></ol>    </div>
    </div>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-SQLcodeinformfields">
        <h1 class="heading "><span>SQL code in form fields</span></h1>
<p>When defining the fields of <a href="forms">Forms</a>, certain types of fields (<a href="developing-form-controls">Form controls</a>) offer the possibility to load a list of options using an SQL query. Users are only allowed to write the code of these queries if they have the <strong class=" ">Global administrator</strong> <a href="user-management">privilege level</a> or belong to a role with the <strong class=" ">Edit SQL Queries</strong> permission for the <strong class=" ">Forms</strong> module.</p>
    </div>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-SQLcodeintheadvancedexportdialog">
        <h1 class="heading "><span>SQL code in the advanced export dialog</span></h1>
<p>When performing an <a href="exporting-data-from-the-ui---advanced-export">Advanced export</a> of data from a listing page in the administration interface, users with sufficient privileges have the option to modify the exported data using an SQL <strong class=" ">Where condition</strong> or <strong class=" ">Order by</strong> clause.</p>
<p>Writing SQL code in the advanced export dialog is only available for users who have the <strong class=" ">Global administrator</strong> <a href="user-management">privilege level</a> or belong to a role that has the <strong class=" ">Edit SQL code</strong> permission for the <strong class=" ">Design</strong> module.</p>
    </div>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-Allowingcodeeditingforsiteadministrators">
        <h1 class="heading "><span>Allowing code editing for site administrators</span></h1>
<p>You can choose whether users with the <strong class=" ">Administrator</strong> <a href="user-management">privilege level </a>are allowed to edit SQL and ASCX code by default, or if they need to have a role with the permissions mentioned on this page.</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Settings</strong> application.</p>
</li><li class=" "><p>Select the <strong class=" ">Security &amp; Membership</strong> category.</p>
</li><li class=" "><p>In the <strong class=" ">Administration</strong> section, set the <strong class=" ">Enable code editing for site administrators </strong>option.</p>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.<br></p>
</li></ol>    </div>
    <div class="section section-1" id="src-68881160_Specialsecuritypermissions-Conclusion">
        <h1 class="heading "><span>Conclusion</span></h1>
<p>From a security standpoint, the best practice is to:</p>
<ul class=" "><li class=" "><p>NOT grant any of the permissions listed on this page to any roles</p>
</li><li class=" "><p>Not allow site administrators to edit code</p>
</li></ul><p>If you do not follow this recommendation, you risk privilege escalation.</p>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>