<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Enumeration - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68881105">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881105"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Securing-websites.html">Securing websites</a></li>
                                                                                     <li><a href="Developing-secure-websites.html">Developing secure websites</a></li>
                                                            </ul>
</div>            <h1 id="src-68881105"> <span>Enumeration</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-section"><div class="sp-grid-cell sp-grid-60"><div class="sp-grid-section"></div></div><div class="sp-grid-cell sp-grid-60"><p>Enumeration, in terms of security, is a vulnerability, which enables a potential attacker to guess some hidden system information. There are many types of enumeration threats, but we will discuss only two of them in this topic:</p><ul class=" "><li class=" "><p><a href="#src-68881105_enumeration-usernameenumeration">Username enumeration</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-fileenumeration">File enumeration</a></p>
</li></ul><h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Username enumeration</span></h3><p>The username enumeration is an activity in which an attacker tries to retrieve valid usernames from a web application. The web applications are mostly vulnerable to this type of attack on login pages, registration form pages or password reset pages.</p><p>If the system is vulnerable to the username enumeration attack, the attacker may be able to obtain a list of existing usernames in the system by submitting input (valid and invalid user names) and analyzing the server response (error messages). The attacker can then run a dictionary attack to further exploit the obtained information.</p><p></p><div class="sp-grid-section"></div><div class="sp-grid-section"></div></div><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881105_enumeration-usernameenumeration">Username enumeration</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881105_enumeration-real-worldexampleofausernameenumerationattack">Real-world example of a username enumeration attack</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-exampleofawebapplicationusernameenumerationvulnerabilityinwebapplication">Example of a web application username enumeration vulnerability in web application</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-howtopreventusernameenumerationattacksinkentico">How to prevent username enumeration attacks in Kentico</a></p>
</li></ul></li><li class=" "><p><a href="#src-68881105_enumeration-fileenumeration">File enumeration</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-summary">Summary</a></p>
</li></ul><p></p>
        </div>
    </div></div><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881105_enumeration-usernameenumeration">Username enumeration</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881105_enumeration-real-worldexampleofausernameenumerationattack">Real-world example of a username enumeration attack</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-exampleofawebapplicationusernameenumerationvulnerabilityinwebapplication">Example of a web application username enumeration vulnerability in web application</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-howtopreventusernameenumerationattacksinkentico">How to prevent username enumeration attacks in Kentico</a></p>
</li></ul></li><li class=" "><p><a href="#src-68881105_enumeration-fileenumeration">File enumeration</a></p>
</li><li class=" "><p><a href="#src-68881105_enumeration-summary">Summary</a></p>
</li></ul><p></p>
        </div>
    </div></div></div><div class="sp-grid-section"></div>
    



    
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Real-world example of a username enumeration attack</span></h4>
<p>There was one well-known username enumeration vulnerability related to previous versions of Apache web server. Some distributions contained a misconfiguration, which enabled potential attackers to identify existing usernames.</p>
<p>When an attacker submits an HTTP request for a possible user's home page, <i class=" ">http://www.example.com/~&lt;username&gt;</i>, the server responses differently depending on whether the username exists or not:</p>
<ul class=" "><li class=" "><p>If the username exists and does not have a homepage, the server responses with     <span style="color: #000000;">
HTTP result code 403, and the server message "<i class=" ">You don't have permission to access /~username on this server.</i>"    </span>
</p>
</li><li class=" "><p>    <span style="color: #000000;">
If the username does not exist, the server responses with     <span style="color: #000000;">
HTTP result code 404 and the message "<i class=" ">The requested URL /~username was not found on this server.</i>"    </span>
    </span>
</p>
</li></ul><p>    <span style="color: #000000;">
    <span style="color: #000000;">
Because the server responses differently in these cases, the potential attacker can test and enumerate existing usernames. The attacker can then exploit this data for further attacks on the server.    </span>
    </span>
</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Example of a web application username enumeration vulnerability in web application</span></h4>
<p>    <span style="color: #000000;">
    <span style="color: #000000;">
When you create a web part in your web application, which enables users to log in, do not reveal information about existing usernames:<br>    </span>
    </span>
</p>
    <div class="confbox admonition admonition-warning has-no-icon">
                    <p class="title">Wrong</p>
                        <div class="admonition-body">
<p>If the submitted username is incorrect:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">Entered login does not exist.</code></div>
</div>
    </div>
<p>If the submitted username exists, but the password is incorrect:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">Entered password is incorrect.</code></div>
</div>
    </div>
        </div>
    </div>
<p>This way, the attacker can learn, which usernames exist in the system and which do not.</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>How to prevent username enumeration attacks in Kentico</span></h4>
<p>The default configuration of Kentico is protected against this type of attack.</p>
<p>If you plan to create a custom login web part, be sure to <strong class=" ">show only generic error messages</strong>:</p>
    <div class="confbox admonition admonition-tip has-no-icon">
                    <p class="title">Correct</p>
                        <div class="admonition-body">
<p>In both situations (username does not exist or the password is incorrect):</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">Authentication failed. </code></div>
</div>
    </div>
        </div>
    </div>
<p>This way, the attacker cannot distinguish between valid and invalid usernames.</p>
<p>In registration web parts, you cannot completely eliminate this vulnerability, because you have to check (and tell the user) if the submitted username already exists. Therefore, <strong class=" ">always include CAPTCHA </strong>in these web parts<strong class=" "> </strong>to prevent automatic collecting of the data by scripts.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>File enumeration</span></h3>
<p>In this type of enumeration attack, the attacker tries to guess the file names on the server and manage to gain access to them.</p>
<p>In Kentico, the attacker can for example try to guess the name of an export file. The export files are generally located in the <i class=" ">&lt;web project&gt;\CMSSiteUtils<strong class=" ">\</strong>Export</i> folder. The attacker can learn the structure of the file name and eventually guess an existing one (for example, by trying out different time stamps).</p>
<p>To protect your servers against this type of attack, <strong class=" ">forbid access to sensitive directories</strong> in the <i class=" ">web.config</i> file. See <a href="restricting-access-to-directories">Restricting access to directories</a>.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Summary</span></h3>
<ul class=" "><li class=" "><p>Do not reveal username and password details on your web pages (how long the username/password should be, which characters it should contain, etc.)</p>
</li><li class=" "><p>Show only generic error messages (<i class=" ">Login failed.</i> / <i class=" ">The combination of username and password is invalid.</i>) in custom login web parts.</p>
</li><li class=" "><p>Use CAPTCHA in registration forms.</p>
</li><li class=" "><p>Forbid access from the outside to directories, whose names could be guessed by potential attackers.</p>
</li></ul>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>