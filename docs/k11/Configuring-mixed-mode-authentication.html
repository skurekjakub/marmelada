<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Configuring mixed-mode authentication - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68880381"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Managing-users.html">Managing users</a></li>
                                                                                                         <li class="shortcut"><a href="User-registration-and-authentication.html">User registration and authentication</a></li>
                                                                                     <li><a href="Configuring-Windows-AD-authentication.html">Configuring Windows AD authentication</a></li>
                                                            </ul>
</div>            <h1 id="src-68880381"> <span>Configuring mixed-mode authentication</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"></div><p>Mixed mode authentication enables users to sign in to your website using both <a href="configuring-windows-ad-authentication">Windows Active Directory authentication</a> and standard <a href="configuring-forms-authentication">forms authentication</a>.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Forms and AD user name conflicts</strong></p>
<p>Active Directory users cannot authenticate if an existing forms user has the same user name (only the <i class=" ">common name</i> of the AD user is processed, i.e. without the domain component). In these cases, the system cannot create an account for the AD user. You can avoid these conflicts by renaming the existing forms user.</p>
        </div>
    </div>
<p>When a user signs in using Active Directory credentials for the first time, the system automatically creates a matching user account in the Kentico database and also imports the user's domain groups as roles. The imported roles do <i class=" "><strong class=" ">not</strong></i> authorize the users to perform any actions in Kentico by default. You need to configure <a href="configuring-permissions">permissions</a> and <a href="ui-personalization">UI personalization</a> settings for the imported roles manually if you wish to use them.</p>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Disabling the automatic role import</strong></p>
<p>If you wish to disable the automatic import of user domain groups as roles in Kentico, add the following key to the <i class=" ">/configuration/appSettings</i> section of your project's web.config file:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSImportWindowsRoles"</code><code class="plain"> value=</code><code class="string">"false"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
        </div>
    </div>
    <div class="section section-1" id="src-68880381_Configuringmixedmodeauthentication-Prerequisites">
        <h1 class="heading "><span>Prerequisites</span></h1>
<p>For mixed mode authentication to work, the application must be able to access the following attributes of user objects in Active Directory (i.e. the attributes cannot be protected or confidential):</p>
<ul class=" "><li class=" "><p><strong class=" ">memberof</strong></p>
</li><li class=" "><p><strong class=" ">userAccountControl</strong></p>
</li></ul>    </div>
    <div class="section section-1" id="src-68880381_Configuringmixedmodeauthentication-Configuringmixedauthentication">
        <h1 class="heading "><span>Configuring mixed authentication</span></h1>
<p>To enable mixed authentication mode:</p>
<ol class=" "><li class=" "><p>Edit your application's <i class=" ">web.config</i> file.</p>
</li><li class=" "><p>Make sure that the <strong class=" ">mode</strong> attribute of the <strong class=" ">&lt;authentication&gt;</strong> element in the <i class=" ">&lt;system.web&gt;</i> section is set to <strong class=" ">Forms</strong> (this is the default value for Kentico projects):</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;authentication mode=</code><code class="string">"Forms"</code><code class="plain">&gt;</code></div>
</div>
    </div>
</li><li class=" "><p>Add the LDAP connection string of your Active Directory service into the <strong class=" ">configuration/connectionStrings</strong> section:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;connectionStrings&gt;</code></div>
<div class="line"><code class="plain">  ...</code></div>
<div class="line"><code class="plain">  &lt;add name=</code><code class="string">"CMSADConnectionString"</code><code class="plain"> connectionString=</code><code class="string">"&lt;LDAP connection string&gt;"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">&lt;/connectionStrings&gt;</code></div>
</div>
    </div>
<p><br></p>
<ul class=" "><li class=" "><p>Replace the <i class=" ">&lt;LDAP connection string&gt;</i> text in the code above with the actual connection string. Enter it according to the following format:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&nbsp;LDAP:</code><code class="comments">//mydomain.example.com/DC=mydomain,DC=example,DC=com</code></div>
</div>
    </div>
<p>The first part is the full domain. In the second part, the same domain is divided into DC (domain component) units.<br><br></p>
</li></ul></li><li class=" "><p>Modify the <strong class=" ">membership</strong> and <strong class=" ">roleManager</strong> elements under the <strong class=" ">configuration/system.web</strong> section according to the following:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;membership defaultProvider=</code><code class="string">"CMSProvider"</code><code class="plain"> userIsOnlineTimeWindow=</code><code class="string">"30"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;providers&gt;</code></div>
<div class="line"><code class="plain">    &lt;clear/&gt;</code></div>
<div class="line"><code class="plain">	 &lt;add name=</code><code class="string">"CMSProvider"</code><code class="plain"> type=</code><code class="string">"CMS.MembershipProvider.CMSMembershipProvider, CMS.MembershipProvider"</code><code class="plain"> connectionStringName=</code><code class="string">"CMSConnectionString"</code><code class="plain"> enablePasswordRetrieval=</code><code class="string">"false"</code><code class="plain"> enablePasswordReset=</code><code class="string">"true"</code><code class="plain"> requiresQuestionAndAnswer=</code><code class="string">"false"</code><code class="plain"> requiresUniqueEmail=</code><code class="string">"true"</code><code class="plain"> passwordFormat=</code><code class="string">"Hashed"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;add name=</code><code class="string">"CMSADProvider"</code><code class="plain"> type=</code><code class="string">"CMS.MembershipProvider.CMSADMembershipProvider, CMS.MembershipProvider"</code><code class="plain"> connectionStringName=</code><code class="string">"CMSADConnectionString"</code><code class="plain"> connectionUsername=</code><code class="string">"username"</code><code class="plain"> connectionPassword=</code><code class="string">"password"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">  &lt;/providers&gt;</code></div>
<div class="line"><code class="plain">&lt;/membership&gt;</code></div>
</div>
    </div>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;roleManager defaultProvider=</code><code class="string">"CMSRoleProvider"</code><code class="plain"> enabled=</code><code class="string">"true"</code><code class="plain"> cacheRolesInCookie=</code><code class="string">"true"</code><code class="plain"> cookieName=</code><code class="string">".ASPROLES"</code><code class="plain"> cookieTimeout=</code><code class="string">"30"</code><code class="plain"> cookiePath=</code><code class="string">"/"</code><code class="plain"> cookieRequireSSL=</code><code class="string">"false"</code><code class="plain"> cookieSlidingExpiration=</code><code class="string">"true"</code><code class="plain"> cookieProtection=</code><code class="string">"All"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;providers&gt;</code></div>
<div class="line"><code class="plain">    &lt;clear/&gt;</code></div>
<div class="line"><code class="plain">	 &lt;add name=</code><code class="string">"CMSRoleProvider"</code><code class="plain"> type=</code><code class="string">"CMS.MembershipProvider.CMSRoleProvider, CMS.MembershipProvider"</code><code class="plain"> connectionStringName=</code><code class="string">"CMSConnectionString"</code><code class="plain"> applicationName=</code><code class="string">"SampleApplication"</code><code class="plain"> writeExceptionsToEventLog=</code><code class="string">"false"</code><code class="plain">/&gt;    </code></div>
<div class="line"><code class="plain">	 &lt;add name=</code><code class="string">"CMSADRoleProvider"</code><code class="plain"> type=</code><code class="string">"CMS.MembershipProvider.CMSADRoleProvider, CMS.MembershipProvider"</code><code class="plain"> connectionStringName=</code><code class="string">"CMSADConnectionString"</code><code class="plain"> connectionUsername=</code><code class="string">"username"</code><code class="plain"> connectionPassword=</code><code class="string">"password"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">  &lt;/providers&gt;</code></div>
<div class="line"><code class="plain">&lt;/roleManager&gt;</code></div>
</div>
    </div>
<ul class=" "><li class=" "><p>Replace the following values:</p>
<ul class=" "><li class=" "><p><strong class=" ">username</strong> – the user name of an Active Directory account that has read permissions for the required users and groups in your domain. Must include the fully qualified domain name, for example: <strong class=" "><i class=" ">office.example.com\johns</i></strong></p>
</li><li class=" "><p><strong class=" ">password</strong> – the Active Directory password for the specified account</p>
</li></ul></li></ul></li></ol><p>Users can now sign in with their Active Directory user name (without the domain) and password, or their standard Kentico user name and password.</p>
<p>You can also allow users to sign in using their full Active Directory user name (e.g. <i class=" ">MyName@office.example.com</i>) by adding the following key to the <i class=" ">appSettings</i> section of your <i class=" ">web.config</i> file:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSADDefaultMapUserName"</code><code class="plain"> value=</code><code class="string">"userPrincipalName"</code><code class="plain"> /&gt;&nbsp;</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Password features not supported for Active Directory users</strong></p>
<p>The passwords of Active Directory users are stored externally and are not managed by Kentico. For these users, the system does not support any features related to password changes or requirements (for example <a href="forgotten-password">Password reset</a>, <a href="password-expiration">Password expiration</a>, <a href="password-strength-policy-and-its-enforcement">Password policies</a>).</p>
        </div>
    </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>