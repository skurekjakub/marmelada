<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Using the Kentico API externally - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882884">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882884"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                     <li><a href="Integrating-3rd-party-systems.html">Integrating 3rd party systems</a></li>
                                                            </ul>
</div>            <h1 id="src-68882884"> <span>Using the Kentico API externally</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>This page describes how to configure external ASP.NET applications so that they support the Kentico API. Using Kentico functionality externally allows you to create scenarios such as:</p><ul class=" "><li class=" "><p>Separate applications integrated with your main Kentico website</p>
</li><li class=" "><p>Custom websites or applications that use Kentico as a content repository</p>
</li></ul><p>Start Visual Studio and open your external application's project. You need to perform the following steps:</p><ol class=" "><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-connectingtothekenticodatabase">Connect to the Kentico database</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-integratingkenticoapilibraries">Integrate the Kentico API libraries</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-initializingthekenticoapplication">Initialize the Kentico application</a></p>
</li></ol><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">License requirements</strong></p>
<p>The Kentico API performs license checks even when running in an external application. For applications that run under a different domain than your main Kentico site (web applications, WCF services, etc.), you need to have a valid <a href="managing-site-licenses">license</a> for the given domain.</p>
<p>Add the license via the administration interface of the connected Kentico application â€“ the license is available through the shared database.</p>
        </div>
    </div></div>

    
    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-connectingtothekenticodatabase">Connecting to the Kentico database</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-integratingkenticoapilibraries">Integrating Kentico API libraries</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-initializingthekenticoapplication">Initializing the Kentico application</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-additionalconfigurationandtips">Additional configuration and tips</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-sharingprojectfileswiththekenticoapplication">Sharing project files with the Kentico application</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-workingwiththeusercontext">Working with the user context</a></p>
</li><li class=" "><p><a href="#src-68882884_usingthekenticoapiexternally-disablingthekenticovirtualpathprovider">Disabling the Kentico Virtual path provider</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="displaying-kentico-content-in-external-applications">Displaying Kentico content in external applications</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Connecting to the Kentico database</span></h3>
<p>To be able to access the Kentico database, you need to specify the appropriate connection string in your application's <strong class=" ">web.config</strong> or <strong class=" ">app.config</strong> file.</p>
<p>Add the connection string into the <i class=" ">configuration/connectionStrings</i> section using an <i class=" ">&lt;add&gt;</i> element named <strong class=" ">CMSConnectionString</strong>.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&nbsp;&lt;configuration&gt;</code></div>
<div class="line"><code class="plain">  &lt;connectionStrings&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    ...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">    &lt;add name=</code><code class="string">"CMSConnectionString"</code><code class="plain"> connectionString=</code><code class="string">"Persist Security Info=False;database=Kentico;server=myserver;user id=username;password=mypassword;Current Language=English;Connection Timeout=120;"</code><code class="plain"> /&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">  &lt;/connectionStrings&gt;</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Tip</strong>: We recommend copying the exact connection string from the web.config file of your Kentico web project.</p>
        </div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Integrating Kentico API libraries</span></h3>
<p>Before you can use Kentico functionality in your application, you need to add the libraries containing the required code:</p>
<ol class=" "><li class=" "><p>Right-click your application's project in the Visual Studio <strong class=" ">Solution Explorer</strong> and select <strong class=" ">Manage NuGet Packages</strong>.</p>
</li><li class=" "><p>Search for the <a class="external-link" href="https://www.nuget.org/packages/Kentico.Libraries"><strong class=" ">Kentico.Libraries</strong></a> package.</p>
</li><li class=" "><p>Install the <i class=" ">Kentico.Libraries</i> version that matches the version of the connected Kentico database.</p>
</li><li class=" "><p>(Optional) If you wish to use Kentico controls or web form API in external web applications, you need to install the <strong class=" ">Kentico.Libraries.Web.UI</strong> package.</p>
</li></ol>    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Maintaining Kentico.Libraries</strong></p>
<p>If you <a href="upgrading-and-hotfixing-an-instance">upgrade or hotfix</a> the related Kentico project and its database to a newer version, you also need to update the Kentico NuGet packages to a matching version in your external application.</p>
        </div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Initializing the Kentico application</span></h3>
<p>You need to initialize Kentico before making calls to its API from an external project.</p>
<p><strong class=" ">Web applications</strong></p>
<ol class=" "><li class=" "><p>Edit your application's <a class="external-link" href="http://msdn.microsoft.com/en-us/library/1xaas8a2%28v=vs.71%29.aspx">Global.asax</a> file (create the file if necessary).</p>
</li><li class=" "><p>Execute the <strong class=" ">CMSApplication.Init</strong> method in the <strong class=" ">Application_BeginRequest</strong> method:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">void</code><code class="plain"> Application_BeginRequest(</code><code class="keyword">object</code><code class="plain"> sender, EventArgs e)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	CMS.DataEngine.CMSApplication.Init();</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
</li></ol><p>If you wish to load and display content from the Kentico database in an external web application, you need to perform additional steps. See <a href="displaying-kentico-content-in-external-applications">Displaying Kentico content in external applications</a>.</p>
<p><strong class=" ">Non-web applications (for example Console applications)</strong></p>
<ol class=" "><li class=" "><p>Edit your application's <strong class=" ">Main</strong> method.</p>
</li><li class=" "><p>Execute the <strong class=" ">CMSApplication.Init</strong> method at any point before the first call of the Kentico API.</p>
</li></ol><p>You can now use the Kentico API in your external application. The Kentico API allows you to perform any action available in the standard administration interface.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Using custom code that requires discovery</strong></p>
<p>For external projects that compile into a different output type than a DLL assembly (for example Console applications), do NOT directly add any custom classes that need to be detected during the API initialization. This includes classes registered using attributes, such as generated wrapper classes for objects, <a href="creating-custom-modules">custom module classes</a>, custom implementations of interfaces or providers, etc. The system is only able to discover such code within assemblies.</p>
<p>Instead, add the code into a <i class=" ">Class Library</i> project with the <i class=" ">AssemblyDiscoverable</i> attribute and reference the assembly from your project.</p>
        </div>
    </div>
<p><strong class=" ">WCF services</strong></p>
<p>If implementing custom WCF services within the Kentico web project, you need to initialize the Kentico application before calling the Kentico API within the service code.</p>
<p>Otherwise you may encounter errors if the first request that starts the application is destined for the WCF service. The standard initialization does not occur, because WCF requests are not processed by the ASP.NET HTTP runtime. For more information, see the <a class="external-link" href="https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/wcf-services-and-aspnet">WCF Services and ASP.NET</a> article.</p>
<p>For example, you can execute the <strong class=" ">CMSApplication.Init</strong> method within the constructor of your WCF service class.</p>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Additional configuration and tips</span></h3>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Sharing project files with the Kentico application</span></h4>
<p>If you need to call API that works with a specific folder in the Kentico project, you can map the physical path used by the Kentico API in your external application to a specific Kentico project. For example, you can use this approach if you wish to externally update or rebuild the files of <a href="using-locally-stored-search-indexes">locally stored search indexes</a>.</p>
<p>Set the <strong class=" ">SystemContext.WebApplicationPhysicalPath</strong> property to the path of your Kentico project's <strong class=" ">CMS</strong> folder. Map the path <i class=" ">before</i> you initialize the Kentico API (i.e. call <i class=" ">CMSApplication.Init</i>), for example in the <strong class=" ">Application_Start</strong> method of <i class=" ">Global.asax,</i> or in your application's <strong class=" ">Main</strong> method.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments">// Maps the physical path used by the Kentico API in the external application to the folder of the connected Kentico project</code></div>
<div class="line"><code class="plain">CMS.Base.SystemContext.WebApplicationPhysicalPath = </code><code class="string">"C:\\inetpub\\wwwroot\\Kentico\\CMS"</code><code class="plain">;</code></div>
</div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Working with the user context</span></h4>
<p>When working with the Kentico API in an external application, the default Kentico user context is not available. The standard API for getting the current user (<i class=" "><strong class=" ">CMS.Membership.MembershipContext.AuthenticatedUser</strong></i>) always returns the "public" user when called externally.</p>
<p>To use API that relies on the context of a specific user, enclose the code into a <strong class=" ">using</strong> statement with a declared <strong class=" ">CMSActionContext</strong> instance and the appropriate <i class=" ">UserInfo</i> object as a parameter.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Base;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Membership;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.EventLog;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Gets an object representing a specific Kentico user</code></div>
<div class="line"><code class="plain">UserInfo user = UserInfoProvider.GetUserInfo(</code><code class="string">"Andy"</code><code class="plain">);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Sets the context of the user</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> (</code><code class="keyword">new</code><code class="plain"> CMSActionContext(user))</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Logs an information event into the Kentico event log, with "Andy" as the user who caused the event</code></div>
<div class="line"><code class="plain">	EventLogProvider.LogEvent(EventType.INFORMATION, </code><code class="string">"External Application"</code><code class="plain">, </code><code class="string">"Event_Code"</code><code class="plain">, </code><code class="string">"Details"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Disabling the Kentico Virtual path provider</span></h4>
<p>If you have the <strong class=" ">Kentico.Libraries.Web.UI</strong> package installed, Kentico uses a <a class="external-link" href="https://msdn.microsoft.com/en-us/library/bhesyfec.aspx">virtual path provider</a> to load virtual objects, such as ASCX <a href="writing-transformations">transformations</a> or <a href="editing-page-layouts">page layouts</a>, from the database. When using the Kentico API externally in web applications, you may wish to disable the virtual path provider for the following reasons:</p>
<ul class=" "><li class=" "><p>To avoid conflicts if your application has its own virtual path provider implementation</p>
</li><li class=" "><p>If your external application does not use Kentico virtual objects at all (disabling the virtual path provider reduces overhead)</p>
</li></ul><p>To disable the Kentico virtual path provider:</p>
<ol class=" "><li class=" "><p>Edit your external application's <strong class=" ">web.config</strong> or <strong class=" ">app.config</strong> file.</p>
</li><li class=" "><p>Add the <strong class=" ">&lt;appSettings&gt;</strong> element under the <i class=" ">&lt;configuration&gt;</i> section.</p>
</li><li class=" "><p>Add the <strong class=" ">CMSUseVirtualPathProvider</strong> key and set the value to <i class=" ">false.</i></p>
</li></ol>    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">configuration</code><code class="plain">&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">	&lt;</code><code class="keyword">appSettings</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">		&lt;</code><code class="keyword">add</code><code class="plain"> </code><code class="color1">key</code><code class="plain">=</code><code class="string">"CMSUseVirtualPathProvider"</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"false"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">	&lt;/</code><code class="keyword">appSettings</code><code class="plain">&gt;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">configuration</code><code class="plain">&gt;</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: Without the virtual path provider, you cannot use ASCX transformations (or other Kentico virtual objects) to display data in external web applications. See <a href="displaying-kentico-content-in-external-applications">Displaying Kentico content in external applications</a> for more information and workarounds.</p>
        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>