<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Serializing objects to XML using the API - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882144"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom-development.html">Custom development</a></li>
                                                                                     <li><a href="Miscellaneous-custom-development-tasks.html">Miscellaneous custom development tasks</a></li>
                                                            </ul>
</div>            <h1 id="src-68882144"> <span>Serializing objects to XML using the API</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"><p>The Kentico API provides a way to <a class="external-link" href="http://en.wikipedia.org/wiki/Serialization">serialize</a> many types of objects from the database into XML data. You can use the serialized data to synchronize objects between multiple development instances, in combination with a custom source control system or continuous integration solution. The system ensures that the XML data of matching objects is always identical and consistent (including element and attribute order), even when serialized on different instances of Kentico.</p><p>Serialization is supported for the object types listed on the <a href="object-types-supported-by-continuous-integration">Object types supported by continuous integration</a> page.</p><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: Only use the serialization API when implementing a custom synchronization solution. If you are using the default <a href="setting-up-continuous-integration">Kentico continuous integration solution</a>, you do not need to write any custom code.</p>
        </div>
    </div><h3 id="src-68882144_SerializingobjectstoXMLusingtheAPI-GettingtheserializedXMLdataforobjects" class="heading "><span>Getting the serialized XML data for objects</span></h3><p>To get the serialized XML data of Kentico objects:</p><ol class=" "><li class=" "><p>Prepare a <i class=" ">BaseInfo (WebPartInfo, PageTemplateInfo</i> etc.) instance representing the object.</p>
</li><li class=" "><p>Call the <strong class=" ">Serialize</strong> extension method of the <i class=" ">BaseInfo</i> object (provided within the <strong class=" ">CMS.DataEngine.Serialization</strong> library).</p>
</li></ol><p>The <i class=" ">Serialize</i> method returns an <a class="external-link" href="https://msdn.microsoft.com/en-us/library/system.xml.xmlelement%28v=vs.100%29.aspx">XmlElement</a>.</p><div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example - Serializing a web part</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example - Serializing a web part" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System.Xml;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine.Serialization;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.PortalEngine;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Gets a web part object                </code></div>
<div class="line"><code class="plain">WebPartInfo webPartObject = WebPartInfoProvider.GetWebPartInfo(</code><code class="string">"repeater"</code><code class="plain">);</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Creates an XmlElement containing the serialized data of the object</code></div>
<div class="line"><code class="plain">XmlElement objectElement = webPartObject.Serialize();</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Gets the serialized object data as an XmlDocument</code></div>
<div class="line"><code class="plain">XmlDocument xmlDoc = objectElement.OwnerDocument;</code></div>
</div>
    </div></div>

    
    


    
    <div class="section-right"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882144_serializingobjectstoxmlusingtheapi-gettingtheserializedxmldataforobjects">Getting the serialized XML data for objects</a></p>
</li><li class=" "><p><a href="#src-68882144_serializingobjectstoxmlusingtheapi-deserializingxmldataintoobjects">Deserializing XML data into objects</a></p>
</li><li class=" "><p><a href="#src-68882144_serializingobjectstoxmlusingtheapi-serializingallobjectstothefilesystem">Serializing all objects to the file system</a></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882144_serializingobjectstoxmlusingtheapi-restoringobjectsfromthefilesystem">Restoring objects from the file system</a></p>
</li></ul></li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="setting-up-continuous-integration">Setting up continuous integration</a></p>
</li><li class=" "><p><a href="continuous-integration-repository-structure">Continuous integration repository structure</a></p>
</li><li class=" "><p><a href="database-table-api">Database table API</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 id="src-68882144_SerializingobjectstoXMLusingtheAPI-DeserializingXMLdataintoobjects" class="heading "><span>Deserializing XML data into objects</span></h3>
<p>The API provides a way to deserialize XML data back into Kentico objects:</p>
<ol class=" "><li class=" "><p>Read the XML data as an <a class="external-link" href="https://msdn.microsoft.com/en-us/library/system.xml.xmldocument%28v=vs.100%29.aspx">XmlDocument</a> from the file system (or another source).</p>
</li><li class=" "><p>Get the <a class="external-link" href="https://msdn.microsoft.com/en-us/library/system.xml.xmlelement%28v=vs.100%29.aspx">XmlElement</a> representing the given object from the <i class=" ">XmlDocument</i> (typically the root element).</p>
</li><li class=" "><p>Call the <strong class=" ">Deserialize</strong> extension method of the <i class=" ">XmlElement</i> (provided within the <strong class=" ">CMS.DataEngine.Serialization</strong> library).</p>
</li></ol><p>The <i class=" ">Deserialize</i> method returns a <strong class=" ">DeserializationResult</strong> object, which you can convert to a specific Info object type <i class=" ">(WebPartInfo, PageTemplateInfo,</i> etc.) or a general <i class=" ">BaseInfo.</i> You can then work with the <i class=" ">Info</i> object in any way. For example, use the corresponding <i class=" ">InfoProvider</i> class to save the deserialized object into the application's database.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example - Deserializing a web part</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example - Deserializing a web part" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> System.Xml;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine.Serialization;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.PortalEngine;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Prepare an XmlDocument containing the serialized data of a web part</code></div>
<div class="line"><code class="plain">XmlDocument xmlDoc = ... ;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Gets the root XmlElement of the XmlDocument</code></div>
<div class="line"><code class="plain">XmlElement xmlElement = xmlDoc.DocumentElement;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Deserializes the XML data into a WebPartInfo object</code></div>
<div class="line"><code class="plain">DeserializationResult result = xmlElement.Deserialize();</code></div>
<div class="line"><code class="plain">WebPartInfo webPart = (WebPartInfo)result;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Saves the deserialized web part into the database</code></div>
<div class="line"><code class="plain">WebPartInfoProvider.SetWebPartInfo(webPart);</code></div>
</div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">IDs of deserialized objects</strong></p>
<p>When deserializing XML data, the system automatically checks whether the given object already exists in the database (based on the code name or GUID values). If yes, the <i class=" ">Deserialize</i> method sets the appropriate object ID when creating the <i class=" ">DeserializationResult</i>. Saving the deserialized object into the database then updates the existing object instead of creating a new one.</p>
        </div>
    </div>
    <h3 id="src-68882144_SerializingobjectstoXMLusingtheAPI-Serializingallobjectstothefilesystem" class="heading "><span>Serializing all objects to the file system</span></h3>
<p>You can call the API of the <a href="setting-up-continuous-integration">Kentico continuous integration solution</a> to serialize all objects of the supported types directly to the file system.</p>
<p>Call the <strong class=" ">StoreAll</strong> static method of the <strong class=" ">CMS.ContinuousIntegration.FileSystemRepositoryManager</strong> class. The method returns a <strong class=" ">RepositoryActionResult</strong> object, which you can use to verify the success of the operation and process any errors that occurred.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: The <i class=" ">StoreAll</i> method may have a long run time, depending on the number of objects in your database.</p>
        </div>
    </div>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.ContinuousIntegration;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Serializes all supported objects to the file system</code></div>
<div class="line"><code class="plain">RepositoryActionResult result = FileSystemRepositoryManager.StoreAll((logItem) =&gt;</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Optionally create a progress log by processing the 'logItem.Message' strings </code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Checks whether the serialization process was successful</code></div>
<div class="line"><code class="keyword">if</code><code class="plain"> (!result.Success)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">foreach</code><code class="plain"> (</code><code class="keyword">string</code><code class="plain"> error </code><code class="keyword">in</code><code class="plain"> result.Errors)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Display or log the errors</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
<p>The <i class=" ">StoreAll</i> method creates XML files containing the serialized data of objects in the project's <strong class=" ">CMS\App_Data\CIRepository</strong> folder. You need to ensure that the <strong class=" ">CIRepository</strong> folder is included in your source control system.</p>
<p>For details about the file system structure, see <a href="continuous-integration-repository-structure">Continuous integration repository structure</a>.</p>
    <h4 id="src-68882144_SerializingobjectstoXMLusingtheAPI-Restoringobjectsfromthefilesystem" class="heading "><span>Restoring objects from the file system</span></h4>
<p>When developing websites in a team, you may often need to load the serialized XML data of objects from a source control system or another developer.</p>
<p>You can restore the data from the XML files in the project's <strong class=" ">CIRepository</strong> folder using the <strong class=" ">ContinuousIntegration.exe</strong> command line utility available in the Kentico project's <strong class=" ">CMS\bin</strong> folder. The utility deserializes the objects stored in the project's <i class=" ">CIRepository</i> folder and creates, overwrites or removes corresponding data in the given project's database. See <a href="restoring-continuous-integration-files-to-the-database">Restoring continuous integration files to the database</a> for details.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Warning</strong>: The restore operation <i class=" "><strong class=" ">deletes</strong></i> all objects of the supported types that do not exist as files in the repository. Only restore if you are sure that the <i class=" ">CIRepository</i> folder contains the required state of your object data. We also recommend creating regular backups of your database.</p>
        </div>
    </div>
<p>If you wish to implement a custom solution for restoring objects to the database, use the Kentico API.</p>
<p>Call the <strong class=" ">RestoreAll</strong> static method of the <strong class=" ">CMS.ContinuousIntegration.FileSystemRepositoryManager</strong> class. The method returns a <strong class=" ">RepositoryActionResult</strong> object, which you can use to verify the success of the operation and process any errors that occurred.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Notes</strong></p>
<ul class=" "><li class=" "><p>To avoid potential collisions in the <i class=" ">CIRepository</i> folder, we strongly recommend calling the restore API from an external application while the main Kentico application is not running. For example, you can create a custom console application for this purpose (see <a href="using-the-kentico-api-externally">Using the Kentico API externally</a>).<br><br></p>
</li><li class=" "><p>The <i class=" ">RestoreAll</i> method may have a long run time, depending on the number of objects in your file system repository.</p>
</li></ul>        </div>
    </div>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.Base;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.ContinuousIntegration;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">...</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">RepositoryActionResult result;</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Disables automatic processing of new smart search indexing tasks during the restore operation to prevent potential conflicts</code></div>
<div class="line"><code class="comments">// Indexing tasks are still created, but processed after the restore is finished</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> (</code><code class="keyword">new</code><code class="plain"> CMSActionContext { EnableSmartSearchIndexer = </code><code class="keyword">false</code><code class="plain"> })</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Deserializes all supported objects from the file system repository and saves them to the database</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Deletes objects from the database if their representation does not exist in the file system repository</code></div>
<div class="line"><code class="plain">	result = FileSystemRepositoryManager.RestoreAll((logItem) =&gt; </code></div>
<div class="line"><code class="plain">	{ </code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Optionally create a progress log by processing the 'logItem.Message' strings </code></div>
<div class="line"><code class="plain">	});</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="comments">// Checks whether the restoring process was successful        </code></div>
<div class="line"><code class="keyword">if</code><code class="plain"> (!result.Success)</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">foreach</code><code class="plain"> (</code><code class="keyword">string</code><code class="plain"> error </code><code class="keyword">in</code><code class="plain"> result.Errors)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Display or log the errors</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>