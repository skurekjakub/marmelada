<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Working with Buy X Get Y discounts - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68881374"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="E-commerce-features.html">E-commerce features</a></li>
                                                                                                         <li class="shortcut"><a href="Managing-your-store.html">Managing your store</a></li>
                                                                                     <li><a href="Discounts.html">Discounts</a></li>
                                                            </ul>
</div>            <h1 id="src-68881374"> <span>Working with Buy X Get Y discounts</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="section-left"><p>Buy X Get Y discounts in the Kentico E-commerce Solution are a cross-selling tool which allows you to increase sales of chosen products. The <strong class=" ">Buy X Get Y discounts</strong> application facilitates a number of shopping scenarios, such as:</p><ul class=" "><li class=" "><p>buy some of specified products, get the cheapest product for free, e.g., buy 3 pieces of clothes, get the cheapest one for free, or</p>
</li><li class=" "><p>buy some of specified products, get a specific other product for free or with a discount, e.g. buy a computer, get <i class=" ">Steve Jobs (E-book)</i> for free, or buy <i class=" ">Adidas Zebra Crew T-Shirt</i>, get one more with a 50% discount.</p>
</li></ul><p>To set up a basic Buy X Get Y discount:</p><ol class=" "><li class=" "><p>Open the <strong class=" ">Buy X Get Y discounts</strong> application.</p>
</li><li class=" "><p>Click <strong class=" ">New Buy X Get Y discount</strong>.</p>
</li><li class=" "><p>Type a <strong class=" ">Name</strong> for the discount.</p>
</li><li class=" "><p>Specify <strong class=" ">"Buy" conditions</strong>. Buy conditions indicate the products that customers need to add to their shopping cart to be eligible to get products for free or with a discount.</p>
<ul class=" "><li class=" "><p><strong class=" ">Buy any </strong>– select one of the following options:</p>
<ul class=" "><li class=" "><p><strong class=" ">products</strong> – for individual products</p>
</li><li class=" "><p><strong class=" ">products in sections</strong> – for entire sections of the <a href="configuring-product-structure">product tree structure</a></p>
</li><li class=" "><p><strong class=" ">products in departments</strong> – for entire <a href="departments">departments</a></p>
</li><li class=" "><p><strong class=" ">products with brands</strong> – for products with assigned <a href="managing-brands-and-manufacturers">brands</a></p>
</li><li class=" "><p><strong class=" ">products in collections</strong> – for products assigned to <a href="managing-product-collections">collections</a></p>
</li></ul></li><li class=" "><p><strong class=" ">Products / Sections / Departments / Brands / Collections</strong> – depending on your choice in <strong class=" ">Buy any</strong>, select a list of either products, sections, departments, brands or collections.</p>
</li><li class=" "><p><strong class=" ">Minimum unit quantity</strong> – specify how many product units customers need to add to their shopping cart to be eligible for the discount.</p>
</li></ul></li><li class=" "><p>Specify <strong class=" ">"Get" conditions</strong>. Get conditions define what products customers get for free or with a discount.</p>
<ul class=" "><li class=" "><p><strong class=" ">Get</strong> – select <i class=" ">cheapest unit for discounted amount</i> to automatically apply the discount to the cheapest product from the set specified in <strong class=" ">"Buy" conditions</strong>; select <i class=" ">specific product for discounted amount</i> to define a product that will be added to the customer's order as a gift.</p>
</li><li class=" "><p><strong class=" ">Specific product</strong> – appears if you selected <i class=" ">specific product for discounted amount</i> in <strong class=" ">Get</strong>.</p>
</li><li class=" "><p><strong class=" ">Discount</strong> – select <i class=" ">percentage</i> to apply the discount as a percentage or <i class=" ">fixed amount</i> to apply the discount in a specific amount of money in the <a href="configuring-currencies">main currency</a>.</p>
</li><li class=" "><p><strong class=" ">Amount</strong> – specify an exact value of the discount either as a percentage or fixed amount according to <strong class=" ">Discount</strong>.</p>
</li></ul></li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>You have now created a <strong class=" ">Buy X Get Y discount</strong>. Whenever a customer fulfills the <strong class=" ">"Buy" conditions</strong>, they get the discount which you specified in the <strong class=" ">"Get" conditions</strong>. You can find the newly added discount with the lowest priority at the end of the Buy X Get Y discount list. To create more complex Buy X Get Y discount, <a href="#src-68881374_workingwithbuyxgetydiscounts-reference">see all parameters below</a>.</p><p></p><p></p><div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Effects of discount modification on already existing orders</strong></p>
<p>If you edit or delete a discount, existing orders do not change and remain with the original discount. To update existing orders according to the new rules, you need to edit the orders manually.</p>
        </div>
    </div><p></p></div>




    

    <div class="section-right"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p></p>
<ul class="toc-indentation "><li class=" "><p><a href="#src-68881374_workingwithbuyxgetydiscounts-buyxgetydiscountsshoppingexamples">Buy X Get Y discounts shopping examples</a></p>
</li><li class=" "><p><a href="#src-68881374_workingwithbuyxgetydiscounts-changingbuyxgetydiscountpriority">Changing Buy X Get Y discount priority</a></p>
</li><li class=" "><p><a href="#src-68881374_workingwithbuyxgetydiscounts-displayingbuyxgetydiscountdatatocustomers">Displaying Buy X Get Y discount data to customers</a></p>
</li><li class=" "><p><a href="#src-68881374_workingwithbuyxgetydiscounts-reference">Reference</a></p>
</li><li class=" "><p><a href="#src-68881374_workingwithbuyxgetydiscounts-buyxgetydiscountapi">Buy X Get Y discount API</a></p>
</li></ul><p></p>
        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class="confluence-link "><p><a href="working-with-coupon-codes">Working with coupon codes</a></p>
</li><li class=" "><p><a href="displaying-shopping-cart-details-on-pages">Displaying shopping cart details on pages</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 id="src-68881374_WorkingwithBuyXGetYdiscounts-BuyXGetYdiscountsshoppingexamples" class="heading "><span>Buy X Get Y discounts shopping examples</span></h3>
<p>Example 1 – <strong class=" ">buy one item, get another one free</strong> (in other words, buy two items for the price of one): A customer adds two pairs of jeans to their shopping cart. The system automatically applies a 100% discount on one of the items. If a customer adds only one pair of jeans to their shopping cart, another pair is <strong class=" ">not</strong> added automatically.</p>
<p>Example 2 – <strong class=" ">buy multiple items, get the cheapest one free</strong>: A customer adds multiple different books to the shopping cart. The system evaluates which item has the lowest price (before applying other discounts) and applies a 100% discount on that item. The discount can also be less than 100%.</p>
<p>Example 3 – <strong class=" ">buy one item, get a gift</strong>: A customer adds a tennis racket to their shopping cart. The system automatically adds a pack of tennis balls (with a 100% discount) to the shopping cart. If the customer adds the balls first and then the racket, the system applies a 100% discount on the set of balls.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The system adds products to the shopping cart automatically only if you set the "Get" condition of the particular Buy X Get Y discount to "specific product" and select the <strong class=" ">Add product to cart automatically</strong> field.</p>
        </div>
    </div>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Customers are not automatically notified when they have an opportunity to purchase a discounted product based on their current shopping cart content. To notify them, you can <a href="creating-new-web-parts">create a custom web part</a>.</p>
        </div>
    </div>
    <h3 id="src-68881374_WorkingwithBuyXGetYdiscounts-ChangingBuyXGetYdiscountpriority" class="heading "><span>Changing Buy X Get Y discount priority</span></h3>
<p>Buy X Get Y discounts are applied based on their priority. The discount priority is determined by the order of items in the discount listing. The higher the discount is, the higher its priority.</p>
<p>Priorities can be changed using drag-and-drop functionality. To change the priorities of your discounts:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Buy X Get Y discounts</strong> application.</p>
<ul class=" "><li class=" "><p>The discounts are ordered according to their current priority.</p>
</li></ul></li><li class=" "><p>Drag a discount using the <strong class=" ">Move</strong> (<img class="confluence-embedded-image" src="images/download/attachments/68879208/move2.png" alt="images/download/attachments/68879208/move2.png">
    ) area to a different position in the listing.<br><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68881374/changing_priority.png" alt="images/download/attachments/68881374/changing_priority.png" width="500">
        <br><span class="caption">Changing the discount priority</span>
    <br></p>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>If you cannot use drag-and-drop, expand the <i class=" ">Other actions </i>menu by clicking the <strong class=" ">Other actions</strong> button (<strong class=" ">...</strong>) and then click either <strong class=" ">Move up</strong> or <strong class=" ">Move down</strong> to change the discount's priority.</p>
        </div>
    </div>
<p><br></p>
</li><li class=" "><p>(Optional) <strong class=" ">Edit</strong> (<img class="confluence-embedded-image confluence-external-resource" src="images/docs.kentico.com/download/attachments/57442434/edit2.png" alt="images/docs.kentico.com/download/attachments/57442434/edit2.png">
) individual discounts and change the <strong class=" ">Apply lower priority discounts</strong> field<strong class=" "> </strong>as necessary. If cleared, no other Buy X Get Y discounts are applied to the shopping cart.</p>
</li></ol><p>Buy X Get Y discounts are now applied based on the new order.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong><br></p>
<ul class=" "><li class=" "><p>The system does not stack Buy X Get Y discounts for individual units of products. If multiple Buy X Get Y discounts apply to a single product that is added multiple times to the shopping cart, the system applies the discounts according to their priority. Each application "uses up" the number of product units specified in the discount's "Buy" and "Get" conditions, and these units can no longer be processed by other Buy X Get Y discounts.</p>
</li><li class=" "><p>If you have a discount for a group of products, and want to set a larger discount for a specific product from the same group, you need to create a new discount with the total discount amount and assign it a higher priority.</p>
</li><li class=" "><p>Other <a href="discounts">discounts</a> of a different type (e.g., volume discounts, product coupons) are still applied regardless of the Buy X Get Y priority.</p>
</li></ul>        </div>
    </div>
    <h4 id="src-68881374_safe-id-V29ya2luZ3dpdGhCdXlYR2V0WWRpc2NvdW50cy1FeGFtcGxl4oCTQnV5WEdldFlkaXNjb3VudHByaW9yaXR5" class="heading "><span>Example – Buy X Get Y discount priority</span></h4>
<p>The following example sets a 10% discount on any book and an additional 5% discount to every bought <i class=" ">Steve Jobs (E-book</i>) product.</p>
<ol class=" "><li class=" "><p>Create a new discount for any book.</p>
<ul class=" "><li class=" "><p><strong class=" ">Name</strong>: Buy a book, get 10% off</p>
</li><li class=" "><p><strong class=" ">Buy any</strong>: products in departments</p>
</li><li class=" "><p><strong class=" ">Departments</strong>: Books</p>
</li><li class=" "><p><strong class=" ">Amount</strong>: 10%</p>
</li></ul></li><li class=" "><p>Create a new discount for the <i class=" ">Steve Jobs (E-book)</i> product.</p>
<ul class=" "><li class=" "><p><strong class=" ">Name</strong>: Buy Steve Jobs, get 15% off</p>
</li><li class=" "><p><strong class=" ">Products</strong>: Steve Jobs (E-book)</p>
</li><li class=" "><p><strong class=" ">Amount</strong>: 15%</p>
<ul class=" "><li class=" "><p>That is 10% for any book and the additional 5% discount for <i class=" ">Steve Jobs (E-book)</i>.</p>
</li></ul></li></ul></li><li class=" "><p>Drag the <i class=" ">Steve Jobs (E-book)</i> discount using the <strong class=" ">Move</strong> (</p>
<img class="confluence-embedded-image" src="images/download/attachments/68879208/move2.png" alt="images/download/attachments/68879208/move2.png">
    <p>) area above the <i class=" ">Buy a book, get 10% off</i> discount in the listing.</p>
</li></ol><p>Now when a customer adds a book to the shopping cart, the discount for all books applies. If the <i class=" ">Steve Jobs (E-book)</i> product is added to the shopping cart, the discount just for the book about Steve Jobs applies.</p>
    <h3 id="src-68881374_WorkingwithBuyXGetYdiscounts-DisplayingBuyXGetYdiscountdatatocustomers" class="heading "><span>Displaying Buy X Get Y discount data to customers</span></h3>
<p>To display information about applied Buy X Get Y discounts on your store's <a href="checkout-process">checkout</a> pages, you need to correctly format the data of the items in the current shopping cart.</p>
<p>When using the <strong class=" ">Shopping cart content</strong> web part, display Buy X Get Y discount data within the <a href="writing-transformations">transformation</a> applied to the shopping cart items. You can either call the <strong class=" ">GetMultiBuyDiscountNames</strong> transformation method or work with the <strong class=" ">DiscountSummary</strong> property of the transformed shopping cart items. For detailed information, see <a href="displaying-shopping-cart-details-on-pages">Displaying shopping cart details on pages</a>.</p>
<p><img class="confluence-embedded-image confluence-content-image-border" src="images/download/attachments/68881374/displaying_bxgy_pages.png" alt="images/download/attachments/68881374/displaying_bxgy_pages.png" width="500">
        <br><span class="caption">Buy X Get Y discounts displayed in the shopping cart content on a checkout page</span>
    </p>
    <h4 id="src-68881374_WorkingwithBuyXGetYdiscounts-Invoicesandemails" class="heading "><span>Invoices and emails</span></h4>
<p>In <a href="configuring-invoices">invoices</a> and <a href="configuring-e-commerce-email-notifications">e-commerce notification templates</a>, you can display Buy X Get Y discount data in the <a href="using-transformations-in-macro-expressions">transformation</a> applied to the <strong class=" ">ContentTable</strong> items (i.e. the product items in the related order).</p>
<p>To show customers the price reduction granted by Buy X Get Y discounts for each item, display the <strong class=" ">TotalDiscount</strong> value of the transformed order item. The property contains the sum of the discount values for all Buy X Get Y discounts and <a href="working-with-product-coupons">product coupons</a> applied to the given order item.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example - ContentTable item transformation</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example - ContentTable item transformation" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">tr</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">td</code><code class="plain">&gt;{% HTMLEncode(Localize(SKUName)) %} {% HTMLEncode(SKUNumber) %}&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">td</code><code class="plain">&gt;{% Units %}&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">td</code><code class="plain">&gt;{% HTMLEncode(UnitPrice.Format(Currency.CurrencyFormatString)) %}&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">td</code><code class="plain">&gt;{% HTMLEncode(TotalDiscount.Format(Currency.CurrencyFormatString)) %}&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">td</code><code class="plain">&gt;{% HTMLEncode(TotalPrice.Format(Currency.CurrencyFormatString)) %}&lt;/</code><code class="keyword">td</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">tr</code><code class="plain">&gt;</code></div>
</div>
    </div>
<p>If you wish to include detailed information about the applied Buy X Get Y discounts, you need to process the data available in the <strong class=" ">DiscountSummary</strong> property of order items. <i class=" ">DiscountSummary</i> is a collection of all Buy X Get Y discounts and product coupons that were applied to the given order item. Each record in the collection holds the following properties:</p>
<ul class=" "><li class=" "><p><strong class=" ">Name</strong> – the name of the discount as specified in the Buy X Get Y discounts application.</p>
</li><li class=" "><p><strong class=" ">Value</strong> – the total amount saved after applying the discount to the given order item (for all product units).</p>
</li></ul><p>To format the <i class=" ">DiscountSummary,</i> either <a href="macro-syntax">iterate through the collection</a> and manually generate the output, or call the <strong class=" ">ApplyTransformation</strong> macro method and define a <strong class=" ">Text / XML</strong> type transformation for the summary items.</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example - Iterating through DiscountSummary</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example - Iterating through DiscountSummary" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">{%</code></div>
<div class="line"><code class="plain">  result = </code><code class="string">""</code><code class="plain">;</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">if</code><code class="plain"> (DiscountSummary.Any()) {</code></div>
<div class="line"><code class="plain">    result += </code><code class="string">"&lt;ul&gt;"</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    </code><code class="keyword">foreach</code><code class="plain"> (item </code><code class="keyword">in</code><code class="plain"> DiscountSummary) {</code></div>
<div class="line"><code class="plain">      result += </code><code class="string">"&lt;li&gt;"</code><code class="plain"> + HTMLEncode(Localize(item.Name)) + </code><code class="string">" ("</code><code class="plain"> + HTMLEncode(item.Value.Format(Currency.CurrencyFormatString)) + </code><code class="string">")&lt;/li&gt;"</code></div>
<div class="line"><code class="plain">    };</code></div>
<div class="line"><code class="plain">	result += </code><code class="string">"&lt;/ul&gt;"</code><code class="plain">;</code></div>
<div class="line"><code class="plain"> &nbsp;}</code></div>
<div class="line"><code class="plain">  </code><code class="keyword">return</code><code class="plain"> result;</code></div>
<div class="line"><code class="plain">%}</code></div>
</div>
    </div>
    <h3 id="src-68881374_WorkingwithBuyXGetYdiscounts-Reference" class="heading "><span>Reference</span></h3>
    <div class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col width="275.0">
                                    <col width="1527.0">
                            </colgroup>
        <thead class=" ">    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>General</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Name</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The discount name that is displayed in the shopping cart, invoices, and emails.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Code name</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>The unique identifier of the discount object (for example used by developers in custom code).</p>
<p>Unless there is a reason to set a particular value, you can leave the default <i class=" ">(automatic)</i> option, and the system generates an appropriate code name automatically.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Enabled</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>If selected, the discount can be applied. If cleared, the discount is disabled.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>"Buy" Conditions</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Buy any</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specifies the products that customers need to add to the shopping cart to obtain the discount.</p>
<ul class=" "><li class=" "><p><strong class=" ">Products</strong> – choose individual products.</p>
</li><li class=" "><p><strong class=" ">Products in sections</strong> – choose entire sections of the <a href="configuring-product-structure">product tree structure</a></p>
</li><li class=" "><p><strong class=" ">Products in departments</strong> – choose whole <a href="departments">departments</a> of products.</p>
</li><li class=" "><p><strong class=" ">Products with brands</strong> – choose <a href="managing-brands-and-manufacturers">brands</a>, which are assigned to products</p>
</li><li class=" "><p><strong class=" ">Products in collections</strong> – choose product <a href="managing-product-collections">collections</a> (each product can be assigned to a collection)</p>
</li></ul><p>For example, if you set the discount's <strong class=" ">Minimum unit quantity</strong> to 3 and choose 6 products in this field, the "Buy" conditions are fulfilled whenever a customer adds any combination of 3 products from the given set to the shopping cart.</p>
<p>Choose one of the options and then select the <strong class=" ">Products</strong>, <strong class=" ">Sections</strong>, <strong class=" ">Departments</strong>,<strong class=" "> Brands</strong> or <strong class=" ">Collections</strong> that fulfill the "Buy conditions".</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Exclude</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>You can optionally exclude products from the discount's "Buy conditions" (unless the <i class=" ">Buy any</i> property is set to choose individual products). The exclusion options allow you to select <a href="configuring-product-structure">product sections</a>, <a href="managing-brands-and-manufacturers">brands</a> or <a href="managing-product-collections">collections</a>.</p>
<p>Choose the <i class=" ">products in sections</i>, <i class=" ">products with brands</i> or <i class=" ">products in collections</i> option in the <strong class=" ">Exclude</strong> property and then select the <strong class=" ">Excluded sections</strong>, <strong class=" ">Excluded brands</strong> or <strong class=" ">Excluded collections</strong>.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Minimum unit quantity</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specify how many units customers need to add to their shopping cart to be eligible for the discount.</p>
<p>For example, type 2 when:</p>
<ul class=" "><li class=" "><p>The customer adds 2 products to the shopping cart, and gets another product for free.</p>
</li><li class=" "><p>The customer adds 3 products to the shopping cart, and one of them gets a discount.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>"Get" Conditions</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Get</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Select what customers get if they fulfill <strong class=" ">"Buy" conditions</strong>.</p>
<ul class=" "><li class=" "><p><strong class=" ">Cheapest unit for discounted amount</strong> – the cheapest unit from the "Buy condition" products gets the discount.</p>
</li><li class=" "><p><strong class=" ">Specific product for discounted amount</strong> – the system automatically adds a specific product to the customer's shopping cart, or customers have an option to add a specific product to their shopping cart for a discounted price.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specific product</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Appears when you select <i class=" ">specific product for discounted amount</i> in <strong class=" ">Get</strong>.</p>
<p>Select specific product which gets the discount.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Discount</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specify if you want to apply the discount as a percentage or a fixed amount.</p>
<ul class=" "><li class=" "><p><strong class=" ">Percentage</strong> – the price of the cheapest unit or the product specified in <strong class=" ">Get</strong> is reduced by the specified percentage.</p>
</li><li class=" "><p><strong class=" ">Fixed amount</strong> – the price of the cheapest unit or the product specified in <strong class=" ">Get</strong> is reduced by a specific amount in the site's <a href="configuring-currencies">main currency</a>.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Amount</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specify the exact value of the discount. The amount must be a valid decimal number.</p>
<ul class=" "><li class=" "><p>If the amount is a percentage, enter a number between 0 and 100.</p>
</li><li class=" "><p>If the amount is fixed, enter a number greater than 0.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Add product to cart automatically</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Appears when you select <i class=" ">specific product for discounted amount</i> in <strong class=" ">Get</strong>, and when <strong class=" ">Amount</strong> is 100%.</p>
<p>If selected, the system adds the specified product to the shopping cart automatically when the shopping cart fulfills the <strong class=" ">"Buy" conditions</strong></p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>If you choose a specific product to be added automatically to the customer's order as a gift, the system does not add the product when:</p>
<ul class=" "><li class=" "><p>you choose a product with <a href="working-with-product-options">product options</a> (but you can choose a product variant), or</p>
</li><li class=" "><p>the discounted product is not allowed for sale, or</p>
</li><li class=" "><p>the discounted product is allowed to be sold only if items are available and there are no available items left.</p>
</li></ul>        </div>
    </div>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>Customers cannot remove an automatically added product if they are entitled to it. If they try to remove the product, the system adds it again immediately.</p>
        </div>
    </div>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Coupons</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Customer has to redeem a coupon to get the discount</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>If selected, only customers who enter a valid coupon code are able to apply the discount.</p>
<p>You can define coupon codes on the <strong class=" ">Coupons</strong> tab in the left menu. After enabling the field and saving the discount, you will be redirected there automatically.</p>
<p>See <a href="working-with-coupon-codes">Working with coupon codes</a> to learn more.</p>
    <div class="scroll-expand-container collapsed">
        <div class="scroll-expand-control">
            <span class="scroll-expand-control-icon">&nbsp;</span>
            <span class="scroll-expand-control-text">Examples...</span>
        </div>
        <div class="scroll-expand-content">
<p>The examples show how the auto-adding feature works if the discount is coupon-based.</p>
<p><strong class=" ">Example 1:</strong></p>
<ul class=" "><li class=" "><p>The customer adds X to the cart, Y is not auto-added.</p>
</li><li class=" "><p>The customer enters a coupon code, Y is auto-added.</p>
</li><li class=" "><p>The customer removes the coupon code, Y is auto-removed.</p>
</li></ul><p><strong class=" ">Example 2:</strong></p>
<ul class=" "><li class=" "><p>The customer adds X to the cart, Y is not auto-added.</p>
</li><li class=" "><p>The customer adds Y.</p>
</li><li class=" "><p>The customer enters a coupon code, Y in the shopping cart is recalculated as free.</p>
</li></ul><p><strong class=" ">Example 3:</strong></p>
<ul class=" "><li class=" "><p>The customer enters a coupon code.</p>
</li><li class=" "><p>The customer adds X to the cart, Y is auto-added.</p>
</li></ul>        </div>
    </div>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Target customers</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Available for</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Determines which types of users are able to apply the discount:</p>
<ul class=" "><li class=" "><p><strong class=" ">All visitors</strong> – all customers are eligible for the discount.</p>
</li><li class=" "><p><strong class=" ">Registered users</strong> – only <a href="customers">registered customers</a> are eligible for the discount.</p>
</li><li class=" "><p><strong class=" ">Registered users in selected roles</strong> – only registered customers in selected <a href="role-management">roles</a> can use the discount. To specify the roles:<br></p>
<ol class=" "><li class=" "><p>Click<strong class=" "> Select roles</strong> to open the <strong class=" ">Select roles</strong> dialog.</p>
</li><li class=" "><p>Choose the required roles.</p>
</li><li class=" "><p>Click <strong class=" ">Select</strong>.</p>
</li></ol></li></ul>    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>You can enter roles directly by typing in their code names separated by semicolons, e.g., <i class=" ">_authenticated_;Members</i>.</p>
        </div>
    </div>
    <div class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>You can add registered customers to roles in the <strong class=" ">Customers</strong> application while editing customers on the <strong class=" ">Roles</strong> tab.</p>
        </div>
    </div>
            </td>
        </tr>
    <tr>
            <td class="confluenceTh" rowspan="1" colspan="2">
    <p>Discount processing</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Apply lower priority discounts</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>If selected, other Buy X Get Y discounts with lower priority are applied to the order as well. If cleared, processing of Buy X Get Y discounts stops with this discount.</p>
<p>Note: The system does not stack Buy X Get Y discounts for individual units of products. If multiple Buy X Get Y discounts apply to a single product that is added multiple times to the shopping cart, the system applies the discounts according to their priority. Each application "uses up" the number of product units specified in the discount's "Buy" and "Get" conditions, and these units can no longer be processed by other Buy X Get Y discounts.</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Limit use per order</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Determines how many times the system can apply the discount to a single order. If you leave the value empty, the number of discount applications is unlimited.</p>
<p>For example, if a discount has the <strong class=" ">Minimum unit quantity</strong> set to 2 and a <strong class=" ">100% discount</strong> on the <strong class=" ">cheapest</strong> product:</p>
<ul class=" "><li class=" "><p>A customer adds 3 products to their shopping cart.</p>
</li><li class=" "><p>In the shopping cart, the system applies a 100% discount to the cheapest product.</p>
</li><li class=" "><p>If the customer adds another 3 products, the cart contains 6 total products. If <strong class=" ">Limit user per order</strong> is not set, the system applies the discount twice, so the two cheapest products are for free. If <strong class=" ">Limit user per order</strong> is set to 1, the system applies the discount only once, so only the first cheapest product is for free.</p>
</li></ul>            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Valid to</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specifies the time and date until which the discount is valid. If you leave the value empty, the discount is valid permanently (starting from the <strong class=" ">Valid from</strong> date).</p>
            </td>
        </tr>
    <tr>
            <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Valid from</p>
            </td>
                <td class="confluenceTd" rowspan="1" colspan="1">
    <p>Specifies the time and date from which the discount is valid. If you leave the value empty, the discount applies at any time before the <strong class=" ">Valid to</strong> date.</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <h3 id="src-68881374_WorkingwithBuyXGetYdiscounts-BuyXGetYdiscountAPI" class="heading "><span>Buy X Get Y discount API</span></h3>
<p>Buy X Get Y discounts are called MultiBuyDiscounts in the API. The basic API consists of the following classes:</p>
<ul class=" "><li class=" "><p><strong class=" ">MultiBuyDiscountInfo</strong> – each object represents a Buy X Get Y discount (or <a href="working-with-product-coupons">product coupon</a>).</p>
</li><li class=" "><p><strong class=" ">MultiBuyDiscountInfoProvider</strong> – provides management functionality for Buy X Get Y discounts (and product coupons).</p>
</li></ul><p>The system applies Buy X Get Y discounts on the level of individual items in the shopping cart (each item can contain multiple units of the same product). In the API and macros, you can access related values using the following:</p>
<ul class=" "><li class=" "><p><strong class=" ">ShoppingCartInfo.CartItems</strong> (<strong class=" ">ShoppingCartItems</strong> in macros) – a collection of all <strong class=" ">ShoppingCartItemInfo</strong> objects within a given shopping cart object.</p>
</li><li class=" "><p><strong class=" ">ShoppingCartItemInfo.TotalDiscount</strong> –<strong class=" "> </strong>decimal value containing the sum of all price reductions granted by Buy X Get Y discounts and product coupons applied to the given shopping cart item.</p>
</li><li class=" "><p><strong class=" ">ShoppingCartItemInfo.DiscountSummary</strong> – a collection of <strong class=" ">SummaryItem</strong> objects applied to the given shopping cart item. The collection contains both Buy X Get Y discounts and product coupons that apply to the shopping cart item.</p>
</li><li class=" "><p><strong class=" ">SummaryItem </strong>– a simplified data view used to summarize applied discounts. Contains only the <i class=" ">Name</i> and <i class=" ">Value</i> of the discount.</p>
</li></ul>        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>