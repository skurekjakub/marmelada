<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Searching attachment files - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script> 
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260" elementpageid="68882007">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15">
                    <input type="submit" style="display:none" tabindex="-4">
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo">
                </h1>
                <a href="Kentico-11-Documentation-Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882007"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico-11-Documentation-Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Configuring-Kentico.html">Configuring Kentico</a></li>
                                                                                     <li><a href="Setting-up-search-on-your-website.html">Setting up search on your website</a></li>
                                                            </ul>
</div>            <h1 id="src-68882007"> <span>Searching attachment files</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
<div class="sp-grid-cell sp-grid-60"><p>The <a href="setting-up-search-on-your-website">smart search</a> allows users to search through the content of files uploaded as <a href="attaching-files-to-pages">page attachments</a>. The attachment search supports both types of <a href="storing-files">file storage</a> provided by Kentico (database or file system).</p><div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The attachment search only works for files that are connected to pages through one of the following methods:</p>
<ul class=" "><li class=" "><p>Attachment files added to pages through fields with the <strong class=" ">Data type </strong>set to <i class=" "><strong class=" ">File</strong></i> or <i class=" "><strong class=" ">Attachments</strong></i> in the <a href="creating-page-types">page type definition</a></p>
</li><li class=" "><p>Attachments uploaded in the <strong class=" ">Pages</strong> application on the <strong class=" ">Properties -&gt; Attachments</strong> tab of pages</p>
</li></ul>        </div>
    </div><h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Choosing which file types are searchable</span></h3><p>By default, the attachment search supports the following file types:</p><ul class=" "><li class=" "><p>txt</p>
</li><li class=" "><p>csv</p>
</li><li class=" "><p>pdf</p>
</li><li class=" "><p>docx</p>
</li><li class=" "><p>xlsx</p>
</li><li class=" "><p>pptx</p>
</li><li class=" "><p>xml</p>
</li><li class=" "><p>html</p>
</li><li class=" "><p>htm</p>
</li></ul><div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: The search does NOT work for:</p>
<ul class=" "><li class=" "><p>Legacy MS Office formats: doc, xls, ppt</p>
</li><li class=" "><p>Certain types of PDF files, including:</p>
<ul class=" "><li class=" "><p>Encrypted files</p>
</li><li class=" "><p>Files using PDF version 1.5 or older</p>
</li></ul></li></ul>        </div>
    </div><p>You can limit which of the file types are searchable for individual websites:</p><ol class=" "><li class=" "><p>Open the <strong class=" ">Settings</strong> application.</p>
</li><li class=" "><p>Navigate to the <strong class=" ">System -&gt; Search</strong> category.</p>
</li><li class=" "><p>Select file extensions in the <strong class=" ">Allowed attachment file types</strong> setting (if no checkboxes are selected, all supported types of attachment files are indexed).</p>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li></ol><p>If you wish to search one of the unsupported file types, you need to implement a <a href="adding-custom-search-text-extractors-for-files">custom search text extractor</a>.</p></div>
    
    

    


    <div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="sp-grid-cell sp-grid-40 sp-grid-sidebar"><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882007_searchingattachmentfiles-choosingwhichfiletypesaresearchable">Choosing which file types are searchable</a></p>
</li><li class=" "><p><a href="#src-68882007_searchingattachmentfiles-enablingindexingforpageattachments">Enabling indexing for page attachments</a></p>
</li><li class=" "><p><a href="#src-68882007_searchingattachmentfiles-configuringtheattachmentsearch">Configuring the attachment search</a></p>
</li></ul>        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="adding-custom-search-text-extractors-for-files">Adding custom search text extractors for files</a></p>
</li><li class=" "><p><a href="configuring-sql-search-for-attachment-files">Configuring SQL search for attachment files</a></p>
</li></ul>        </div>
    </div></div><div class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<ul class="toc-indentation "><li class=" "><p><a href="#src-68882007_searchingattachmentfiles-choosingwhichfiletypesaresearchable">Choosing which file types are searchable</a></p>
</li><li class=" "><p><a href="#src-68882007_searchingattachmentfiles-enablingindexingforpageattachments">Enabling indexing for page attachments</a></p>
</li><li class=" "><p><a href="#src-68882007_searchingattachmentfiles-configuringtheattachmentsearch">Configuring the attachment search</a></p>
</li></ul>        </div>
    </div><div class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p><a href="adding-custom-search-text-extractors-for-files">Adding custom search text extractors for files</a></p>
</li><li class=" "><p><a href="configuring-sql-search-for-attachment-files">Configuring SQL search for attachment files</a></p>
</li></ul>        </div>
    </div></div>
    
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Enabling indexing for page attachments</span></h3>
<p>The attachment search functionality is supported by indexes of the <strong class=" ">Pages</strong> type, for both <a href="creating-azure-search-indexes">Azure Search indexes</a> and <a href="defining-local-page-indexes">local indexes</a>. The attachment search is NOT available for local indexes of the <strong class=" ">Pages crawler</strong> type, which directly index the HTML output of pages.</p>
<p>To set up the attachment search for your website:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">Smart search</strong> application.</p>
</li><li class=" "><p>Create or edit a <strong class=" ">Pages</strong> type search index (either as an <a href="creating-azure-search-indexes">Azure Search index</a> or a <a href="defining-local-page-indexes">local index</a>).</p>
</li><li class=" "><p>When defining the search content on the <strong class=" ">Indexed content</strong> tab, select the <strong class=" ">Include attachment content</strong> option for the index's allowed content.</p>
</li><li class=" "><p>Click <strong class=" ">Save</strong>.</p>
</li><li class=" "><p>Switch to the <strong class=" ">General</strong> tab and<strong class=" "> Rebuild</strong> the index.</p>
</li></ol><p>While building the page index, the smart search processes the allowed pages, extracts the text of any attachment files and includes it in the content of the index (along with the other page data). When users perform a search using the index, the system returns results for pages whose attachments match the search expression.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Updating the search content of attachments (Upgrades and Hotfixes)<br></strong></p>
<p>Kentico stores the text content extracted from page attachments in the database. When rebuilding page indexes, the search loads the "cached" attachment text from the database. The system only processes the file text directly for attachments that do not have any search content saved.</p>
<p>If you apply a hotfix or upgrade that changes how the search indexes attachment files, you need to clear the attachment search content:</p>
<ol class=" "><li class=" "><p>Open the <strong class=" ">System</strong> application.</p>
</li><li class=" "><p>Select the <strong class=" ">Files -&gt; Attachments</strong> tab.</p>
</li><li class=" "><p>Click <strong class=" ">Clear attachment search cache</strong>.</p>
</li></ol><p>You can then <strong class=" ">Rebuild</strong> your page indexes, which updates the attachment content according to the new functionality.</p>
        </div>
    </div>
    <h3 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Configuring the attachment search</span></h3>
<p>You can adjust how the system indexes attachment files by adding keys to the <strong class=" ">appSettings</strong> section of your application's <strong class=" ">web.config</strong> file.</p>
    <div class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p>The indexed content always includes:</p>
<ul class=" "><li class=" "><p>File metadata (title, tags, author name etc.)</p>
</li><li class=" "><p>Comments (for example in MS Office files)</p>
</li></ul>        </div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Limiting the maximum size of indexed files</span></h4>
<p>Indexing of very large files can be resource intensive and have a negative impact on your website's performance. To prevent the system from indexing files larger than a certain size, add the <strong class=" ">CMSSearchMaxAttachmentSize</strong> key:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSSearchMaxAttachmentSize"</code><code class="plain"> value=</code><code class="string">"10000"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
<p>They key sets the maximum allowed file size in kB. The search ignores page attachments whose size exceeds the value.</p>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Indexing of XML content</span></h4>
<p>When indexing the content of XML files, the search does NOT include the following content by default:</p>
<ul class=" "><li class=" "><p>Comments</p>
</li><li class=" "><p>The values of tag attributes</p>
</li></ul><p>You can enable indexing for such content by adding the following web.config keys:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSSearchIndexXmlComments"</code><code class="plain"> value=</code><code class="string">"true"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSSearchIndexXmlAttributes"</code><code class="plain"> value=</code><code class="string">"true"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
    <h4 $stringutils.tolowercase(${idattribute})="" class="heading "><span>Enabling character encoding detection for text files</span></h4>
<p>By default, the search can read text files (<strong class=" ">txt</strong> and <strong class=" ">csv</strong>) that use the following character encoding:</p>
<ul class=" "><li class=" "><p><a class="external-link" href="http://en.wikipedia.org/wiki/Utf-8">UTF-8</a></p>
</li><li class=" "><p>The default Windows encoding (the operating system's current ANSI code page)</p>
</li></ul><p>If you encounter problems when indexing text files with a different encoding type, you can enable automatic encoding detection:</p>
    <div class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;add key=</code><code class="string">"CMSSearchDetectTextEncoding"</code><code class="plain"> value=</code><code class="string">"true"</code><code class="plain"> /&gt;</code></div>
</div>
    </div>
<p>The system then attempts to detect the encoding type for each file, and use the correct option when reading the content during the indexing process.</p>
    <div class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p><strong class=" ">Note</strong>: Correct encoding detection is not guaranteed for all files. Automatic detection also slightly increases the time required to index text files.</p>
        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>


</body></html>