<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Initializing modules to run custom code - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico_11_Documentation_Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882228"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico_11_Documentation_Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Custom_development.html">Custom development</a></li>
                                                                                     <li><a href="Creating_custom_modules.html">Creating custom modules</a></li>
                                                            </ul>
</div>            <h1 id="src-68882228"> <span>Initializing modules to run custom code</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
        $page.content
<p   
>You can modify the behavior of the Kentico application by registering a <a   href="Creating_custom_modules.html">custom module</a> and executing code during its initialization:</p>
    <div  class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">Tip</strong>: If you only wish to run custom initialization code without developing a complete module, you can register &quot;code-only&quot; modules. You do not need to create a matching module object within the <strong class=" ">Modules</strong> application in the Kentico administration interface.</p>
        </div>
    </div>
<ol class=" "><li class=" "><p   
>Open your project in Visual Studio (using the <strong class=" ">WebSite.sln</strong> or <strong class=" ">WebApp.sln</strong> file).</p>
</li><li class=" "><p   
>Create a class in the module&#39;s code folder, for example <i class=" ">~/App_Code/CMSModules/CompanyOverview</i>.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If your module uses a separate assembly, add the module class into the corresponding project.</p>
<p   
>Keep in mind that the code of your custom assembly project must contain the <strong class=" ">[assembly: AssemblyDiscoverable]</strong> attribute (the recommended location is in the <i class=" ">Properties/AssemblyInfo.cs</i> file). To use the attribute, your assembly&#39;s project must contain a reference to the <i class=" ">CMS.Core.dll</i> library.</p>
        </div>
    </div>
</li><li class=" "><p   
>Make the module class inherit from <strong class=" ">CMS.DataEngine.Module</strong>.</p>
</li><li class=" "><p   
>Define the constructor of the module class:</p>
<ul class=" "><li class=" "><p   
>Inherit from the base constructor</p>
</li><li class=" "><p   
>Enter the code name of the module as the base constructor parameter (for code-only modules, the value can be any string except for the names of existing modules)</p>
</li><li class=" "><p   
>If you are developing a <a   href="Creating_installation_packages_for_modules.html">module with installation package support</a>, you need to set the optional second parameter <i class=" ">(isInstallable)</i> to <i class=" "><strong class=" ">true</strong></i><br/><br/></p>
</li></ul></li><li class=" "><p   
>Register the module class using the <strong class=" ">RegisterModule</strong> assembly attribute.</p>
</li><li class=" "><p   
>Implement your custom functionality inside the module class.</p>
</li></ol>    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="Creating_custom_modules.html">Creating custom modules</a></p>
</li><li class=" "><p   
><a   href="Handling_global_events.html">Handling global events</a></p>
</li></ul>        </div>
    </div>
<p   
>You can achieve most customizations by running code during the initialization of the module &ndash; override the following methods:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">OnInit (recommended)</strong> - the system executes the code during the initialization (start) of the application. A typical example of <i class=" ">OnInit</i> code is assigning handler methods to system events.</p>
</li><li class=" "><p   
><strong class=" ">OnPreInit</strong> - the system executes the code before <i class=" ">OnInit.</i> Does <i class=" ">not</i> support any operations that require access to the database, such as working with the data of modules. For example, you can use <i class=" ">OnPreInit</i> to register custom implementations of interfaces.</p>
</li></ul><p   
>Because you cannot manually set the initialization order of modules or define dependencies between modules, we do not recommend working with the data of other modules directly inside the <i class=" ">OnInit</i> method<i class=" ">.</i> The best approach is to <a   href="Handling_global_events.html">assign handlers to system events</a>, and perform the actual operations inside the handler methods. For general code that is not related to a specific system event, you can use the <strong class=" ">ApplicationEvents.Initialized.Execute</strong> event, which occurs after all modules in the system are initialized.</p>
<p   
>For example, the following code extends the sample <i class=" ">Company overview</i> module from the <a   href="Creating_custom_modules.html">Creating custom modules</a> page. The example uses event handling to log an entry in the system&#39;s <a   href="Working_with_the_system_event_log.html">Event log</a> whenever a new office is created.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">Example</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="Example" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">using</code><code class="plain"> CMS;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.DataEngine;</code></div>
<div class="line"><code class="keyword">using</code><code class="plain"> CMS.EventLog;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">[assembly: RegisterModule(</code><code class="keyword">typeof</code><code class="plain">(CompanyOverviewModule))]</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">public</code><code class="plain"> </code><code class="keyword">class</code><code class="plain"> CompanyOverviewModule : Module</code></div>
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain">	</code><code class="comments">// Module class constructor, inherits from the base constructor with the code name of the module as the parameter</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">public</code><code class="plain"> CompanyOverviewModule()</code></div>
<div class="line"><code class="plain">		: </code><code class="keyword">base</code><code class="plain">(</code><code class="string">"CompanyOverview"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="comments">// Initializes the module. Called when the application starts.</code></div>
<div class="line"><code class="plain">	</code><code class="keyword">protected</code><code class="plain"> </code><code class="keyword">override</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> OnInit()</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">base</code><code class="plain">.OnInit();</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">		</code><code class="comments">// Assigns a handler to the Insert.After event for OfficeInfo objects</code></div>
<div class="line"><code class="plain">		CompanyOverview.OfficeInfo.TYPEINFO.Events.Insert.After += Office_InsertAfter;</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">	</code><code class="keyword">private</code><code class="plain"> </code><code class="keyword">void</code><code class="plain"> Office_InsertAfter(</code><code class="keyword">object</code><code class="plain"> sender, ObjectEventArgs e)</code></div>
<div class="line"><code class="plain">	{</code></div>
<div class="line"><code class="plain">		</code><code class="comments">// Logs an information entry into the system's event log whenever a new office is created</code></div>
<div class="line"><code class="plain">		</code><code class="keyword">string</code><code class="plain"> message = </code><code class="string">"New office '"</code><code class="plain"> + e.Object.GetStringValue(</code><code class="string">"OfficeDisplayName"</code><code class="plain">, </code><code class="string">""</code><code class="plain">) + </code><code class="string">"' was created in the custom Company overview module."</code><code class="plain">;</code></div>
<div class="line"><code class="plain">		EventLogProvider.LogInformation(</code><code class="string">"Company overview module"</code><code class="plain">, </code><code class="string">"NEW OFFICE"</code><code class="plain">, message);</code></div>
<div class="line"><code class="plain">	}</code></div>
<div class="line"><code class="plain">}</code></div>
</div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
