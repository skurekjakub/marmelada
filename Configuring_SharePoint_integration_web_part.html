<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Configuring SharePoint integration web part - Kentico 11 Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="68879260">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">K11</span>
                    <img class="space-logo" src="global.logo" />
                </h1>
                <a href="Kentico_11_Documentation_Home.html" class="ht-space-link">
                    <h2>Kentico 11 Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=68882854"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Kentico_11_Documentation_Home.html">Kentico 11 Documentation</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="Integrating_3rd_party_systems.html">Integrating 3rd party systems</a></li>
                                                                                     <li><a href="Integrating_SharePoint.html">Integrating SharePoint</a></li>
                                                            </ul>
</div>            <h1 id="src-68882854"> <span>Configuring SharePoint integration web part</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">
        $page.content
<p   
>Besides specifying a <a   href="Configuring_SharePoint_integration_connections.html">connection to the SharePoint server</a>, you need to configure the <strong class=" ">SharePoint data source</strong> <a   href="Using_and_configuring_web_parts.html">web part</a> to be able to browse the contents of a SharePoint site in Kentico.</p>
    <h3 id="src-68882854_ConfiguringSharePointintegrationwebpart-AddingSharePointintegrationwebpart" class="heading "><span>Adding SharePoint integration web part</span></h3>
<ol class=" "><li class=" "><p   
>Open the <strong class=" ">Pages</strong> application.</p>
</li><li class=" "><p   
>Select a page in the content tree.</p>
<ul class=" "><li class=" "><p   
>You are selecting a page where the system will display the requested SharePoint data.</p>
</li></ul></li><li class=" "><p   
>Switch to the <strong class=" ">Design</strong> tab.</p>
</li><li class=" "><p   
><a   href="Using_and_configuring_web_parts.html">Add</a> the <strong class=" ">SharePoint data source</strong> web part to the selected web part zone.</p>
</li><li class=" "><p   
>Configure the <strong class=" ">SharePoint data source</strong> web part.</p>
</li></ol>    <h4 id="src-68882854_ConfiguringSharePointintegrationwebpart-ConfiguringSharePointintegrationwebpart" class="heading "><span>Configuring SharePoint integration web part</span></h4>
<ol class=" "><li class=" "><p   
>Specify the SharePoint integration connection.</p>
<ul class=" "><li class=" "><p   
><strong class=" ">Connection</strong></p>
</li></ul></li><li class=" "><p   
>Specify how the system retrieves the SharePoint data.<br/></p>
<ul class=" "><li class=" "><p   
><strong class=" ">Retrieve </strong>- indicates whether the system downloads all lists of the selected type (the<strong class=" "> List type</strong> property), or only items from a specified list (the <strong class=" ">List name</strong> property) of the selected type.<strong class=" "><br/></strong></p>
</li></ul></li><li class=" "><p   
>Specify the type of SharePoint data.</p>
<ul class=" "><li class=" "><p   
><strong class=" ">List type</strong> - indicates whether the system downloads from the SharePoint server custom lists, picture libraries, or document libraries.<strong class=" "><br/></strong></p>
</li></ul><p   
><img  class="confluence-embedded-image confluence-content-image-border"  src="images/download/attachments/68882854/configuring_web_part.png" alt="images/download/attachments/68882854/configuring_web_part.png" width="500"  />
<br/><br/></p>
<ul class=" "><li class=" "><p   
>Based on the selection of the data retrieval mode (the <strong class=" ">Retrieve</strong> property), the system offers other web part properties.<br/></p>
</li></ul></li><li class=" "><p   
>Specify other web part properties based on the selection of the data retrieval mode.</p>
<ul class=" "><li class=" ">    <div class="scroll-expand-container collapsed">
        <div class="scroll-expand-control">
            <span class="scroll-expand-control-icon">&nbsp;</span>
            <span class="scroll-expand-control-text">Retrieve: All lists of type</span>
        </div>
        <div class="scroll-expand-content">
<p   
>(Optional) You can specify web part properties in the <strong class=" ">System settings</strong> section. See <a   href="Configuring_caching.html">Configuring caching</a> for more details.</p>
        </div>
    </div>
</li><li class=" ">    <div class="scroll-expand-container collapsed">
        <div class="scroll-expand-control">
            <span class="scroll-expand-control-icon">&nbsp;</span>
            <span class="scroll-expand-control-text">Retrieve: Specified list's items</span>
        </div>
        <div class="scroll-expand-content">
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Section</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Properties</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>General</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">List name </strong>- specifies the name of the list or library on the SharePoint server from which the system loads the items.<strong class=" "><br/></strong></p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Selection</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Field name</strong><strong class=" "><br/></strong></p>
</li><li class=" "><p   
><strong class=" ">Field type</strong><strong class=" "><br/></strong></p>
</li><li class=" "><p   
><strong class=" ">Field value</strong></p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Properties in the <strong class=" ">Selection</strong> section allow you to specify which items the system retrieves from the SharePoint server. To achieve this, you can also use the <strong class=" ">Query</strong> property in the <strong class=" ">Advanced</strong> section.</p>
<p   
>Properties in the <strong class=" ">Selection</strong> section are optional.</p>
        </div>
    </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Advanced</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" "><p   
><strong class=" ">Relative URL of listed folder </strong>- allows you to specify the server-relative URL of the SharePoint folder within a list or library.</p>
<ul class=" "><li class=" "><p   
>If blank, the system lists the root folder.</p>
</li><li class=" "><p   
>If the list or library does not support folders, keep blank.</p>
</li></ul></li><li class=" "><p   
><strong class=" ">Retrieval mode </strong>- allows you to specify whether the system retrieves files and folders, or only files. The system supports inclusion of subfolders.</p>
<ul class=" "><li class=" "><p   
>Some lists and libraries do not support folders. In such case the listing of folders or inclusion of subfolders has no effect.</p>
</li></ul></li><li class=" "><p   
><strong class=" ">Row limit</strong> - allows you to specify the maximum number of items (data rows) that the system retrieves.<strong class=" "><br/></strong></p>
</li><li class=" "><p   
><strong class=" ">Query</strong> - allows you to enter a condition determining which items the system retrieves. You can use this property to change the items&#39; order, too.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>You need to enter an inner XML of CAML Query element. See a sample query:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;Where&gt;</code></div>
<div class="line"><code class="plain">  &lt;Eq&gt;</code></div>
<div class="line"><code class="plain">    &lt;FieldRef Name=</code><code class="string">"ID"</code><code class="plain"> /&gt;&lt;Value Type=</code><code class="string">"Counter"</code><code class="plain">&gt;</code><code class="value">1</code><code class="plain">&lt;/Value&gt;</code></div>
<div class="line"><code class="plain">  &lt;/Eq&gt;</code></div>
<div class="line"><code class="plain">&lt;/Where&gt;</code></div>
<div class="line"><code class="plain">&lt;OrderBy&gt;</code></div>
<div class="line"><code class="plain">  &lt;FieldRef Name=</code><code class="string">"Modified"</code><code class="plain"> Ascending=</code><code class="string">"false"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">&lt;/OrderBy&gt;</code></div>
</div>
    </div>
        </div>
    </div>
<p   
></p>
</li><li class=" "><p   
><strong class=" ">Retrieved fields</strong> - allows you to specify SharePoint list or SharePoint library field names (internal names) that the system retrieves. Separate the names by semicolons, or keep blank to retrieve all fields.<strong class=" "><br/></strong></p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Properties in the <strong class=" ">Advanced </strong>section are optional.</p>
        </div>
    </div>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
>(Optional) You can specify web part properties in the <strong class=" ">System settings</strong> section. See <a   href="Configuring_caching.html">Configuring caching</a> for more details.</p>
        </div>
    </div>
<p   
></p>
</li></ul></li><li class=" "><p   
>(Optional) Select the <strong class=" ">Show debugging information</strong> property available in the <strong class=" ">Debug</strong> section to display information suitable for debugging.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If selected, the system displays the SharePoint data in a table. The system informs you whether the data is retrieved from the SharePoint server, or from the system cache.</p>
<p   
><strong class=" ">Debugging allows you to look for fields that contain valuable information, and are suitable for display purposes.</strong></p>
        </div>
    </div>
<p   
></p>
</li><li class=" "><p   
>Click <strong class=" ">Save &amp; Close</strong>.</p>
</li></ol><p   
>You have configured the SharePoint integration web part. Because this web part serves as a data source for the SharePoint data, to <a   href="Displaying_SharePoint_data_in_Kentico.html">display the data</a>, you now need to add a content displaying web part to the same page.</p>
    <div  class="confbox panel">
            <div class="title panel-header">On this page</div>
            <div class="panel-content">
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-68882854_ConfiguringSharePointintegrationwebpart-AddingSharePointintegrationwebpart">Adding SharePoint integration web part</a></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-68882854_ConfiguringSharePointintegrationwebpart-ConfiguringSharePointintegrationwebpart">Configuring SharePoint integration web part</a></p>
</li></ul></li></ul><p   
></p>
        </div>
    </div>
    <div  class="confbox panel">
            <div class="title panel-header">Related pages</div>
            <div class="panel-content">
<ul class=" "><li class=" "><p   
><a   href="Configuring_SharePoint_integration_connections.html">Configuring SharePoint integration connections</a></p>
</li><li class=" "><p   
><a   href="Displaying_SharePoint_data_in_Kentico.html">Displaying SharePoint data in Kentico</a></p>
</li><li class=" "><p  class="with-breadcrumbs" 
><a   href="Using_and_configuring_web_parts.html">Using and configuring web parts</a></p>
</li></ul>        </div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
><strong class=" ">How it works - API<br/></strong></p>
<p   
>The system uses the <strong class=" ">SharePoint data source</strong> web part to retrieve a data source object (DataSet), which contains a table with the requested SharePoint data. Another web part that uses the SharePoint web part as its data source, for example the <strong class=" ">Basic repeater</strong> web part, then displays the SharePoint data on the page through a selected transformation.</p>
<p   
>Based on configuration of the <strong class=" ">SharePoint data source</strong> web part, the system loads the data using the corresponding SharePoint integration service.</p>
<ul class=" "><li class=" "><p   
>SharePoint integration API uses the <strong class=" ">CMS.SharePoint</strong> namespace.</p>
</li><li class=" "><p   
>The system contains a factory class for each supported SharePoint version, implementing the <strong class=" ">ISharePointServiceFactory</strong> interface.</p>
</li><li class=" "><p   
>The system gets the factory object corresponding to the target SharePoint version using the <strong class=" ">SharePointServiceFactoryProvider.Current.GetSharePointServiceFactory</strong> method.</p>
</li><li class=" "><p   
>To create an instance of the required SharePoint service, the system calls the <strong class=" ">GetImplementationFor&lt;ISharePointService&gt;</strong> method of this factory object.</p>
</li></ul>        </div>
    </div>
        </div>

    </article>


               
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
